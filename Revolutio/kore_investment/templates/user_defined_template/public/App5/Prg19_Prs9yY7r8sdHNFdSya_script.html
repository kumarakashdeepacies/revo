
      <style>
        .buttonstyling{
          margin-bottom:10px;
        }
      </style>
     <script>
      var dashboardSave_ = true;
      function editNameIndex(){
        let id_ = $(this).attr("id").replace("tabHeader","indextab");
        $(`#${id_}`).find("a").html($(this).text());
      }
      const gotoTab = (parent, index) => {
          let id = '#analysis' + index;
          $(id).trigger('click');
        }
      function plotChartsAnalysis(calling = false, dic = {}, p_id = "", app_code = "", tab = false) {
        if($(this).attr("data-data") != undefined || calling == true) {
          let chartJson = "";
          let parentContainerID = "";
          let thresholdGuage = "";
          let parentId = "";
          if (calling == false){
            app_code = $(this).attr("app_code");
            chartJson=JSON.parse($(this).attr("data-data"))
            parentContainerID = JSON.parse($(this).attr("data-parentContainerID"))
            let configDic = JSON.parse($(this).attr("data-configdic"))
            let tabDict = configDic["tabDict"]
            let tabSlicerConfig = configDic["tabSlicerConfig"]
            let final_f_dict2 = configDic["final_f_dict2"]
            thresholdGuage = configDic["thresholdGuage"]
            let interaction = configDic["interaction"]
            let tab_ID = configDic["tab_ID"]
            parentId = configDic["parentId"]
          }
          if (calling == true){
            chartJson = dic["chartJson"]
            parentContainerID = p_id
            thresholdGuage = {}
            parentId = dic["parentId"]
          }

          $(this).removeAttr("data-data")
          $("#"+parentContainerID).attr("data-count",chartJson.length)
          let marginLeft = parseInt($("#"+parentContainerID).css("width"))
          if(chartJson.length != 0 && calling == false){
            $("#"+parentContainerID).append(`<i class="fa fa-spinner fa-pulse loadingSymbol" style="position:absolute;font-size: 100px;margin-left:50%; margin-top:15%;z-index: 99999;"></i>`)
          }
          for(i in chartJson){
          let filters = chartJson[i].filters
          let filter_input_final = chartJson[i].filter_input_final
          let drange = chartJson[i].drange
          let plotType = chartJson[i].chartType;
          if(plotType=="Textbox"){
            let chartLength = parseInt($("#"+parentContainerID).attr("data-count"));
            chartLength --;
            $("#"+parentContainerID).attr("data-count",chartLength)
          }
          if(plotType=="Textbox"){
              if(!chartJson[i].hasOwnProperty('id_text_editor')) {
              $(`#${parentContainerID}`).append(`<div class="small-box commentboxcard" data-id="${id_text_editor}" id = "${id_text_editor}" onmouseenter="showTool.call(this)" onmouseleave="hideTool.call(this)" style="position:absolute;min-height:6rem;min-width:6rem;height:${chartJson[i].height+"px"};width:${chartJson[i].width+"px"};top:${chartJson[i].position.top+"px"};left:${chartJson[i].position.left+"px"};" >
                  <div class="row"  style="position:absolute; margin-left:100%; display:none;flex-wrap:wrap;">
                    <i class="fa fa-times deleteCommentBox" title="Delete" style="font-size:1rem;margin-right:0.5rem;margin-left:1px;margin-bottom:2px;"></i>
                    <i class='fas fa-edit' onclick="ckEditorFunc.call(this)" style="font-size:1rem;margin-right:0.5rem;margin-bottom:2px;"></i>
                    <i class="fa fa-arrows" style="font-size:1rem;margin-right:0.5rem;"></i>
                  </div>
                <div class="commentbox contentEditable" name="comment" style="margin-top:1rem;max-height: 75%;padding: 0.3em 0.5em 0 0.5em;background-color: transparent;text-align: left;overflow-y: auto;">
                ${chartJson[i].textboxvalue}
                </div>
              </div>`)
            } else {
              let id_text_editor =  chartJson[i].id_text_editor

              $(`#${parentContainerID}`).append(`
              <div class="small-box commentboxcard" data-id="${id_text_editor}" id = "${id_text_editor}" onmouseenter="showTool.call(this)" onmouseleave="hideTool.call(this)" style="position:absolute;min-height:6rem;min-width:6rem;height:${chartJson[i].height+"px"};width:${chartJson[i].width+"px"};top:${chartJson[i].position.top+"px"};left:${chartJson[i].position.left+"px"};">
                <div class="row"  style="position:absolute; margin-left:100%; display:none;flex-wrap:wrap;">
                  <i class="fa fa-times deleteCommentBox" title="Delete" style="font-size:1rem;margin-right:0.5rem;margin-left:1px;margin-bottom:2px;"></i>
                  <i class='fas fa-edit' onclick="ckEditorFunc.call(this)" style="font-size:1rem;margin-right:0.5rem;margin-bottom:2px;"></i>
                  <i class="fa fa-arrows" style="font-size:1rem;margin-right:0.5rem;"></i>
                </div>
                <div class="commentbox contentEditable" name="comment" style="margin-top:1rem;max-height: 75%;padding: 0.3em 0.5em 0 0.5em;background-color: transparent;text-align: left;overflow-y: auto;">
                ${chartJson[i].textboxvalue}
                </div>
              </div>`);

              }
              $(".commentboxcard").resizable();
              $('.contentEditable').each(function () {
                  $(this).on('click', function () {
                    $(this).attr("contenteditable", "true")
                    $(this).focus()
                  })
                  $(this).focusout(function () {
                      let content = this.innerText
                      content = content.trim()
                      if (content.length == 0){
                        this.innerText = "Enter text here."
                        $(this).removeAttr("contenteditable");
                        $(this).trigger("click")
                      }
                      else{
                      $(this).removeAttr("contenteditable");
                      }
                  })
                })
                  $(`#${parentContainerID}`).find('.deleteCommentBox').click(function () {
                      $(this).parent().parent().remove()
                  })
                  $(`#${parentContainerID}`).find(".commentboxcard").draggable({
                      cancel: '',
                      containment: "parent",
                  });
          }
          else{
              let tab_id = parentContainerID
              let height = chartJson[i].height;
              let width = chartJson[i].width;
              let position = chartJson[i].position;
              let config_gridlines = chartJson[i].config_gridlines;
              let layout = chartJson[i].layout;
              let graph_subtype = chartJson[i].graph_subtype;
              let chartDivId = chartJson[i].id;
              let graphdata = chartJson[i].data;
              let x_axis = chartJson[i].x_axis;
              let y_axis = chartJson[i].y_axis;

              let computed_number = chartJson[i].computed_number;
              let img_icon = chartJson[i].img_icon;
              let is_title = chartJson[i].is_title;
              let title_value = chartJson[i].title_value;
              let operation_n = chartJson[i].operation_n;
              let agg_distinct = chartJson[i].agg_distinct;

              let second_column = chartJson[i].second_column;
              let operation = chartJson[i].operation;
              let operation_line = chartJson[i].operation_line;
              let titlefontsize = chartJson[i].titlefontsize;
              let valuefontsize = chartJson[i].font_size;
              let chart_title = chartJson[i].chart_title;
              let data_value = chartJson[i].data_value;
              let config_valuesize = chartJson[i].config_valuesize;
              let config_titlesize = chartJson[i].config_titlesize;
              let config_data_value = chartJson[i].config_data_value;
              let backgroundcolor = chartJson[i].backgroundcolor;
              let changed_text = chartJson[i].changed_text;
              let chartheader = chartJson[i].chartheader;
              let filters=JSON.stringify(chartJson[i].filters);
              let line_column=chartJson[i].line_column;
              let tableName=chartJson[i].tableName;
              let color = chartJson[i].color;
              let plot_bg_color = chartJson[i].plot_bg_color;
              let global_bg = chartJson[i].global_bg;
              let grad_color = chartJson[i].grad_color;
              let global_bgcolor = chartJson[i].global_bgcolor;
              let global_ind_color = chartJson[i].global_ind_color;
              let config_color = chartJson[i].config_color;
              let config_labels = chartJson[i].config_labels;
              let config_xrange = chartJson[i].config_xrange;
              let config_yrange = chartJson[i].config_yrange;
              let config_x_axis_title = chartJson[i].config_x_axis_title;
              let legend_x = chartJson[i].legend_x;
              let legend_y = chartJson[i].legend_y;
              let config_label_placement = chartJson[i].config_label_placement;
              let config_y_axis_title = chartJson[i].config_y_axis_title;
              let config_element_color = chartJson[i].config_element_color;
              let element_label = chartJson[i].element_label;
              let total_y = chartJson[i].total_y;
              let total_L = chartJson[i].total_L;
              let data_shadowon = chartJson[i].data_shadowon;
              let data_shadecolor = chartJson[i].data_shadecolor;
              let data_shadowX = chartJson[i].data_shadowX;
              let data_shadowY = chartJson[i].data_shadowY;
              let data_shadowblurry = chartJson[i].data_shadowblurry;
              let data_borderColor = chartJson[i].data_borderColor;
              let data_borderStyle = chartJson[i].data_borderStyle;
              let data_borderon = chartJson[i].data_borderon;
              let data_borderThickness = chartJson[i].data_borderThickness;
              let data_shadowThick = chartJson[i].data_shadowThick;
              let header_fontsize = chartJson[i].header_fontsize;
              let header_fontweight = chartJson[i].header_fontweight;
              let header_fontstyle = chartJson[i].header_fontstyle;
              let header_alignment = chartJson[i].header_alignment;
              let header_color = chartJson[i].header_color;
              let header_bgcolor = chartJson[i].header_bgcolor;
              let conditional_table = chartJson[i].conditional_table;
              let slicerColumnId = tab_id.replace("analysisrow", "selectSlicerConfig_")
              let slicerColumnValue = []
              let slicerColumn = []
              if(chartJson[i]["app_code"] != undefined){
                app_code = chartJson[i]["app_code"];
              } else {
                if (calling == true && tab == false){
                  app_code = "";
                }
              }


              for (let i = 0; i < $(`.${slicerColumnId}`).length; i++) {
                  slicerColumnValue.push($(`.${slicerColumnId}`).eq(i).val());
                  slicerColumn.push($(`.${slicerColumnId}`).eq(i).attr("data-slicerColumn"))
              }

              let plotDict = {"thresholdConfig":thresholdGuage, 'is_title':is_title,'title_value':title_value,"element_id":parentId,"pr_code":windowLocation.split("/")[2],"conditional_table":conditional_table,"img_icon" : img_icon, "header_alignment":header_alignment,"header_fontstyle":header_fontstyle,"header_fontsize":header_fontsize,"header_fontweight":header_fontweight, "header_color":header_color,"header_bgcolor":header_bgcolor,"data_shadowon":data_shadowon, "data_shadecolor":data_shadecolor, "data_shadowX":data_shadowX, "data_shadowY":data_shadowY, "data_shadowblurry":data_shadowblurry, "data_shadowThick":data_shadowThick, "data_borderColor":data_borderColor, "data_borderStyle":data_borderStyle, "data_borderon":data_borderon, "data_borderThickness":data_borderThickness,'total_y':total_y,'total_L':total_L,'color':color,'plot_bg_color':plot_bg_color,'global_bg':global_bg,'grad_color':grad_color,'global_bgcolor':global_bgcolor,'global_ind_color':global_ind_color,"element_label":element_label,"config_element_color":config_element_color,"config_data_value":config_data_value,"config_valuesize":config_valuesize,"config_titlesize":config_titlesize, "config_label_placement":config_label_placement,"legend_x":legend_x,"legend_y":legend_y,'computed_number':computed_number,'operation_n':operation_n,"agg_distinct":agg_distinct, "operation": operation, "operation_line": operation_line, "tableName":tableName, "filters":filters,"line_column":line_column,"chartheader": chartheader, "chart_title": chart_title,"data_value":data_value, "x_axis": x_axis, "y_axis": y_axis, "second_column": second_column,  'graph_subtype': graph_subtype, 'tab_id': tab_id, 'height': height, 'width': width, 'data': graphdata, 'layout': layout, 'chartDivId': chartDivId, "position": position, "backgroundcolor": backgroundcolor, "titlefontsize": titlefontsize, "valuefontsize": valuefontsize,"titlefontsize": titlefontsize, "config_color":config_color,"config_xrange":config_xrange,"config_yrange":config_yrange,"config_gridlines":config_gridlines,"config_labels":config_labels,"config_x_axis_title":config_x_axis_title,"config_y_axis_title":config_y_axis_title,"changed_text": changed_text,"filters":filters,'filter_input_final': JSON.stringify(filter_input_final), 'drange': JSON.stringify(drange)}
              let y = false;
              if (editType == "Disable"){
                y = true;
              }
              plotFunction(plotDict, slicerColumn="", slicerColumnValue="", slicerColumnId=slicerColumnId,existingDivId=chartDivId, app_code_ = app_code, disable = y)

              slicerChangeUpdatePlots(app_code);
          }

          }
        }
      }
    </script>
    <script>
        let activeElement = "no";        var None = 'None';        var listViewTableDict={};        var listViewEditTemplate = {};        var createViewIdList = [];        var elementIDList=[];        var chartConfigDict={};        var crossFilterDict={};        var element_table_IDList = [];        var computationElementIdsArray = [];        var previousRunComputeElementIdArray = [];        var element_page = [];        var names = {};
        var app_code_home = '';        var user_home = '';        var item_code_list = [];        var grapejs = 1;        var m_col_basefilter = {};        var globalFuncList_scenario = [];        var variableList_scenario = [];        var analysiselementIDList=[];        var mColBasefilter = {};        var chartSaveEleIdList = [];        var chartSaveEleId = "";        var slicerTabConfigDict = {};        var sharedConfig = {"element_id":"", "config":[]};        var editType = "Enable";        var button_ids = ["savebutton_","saveDraftbutton_","customValidationList","calculateComp","viewHistory_","button-id-back","resetDraft_","previewDraft_","rejectedRecords","viewTransactions"];        function enableSaveButton () {        
 $(this).find('button[value=Save]').prop('disabled',false);      
};

      function bta_apply() {
            let lba_data = {{lba_data | safe}};
            for (var key of Object.keys(lba_data)) {
              if(Object.keys(lba_data[key]).length != 0) {
              e_id = key;
              if (e_id.startsWith("whiteSpacewrap")) {
                if (!lba_data[key].includes("CreateView - Save")) {
                  $(`#savebutton_${e_id}`).attr("disabled", "true");
                  $(`#compare_existing_${e_id}`).attr("disabled", "true");
                }

                if (!lba_data[key].includes("CreateView - Save as Draft")) {
                  $(`#saveDraftbutton_${e_id}`).attr("disabled", "true");
                  $(`#resetDraft_${e_id}`).attr("disabled", "true");
                  $(`#previewDraft_${e_id}`).attr("disabled", "true");
                }

                if (!lba_data[key].includes("CreateView - Custom Validation")) {
                  $(`#customValidationList${e_id}`).attr("disabled", "true");
                  $(`#customValidation${e_id}`).attr("disabled", "true");
                }

                if (!lba_data[key].includes("CreateView - Refresh Computation")) {
                  $(`#calCompVal_${e_id}`).attr("disabled", "true");
                }

                if (!lba_data[key].includes("CreateView - Back")) {
                  $(`#button-id-back${e_id}`).attr("disabled", "true");
                }

                if (!lba_data[key].includes("CreateView - View History")) {
                  $(`#viewHistory_${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("CreateView - View Rejected Records")) {
                  $(`#rejectedRecords${e_id}`).attr("disabled", "true");
                }

                if (!lba_data[key].includes("CreateView - View Transaction Status")) {
                  $(`#showTransactions${e_id}`).attr("disabled", "true");
                  $(`#viewTransactions${e_id}`).attr("disabled", "true");
                }
              }
              if (e_id.startsWith("ellipse")) {
                if (!lba_data[key].includes("Analysis - Previous Versions")) {
                  $(`#previousVersion${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("Analysis - Save and Share")) {
                  $(`#saveShare${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("Analysis - Plot charts")) {
                  $(`#plotCharts${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("Analysis - PDF")) {
                  $(`#analysisPDF${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("Analysis - Save")) {
                  $(`#saveChartConfigButton${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("Analysis - Global Settings")) {
                  $(`#globalButton${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("Analysis - Add tab")) {
                  $(`#analysisAddTab${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("Analysis - Tab config")) {
                  $(`#TabSettings${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("Analysis - Import dashboard")) {
                  $(`#importDashboard${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("Analysis - Publish")) {
                  $(`#publishDashboard${e_id}`).attr("disabled", "true");
                }
              }

              if (e_id.startsWith("parallelogram")) {
                if (!lba_data[key].includes("Computation - Run Model")) {
                  $(`#runModel_${e_id}`).attr("disabled", "true");
                }

                if (!lba_data[key].includes("Computation - Configure Scenario")) {
                  $(`#scenarios_${e_id}`).attr("disabled", "true");
                }

                if (!lba_data[key].includes("Computation - Filter")) {
                  $(`#filter_button_prev_run_computation${e_id}`).attr(
                    "disabled",
                    "true"
                  );
                  $(`#freezepane_button_prev_run_computation${e_id}`).attr(
                    "disabled",
                    "true"
                  );
                }
              }
              if (e_id.startsWith("document")) {
                if (!lba_data[key].includes("UploadView - Upload")) {
                  $(`#uploadFile${e_id}`).attr("disabled", "true");
                  $(`#downloadButton${e_id}`).attr("disabled", "true");
                }

                if (!lba_data[key].includes("UploadView - Map Columns")) {
                  $(`#columnMapperButton${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("UploadView - Custom Validation")) {
                  $(`#customValidationButton${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("UploadView - Add computation logic")) {
                  $(`#computedFieldMapperButton${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("UploadView - Download data")) {
                  $(`#downloadData${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("UploadView - Upload history")) {
                  $(`#downloadHistory${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("UploadView - Last upload errors")) {
                  $(`#downloadLastUploadErrors${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("UploadView - Detailed error log")) {
                  $(`#downloadErrorLog${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("UploadView - Transaction status")) {
                  $(`#showTransactions${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("UploadView - SFTP connectors")) {
                  $(`#sftpUploadButton${e_id}`).attr("disabled", "true");
                }
              }
              if (e_id.startsWith("process")) {
                if (!lba_data[key].includes("ListView - Upload")) {
                  $(`#uploadButton${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Save template")) {
                  $(`#saveTemplateButton${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Set Alerts")) {
                  $(`#displayalert${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Paste Tabular Data")) {
                  $(`#tablegenerator_${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Edit Mode")) {
                  $(`#editListView${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Delete all data")) {
                  $(`#listview_clearall_${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Find and replace")) {
                  $(`#find_replace_${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Freeze Panes")) {
                  $(`#freeze_pane_${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Formatters")) {
                  $(`#formatter_${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Transactions Status")) {
                  $(`#showTransactions${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Plot Charts")) {
                  $(`#plotCharts${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Filter")) {
                  $(`#filter_button_list_view${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Add Computed Fields")) {
                  $(`#addComp_field_${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Expand")) {
                  $(`#example1_expand${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Extract Data")) {
                  $(`#extract_data_${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Bulk Update")) {
                  $(`#bulk_update_${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Conditional Delete")) {
                  $(`#conditional_delete_${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Approve all")) {
                  $(`#approve_all_ApprovalTemplate_${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Reject all")) {
                  $(`#reject_all_ApprovalTemplate_${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Approve Multiple")) {
                  $(`#approve_multiple_ApprovalTemplate_${e_id}`).attr("disabled", "true");
                }
                if (!lba_data[key].includes("ListView - Reject Multiple")) {
                  $(`#reject_multiple_ApprovalTemplate_${e_id}`).attr("disabled", "true");
                }
              }
              $("section").addClass('visible-section')
          }else{
            $("section").addClass('visible-section')
          }
        }
      }
      $(document).ready(bta_apply);
    </script>
  
<script>
        
        if(document.getElementById(`indextabellipse085898477182030741`) != null){
          document.getElementById(`indextabellipse085898477182030741`).addEventListener("click", (e) => { 
              e.preventDefault();
              gotoTab("#analysisTabellipse08589847718203074", "tabellipse085898477182030741"); 
          });
        }
        $(`#removeTabellipse085898477182030741`).click(function() {
          $(`#index`+$(this).attr("id").replace("removeT","t")).closest(".row").remove()
          const deleteButton = document.getElementById(`removeTabellipse085898477182030741`);
          let ind = 0
          $("#tabLinksellipse08589847718203074").find(".col-2").each(function() {
            $(this).find("p").html(++ind)
          })
          deleteButton.addEventListener("click", (e) => {
            const id = e.target.parentNode.id.replace('removeT', 'indext');;
            const indexTab = document.getElementById('tabLinksellipse08589847718203074');
            const linkToBeDeleted  = document.getElementById(`${id}`);
            $(`#${id}`).closest(".row").remove();
          })
          var tabAnchorID=$(this).attr('data-tabAnchorID')
          var tabContainerDivID=$(this).attr('data-tabContainerDivID')
          $(`#${tabAnchorID}`).parent().remove()
          $(`#${tabContainerDivID}`).remove()
        })
        $('.contentEditable').each(function () {
        $(this).on('click', function () {
          $(this).attr("contenteditable", "true")
          $(this).focus()
        })
        $(this).focusout(function () {
          var tab_header = this.innerText
          tab_header = tab_header.trim()
          if (tab_header.length == 0){
            this.innerText = "Set Name"
            $(this).removeAttr("contenteditable");
            $(this).addClass("bg-danger")
            $(this).trigger("click")
          }
          else{
          $(this).removeAttr("contenteditable");
          $(this).removeClass("bg-danger")
          }
      })
      })
    </script><script>
        
        if(document.getElementById(`indextabellipse085898477182030742`) != null){
          document.getElementById(`indextabellipse085898477182030742`).addEventListener("click", (e) => { 
              e.preventDefault();
              gotoTab("#analysisTabellipse08589847718203074", "tabellipse085898477182030742"); 
          });
        }
        $(`#removeTabellipse085898477182030742`).click(function() {
          $(`#index`+$(this).attr("id").replace("removeT","t")).closest(".row").remove()
          const deleteButton = document.getElementById(`removeTabellipse085898477182030742`);
          let ind = 0
          $("#tabLinksellipse08589847718203074").find(".col-2").each(function() {
            $(this).find("p").html(++ind)
          })
          deleteButton.addEventListener("click", (e) => {
            const id = e.target.parentNode.id.replace('removeT', 'indext');;
            const indexTab = document.getElementById('tabLinksellipse08589847718203074');
            const linkToBeDeleted  = document.getElementById(`${id}`);
            $(`#${id}`).closest(".row").remove();
          })
          var tabAnchorID=$(this).attr('data-tabAnchorID')
          var tabContainerDivID=$(this).attr('data-tabContainerDivID')
          $(`#${tabAnchorID}`).parent().remove()
          $(`#${tabContainerDivID}`).remove()
        })
        $('.contentEditable').each(function () {
        $(this).on('click', function () {
          $(this).attr("contenteditable", "true")
          $(this).focus()
        })
        $(this).focusout(function () {
          var tab_header = this.innerText
          tab_header = tab_header.trim()
          if (tab_header.length == 0){
            this.innerText = "Set Name"
            $(this).removeAttr("contenteditable");
            $(this).addClass("bg-danger")
            $(this).trigger("click")
          }
          else{
          $(this).removeAttr("contenteditable");
          $(this).removeClass("bg-danger")
          }
      })
      })
    </script> <script>
        if(!analysiselementIDList.includes('ellipse08589847718203074')){
              analysiselementIDList.push("ellipse08589847718203074");
        }
        function fetchSlicerParams(app_code = ""){
          $(".analysisSlicerTable").off('select2:select').on('select2:select', function(){
             if (app_code == ""){
              if($("body").find("div").eq(0).attr("app_code") != undefined){
                app_code = $("body").find("div").eq(0).attr("app_code")
              } else if($(this).closest(".chartDivSection").attr("app_code") != undefined){
                app_code = $(this).closest(".chartDivSection").attr("app_code");
              }
            }
            let tableNameSlicer = $(this).val();
            let closestAnalysisParameter = $(this).parent().parent().find(".form-group").eq(1).find(".analysisSlicerParameter");
            if (tableNameSlicer != "") {
              let url_string = window.location.pathname
              let f_occ = url_string.indexOf('/', url_string.indexOf('/') + 1)
              let s_occ = url_string.indexOf('/', url_string.indexOf('/') + f_occ +1)
              let t_occ = url_string.indexOf('/', url_string.indexOf('/') + s_occ +1)
              let app_code2 = url_string.substring(f_occ+1,s_occ)
              let current_dev_mode2 = url_string.substring(s_occ+1,t_occ)
              if(current_dev_mode2 != 'Build' && current_dev_mode2 != 'Edit'){
                current_dev_mode2 = 'User'
              }
              $.ajax({
                url: `/users/${urlPath}/processGraphModule/`,

                data: {
                  'operation': 'dropFieldList',
                  'app_code': app_code,
                  'tableName':tableNameSlicer,
                },
                type: "POST",
                dataType: "json",
                success: function (data) {
                  if (data.fieldList.length > 0) {
                    closestAnalysisParameter.empty();
                    closestAnalysisParameter.append("<option value=''>Select slicer parameter</option>");
                    for (var i = 0; i < data.fieldList.length; i++) {
                      closestAnalysisParameter.append(new Option(data.fieldList[i], data.fieldNameList[i]));
                    }
                    if(closestAnalysisParameter.attr('data-slicerParam') != undefined){
                      var slicerParameter = closestAnalysisParameter.attr('data-slicerParam')
                      closestAnalysisParameter.val(slicerParameter).trigger('change');
                      closestAnalysisParameter.removeAttr('data-slicerParam')
                    }
                  }
                },
                error: function () {
                  Swal.fire({icon: 'error',text: 'Error! Failure in fetching the columns. Please try again.'});
                }
              });
            } else {
              closestAnalysisParameter.empty();
              closestAnalysisParameter.append("<option value=''>Select slicer parameter</option>");
            }
          });
        }
        fetchSlicerParams()
        function addSlicers(analysisElementId, tabId){
          $(`#slicerConfigCard${analysisElementId}${tabId}`).append(`
            <div class="card" data-slicer_class="selectSlicerConfig_ellipse08589847718203074{tabId}" >
              <div class="card-header">
                <button type="button" class="btn removeSlicer" onclick="removeSlicer.call(this)"><i class="far fa-trash-alt text-primary"></i> Remove slicer</button>
              </div>
              <div class="card-body">
                <div class="form-group" style="margin-bottom:5px;text-align:left;">
                  <label for="analysisSlicerTable" class="justify-content-start" style="width:100%">Source table:
                  </label>
                  <select  class="select2 form-control analysisSlicerTable" name="analysisSlicerTable" style="width:100%">
                    <option value="">Select source table</option>
                  </select>
                    </div>
                    <div class="form-group" style="flex-direction: column;align-items: baseline;margin-bottom:5px;text-align:left;">
                      <label for="analysisSlicerParameter" class="justify-content-start" style="width:100%">Slicer parameter:
                      </label>
                      <select  class="select2 form-control analysisSlicerParameter" name="analysisSlicerParameter" style="width:100%">
                        <option value="">Select slicer parameter</option>
                      </select>
                    </div>
                    <div class = "form-group" style="margin-bottom:5px;text-align:left;">
                      <label for="analysisSlicerBoolean">
                      <input type="checkbox" class="analysisSlicerBoolean" name="analysisSlicerBoolean" value="True" style="margin-right:10px">
                      Add default option for all values</label>
                    </div>
                    <div class="form-group" style="margin-bottom:5px;text-align:left;">
                      <label>
                      <input class="mulcheckbox" type="checkbox" style="margin-right:10px">
                      Multiselect Slicer</label>
                    </div>
                  </div>
                </div>
                `)
                var tableArray = $(`#slicerConfigCard${analysisElementId}${tabId}`).attr('data-tableArray');
                if (tableArray) {
                  tableArray = JSON.parse(tableArray);
                  for (var table of tableArray) {
                    $(`#slicerConfigCard${analysisElementId}${tabId}`).find('.card').eq(-1).find(".analysisSlicerTable").append(`<option value="${table}">${table}</option>`)
                  };
                } else {
                  $.ajax({
                    url: `/users/${urlPath}/dynamicVal/`,
                    data: {
                        'operation': 'fetchAnalysisSlicerTableList',
                    },
                    type: "POST",
                    dataType: "json",
                    success: function (data) {
                      var tableArray = data.table;
                      $(`#slicerConfigCard${analysisElementId}${tabId}`).attr('data-tableArray', JSON.stringify(tableArray));
                      for (var table of tableArray) {
                        $(`#slicerConfigCard${analysisElementId}${tabId}`).find('.card').eq(-1).find(".analysisSlicerTable").append(`<option value="${table}">${table}</option>`)
                      };
                    },
                    error: ()=>{

                    }
                  });
                }

                $(`#slicerConfigCard${analysisElementId}${tabId}`).find('.card').eq(-1).find(".card-body").find("select").each(function(){
    parent = $(this).parent()
    $(this).select2({dropdownParent:parent})
  })
                fetchSlicerParams();
            }

            function removeSlicer(){
              $(this).parent().parent().remove();
            }

            $('#saveTabSlicerConfigellipse085898477182030741' ).on('click', function(){
              var tabDict={
                "TabID":('1'),
                "slicerTable":[],
                "slicerParameter":[],
                "slicerBoolean":[],
                "slicerReload" : [],
                "multipleSlicer":[]
              }
              $('#slicerConfigCardellipse085898477182030741' ).find('.card').find('.analysisSlicerTable').each(function() {
                tabDict["slicerTable"].push($(this).val())
              })
              $('#slicerConfigCardellipse085898477182030741' ).find('.card').find('.analysisSlicerParameter').each(function() {
                tabDict["slicerParameter"].push($(this).val())
              })
              $('#slicerConfigCardellipse085898477182030741' ).find('.card').find('.mulcheckbox').each(function() {
                if ($(this).is(":checked")){
                  tabDict["multipleSlicer"].push(true);
                }else{
                  tabDict["multipleSlicer"].push(false);
                }
              })
              $('#slicerConfigCardellipse085898477182030741' ).find('.card').find('.analysisSlicerBoolean').each(function() {
                if ($(this).is(":checked")){
                  tabDict["slicerBoolean"].push("True")
                }else {
                  tabDict["slicerBoolean"].push("False")
                }
              });
              url_string = window.location.pathname
              f_occ = url_string.indexOf('/', url_string.indexOf('/') + 1)
              s_occ = url_string.indexOf('/', url_string.indexOf('/') + f_occ +1)
              t_occ = url_string.indexOf('/', url_string.indexOf('/') + s_occ +1)
              app_code2 = url_string.substring(f_occ+1,s_occ)
              current_dev_mode2 = url_string.substring(s_occ+1,t_occ)
              if(current_dev_mode2 != 'Build' && current_dev_mode2 != 'Edit'){
                current_dev_mode2 = 'User'
              }
              $.ajax({
                url: `/users/${urlPath}/processGraphModule/`,
                data: {
                  'tab_slicer_config': JSON.stringify(tabDict),
                  'element_id': 'ellipse08589847718203074',
                  'tab_id': '1',
                  'operation': 'saveAnalysisSlicerConfigL3',
                },

                type: "POST",
                dataType: "json",
                success: function (data) {
                  $('#tabellipse085898477182030741' ).find('.card-tools').empty();
                  $('#tabellipse085898477182030741' ).find('.card-tools').append(`<button type="button" value="AddComment" class="btn btn-primary commentButton btn-md" id="AddCommentellipse085898477182030741"   data-toggle="tooltip" title="Add comment" style="height: 25px;border-radius:5px;border-color:none;color:white;margin-top:10px; margin-bottom:10px"><i class='far fa-comment-dots' style="font-size:1rem;"></i></button>&nbsp;<button type="button" value="PDF" class=" btn btn-primary" data-tabHeaderID="tabHeaderellipse085898477182030741"  id='analysisPDFellipse085898477182030741'  style="height: 25px;border-radius:5px;border-color:none;color:white;padding-left:9px;padding-top:2px;  margin-right:5px;margin-top:10px; margin-bottom:10px"><i class="fa fa-file-pdf-o"></i>&nbsp;PDF</button><button type="button" value="slicerConfig" class="btn btn-primary" data-tabHeaderID="tabHeaderellipse085898477182030741"  id='slicerConfigellipse085898477182030741'  data-toggle="modal" data-target="#slicerConfigModalellipse085898477182030741"  style="height: 25px;border-radius:5px;border-color:none;color:white;padding-left:9px;padding-top:2px; margin-right:10px; margin-top:10px; margin-bottom:10px"><i class="fas fa-filter"></i>&nbsp;Slicer</button> `);

                  let tabSlicerConfig = data['1'];
                  let analysis_additional_config = tabSlicerConfig.analysis_additional_config;
                  if (analysis_additional_config == "slicer_config") {
                    let slicerTables = tabSlicerConfig.slicerTable;
                    let slicerParameters = tabSlicerConfig.slicerParameter;
                    let slicerBooleans = tabSlicerConfig.slicerBoolean;
                    let slicerParameterValues = tabSlicerConfig.slicer_parameter_values;
                    let slicerReloadValue = tabSlicerConfig.slicerReload;
                    let multipleSlicer = tabSlicerConfig.multipleSlicer;
                    let mapDict = tabSlicerConfig.mappingDict
                    var html = '';
                    for(let i = 0; i < slicerParameterValues.length; i++) {
                      let attr_ = 'data-value = ""'
                      let multiple = "";
                      if(slicerReloadValue != undefined){
                        if (slicerReloadValue.length != 0) {
                          attr_ = 'data-value' + `= '${JSON.stringify(slicerReloadValue[i])}'`
                        }
                      }
                      if(multipleSlicer != undefined){
                        if(multipleSlicer.length > 0){
                          if(multipleSlicer[i]){
                            multiple = "multiple";
                          }
                        }
                      }
                      html = html + `
                      <div class="form-inline" style="flex-direction: column;align-items: baseline;margin-bottom:5px;text-align:left;">
                        <span class="text-primary" style=" margin-right:10px; margin-left:10px;">${mapDict[i][slicerParameters[i]]}:</span>

                        <select class="selectSlicerConfig_ellipse085898477182030741  select2 form-control slicerParamValueellipse08589847718203074 data-tab='1' data-slicertable="${slicerTables[i]}" data-slicerColumn= "${slicerParameters[i]}" ${attr_} data-id="selectSlicerConfig_ellipse085898477182030741"  style="width:150px;display:inline-block;" ${multiple}>`
                          if(slicerBooleans != undefined){
                            if (slicerBooleans.length != 0) {
                              if(slicerBooleans[i] == 'True'){
                                html = html + `<option value="" selected>All</option>`
                              }
                            }
                          }
                          for(let j = 0; j < slicerParameterValues[i].length; j++) {
                            if(slicerParameterValues[i][j] != ''){
                            html = html + `<option value="${slicerParameterValues[i][j]}">${slicerParameterValues[i][j]}</option>`
                            }
                          }
                        html = html +
                        `</select>
                      </div>
                      `
                    }
                    $('#tabellipse085898477182030741' ).find('.card-tools').append(html);
                    $('#tabellipse085898477182030741' ).find('.card-tools').find('select').each(function(){
    parent = $(this).parent()
    $(this).select2({dropdownParent:parent})
  })
                    $('#tabellipse085898477182030741' ).find('.card-tools.tabCardTools').find('.select2').parent().find(".select2-container").css("max-height","55px");
                    $('#tabellipse085898477182030741' ).find('.card-tools.tabCardTools').find('.select2').parent().find(".select2-container").css("overflow-y","scroll");
                    slicerChangeUpdatePlots();
                  }
                },
                error: function () {
                  Swal.fire({icon: 'error',text: 'Error! Failure in fetching the columns. Please try again.'});
                }
              });
            });
          </script><script>
        $(`#AddCommentellipse085898477182030741`).click(function(){
          var id_ = ('analysisEditor' + Math.random()).replace('.',"");// $(this).attr('id').split('AddComment')[1];
          $(this).parent().parent().next().append(`
                  <div class="small-box commentboxcard" data-id="${id_}" id = "${id_}" onmouseenter="showTool.call(this)" onmouseleave="hideTool.call(this)" style="min-height:6rem;min-width:6rem;height:6rem;width:9rem;" >
                    <div class="row"  style="position:absolute; margin-left:100%; display:none;flex-wrap:wrap;">
                      <i class="fa fa-times deleteCommentBox" title="Delete" style="font-size:1rem;margin-right:0.5rem;margin-left:1px;margin-bottom:2px;"></i>
                      <i class='fas fa-edit' onclick="ckEditorFunc.call(this)" style="font-size:1rem;margin-right:0.5rem;margin-bottom:2px;"></i>
                      <i class="fa fa-arrows" style="font-size:1rem;margin-right:0.5rem;"></i>
                    </div>
                    <div class="commentbox contentEditable" name="comment" style="margin-top:1rem;max-height: 75%;padding: 0.3em 0.5em 0 0.5em;background-color: transparent;text-align: left;overflow-y: auto;">

                    </div>
                  </div>`)
          $(".commentboxcard").resizable();
          $('.contentEditable').each(function () {
              $(this).on('click', function () {
                $(this).attr("contenteditable", "true")
                $(this).focus()
              })
              $(this).focusout(function () {
                  var content = this.innerText
                  content = content.trim()
                  if (content.length == 0){
                    this.innerText = "Enter text here."
                    $(this).removeAttr("contenteditable");
                    $(this).trigger("click")
                  }
                  else{
                  $(this).removeAttr("contenteditable");
                  }
              })
            })
        $('.deleteCommentBox').click(function () {
            $(this).parent().parent().remove()
        })
        $(".commentboxcard").draggable({
            cancel: '',
            containment: "parent",
        });
      })
      </script> <script>
        if(!analysiselementIDList.includes('ellipse08589847718203074')){
              analysiselementIDList.push("ellipse08589847718203074");
        }
        function fetchSlicerParams(app_code = ""){
          $(".analysisSlicerTable").off('select2:select').on('select2:select', function(){
             if (app_code == ""){
              if($("body").find("div").eq(0).attr("app_code") != undefined){
                app_code = $("body").find("div").eq(0).attr("app_code")
              } else if($(this).closest(".chartDivSection").attr("app_code") != undefined){
                app_code = $(this).closest(".chartDivSection").attr("app_code");
              }
            }
            let tableNameSlicer = $(this).val();
            let closestAnalysisParameter = $(this).parent().parent().find(".form-group").eq(1).find(".analysisSlicerParameter");
            if (tableNameSlicer != "") {
              let url_string = window.location.pathname
              let f_occ = url_string.indexOf('/', url_string.indexOf('/') + 1)
              let s_occ = url_string.indexOf('/', url_string.indexOf('/') + f_occ +1)
              let t_occ = url_string.indexOf('/', url_string.indexOf('/') + s_occ +1)
              let app_code2 = url_string.substring(f_occ+1,s_occ)
              let current_dev_mode2 = url_string.substring(s_occ+1,t_occ)
              if(current_dev_mode2 != 'Build' && current_dev_mode2 != 'Edit'){
                current_dev_mode2 = 'User'
              }
              $.ajax({
                url: `/users/${urlPath}/processGraphModule/`,

                data: {
                  'operation': 'dropFieldList',
                  'app_code': app_code,
                  'tableName':tableNameSlicer,
                },
                type: "POST",
                dataType: "json",
                success: function (data) {
                  if (data.fieldList.length > 0) {
                    closestAnalysisParameter.empty();
                    closestAnalysisParameter.append("<option value=''>Select slicer parameter</option>");
                    for (var i = 0; i < data.fieldList.length; i++) {
                      closestAnalysisParameter.append(new Option(data.fieldList[i], data.fieldNameList[i]));
                    }
                    if(closestAnalysisParameter.attr('data-slicerParam') != undefined){
                      var slicerParameter = closestAnalysisParameter.attr('data-slicerParam')
                      closestAnalysisParameter.val(slicerParameter).trigger('change');
                      closestAnalysisParameter.removeAttr('data-slicerParam')
                    }
                  }
                },
                error: function () {
                  Swal.fire({icon: 'error',text: 'Error! Failure in fetching the columns. Please try again.'});
                }
              });
            } else {
              closestAnalysisParameter.empty();
              closestAnalysisParameter.append("<option value=''>Select slicer parameter</option>");
            }
          });
        }
        fetchSlicerParams()
        function addSlicers(analysisElementId, tabId){
          $(`#slicerConfigCard${analysisElementId}${tabId}`).append(`
            <div class="card" data-slicer_class="selectSlicerConfig_ellipse08589847718203074{tabId}" >
              <div class="card-header">
                <button type="button" class="btn removeSlicer" onclick="removeSlicer.call(this)"><i class="far fa-trash-alt text-primary"></i> Remove slicer</button>
              </div>
              <div class="card-body">
                <div class="form-group" style="margin-bottom:5px;text-align:left;">
                  <label for="analysisSlicerTable" class="justify-content-start" style="width:100%">Source table:
                  </label>
                  <select  class="select2 form-control analysisSlicerTable" name="analysisSlicerTable" style="width:100%">
                    <option value="">Select source table</option>
                  </select>
                    </div>
                    <div class="form-group" style="flex-direction: column;align-items: baseline;margin-bottom:5px;text-align:left;">
                      <label for="analysisSlicerParameter" class="justify-content-start" style="width:100%">Slicer parameter:
                      </label>
                      <select  class="select2 form-control analysisSlicerParameter" name="analysisSlicerParameter" style="width:100%">
                        <option value="">Select slicer parameter</option>
                      </select>
                    </div>
                    <div class = "form-group" style="margin-bottom:5px;text-align:left;">
                      <label for="analysisSlicerBoolean">
                      <input type="checkbox" class="analysisSlicerBoolean" name="analysisSlicerBoolean" value="True" style="margin-right:10px">
                      Add default option for all values</label>
                    </div>
                    <div class="form-group" style="margin-bottom:5px;text-align:left;">
                      <label>
                      <input class="mulcheckbox" type="checkbox" style="margin-right:10px">
                      Multiselect Slicer</label>
                    </div>
                  </div>
                </div>
                `)
                var tableArray = $(`#slicerConfigCard${analysisElementId}${tabId}`).attr('data-tableArray');
                if (tableArray) {
                  tableArray = JSON.parse(tableArray);
                  for (var table of tableArray) {
                    $(`#slicerConfigCard${analysisElementId}${tabId}`).find('.card').eq(-1).find(".analysisSlicerTable").append(`<option value="${table}">${table}</option>`)
                  };
                } else {
                  $.ajax({
                    url: `/users/${urlPath}/dynamicVal/`,
                    data: {
                        'operation': 'fetchAnalysisSlicerTableList',
                    },
                    type: "POST",
                    dataType: "json",
                    success: function (data) {
                      var tableArray = data.table;
                      $(`#slicerConfigCard${analysisElementId}${tabId}`).attr('data-tableArray', JSON.stringify(tableArray));
                      for (var table of tableArray) {
                        $(`#slicerConfigCard${analysisElementId}${tabId}`).find('.card').eq(-1).find(".analysisSlicerTable").append(`<option value="${table}">${table}</option>`)
                      };
                    },
                    error: ()=>{

                    }
                  });
                }

                $(`#slicerConfigCard${analysisElementId}${tabId}`).find('.card').eq(-1).find(".card-body").find("select").each(function(){
    parent = $(this).parent()
    $(this).select2({dropdownParent:parent})
  })
                fetchSlicerParams();
            }

            function removeSlicer(){
              $(this).parent().parent().remove();
            }

            $('#saveTabSlicerConfigellipse085898477182030742' ).on('click', function(){
              var tabDict={
                "TabID":('2'),
                "slicerTable":[],
                "slicerParameter":[],
                "slicerBoolean":[],
                "slicerReload" : [],
                "multipleSlicer":[]
              }
              $('#slicerConfigCardellipse085898477182030742' ).find('.card').find('.analysisSlicerTable').each(function() {
                tabDict["slicerTable"].push($(this).val())
              })
              $('#slicerConfigCardellipse085898477182030742' ).find('.card').find('.analysisSlicerParameter').each(function() {
                tabDict["slicerParameter"].push($(this).val())
              })
              $('#slicerConfigCardellipse085898477182030742' ).find('.card').find('.mulcheckbox').each(function() {
                if ($(this).is(":checked")){
                  tabDict["multipleSlicer"].push(true);
                }else{
                  tabDict["multipleSlicer"].push(false);
                }
              })
              $('#slicerConfigCardellipse085898477182030742' ).find('.card').find('.analysisSlicerBoolean').each(function() {
                if ($(this).is(":checked")){
                  tabDict["slicerBoolean"].push("True")
                }else {
                  tabDict["slicerBoolean"].push("False")
                }
              });
              url_string = window.location.pathname
              f_occ = url_string.indexOf('/', url_string.indexOf('/') + 1)
              s_occ = url_string.indexOf('/', url_string.indexOf('/') + f_occ +1)
              t_occ = url_string.indexOf('/', url_string.indexOf('/') + s_occ +1)
              app_code2 = url_string.substring(f_occ+1,s_occ)
              current_dev_mode2 = url_string.substring(s_occ+1,t_occ)
              if(current_dev_mode2 != 'Build' && current_dev_mode2 != 'Edit'){
                current_dev_mode2 = 'User'
              }
              $.ajax({
                url: `/users/${urlPath}/processGraphModule/`,
                data: {
                  'tab_slicer_config': JSON.stringify(tabDict),
                  'element_id': 'ellipse08589847718203074',
                  'tab_id': '2',
                  'operation': 'saveAnalysisSlicerConfigL3',
                },

                type: "POST",
                dataType: "json",
                success: function (data) {
                  $('#tabellipse085898477182030742' ).find('.card-tools').empty();
                  $('#tabellipse085898477182030742' ).find('.card-tools').append(`<button type="button" value="AddComment" class="btn btn-primary commentButton btn-md" id="AddCommentellipse085898477182030742"   data-toggle="tooltip" title="Add comment" style="height: 25px;border-radius:5px;border-color:none;color:white;margin-top:10px; margin-bottom:10px"><i class='far fa-comment-dots' style="font-size:1rem;"></i></button>&nbsp;<button type="button" value="PDF" class=" btn btn-primary" data-tabHeaderID="tabHeaderellipse085898477182030742"  id='analysisPDFellipse085898477182030742'  style="height: 25px;border-radius:5px;border-color:none;color:white;padding-left:9px;padding-top:2px;  margin-right:5px;margin-top:10px; margin-bottom:10px"><i class="fa fa-file-pdf-o"></i>&nbsp;PDF</button><button type="button" value="slicerConfig" class="btn btn-primary" data-tabHeaderID="tabHeaderellipse085898477182030742"  id='slicerConfigellipse085898477182030742'  data-toggle="modal" data-target="#slicerConfigModalellipse085898477182030742"  style="height: 25px;border-radius:5px;border-color:none;color:white;padding-left:9px;padding-top:2px; margin-right:10px; margin-top:10px; margin-bottom:10px"><i class="fas fa-filter"></i>&nbsp;Slicer</button> `);

                  let tabSlicerConfig = data['2'];
                  let analysis_additional_config = tabSlicerConfig.analysis_additional_config;
                  if (analysis_additional_config == "slicer_config") {
                    let slicerTables = tabSlicerConfig.slicerTable;
                    let slicerParameters = tabSlicerConfig.slicerParameter;
                    let slicerBooleans = tabSlicerConfig.slicerBoolean;
                    let slicerParameterValues = tabSlicerConfig.slicer_parameter_values;
                    let slicerReloadValue = tabSlicerConfig.slicerReload;
                    let multipleSlicer = tabSlicerConfig.multipleSlicer;
                    let mapDict = tabSlicerConfig.mappingDict
                    var html = '';
                    for(let i = 0; i < slicerParameterValues.length; i++) {
                      let attr_ = 'data-value = ""'
                      let multiple = "";
                      if(slicerReloadValue != undefined){
                        if (slicerReloadValue.length != 0) {
                          attr_ = 'data-value' + `= '${JSON.stringify(slicerReloadValue[i])}'`
                        }
                      }
                      if(multipleSlicer != undefined){
                        if(multipleSlicer.length > 0){
                          if(multipleSlicer[i]){
                            multiple = "multiple";
                          }
                        }
                      }
                      html = html + `
                      <div class="form-inline" style="flex-direction: column;align-items: baseline;margin-bottom:5px;text-align:left;">
                        <span class="text-primary" style=" margin-right:10px; margin-left:10px;">${mapDict[i][slicerParameters[i]]}:</span>

                        <select class="selectSlicerConfig_ellipse085898477182030742  select2 form-control slicerParamValueellipse08589847718203074 data-tab='2' data-slicertable="${slicerTables[i]}" data-slicerColumn= "${slicerParameters[i]}" ${attr_} data-id="selectSlicerConfig_ellipse085898477182030742"  style="width:150px;display:inline-block;" ${multiple}>`
                          if(slicerBooleans != undefined){
                            if (slicerBooleans.length != 0) {
                              if(slicerBooleans[i] == 'True'){
                                html = html + `<option value="" selected>All</option>`
                              }
                            }
                          }
                          for(let j = 0; j < slicerParameterValues[i].length; j++) {
                            if(slicerParameterValues[i][j] != ''){
                            html = html + `<option value="${slicerParameterValues[i][j]}">${slicerParameterValues[i][j]}</option>`
                            }
                          }
                        html = html +
                        `</select>
                      </div>
                      `
                    }
                    $('#tabellipse085898477182030742' ).find('.card-tools').append(html);
                    $('#tabellipse085898477182030742' ).find('.card-tools').find('select').each(function(){
    parent = $(this).parent()
    $(this).select2({dropdownParent:parent})
  })
                    $('#tabellipse085898477182030742' ).find('.card-tools.tabCardTools').find('.select2').parent().find(".select2-container").css("max-height","55px");
                    $('#tabellipse085898477182030742' ).find('.card-tools.tabCardTools').find('.select2').parent().find(".select2-container").css("overflow-y","scroll");
                    slicerChangeUpdatePlots();
                  }
                },
                error: function () {
                  Swal.fire({icon: 'error',text: 'Error! Failure in fetching the columns. Please try again.'});
                }
              });
            });
          </script><script>
        $(`#AddCommentellipse085898477182030742`).click(function(){
          var id_ = ('analysisEditor' + Math.random()).replace('.',"");// $(this).attr('id').split('AddComment')[1];
          $(this).parent().parent().next().append(`
                  <div class="small-box commentboxcard" data-id="${id_}" id = "${id_}" onmouseenter="showTool.call(this)" onmouseleave="hideTool.call(this)" style="min-height:6rem;min-width:6rem;height:6rem;width:9rem;" >
                    <div class="row"  style="position:absolute; margin-left:100%; display:none;flex-wrap:wrap;">
                      <i class="fa fa-times deleteCommentBox" title="Delete" style="font-size:1rem;margin-right:0.5rem;margin-left:1px;margin-bottom:2px;"></i>
                      <i class='fas fa-edit' onclick="ckEditorFunc.call(this)" style="font-size:1rem;margin-right:0.5rem;margin-bottom:2px;"></i>
                      <i class="fa fa-arrows" style="font-size:1rem;margin-right:0.5rem;"></i>
                    </div>
                    <div class="commentbox contentEditable" name="comment" style="margin-top:1rem;max-height: 75%;padding: 0.3em 0.5em 0 0.5em;background-color: transparent;text-align: left;overflow-y: auto;">

                    </div>
                  </div>`)
          $(".commentboxcard").resizable();
          $('.contentEditable').each(function () {
              $(this).on('click', function () {
                $(this).attr("contenteditable", "true")
                $(this).focus()
              })
              $(this).focusout(function () {
                  var content = this.innerText
                  content = content.trim()
                  if (content.length == 0){
                    this.innerText = "Enter text here."
                    $(this).removeAttr("contenteditable");
                    $(this).trigger("click")
                  }
                  else{
                  $(this).removeAttr("contenteditable");
                  }
              })
            })
        $('.deleteCommentBox').click(function () {
            $(this).parent().parent().remove()
        })
        $(".commentboxcard").draggable({
            cancel: '',
            containment: "parent",
        });
      })
      </script> <script>
        var elementIDList = []
        var analysisData_Raw;
        $(document).ready(function() {
            $(`#select2multiple_groupellipse08589847718203074`).select2({

            })
            })
            var element_id =  'ellipse08589847718203074' 
            $(`#last_updated_time${element_id}`).text("00-00-00 00:00");
            $(`#analysisDashboard${element_id} .nav-tabs a`).first().tab('show');  $(`#plotCharts${element_id}`).click(function(event){
            var element_id =  'ellipse08589847718203074'
            $(`#plotCharts${element_id}`).off('click');
            event.preventDefault();
            $(`#PlotElements${element_id}`).modal('show');
            })

            $(`#analysisAddTabellipse08589847718203074`).click(function () {
            var element_id =  'ellipse08589847718203074'
            var tabID = String(Math.random()).replace('.','');
            var tabName = $('#analysisTabellipse08589847718203074').children("li").length+1;
            $(`#selectXYTab${element_id}`).append(`<option value="analysisrow${element_id}${tabID}">Tab${tabName}</option>`);
            $(`#analysisTab${element_id}`).append(`<li class="nav-item navtab scroll-link"><a class="nav-link" id="analysistab${element_id}${tabID}" href="#tab${element_id}${tabID}" role="tab" data-toggle="tab" aria-controls="#tab${element_id}${tabID}" aria-selected="false">
            <div class="row">
            <div class="col-md-10" style="padding-right: 0.1rem">
            <span class="contentEditable tabname" id="${`tabHeader${element_id}`+tabID}" data-tab="analysisrow${element_id}${tabID}" data-tab_ct="analysisrow${element_id}${tabID}">Tab${tabName}</span>
            </div>
            <div class="col-md-2" style="padding-top: 0px;">
            <button type="button" id="${`removeTab${element_id}`+tabID}" data-tabAnchorID="analysistab${element_id}${tabID}" data-tabContainerDivID="tab${element_id}${tabID}" style="border-width:0px;padding: 1px 1px;background-color: white;"><i class="fa fa-times" style="font-size:0.9rem;"></i></button>
            </div>
            </div>
            </a></li>`);

            const navUl = document.querySelector('.nav.nav-tabs.nav-fill.analysis-nav');
            if(navUl.children.length > 4) {
              navUl.classList.add("scroll-nav")
            }

            // INDEX TAB UPDATION
            const updateIndex = (index, val) => {
              let ind = index.replace('Header', '')
              const indexTabs = $("#tabLinks"+element_id).find(".linkCard") //document.getElementById('tabLinks').children;
              Array.from(indexTabs).forEach(ele => {
                const id = ele.id.replace('index', '');
                if(id == ind) {
                  $(`#index${id} .tab-title`).text(val)
                }
              });
            }
            let link = 'tab' + element_id + tabID;
            let length_index = $("#tabLinks"+element_id).find(".linkCard").length + 1;let markup = `
              <div class="row index-rows" style="box-shadow: rgb(0 0 0 / 35%) 0px 5px 15px;border-radius: 5px;margin: 20px 20px;align-items: center;display: flex;">
                <div id="" class="col-2 index-no-column">
                  <p style="font-size: 1.2rem; margin:0;"> ${length_index} </p>
                </div>
                <div class="col-10" style="">
                  <i class="fa fa-pen editTabIcon" onclick="openModal('index${link}')" style="right: -8px;top:-8px;"></i>
                  <div id="index${link}" class="linkCard defaultTabTheme">
                    <div class="col-10 d-flex flex-column align-items-center justify-content-center">
                      <a class="tab-header-name tab-title" style="font-size: 1.2rem;" href="${link}"> Tab${tabName} </a>
                      <p class="tab-desc colored-text" data-name="index${link}" style="margin-bottom:0"></p>
                    </div>
                    <div class="col-1 tab-icons TabIcons d-flex align-items-center justify-content-center" >
                      <i class="" data-name="index${link}"></i>
                    </div>
                  </div>
                </div>
              </div>
          ` ;    $(`#tabLinks${element_id}`).append(markup);
              var col1 = "var(--primary-color,var(--primary-color))"
              var col2 = "var(--font-color))"
              let gobalConfigIndexBG = $(".indextabBG").val()
              let gobalConfigindextabFC = $(".indextabFC").val()
              $(".defaultTabTheme").css("background-color",gobalConfigIndexBG);
              $(".index-no-column").css("background-color",gobalConfigIndexBG);
              $(".dropIndex").css("background",`${col1} linear-gradient(to bottom right, ${col1} 25%, #fff)`);
              $(".boxIndex").css("background",`${col1} linear-gradient(to bottom right, ${col1} 25%, #fff)`);
              $(".dropIndex").find('p').css("color",col2);
              $(".boxIndex").find('p').css("color",col2);
              $(".tab-header-name").css("color",col2);
              $(".colored-text").css("color",col2);
              $(".tab-icons").find('i').css("color",col2);
              $(".colored-icons").find('i').css("color",col1);
              $(".index-no-column").find('p').css("color",gobalConfigindextabFC);
              $(".linkCard").find('a').css("color",gobalConfigindextabFC);
              $(".index-rows").css("border-color",col1);
              $(".index-no-column").css("border-color",col1);
              $(".arrow-tab").css("border-left-color",col1);

            if(document.getElementById(`index${link}`) != null){
              document.getElementById(`index${link}`).addEventListener("click", (e) => {
                e.preventDefault();
                gotoTab("#analysisTabellipse09392335077605267", link);
              });
            }
            const editables = document.getElementsByClassName('contentEditable tabname');
            Array.from(editables).forEach(ele => {
              ele.addEventListener("blur", (e) => {
                updateIndex(ele.id, ele.textContent)
              })
            });
            const deleteButton = document.getElementById(`removeTab${element_id}${tabID}`);
            deleteButton.addEventListener("click", (e) => {
              const id = e.target.parentNode.id.replace('removeT', 'indext');;
              const indexTab = document.getElementById('tabLinks'+element_id);
              const linkToBeDeleted  = document.getElementById(`${id}`);
              let ind = 0
              $(`#${id}`).closest(".row").remove();
              $("#tabLinks"+element_id).find(".col-2").each(function() {
                $(this).find("p").html(++ind)
              })
            })

            $(`#analysisTabContent${element_id}`).append(`<div class="tab-pane fade" id="tab${element_id}${tabID}" role="tabpanel" aria-labelledby="analysistab${element_id}${tabID}">
            <div class="d-flex justify-content-between" style="padding-top:1%">
            <div class="card-tools tabCardTools row col-12" style="background:whitesmoke; padding-bottom: 2px;margin:auto"><button type="button" value="AddComment" class="btn btn-primary commentButton btn-md" id="${"AddCommentellipse08589847718203074"  +tabID}"  data-toggle="tooltip" title="Add comment" style="height: 25px;border-radius:5px;border-color:none;color:white;margin-top:10px; margin-bottom:10px"><i class='far fa-comment-dots' style="font-size:1rem;"></i></button>&nbsp;<button type="button" value="PDF" data-tabHeaderID="${"tabHeaderellipse08589847718203074"  +tabID}" class=" btn btn-primary" id='${'analysisPDFellipse08589847718203074' +tabID}' style="height: 25px;border-radius:5px;border-color:none;color:white;padding-left:9px;padding-top:2px;margin-right:5px;margin-top:10px; margin-bottom:10px">
                  <i class="fa fa-file-pdf-o"></i>&nbsp;PDF
              </button>
               <button type="button" value="slicerConfig" class="btn btn-primary" data-tabHeaderID="tabHeaderellipse08589847718203074${tabID}" id='slicerConfigellipse08589847718203074${tabID}' data-toggle="modal" data-target="#slicerConfigModalellipse08589847718203074${tabID}" style="height: 25px;border-radius:5px;border-color:none;color:white;padding-left:9px;padding-top:2px; margin-right:10px; margin-top:10px; margin-bottom:10px"><i class="fas fa-filter"></i>&nbsp;Slicer</button><button type="button" value="gridLines" class="btn btn-primary" data-tabHeaderID="tabHeaderellipse08589847718203074${tabID}" id='gridLinesellipse08589847718203074${tabID}' style="height: 25px;border-radius:5px;border-color:none;color:white;padding-left:9px;padding-top:2px; margin-right:10px; margin-top:10px; margin-bottom:10px" onclick="gridLine.call(this)"><i class="fa fa-table"></i>&nbsp;Grid lines</button>    </div>
      </div>
      <div class="col-lg-12 row chartDivSection" data-layout="Landscape" id="analysisrowellipse08589847718203074${tabID}" ondblclick="resetCrossFilter.call(this)"></div></div>

      <div class="modal" id="slicerConfigModalellipse08589847718203074${tabID}">
        <div class="modal-dialog modal-md modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h6 class="modal-title" style="text-align:center;">Configure slicer</h6>
              <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            <div class="modal-body">
              <div class="card">
                <div class="card-body">
                  <div class="card-tools text-primary" style="display:flex; flex-direction:row; align-items:center; justify-content:space-between;">
                    <label for="">Add slicer</label>
                    <button type="button" class="btn addOptionBtn" onclick="addSlicers('ellipse08589847718203074', '${tabID}')"><i class="fas fa-plus"></i></button>
                  </div>
                  <div id="slicerConfigCardellipse08589847718203074${tabID}" style="max-height: 15.25rem; overflow-y: scroll; overflow-x: hidden;">
                    <div class="card" data-slicer_class="selectSlicerConfig_ellipse08589847718203074${tabID}">
                      <div class="card-body">
                        <div class="form-group" style="margin-bottom:5px;text-align:left;">
                          <label for="analysisSlicerTable" class="justify-content-start" style="width:100%">Source table:
                          </label>
                          <select class="select2 form-control analysisSlicerTable" name="analysisSlicerTable" style="width:100%">
                            <option value="">Select source table</option>
                          </select>
                        </div>
                        <div class="form-group" style="flex-direction: column;align-items: baseline;margin-bottom:5px;text-align:left;">
                          <label for="analysisSlicerParameter" class="justify-content-start" style="width:100%">Slicer parameter:
                          </label>
                          <select  class="select2 form-control analysisSlicerParameter" name="analysisSlicerParameter" style="width:100%">
                            <option value="">Select slicer parameter</option>
                          </select>
                        </div>
                        <div class = "form-group" style="margin-bottom:5px;text-align:left;">
                          <label for="analysisSlicerBoolean">
                          <input type="checkbox" class="analysisSlicerBoolean" name="analysisSlicerBoolean" value="True" style="margin-right:10px">
                          Add default option all values</label>
                        </div>
                        <div class="form-group" style="margin-bottom:5px;text-align:left;">
                          <label>
                          <input class="mulcheckbox" type="checkbox" style="margin-right:10px">
                          Multiselect Slicer</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="saveTabSlicerConfigellipse08589847718203074${tabID}" data-analysis_id= "ellipse08589847718203074"  data-tab_id="${tabID}" class="btn btn-primary btn-md mx-2 rounded px-2" data-dismiss="modal">Save</button>
            </div>
          </div>
            </div>
            </div>
          `);
          $.ajax({
            url: `/users/${urlPath}/dynamicVal/`,
            data: {
                'operation': 'fetchAnalysisSlicerTableList',
            },
            type: "POST",
            dataType: "json",
            success: function (data) {
              var tableArray = data.table;
              $(`#slicerConfigCardellipse08589847718203074${tabID}`).attr('data-tableArray', JSON.stringify(tableArray));
              for (var table of tableArray) {
                $(`#slicerConfigCardellipse08589847718203074${tabID}`).find('.card').eq(-1).find(".analysisSlicerTable").append(`<option value="${table}">${table}</option>`)
              };
            },
            error: ()=>{

            }
          });
          if ($(`#analysisTabContent${element_id}`).find('.chartDivSection').attr('data-layout') == "Landscape") {
            $('.chartDivSection').css({
              "background-image": "linear-gradient(rgba(0, 0, 0, 0.2) 0.05rem, transparent 0.36%), linear-gradient(90deg, rgba(0, 0, 0, 0.2) 0.05rem, transparent 0.36%)",
              "background-size": "5% 5%",
              "width":"100%",
              "margin":"auto",
              "aspect-ratio": 16/9,
              "overflow-y": "hidden",
              "overflow-x": "hidden",
              "border": "0.1px solid black",
            })
          } else if ($(`#analysisTabContent${element_id}`).find('.chartDivSection').attr('data-layout') == "Portrait") {
            $('.chartDivSection').css({
              "background-image": "linear-gradient(rgba(0, 0, 0, 0.2) 0.05rem, transparent 0.36%), linear-gradient(90deg, rgba(0, 0, 0, 0.2) 0.05rem, transparent 0.36%)",
              "background-size": "5% 5%",
              "width":"1080px",
              "margin":"auto",
              "aspect-ratio": 9/16,
              "overflow-y": "hidden",
              "overflow-x": "hidden",
              "border": "0.1px solid black",
            })
          } else {
            $(`#analysisTabContent${element_id}`).find('.chartDivSection').resizable();
              $('.chartDivSection').css({
              "width":"92%",
              "padding-left": "70px",
              "padding-top": "9px",
              "padding-right": "9px",
          })
          }
          
           
          $(`#removeTab${element_id}${tabID}`).click(function() {
              const deleteButton = document.getElementById(`removeTab${element_id}${tabID}`);
                deleteButton.addEventListener("click", (e) => {
                const id = e.target.parentNode.id.replace('removeT', 'indext');;
                const indexTab = document.getElementById('tabLinks'+element_id);
                const linkToBeDeleted  = document.getElementById(`${id}`);
                $(`#${id}`).closest(".row").remove();
              })
              var tabAnchorID=$(this).attr('data-tabAnchorID')
              var tabContainerDivID=$(this).attr('data-tabContainerDivID')
              $(`#${tabAnchorID}`).parent().remove()
              $(`#${tabContainerDivID}`).remove()
            })
            $('.contentEditable').each(function () {
            $(this).on('click', function () {
              $(this).attr("contenteditable", "true")
              $(this).focus()
            })
            $(this).focusout(function () {
              var tab_header = this.innerText
              tab_header = tab_header.trim()
              if (tab_header.length == 0){
                this.innerText = "Set Name"
                $(this).removeAttr("contenteditable");
                $(this).addClass("bg-danger")
                $(this).trigger("click")
              }
              else{
              $(this).removeAttr("contenteditable");
              $(this).removeClass("bg-danger")
              }
          })
          });

            $(`#slicerConfigCardellipse08589847718203074${tabID}`).find('.card').eq(-1).find(".card-body").find("select").each(function(){
    parent = $(this).parent()
    $(this).select2({dropdownParent:parent})
  })
      slicerTabConfigDict['selectSlicerConfig_'+'ellipse08589847718203074'+tabID] = [];
      slicerChangeUpdatePlots();
      global_apply_button_click();
      if(typeof(fetchSlicerParams) != undefined && typeof(fetchSlicerParams) != 'undefined'){
        fetchSlicerParams();
      }
      $(`#saveTabSlicerConfigellipse08589847718203074${tabID}`).on('click', function(){
        let anlysisElementId = $(this).attr('data-analysis_id');
        let analysistabNo = $(this).attr('data-tab_id');
        var tabDict={
          "TabID":(tabID),
          "slicerTable":[],
          "slicerParameter":[],
          "slicerBoolean" :[],
          "slicerReload" : [],
          "multipleSlicer": []
        }
        $(`#slicerConfigCardellipse08589847718203074${tabID}`).find('.card').find('.analysisSlicerTable').each(function() {
          tabDict["slicerTable"].push($(this).val())
        })
        $(`#slicerConfigCardellipse08589847718203074${tabID}`).find('.card').find('.analysisSlicerParameter').each(function() {
          tabDict["slicerParameter"].push($(this).val())
        })
        $(`#slicerConfigCardellipse08589847718203074${tabID}`).find('.card').find('.mulcheckbox').each(function() {
          if ($(this).is(":checked")){
            tabDict["multipleSlicer"].push(true);
          }else{
            tabDict["multipleSlicer"].push(false);
          }
        })
        $(`#slicerConfigCardellipse08589847718203074${tabID}`).find('.card').find('.analysisSlicerBoolean').each(function() {
          if ($(this).is(":checked")){
            tabDict["slicerBoolean"].push("True")
          }else {
            tabDict["slicerBoolean"].push("False")
          }
        })
               url_string = window.location.pathname
               f_occ = url_string.indexOf('/', url_string.indexOf('/') + 1)
               s_occ = url_string.indexOf('/', url_string.indexOf('/') + f_occ +1)
               t_occ = url_string.indexOf('/', url_string.indexOf('/') + s_occ +1)
               app_code2 = url_string.substring(f_occ+1,s_occ)
               current_dev_mode2 = url_string.substring(s_occ+1,t_occ)
              if(current_dev_mode2 != 'Build' && current_dev_mode2 != 'Edit'){
                current_dev_mode2 = 'User'
              }
        $.ajax({
          url: `/users/${urlPath}/processGraphModule/`,
          data: {
            'tab_slicer_config': JSON.stringify(tabDict),
            'element_id': 'ellipse08589847718203074',
            'tab_id': tabID,
            'operation': 'saveAnalysisSlicerConfigL3',
          },
          type: "POST",
          dataType: "json",
          success: function (data) {
            var analysisSlicerElementId = data.elementID;
            var analysisSlicerTabId = data.slicer_tab_id;
            $(`#tab${analysisSlicerElementId}${analysisSlicerTabId}`).find('.card-tools.tabCardTools').empty();
            $(`#tab${analysisSlicerElementId}${analysisSlicerTabId}`).find('.card-tools.tabCardTools').append(`<button type="button" value="AddComment" class="btn btn-primary commentButton btn-md" id="AddComment${analysisSlicerElementId}${analysisSlicerTabId}"  data-toggle="tooltip" title="Add comment" style="height: 25px;border-radius:5px;border-color:none;color:white;margin-top:10px; margin-bottom:10px"><i class='far fa-comment-dots' style="font-size:1rem;"></i></button>&nbsp;<button type="button" value="PDF" class=" btn btn-primary" data-tabHeaderID="tabHeader${analysisSlicerElementId}${analysisSlicerTabId}" id='analysisPDF${analysisSlicerElementId}${analysisSlicerTabId}' style="height: 25px;border-radius:5px;border-color:none;color:white;padding-left:9px;padding-top:2px;  margin-right:5px;margin-top:10px; margin-bottom:10px"><i class="fa fa-file-pdf-o"></i>&nbsp;PDF</button><button type="button" value="slicerConfig" class="btn btn-primary" data-tabHeaderID="tabHeader${analysisSlicerElementId}${analysisSlicerTabId}" id='slicerConfig${analysisSlicerElementId}${analysisSlicerTabId}' data-toggle="modal" data-target="#slicerConfigModal${analysisSlicerElementId}${analysisSlicerTabId}" style="height: 25px;border-radius:5px;border-color:none;color:white;padding-left:9px;padding-top:2px; margin-right:10px; margin-top:10px; margin-bottom:10px"><i class="fas fa-filter"></i>&nbsp;Slicer</button><button type="button" value="gridLines" class="btn btn-primary" data-tabHeaderID="tabHeader${analysisSlicerElementId}${analysisSlicerTabId}" id='gridLines${analysisSlicerElementId}${analysisSlicerTabId}' style="height: 25px;border-radius:5px;border-color:none;color:white;padding-left:9px;padding-top:2px; margin-right:10px; margin-top:10px; margin-bottom:10px" onclick="gridLine.call(this)"><i class="fa fa-table"></i>&nbsp;Grid lines</button>`);

            let tabSlicerConfigOutput = data[analysisSlicerTabId];
            let analysis_additional_config = tabSlicerConfigOutput.analysis_additional_config;
            if (analysis_additional_config == "slicer_config") {
              let slicerTables = tabSlicerConfigOutput.slicerTable;
              let slicerParameters = tabSlicerConfigOutput.slicerParameter;
              let mapDict = tabSlicerConfigOutput.mappingDict
              let slicerBooleans = tabSlicerConfigOutput.slicerBoolean;
              let slicerParameterValues = tabSlicerConfigOutput.slicer_parameter_values;
              let slicerReloadValue = tabSlicerConfigOutput.slicerReload;
              let multipleSlicer = tabSlicerConfigOutput.multipleSlicer;
              var html = '';

              for(let i = 0; i < slicerParameterValues.length; i++) {
                let attr_ = 'data-value = ""'
                let multiple = "";
                if(slicerReloadValue != undefined){
                  if (slicerReloadValue.length != 0) {
                    attr_ = 'data-value' + `= '${JSON.stringify(slicerReloadValue[i])}'`
                  }
                }
                if(multipleSlicer != undefined){
                  if(multipleSlicer.length > 0){
                    if(multipleSlicer[i]){
                      multiple = "multiple";
                    }
                  }
                }
                html = html + `
                <div class="form-inline" style="margin-bottom:5px;text-align:left;">
                  <span class="text-primary" margin-right:10px; margin-left:10px;">${mapDict[i][slicerParameters[i]]}:</span>
                  <select class="selectSlicerConfig_${analysisSlicerElementId}${analysisSlicerTabId} select2 form-control slicerParamValue${analysisSlicerElementId}" data-tab="${analysisSlicerTabId}" data-slicertable="${slicerTables[i]}" data-slicerColumn= "${slicerParameters[i]}" ${attr_} data-id="selectSlicerConfig_${analysisSlicerElementId}${analysisSlicerTabId}" style="width:150px;display:inline-block;" ${multiple}>`
                    if(slicerBooleans != undefined){
                      if (slicerBooleans.length != 0) {
                        if(slicerBooleans[i] == 'True'){
                          html = html + `<option value="" selected>All</option>`
                        }
                      }
                    }
                for(let j = 0; j < slicerParameterValues[i].length; j++) {
                    if(slicerParameterValues[i][j] != ''){
                    html = html + `<option value="${slicerParameterValues[i][j]}">${slicerParameterValues[i][j]}</option>`
                    }
                }
                html = html +
                  `</select>
                </div>
                `
              }
              $(`#tab${analysisSlicerElementId}${analysisSlicerTabId}`).find('.card-tools.tabCardTools').append(html);
              $(`#tab${analysisSlicerElementId}${analysisSlicerTabId}`).find('.card-tools.tabCardTools').find('select').each(function(){
                parent = $(this).parent()
                $(this).select2({dropdownParent:parent})
              })
              $(`#tab${analysisSlicerElementId}${analysisSlicerTabId}`).find('.card-tools.tabCardTools').find('.select2').parent().find(".select2-container").css("max-height","55px");
              $(`#tab${analysisSlicerElementId}${analysisSlicerTabId}`).find('.card-tools.tabCardTools').find('.select2').parent().find(".select2-container").css("overflow-y","scroll");

                                    $(`#AddComment${analysisSlicerElementId}${analysisSlicerTabId}`).click(function(){
                                      var id_ = ('analysisEditor' + Math.random()).replace('.',"");
                                        $(this).parent().parent().next().append(`

                                               <div class="small-box commentboxcard" data-id="${id_}" id = "${id_}" onmouseenter="showTool.call(this)" onmouseleave="hideTool.call(this)" style="min-height:6rem;min-width:6rem;height:6rem;width:9rem;" >
                                        <div class="row"  style="position:absolute; margin-left:100%;display:none;flex-wrap:wrap;">
                                          <i class="fa fa-times deleteCommentBox" title="Delete" style="font-size:1rem;margin-right:0.5rem;margin-left:1px;margin-bottom:2px;"></i>
                                          <i class='fas fa-edit' onclick="ckEditorFunc.call(this)" style="font-size:1rem;margin-right:0.5rem;margin-bottom:2px;"></i>
                                          <i class="fa fa-arrows" style="font-size:1rem;margin-right:0.5rem;"></i>
                                        </div>
                                        <div class="commentbox contentEditable" name="comment" style="margin-top:1rem;max-height: 75%;padding: 0.3em 0.5em 0 0.5em;background-color: transparent;text-align: left;overflow-y: auto;">

                                        </div>
                                      </div>`)
                                      $(".commentboxcard").resizable();
                                      $('.contentEditable').each(function () {
                                          $(this).on('click', function () {
                                            $(this).attr("contenteditable", "true")
                                            $(this).focus()
                                          })
                                          $(this).focusout(function () {
                                              var content = this.innerText
                                              content = content.trim()
                                              if (content.length == 0){
                                                this.innerText = "Enter text here."
                                                $(this).removeAttr("contenteditable");
                                                $(this).trigger("click")
                                              }
                                              else{
                                              $(this).removeAttr("contenteditable");
                                              }
                                          })
                                        })
                                      $('.deleteCommentBox').click(function () {
                                          $(this).parent().parent().remove()
                                      })
                                      $(".commentboxcard").draggable({
                                          cancel: '',
                                          containment: "parent",
                                      });
                                  })
            }
            slicerChangeUpdatePlots();
          },
          error: function () {
            Swal.fire({icon: 'error',text: 'Error! Failure in fetching the columns. Please try again.'});
          }
            });
          });
          $(`#${"removeTab"+element_id+tabID}`).click(function(){

                var tabAnchorID=$(this).attr('data-tabAnchorID')
                var tabContainerDivID=$(this).attr('data-tabContainerDivID')
                $(`#${tabAnchorID}`).parent().remove()
                $(`#${tabContainerDivID}`).remove()
            })
            $('.contentEditable').each(function () {
            $(this).on('click', function () {
                $(this).attr("contenteditable", "true")
                $(this).focus()
            })
            $(this).focusout(function () {
                var tab_header = this.innerText
                tab_header = tab_header.trim()
                if (tab_header.length == 0){
                this.innerText = "Set Name"
                $(this).removeAttr("contenteditable");
                $(this).addClass("bg-danger")
                $(this).trigger("click")

                }
                else{
                $(this).removeAttr("contenteditable");
                $(this).removeClass("bg-danger")
                }
            })
            })
            $(`#${"AddComment"+element_id+tabID}`).click(function(){
                var id_ = ('analysisEditor' + Math.random()).replace('.',"");
                $(this).parent().parent().next().append(`
                  <div class="small-box commentboxcard" data-id="${id_}" id = "${id_}" onmouseenter="showTool.call(this)" onmouseleave="hideTool.call(this)" style="min-height:6rem;min-width:6rem;height:6rem;width:9rem;" >
                  <div class="row"  style="position:absolute; margin-left:100%; display:none;flex-wrap:wrap;">
                    <i class="fa fa-times deleteCommentBox" title="Delete" style="font-size:1rem;margin-right:0.5rem;margin-left:1px;margin-bottom:2px;"></i>
                    <i class='fas fa-edit' onclick="ckEditorFunc.call(this)" style="font-size:1rem;margin-right:0.5rem;margin-bottom:2px;"></i>
                    <i class="fa fa-arrows" style="font-size:1rem;margin-right:0.5rem;"></i>
                  </div>
                  <div class="commentbox contentEditable" name="comment" style="margin-top:1rem;max-height: 75%;padding: 0.3em 0.5em 0 0.5em;background-color: transparent;text-align: left;overflow-y: auto;">

                  </div>
                </div>`)
                $(".commentboxcard").resizable();
                $('.contentEditable').each(function () {
                    $(this).on('click', function () {
                    $(this).attr("contenteditable", "true")
                    $(this).focus()
                    })
                    $(this).focusout(function () {
                        var content = this.innerText
                        content = content.trim()
                        if (content.length == 0){
                        this.innerText = "Enter text here."
                        $(this).removeAttr("contenteditable");
                        $(this).trigger("click")
                        }
                        else{
                        $(this).removeAttr("contenteditable");
                        }
                    })
                })
                $('.deleteCommentBox').click(function () {
                    $(this).parent().parent().remove()
                })
                $(".commentboxcard").draggable({
                    cancel: '',
                    containment: "parent",
                });
            })
        })
        var share_status = false
        $(`#analysisshare${element_id}`).click(function () {
            share_status = true
            let element_id_extract = $(this).attr("data-elementID");

            saveGroupConfigAnalysis(($(this).attr("data-elementID")),($(`#select2multiple_group${element_id_extract}`).val()))
            })
          var analysisType = 'Analysis Pack - II (Advanced)'; 
              url_string = window.location.pathname
              f_occ = url_string.indexOf('/', url_string.indexOf('/') + 1)
              s_occ = url_string.indexOf('/', url_string.indexOf('/') + f_occ +1)
              t_occ = url_string.indexOf('/', url_string.indexOf('/') + s_occ +1)
              app_code2 = url_string.substring(f_occ+1,s_occ)
              current_dev_mode2 = url_string.substring(s_occ+1,t_occ)
              if(current_dev_mode2 != 'Build' && current_dev_mode2 != 'Edit'){
                current_dev_mode2 = 'User'
              }
          var versionData = {};
          $.ajax({
            url:`/users/${urlPath}/dynamicVal/`,
            data: {
              'operation':'saveVersionConfig',
              'element_id': 'ellipse08589847718203074'
            },
            type: 'POST',
            dataType: "json",
            success: function (data) {
              versionData = data;
              saveElementID = data.analysisConfigData.ElementID
              $(`#last_updated_time${saveElementID}`).text(data["last_modified_date"])
              for (const [key, uconfig] of Object.entries(data['user_config_list'])){
                $(`#selectConfig${saveElementID}`).append(`<option value="${uconfig['name']}"> ${uconfig['name']} </option>`)
              };
              for (let i = 0; i < data['group_name_list'].length; i++){
                $(`#select2multiple_group${saveElementID}`).append(`<option value="${data['group_name_list'][i]}"> ${data['group_name_list'][i]} </option>`)
              };
                  $(`#selectConfig${saveElementID}`).change(function(){
                  var name = $(this).val()
                  if(!name) {
                    $(".chartDivSection").empty()
                    analysisData_Raw = undefined
                    window.location.reload()
                  } else {
                    $(`#selectversion${saveElementID}`).empty()
                    $(`#selectversion${saveElementID}`).append(`<option value="------"> ----- </option>`);
                    $(`#select2multiple_group${saveElementID}`).val($(this).val()).trigger("change")
                    for (const [key, gconfig] of Object.entries(data['group_config_list']))
                    {  if(name == gconfig['name'] )
                    {
                        $(`#selectversion${saveElementID}`).append(`<option value="${gconfig['version_name']}"> ${gconfig['version_name']} </option>`);
                        $(`#last_updated_time${saveElementID}`).text(gconfig['date'])
                        var gRawData = JSON.parse(gconfig['config'])



                            var bg_x= gRawData['subTabContent'][0]['tab_background-color']
                            var bg_image= gRawData['subTabContent'][0]['global_bg_name']
                            var bg_folder= gRawData['subTabContent'][0]['global_bg_folder']
                            $(`#bg_image_url${saveElementID}`).html("")
                            $(`#bg_image_url${saveElementID}`).html(bg_image)
                            var global_bg_value = gRawData['subTabContent'][0]['global_bg_value']
                            $(`#global_bg${saveElementID}`).val(global_bg_value).trigger("change")
                            if(global_bg_value == "background_image"){
                              $('.global_bg_color').css("display","none")
                              $('.global_bg_image').css("display","block")
                                if(bg_image != "" || bg_image != undefined)
                            {
                              if ($(`#analysisTabContent${saveElementID}`).find('.chartDivSection').attr('data-layout') == "Landscape") {
                                  $(`#analysisTabContent${saveElementID}`).find('.chartDivSection').css("background-size",'100% calc(100vw * 9/16)' )
                                  }
                              else if ($(`#analysisTabContent${saveElementID}`).find('.chartDivSection').attr('data-layout') == "Portrait") {
                                  $(`#analysisTabContent${saveElementID}`).find('.chartDivSection').css("background-size",'1080px calc(100vw * 16/9)' )
                                  }
                              else{
                                $(`#analysisTabContent${saveElementID}`).find('.chartDivSection').css("background-size",'100%' )
                              }
                              url_string = window.location.pathname
                              f_occ = url_string.indexOf('/', url_string.indexOf('/') + 1)
                              s_occ = url_string.indexOf('/', url_string.indexOf('/') + f_occ +1)
                              t_occ = url_string.indexOf('/', url_string.indexOf('/') + s_occ +1)
                              app_code2 = url_string.substring(f_occ+1,s_occ)
                              current_dev_mode2 = url_string.substring(s_occ+1,t_occ)
                              if(current_dev_mode2 != 'Build' && current_dev_mode2 != 'Edit'){
                                current_dev_mode2 = 'User'
                              }
                              $.ajax({
                                  url: `/users/${urlPath}/reload_bg_image/`,

                                  data:{
                                      'folder_name': bg_folder,
                                      'filename': bg_image,
                                  },
                                  type: "POST",
                                  dataType: "json",
                                  success: function (data) {
                                      $(`.mainDiv`).css("background-image",'url(data:image/png;base64,' + data.image_url )
                                      $(`.mainDiv`).css("background-size",'56em 15em' )
                                      $(`#bg_image_url${saveElementID}`).html("")
                                      $(`#bg_image_url${saveElementID}`).html(data.image_url)
                                      $(`#bg_image_name${saveElementID}`).html("")
                                      $(`#bg_image_name${saveElementID}`).html(data.image_name)
                                      $(`#analysisTabContent${saveElementID}`).find('.chartDivSection').css("background-image",'url(data:image/png;base64,' + data.image_url )

                                  }
                              })
                              }
                              }
                              else{
                                $('.global_bg_color').css("display","block")
                              $('.global_bg_image').css("display","none")
                              $(`.mainDiv`).css("background-image",'none' )
                              }


                            $(`#analysisTabContent${saveElementID}`).find('.chartDivSection').css("background-color",bg_x)
                            $(`#analysisTabContent${saveElementID}`).find('.chartDivSection').attr("config_background-color",bg_x)
                            $(`#analysisDashboard${saveElementID} .tab-content`).attr("config_background-color",bg_x);
                            $(`#analysisTab${saveElementID}`).find('.nav-link').attr("config_background-color",bg_x);
                              if(bg_x != undefined){
                                $(`#myColor${saveElementID}`).val(bg_x)
                                $(`#main_theme${saveElementID}`).css("background-color",bg_x);
                              }
                              if(gRawData['subTabContent'][0]['outer_color'] != undefined){
                                $(`#theme1${saveElementID}`).css("background-color",gRawData['subTabContent'][0]['outer_color']);
                                $(`#themeColor${saveElementID}`).val(gRawData['subTabContent'][0]['outer_color'])
                              }
                              if(gRawData['subTabContent'][0]['inner_color'] != undefined)
                              {
                                $(`#themegrad${saveElementID}`).css("background-color",gRawData['subTabContent'][0]['inner_color']);
                                $(`#themeColor1${saveElementID}`).val(gRawData['subTabContent'][0]['inner_color'])
                              }

                              if(gRawData['subTabContent'][0]['indexCard_BGColor'] != undefined)
                              {
                                $(`#indextabBG${saveElementID}`).css(gRawData['subTabContent'][0]['indexCard_BGColor']);
                                $(`#indextabBG${saveElementID}`).val(gRawData['subTabContent'][0]['indexCard_BGColor'])
                              }
                              if(gRawData['subTabContent'][0]['indexCard_FontColor'] != undefined)
                              {
                                $(`#indextabFC${saveElementID}`).css("background-color",gRawData['subTabContent'][0]['indexCard_FontColor']);
                                $(`#indextabFC${saveElementID}`).val(gRawData['subTabContent'][0]['indexCard_FontColor'])
                              }

                              if(gRawData['subTabContent'][0]['header_color'] != undefined)
                              {
                                 $(".inner-div_title").css("color",gRawData['subTabContent'][0]['header_color']);
                                $(".global_header_color").val(gRawData['subTabContent'][0]['header_color'])
                              }
                              if(gRawData['subTabContent'][0]['header_bg_color'] != undefined)
                              {
                                $(".inner-div_header").css("background-color",gRawData['subTabContent'][0]['header_bg_color']);
                                $(".global_header_bgcolor").val(gRawData['subTabContent'][0]['header_bg_color'])
                              }
                              if(gRawData['subTabContent'][0]['global_header_alignment'] != undefined)
                              {
                              $(".global_header_alignment").val(gRawData['subTabContent'][0]['global_header_alignment']).trigger("change")
                              }
                              $(".global_header_fontsize").val(gRawData['subTabContent'][0]['header_fontsize'])
                              $(".global_header_fontweight").val(gRawData['subTabContent'][0]['header_fontweight']).trigger("change")
                               $(".global_header_fontstyle").val(gRawData['subTabContent'][0]['header_fontstyle']).trigger("change")
                              $(".inner-div_title").css("font-size",gRawData['subTabContent'][0]['header_fontsize'] + 'px');
                              $(".inner-div_title").css("font-weight",gRawData['subTabContent'][0]['header_fontweight']);
                              $(".inner-div_title").css("font-style",gRawData['subTabContent'][0]['header_fontstyle']);
                              var theme_height = (parseInt(gRawData['subTabContent'][0]['header_fontsize']) + 20) + "px"
                              $(".inner-div_header").css("height",theme_height);
                              if(gRawData['subTabContent'][0]['global_checkBox'] != undefined)
                              {
                                $(".global_shadow").prop('checked',gRawData['subTabContent'][0]['global_checkBox'])
                              }
                              if(gRawData['subTabContent'][0]['global_checkBox_border'] != undefined)
                              {
                                $(".global_border").prop('checked',gRawData['subTabContent'][0]['global_checkBox_border'])
                              }
                              if(gRawData['subTabContent'][0]['global_shadowColor'] != undefined)
                              {
                                $(".global_shadow_color").val(gRawData['subTabContent'][0]['global_shadowColor'])
                              }
                              if(gRawData['subTabContent'][0]['global_shadowXOffset'] != undefined)
                              {
                                $(".global_shadow_x").val(gRawData['subTabContent'][0]['global_shadowXOffset'])
                              }
                              if(gRawData['subTabContent'][0]['global_shadowBlur'] != undefined)
                              {
                                $(".global_shadow_blur").val(gRawData['subTabContent'][0]['global_shadowBlur'])
                              }
                              if(gRawData['subTabContent'][0]['global_shadowYOffset'] != undefined)
                              {
                                $(".global_shadow_y").val(gRawData['subTabContent'][0]['global_shadowYOffset'])
                              }
                              if(gRawData['subTabContent'][0]['global_shadowThickness'] != undefined)
                              {
                                $(".global_shadow_thickness").val(gRawData['subTabContent'][0]['global_shadowThickness'])
                              }

                              if(gRawData['subTabContent'][0]['global_borderThickness'] != undefined)
                              {
                                $(".global_border_thickness").val(gRawData['subTabContent'][0]['global_borderThickness'])
                              }
                              if(gRawData['subTabContent'][0]['global_borderStyle'] != undefined)
                              {
                                $(".global_border_style").val(gRawData['subTabContent'][0]['global_borderStyle']).trigger("change")
                              }
                              if(gRawData['subTabContent'][0]['global_borderColor'] != undefined)
                              {
                                $(".global_border_color").val(gRawData['subTabContent'][0]['global_borderColor'])
                              }
                              globalBorderFunction()
                              globalShadowFunction()

                            if(gRawData['subTabContent'][0]['g_color'] == "yes"){
                              $('.global_gradient_color').prop('checked', true);
                            }
                            else{
                              $('.global_gradient_color').prop('checked', false);
                            }
                    }
                    } $(`#selectversion${saveElementID}`).val("version1").trigger('change');
                  }


              })
              $(`#selectversion${saveElementID}`).change(function(){
                  var version_name = $(this).val()
                  var group_name = $(`#selectConfig${saveElementID}`).val()
                    for (const [key, gconfig] of Object.entries(versionData["group_config_list"])){
                    if(version_name == gconfig['version_name'] && group_name == gconfig['name'])
                        {
                        $(`#last_updated_time${saveElementID}`).text(gconfig['date'])
                        analysisData_Raw = JSON.parse(gconfig['config'])
                        let indexTab = true;
                        if(analysisData_Raw.hasOwnProperty("tabIndex")){
                          indexTab = analysisData_Raw["tabIndex"];
                        }
                        var gRawData = JSON.parse(gconfig['config'])

                        var tab_object = $(`#analysisDashboard${saveElementID} .tab-content`)
                             var bg_x= gRawData['subTabContent'][0]['tab_background-color']
                            var bg_image= gRawData['subTabContent'][0]['global_bg_name']
                            var bg_folder= gRawData['subTabContent'][0]['global_bg_folder']
                            $(`#bg_image_url${saveElementID}`).html("")
                            $(`#bg_image_url${saveElementID}`).html(bg_image)
                            var global_bg_value = gRawData['subTabContent'][0]['global_bg_value']
                            $(`#global_bg${saveElementID}`).val(global_bg_value).trigger("change")
                            if(global_bg_value == "background_image"){
                              $('.global_bg_color').css("display","none")
                              $('.global_bg_image').css("display","block")
                                if(bg_image != "" || bg_image != undefined)
                            {
                              if ($(`#analysisTabContent${saveElementID}`).find('.chartDivSection').attr('data-layout') == "Landscape") {
                                  $(`#analysisTabContent${saveElementID}`).find('.chartDivSection').css("background-size",'100% calc(100vw * 9/16)' )
                                  }
                              else if ($(`#analysisTabContent${saveElementID}`).find('.chartDivSection').attr('data-layout') == "Portrait") {
                                  $(`#analysisTabContent${saveElementID}`).find('.chartDivSection').css("background-size",'1080px calc(100vw * 16/9)' )
                                  }
                              else{
                                $(`#analysisTabContent${saveElementID}`).find('.chartDivSection').css("background-size",'100%' )
                              }

                              $.ajax({
                                  url: `/users/${urlPath}/reload_bg_image/`,

                                  data:{
                                      'folder_name': bg_folder,
                                      'filename': bg_image,
                                  },
                                  type: "POST",
                                  dataType: "json",
                                  success: function (data) {
                                      $(`.mainDiv`).css("background-image",'url(data:image/png;base64,' + data.image_url )
                                      $(`.mainDiv`).css("background-size",'56em 15em' )
                                      $(`#bg_image_url${saveElementID}`).html("")
                                      $(`#bg_image_url${saveElementID}`).html(data.image_url)
                                      $(`#bg_image_name${saveElementID}`).html("")
                                      $(`#bg_image_name${saveElementID}`).html(data.image_name)
                                      $(`#analysisTabContent${saveElementID}`).find('.chartDivSection').css("background-image",'url(data:image/png;base64,' + data.image_url )

                                  }
                              })
                              }
                              }
                              else{
                                $('.global_bg_color').css("display","block")
                              $('.global_bg_image').css("display","none")
                              $(`.mainDiv`).css("background-image",'none' )
                              }

                            $(`#analysisTabContent${saveElementID}`).find('.chartDivSection').css("background-color",bg_x)
                            $(`#analysisTabContent${saveElementID}`).find('.chartDivSection').attr("config_background-color",bg_x)
                            $(`#analysisDashboard${saveElementID} .tab-content`).attr("config_background-color",bg_x);
                            $(`#analysisDashboard${saveElementID} .tab-content`).find('.chartDivSection').css("background-color",bg_x);
                            $(`#analysisTab${saveElementID}`).find('.nav-link').attr("config_background-color",bg_x);
                              if(bg_x != undefined){
                                $(`#myColor${saveElementID}`).val(bg_x)
                                $(`#main_theme${saveElementID}`).css("background-color",bg_x);
                                $("#tabLinks"+saveElementID+" .index-rows").css("background-color",bg_x);
                              }
                              if(gRawData['subTabContent'][0]['outer_color'] != undefined){
                                $(`#theme1${saveElementID}`).css("background-color",gRawData['subTabContent'][0]['outer_color']);
                                $(`#themeColor${saveElementID}`).val(gRawData['subTabContent'][0]['outer_color'])
                              }
                              if(gRawData['subTabContent'][0]['inner_color'] != undefined)
                              {
                                $(`#themegrad${saveElementID}`).css("background-color",gRawData['subTabContent'][0]['inner_color']);
                                $(`#themeColor1${saveElementID}`).val(gRawData['subTabContent'][0]['inner_color'])
                              }


                              if(gRawData['subTabContent'][0]['indexCard_BGColor'] != undefined)
                              {
                                $(`#indextabBG${saveElementID}`).css(gRawData['subTabContent'][0]['indexCard_BGColor']);
                                $(`#indextabBG${saveElementID}`).val(gRawData['subTabContent'][0]['indexCard_BGColor'])
                              } else{
                                $(`#indextabBG${saveElementID}`).css('var(--primary-color)');
                                $(`#indextabBG${saveElementID}`).val('var(--primary-color)')

                              }
                              if(gRawData['subTabContent'][0]['indexCard_FontColor'] != undefined)
                              {
                                $(`#indextabFC${saveElementID}`).css("color",gRawData['subTabContent'][0]['indexCard_FontColor']);
                                $(`#indextabFC${saveElementID}`).val(gRawData['subTabContent'][0]['indexCard_FontColor'])
                              } else {
                                $(`#indextabFC${saveElementID}`).css("color",'#ffffff');
                                $(`#indextabFC${saveElementID}`).val('#ffffff')
                              }

                              if(gRawData['subTabContent'][0]['header_color'] != undefined)
                              {
                                $(".inner-div_title").css("color",gRawData['subTabContent'][0]['header_color']);
                                $(".global_header_color").val(gRawData['subTabContent'][0]['header_color'])
                              }
                              if(gRawData['subTabContent'][0]['header_bg_color'] != undefined)
                              {
                                $(".inner-div_header").css("background-color",gRawData['subTabContent'][0]['header_bg_color']);
                                $(".global_header_bgcolor").val(gRawData['subTabContent'][0]['header_bg_color'])
                              }
                              if(gRawData['subTabContent'][0]['global_header_alignment'] != undefined)
                              {
                              $(".global_header_alignment").val(gRawData['subTabContent'][0]['global_header_alignment']).trigger("change")
                              }
                              $(".global_header_fontsize").val(gRawData['subTabContent'][0]['header_fontsize'])
                              $(".global_header_fontweight").val(gRawData['subTabContent'][0]['header_fontweight']).trigger("change")
                               $(".global_header_fontstyle").val(gRawData['subTabContent'][0]['header_fontstyle']).trigger("change")
                              $(".inner-div_title").css("font-size",gRawData['subTabContent'][0]['header_fontsize'] + 'px');
                              $(".inner-div_title").css("font-weight",gRawData['subTabContent'][0]['header_fontweight']);
                              $(".inner-div_title").css("font-style",gRawData['subTabContent'][0]['header_fontstyle']);
                              var theme_height = (parseInt(gRawData['subTabContent'][0]['header_fontsize']) + 20) + "px"
                              $(".inner-div_header").css("height",theme_height);
                              if(gRawData['subTabContent'][0]['global_checkBox'] != undefined)
                              {
                                $(".global_shadow").prop('checked',gRawData['subTabContent'][0]['global_checkBox'])
                              }
                              if(gRawData['subTabContent'][0]['global_checkBox_border'] != undefined)
                              {
                                $(".global_border").prop('checked',gRawData['subTabContent'][0]['global_checkBox_border'])
                              }
                              if(gRawData['subTabContent'][0]['global_shadowColor'] != undefined)
                              {
                                $(".global_shadow_color").val(gRawData['subTabContent'][0]['global_shadowColor'])
                              }
                              if(gRawData['subTabContent'][0]['global_shadowXOffset'] != undefined)
                              {
                                $(".global_shadow_x").val(gRawData['subTabContent'][0]['global_shadowXOffset'])
                              }
                              if(gRawData['subTabContent'][0]['global_shadowBlur'] != undefined)
                              {
                                $(".global_shadow_blur").val(gRawData['subTabContent'][0]['global_shadowBlur'])
                              }
                              if(gRawData['subTabContent'][0]['global_shadowYOffset'] != undefined)
                              {
                                $(".global_shadow_y").val(gRawData['subTabContent'][0]['global_shadowYOffset'])
                              }
                              if(gRawData['subTabContent'][0]['global_shadowThickness'] != undefined)
                              {
                                $(".global_shadow_thickness").val(gRawData['subTabContent'][0]['global_shadowThickness'])
                              }

                              if(gRawData['subTabContent'][0]['global_borderThickness'] != undefined)
                              {
                                $(".global_border_thickness").val(gRawData['subTabContent'][0]['global_borderThickness'])
                              }
                              if(gRawData['subTabContent'][0]['global_borderStyle'] != undefined)
                              {
                                $(".global_border_style").val(gRawData['subTabContent'][0]['global_borderStyle']).trigger("change")
                              }
                              if(gRawData['subTabContent'][0]['global_borderColor'] != undefined)
                              {
                                $(".global_border_color").val(gRawData['subTabContent'][0]['global_borderColor'])
                              }

                              globalBorderFunction()
                              globalShadowFunction()



                            if(gRawData['subTabContent'][0]['g_color'] == "yes"){
                              $('.global_gradient_color').prop('checked', true);
                            }
                            else{
                              $('global_gradient_color').prop('checked', false);
                            }
                        }
                    }

                  if(analysisData_Raw == undefined){

                      $(".chartDivSection").empty()
                      }

              if(analysisData_Raw!=undefined){

                  analysisTabID=analysisData_Raw["ElementID"]
                  let indexTab = true;
                  if(analysisData_Raw.hasOwnProperty("indexTab")){
                    indexTab = analysisData_Raw["indexTab"];
                  }
                  var analysisTableNames = versionData["analysis_table_list"]
                  var mainL3ULID=analysisData_Raw["ParentULID"]
                  var mainTabContainerID=analysisData_Raw["ParentTabContainerID"]
                  $(`#${mainL3ULID}`).empty()
                  $(`#${mainTabContainerID}`).empty()
                  if(indexTab){
                    $(`#${mainL3ULID}`).append(`
                      <li class="nav-item navtab scroll-link">
                        <a class="nav-link" id="indexTab${analysisTabID}" href="#indexTabContent${analysisTabID}" role="tab" data-toggle="tab" aria-controls="#indexTab" aria-selected="true">
                          <div class="row">
                            <div class="col-md-11" style="padding-right: 0.1rem">
                              <span class="tabname1" id="indexTab${analysisTabID}" data-tab="indexTab{analysisTabID}" data-tab_ct="indexTab${analysisTabID}">
                                Index
                              </span>
                            </div>
                          </div>
                        </a>
                      </li>
                      `)
                  }

                    const navUl = document.querySelector('.nav.nav-tabs.nav-fill.analysis-nav');
                    if(navUl.children.length > 4) {
                      navUl.classList.add("scroll-nav")
                    }
                  var interaction
                  var tabs = []
                  for(j in analysisData_Raw["subTabContent"]) {
                    var tabDict=analysisData_Raw["subTabContent"][j];
                    if(!tabDict["aHref"].includes("#indexTabContent")) {
                      tabs.push([tabDict["aHref"], tabDict["subTabName"]])
                    }
                  }
                  tabs = tabs.reverse();

                  // INDEX TAB


                  const updateIndex = (index, val) => {
                    let ind = index.replace('Header', '')
                    const indexTabs = $("#tabLinks").find(".linkCard")
                    Array.from(indexTabs).forEach(ele => {
                      const id = ele.id.replace('index', '');
                      if(id == ind) {
                       $(`#index${id} .tab-title`).text(val)
                      }
                    });
                  }
                  if(indexTab){
                    $(`#${mainTabContainerID}`).append(`
                      <div class="tab-pane fade" id="indexTabContent${analysisTabID}" role="tabpanel" aria-labelledby="indexTab">
                        <div id="tabLinks${analysisTabID}" class="tabLinksclass"  style="max-width: 100%;  margin: auto; border: 0.1px solid black; aspect-ratio: {index_aspect_ratio}; overflow:auto;">
                        </div>
                      </div>
                    `)
                  }

                  tabs.forEach((ele, index) => {
                    let ind = ele[0].split('#')[1];
                    let index1 = tabs.length - index
                    let colo1 = $(".indextabBG").val();
                    let colo2 = $(".indextabFC").val();
                    let markup = `
                    <div class="row" style="box-shadow: rgb(0 0 0 / 35%) 0px 5px 15px;border-radius: 5px;margin: 20px 0;align-items: center;display: flex;">
                      <div id="" class="col-2 index-no-column" style="background-color: ${colo1};">
                        <p style="font-size: 1.2rem; color:${colo2}; margin:0;" href="${ele[0]}"> ${index1} </p>
                      </div>
                      <div class="col-10" style="">
                        <div id="index${ind}" style="background-color:${colo1};" class="linkCard defaultTabTheme">
                          <div class="col-10 d-flex align-items-center justify-content-center">
                            <a style="color:${colo2};font-size: 1.2rem;" href="${ele[0]}"> ${ele[1]} </a>
                          </div>
                          <div class="col-1 tab-icons d-flex align-items-center justify-content-center" style="margin:1rem;height:4rem; ">
                            <i class="fa fa-pen" style="color: ${colo2};"></i>
                          </div>
                        </div>
                      </div>
                    </div>
                    ` ;
                    const tabLinks = document.getElementById('tabLinks'+analysisTabID);
                    if(tabLinks != null){
                      tabLinks.insertAdjacentHTML("afterbegin", markup)
                      document.getElementById(`index${ind}`).addEventListener("click", (e) => {
                        e.preventDefault();
                        gotoTab(mainTabContainerID, ind);
                      });
                    }
                  });

                  // REMOVING THE OVERFLOW
                  const clearOverflow = () => {
                    if(document.getElementById('indexTab'+analysisTabID) != null){
                      const t = document.getElementById('indexTab'+analysisTabID).children
                      Array.from(t).forEach(ele => { if(ele.className == "hidden") { ele.parentNode.removeChild(ele) } })
                    }
                  }
                  const overflow = setTimeout(clearOverflow, 250)
                  for(j in analysisData_Raw["subTabContent"]){
                    var tabDict=analysisData_Raw["subTabContent"][j];
                    if (Object.keys(tabDict).includes('crossFilter')) {
                      interaction = tabDict['crossFilter'];
                    } else {
                        interaction = []
                    }
                    if (Object.keys(tabDict).includes('tabSlicerConfig')) {
                        var tabSlicerConfig = tabDict['tabSlicerConfig'];
                    } else {
                        var tabSlicerConfig = {
                            'slicerTable': [],
                            'slicerParameter': [],
                            'slicerBoolean': [],
                            'slicerReload' : [],
                            'multipleSlicer': [],
                        };
                    }
                    var parentId = mainL3ULID.split('analysisTab')[1]
                    var tab_ID = tabDict["aID"].replace('analysistab'+parentId,"");
                    if(!tab_ID.includes("indexTab")) {
                    $(`#${mainL3ULID}`).append(`<li class="nav-item navtab scroll-link"><a class="nav-link" id="${tabDict["aID"]}" href="${tabDict["aHref"]}" role="tab" data-toggle="tab" aria-controls="${tabDict["aHref"]}" aria-selected="false">
                      <div class="row">
                      <div class="col-md-10" style="padding-right: 0.1rem">
                      <span class="contentEditable tabname" id="${tabDict["tabHeaderID"]}" data-tab="${tabDict["chartDivContainer"]}" data-tab_ct="${tabDict["chartDivContainer"]}">${tabDict["subTabName"]}</span>
                      </div>
                      <div class="col-md-2" style="padding-top: 0.3rem">
                      <button type="button" id="${tabDict["deleteButtonID"]}" data-tabAnchorID="${tabDict["aID"]}" data-tabContainerDivID="${tabDict["aHref"].replace("#","")}" style="border-width:0px;padding: 1px 1px;background-color: white;"><i class="fa fa-times" style="font-size:0.9rem;"></i></button>
                      </div>
                      </div>
                      </a></li>`);
                      const deleteButton = document.getElementById(`${tabDict["deleteButtonID"]}`);
                      deleteButton.addEventListener("click", (e) => {
                        const id = e.target.parentNode.id.replace('removeT', 'indext');;
                        const indexTab = document.getElementById('tabLinks');
                        const linkToBeDeleted  = document.getElementById(`${id}`);
                        $(`#${id}`).closest(".row").remove();
                        let ind = 0
                        $("#tabLinks").find(".col-2").each(function() {
                          $(this).find("p").html(++ind)
                        })
                        const navUl = document.querySelector('.nav.nav-tabs.nav-fill.analysis-nav');
                        if(navUl.children.length > 4) {
                          navUl.classList.add("scroll-nav")
                        } else {
                          navUl.classList.remove("scroll-nav")
                        }
                      })
                      }
                      $(`#${mainTabContainerID}`).append(`<div class="tab-pane fade" id="${tabDict["aHref"].replace("#","")}" role="tabpanel" aria-labelledby="${tabDict["aID"]}">
                      <div class="d-flex justify-content-between" style="padding-top:1%">
                      <div class="card-tools tabCardTools row col-12" style="background:whitesmoke; display:flex; flex-direction:row; align-items:center; flex-wrap:wrap; padding-top:2px; padding-bottom:2px;margin:auto"><button type="button" value="AddComment" class="btn btn-primary commentButton btn-md" id="${tabDict["commentButtonID"]}"  data-toggle="tooltip" title="Add comment" style="height: 25px;border-radius:5px;border-color:none;color:white; margin-top:10px; margin-bottom:10px"><i class='far fa-comment-dots' style="font-size:1rem;"></i></button>&nbsp;<button type="button" value="PDF" class=" btn btn-primary" data-tabHeaderID="${tabDict["tabHeaderID"]}" id='${tabDict["pdfButtonID"]}' style="height: 25px;border-radius:5px;border-color:none;color:white;padding-left:9px;padding-top:2px; margin-right:10px; margin-top:10px; margin-bottom:10px"><i class="fa fa-file-pdf-o"></i>&nbsp;PDF</button><button type="button" value="slicerConfig" class="btn btn-primary" data-tabHeaderID="${tabDict["tabHeaderID"]}" id='${tabDict["pdfButtonID"]}' data-toggle="modal" data-target="#slicerConfigModal${analysisTabID}${tab_ID}" style="height: 25px;border-radius:5px;border-color:none;color:white;padding-left:9px;padding-top:2px; margin-right:10px; margin-top:10px; margin-bottom:10px"><i class="fas fa-filter"></i>&nbsp;Slicer</button></div>
                      </div>
                      <div class="col-lg-12 row chartDivSection"  data-layout="Landscape" id="${tabDict["chartDivContainer"]}" ondblclick="resetCrossFilter.call(this)"></div>
                      <div class="modal" id="slicerConfigModal${analysisTabID}${tab_ID}">
                        <div class="modal-dialog modal-md modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h6 class="modal-title" style="text-align:center;">Configure slicer</h6>
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <div class="card">
                                        <div class="card-body">
                                        <div class="card-tools text-primary" style="display:flex; flex-direction:row; align-items:center; justify-content:space-between;">
                                            <label for="">Add slicer</label>
                                            <button type="button" class="btn addOptionBtn" onclick="addSlicers('${analysisTabID}', '${tab_ID}')"><i class="fas fa-plus text-primary" ></i></button>
                                        </div>
                                        <div id="slicerConfigCard${analysisTabID}${tab_ID}" style="max-height: 15.25rem; overflow-y: scroll; overflow-x: hidden;">
                                            <div class="card" data-slicer_class="selectSlicerConfig_${analysisTabID}${tab_ID}">
                                            <div class="card-body">
                                                <div class="form-group" style="margin-bottom:5px;text-align:left;">
                                                <label for="analysisSlicerTable" class="justify-content-start" style="width:100%">Source table:
                                                </label>
                                                <select class="select2 form-control analysisSlicerTable" name="analysisSlicerTable" style="width:100%">
                                                    <option value="">Select source table</option>

                                                </select>
                                                </div>
                                                <div class="form-group" style="flex-direction: column;align-items: baseline;margin-bottom:5px;text-align:left;">
                                                <label for="analysisSlicerParameter" class="justify-content-start" style="width:100%">Slicer parameter:
                                                </label>
                                                <select  class="select2 form-control analysisSlicerParameter" name="analysisSlicerParameter" style="width:100%">
                                                    <option value="">Select slicer parameter</option>
                                                </select>
                                                </div>
                                                <div class = "form-group" style="margin-bottom:5px;text-align:left;">
                                                  <label for="analysisSlicerBoolean">
                                                  <input type="checkbox" class="analysisSlicerBoolean" name="analysisSlicerBoolean" value="True" style="margin-right:10px">
                                                  Add default option for all values</label>
                                                </div>
                                                <div class="form-group" style="margin-bottom:5px;text-align:left;">
                                                  <label>
                                                  <input class="mulcheckbox" type="checkbox" style="margin-right:10px">
                                                  Multiselect Slicer</label>
                                                </div>
                                            </div>
                                            </div>
                                        </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" id="saveTabSlicerConfig${analysisTabID}${tab_ID}" data-analysis_id="${analysisTabID}" data-tab_id="${tab_ID}" class="btn btn-primary btn-md mx-2 rounded px-2" data-dismiss="modal">Save</button>
                                </div>
                            </div>
                        </div>
                      </div>
                      </div>`)
                        var bg_x= gRawData['subTabContent'][0]['tab_background-color']
                            $(`#analysisTabContent${saveElementID}`).find('.chartDivSection').css("background-color",bg_x);
                            $("#tabLinks"+analysisTabID+" .index-rows").css("background-color",bg_x);
                            $(`#analysisTabContent${saveElementID}`).find('.chartDivSection').attr("config_background-color",bg_x)
                            $(`#analysisDashboard${saveElementID} .tab-content`).attr("config_background-color",bg_x);
                            $(`#analysisTab${saveElementID}`).find('.nav-link').attr("config_background-color",bg_x);
                      if(gRawData['subTabContent'][0]['indexCard_BGColor'] != undefined)
                              {
                                $(`#indextabBG${analysisTabID}`).css(gRawData['subTabContent'][0]['indexCard_BGColor']);
                                $(`#indextabBG${analysisTabID}`).val(gRawData['subTabContent'][0]['indexCard_BGColor'])
                              }
                              if(gRawData['subTabContent'][0]['indexCard_FontColor'] != undefined)
                              {
                                $(`#indextabFC${analysisTabID}`).css("color",gRawData['subTabContent'][0]['indexCard_FontColor']);
                                $(`#indextabFC${analysisTabID}`).val(gRawData['subTabContent'][0]['indexCard_FontColor'])
                              }
                      if($('.chartDivSection').attr('data-layout') == "Landscape") {
                          $('.chartDivSection').css({
                            "background-size": "5% 5%",
                            "width":"100%",
                            "margin":"auto",
                            "aspect-ratio": 16/9,
                            "overflow-y": "hidden",
                            "overflow-x": "hidden",
                          })
                        } else if($('.chartDivSection').attr('data-layout') == "Portrait") {
                          $('.chartDivSection').css({
                            "background-size": "5% 5%",
                            "width":"1080px",
                            "margin":"auto",
                            "aspect-ratio": 9/16,
                            "overflow-y": "hidden",
                            "overflow-x": "hidden",
                          })
                        } else {
                          $('.chartDivSection').css({
                          "width":"92%",
                          "padding-left": "70px",
                          "padding-top": "9px",
                          "padding-right": "9px",
                        })
                        }
                        if($('.chartDivSection').attr('data-layout') == "Landscape" || $('.chartDivSection').attr('data-layout') == "Portrait") {
                          if (Object.keys(tabDict).includes('grid')) {
                              if(tabDict["grid"] == "no") {
                                $(`#${tabDict["chartDivContainer"]}`).css('background-image',"none");
                              } else {
                                $(`#${tabDict["chartDivContainer"]}`).css({"background-image": "linear-gradient(rgba(0, 0, 0, 0.2) 0.05rem, transparent 0.36%), linear-gradient(90deg, rgba(0, 0, 0, 0.2) 0.05rem, transparent 0.36%)"});
                              }
                          } else {
                            $(`#${tabDict["chartDivContainer"]}`).css({"background-image": "linear-gradient(rgba(0, 0, 0, 0.2) 0.05rem, transparent 0.36%), linear-gradient(90deg, rgba(0, 0, 0, 0.2) 0.05rem, transparent 0.36%)"});
                          }

                        }

                            var bg_image= gRawData['subTabContent'][0]['global_bg_name']
                            var bg_folder= gRawData['subTabContent'][0]['global_bg_folder']
                            $(`#bg_image_url${saveElementID}`).html("")
                            $(`#bg_image_url${saveElementID}`).html(bg_image)
                            var global_bg_value = gRawData['subTabContent'][0]['global_bg_value']
                            $(`#global_bg${saveElementID}`).val(global_bg_value).trigger("change")
                            if(global_bg_value == "background_image"){
                              $('.global_bg_color').css("display","none")
                              $('.global_bg_image').css("display","block")
                                if(bg_image != "" || bg_image != undefined)
                            {
                              if ($(`#analysisTabContent${saveElementID}`).find('.chartDivSection').attr('data-layout') == "Landscape") {
                                  $(`#analysisTabContent${saveElementID}`).find('.chartDivSection').css("background-size",'1920px calc(100vw * 9/16)' )
                                  }
                              else if ($(`#analysisTabContent${saveElementID}`).find('.chartDivSection').attr('data-layout') == "Portrait") {
                                  $(`#analysisTabContent${saveElementID}`).find('.chartDivSection').css("background-size",'1080px calc(100vw * 16/9)' )
                                  }
                              else{
                                $(`#analysisTabContent${saveElementID}`).find('.chartDivSection').css("background-size",'100%' )
                              }

                              $.ajax({
                                  url: `/users/${urlPath}/reload_bg_image/`,

                                  data:{
                                      'folder_name': bg_folder,
                                      'filename': bg_image,
                                  },
                                  type: "POST",
                                  dataType: "json",
                                  success: function (data) {
                                      $(`.mainDiv`).css("background-image",'url(data:image/png;base64,' + data.image_url )
                                      $(`.mainDiv`).css("background-size",'56em 15em' )
                                      $(`#tabLinks`+analysisTabID).css("background-image",'url(data:image/png;base64,' + data.image_url )
                                      $(`#tabLinks`+analysisTabID).css("background-size",'56em 15em' )
                                      $(`#bg_image_url${saveElementID}`).html("")
                                      $(`#bg_image_url${saveElementID}`).html(data.image_url)
                                      $(`#bg_image_name${saveElementID}`).html("")
                                      $(`#bg_image_name${saveElementID}`).html(data.image_name)
                                      $(`#analysisTabContent${saveElementID}`).find('.chartDivSection').css("background-image",'url(data:image/png;base64,' + data.image_url )

                                  }
                              })
                              }
                              }
                              else{
                                $('.global_bg_color').css("display","block")
                              $('.global_bg_image').css("display","none")
                              $(`.mainDiv`).css("background-image",'none' )
                              }


                      fetchSlicerParams();
                      function fetchAnalysisSlicer(tabSlicerConfig, analysisTabID, tabNo) {

                          $.ajax({
                          url: `/users/${urlPath}/processGraphModule/`,
                          data: {
                              'tab_slicer_config': JSON.stringify(tabSlicerConfig),
                              'element_id': analysisTabID,
                              'tab_id': (tabNo),
                              'operation': 'saveAnalysisSlicerConfigL3',
                          },
                          type: "POST",
                          dataType: "json",
                          success: function (data) {
                              var analysisSlicerElementId = data.elementID;
                              var analysisSlicerTabId = data.slicer_tab_id;
                              $(`#tab${analysisSlicerElementId}${analysisSlicerTabId}`).find('.card-tools.tabCardTools').empty();
                              $(`#tab${analysisSlicerElementId}${analysisSlicerTabId}`).find('.card-tools.tabCardTools').append(`     <button type="button" value="AddComment" class="btn btn-primary commentButton btn-md" id="AddComment${analysisSlicerElementId}${analysisSlicerTabId}"  data-toggle="tooltip" title="Add comment" style="height: 25px;border-radius:5px;border-color:none;color:white;margin-top:10px; margin-bottom:10px"><i class='far fa-comment-dots' style="font-size:1rem;"></i></button>&nbsp;     <button type="button" value="PDF" class=" btn btn-primary" data-tabHeaderID="tabHeader${analysisSlicerElementId}${analysisSlicerTabId}" id='analysisPDF${analysisSlicerElementId}${analysisSlicerTabId}' style="height: 25px;border-radius:5px;border-color:none;color:white;padding-left:9px;padding-top:2px;  margin-right:5px;margin-top:10px; margin-bottom:10px"><i class="fa fa-file-pdf-o"></i>&nbsp;PDF</button>     <button type="button" value="slicerConfig" class="btn btn-primary" data-tabHeaderID="tabHeader${analysisSlicerElementId}${analysisSlicerTabId}" id='slicerConfig${analysisSlicerElementId}${analysisSlicerTabId}' data-toggle="modal" data-target="#slicerConfigModal${analysisSlicerElementId}${analysisSlicerTabId}" style="height: 25px;border-radius:5px;border-color:none;color:white;padding-left:9px;padding-top:2px; margin-right:10px; margin-top:10px; margin-bottom:10px"><i class="fas fa-filter"></i>&nbsp;Slicer</button><button type="button" value="gridLines" class="btn btn-primary" data-tabHeaderID="tabHeader${analysisSlicerElementId}${analysisSlicerTabId}" id='gridLines${analysisSlicerElementId}${analysisSlicerTabId}' style="height: 25px;border-radius:5px;border-color:none;color:white;padding-left:9px;padding-top:2px; margin-right:10px; margin-top:10px; margin-bottom:10px" onclick="gridLine.call(this)"><i class="fa fa-table"></i>&nbsp;Grid lines</button> `);

                              let tabSlicerConfigOutput = data[analysisSlicerTabId];
                              let analysis_additional_config = tabSlicerConfigOutput.analysis_additional_config;
                              if (analysis_additional_config == "slicer_config") {
                              let slicerTables = tabSlicerConfigOutput.slicerTable;
                              let slicerParameters = tabSlicerConfigOutput.slicerParameter;
                              let slicerParameterValues = tabSlicerConfigOutput.slicer_parameter_values;
                              let mapDict = tabSlicerConfigOutput.mappingDict
                              let slicerBooleans = tabSlicerConfigOutput.slicerBoolean;
                              let slicerReloadValue = tabSlicerConfigOutput.slicerReload;
                              let multipleSlicer = tabSlicerConfigOutput.multipleSlicer;
                              var html = '';
                              for(let i = 0; i < slicerParameterValues.length; i++) {
                                  let attr_ = 'data-value = ""'
                                  let multiple = "";
                                  if(slicerReloadValue != undefined){
                                    if (slicerReloadValue.length != 0) {
                                      attr_ = 'data-value' + `= '${JSON.stringify(slicerReloadValue[i])}'`
                                    }
                                  }
                                  if(multipleSlicer != undefined){
                                    if(multipleSlicer.length > 0){
                                      if(multipleSlicer[i]){
                                        multiple = "multiple";
                                      }
                                    }
                                  }
                                  html = html + `
                                  <div class="form-inline" style="margin-bottom:5px;text-align:left;">
                                  <span class="text-primary" margin-right:10px; margin-left:10px;">${mapDict[i][slicerParameters[i]]}:</span>
                                   <select class="selectSlicerConfig_${analysisSlicerElementId}${analysisSlicerTabId} select2 form-control slicerParamValue${analysisSlicerElementId}" data-tab="${analysisSlicerTabId}" data-slicertable="${slicerTables[i]}" data-slicerColumn= "${slicerParameters[i]}" ${attr_} data-id="selectSlicerConfig_${analysisSlicerElementId}${analysisSlicerTabId}" style="width:150px;display:inline-block;" ${multiple}>`
                                      if(slicerBooleans != undefined){
                                        if (slicerBooleans.length != 0) {
                                          if(slicerBooleans[i] == 'True'){
                                            html = html + `<option value="" selected>All</option>`
                                          }
                                        }
                                      }
                                  for(let slc_val = 0; slc_val < slicerParameterValues[i].length; slc_val++) {
                                    if(slicerParameterValues[i][slc_val] != ''){
                                      html = html + `<option value="${slicerParameterValues[i][slc_val]}">${slicerParameterValues[i][slc_val]}</option>`
                                    }
                                  }
                                  html = html +
                                  `</select>
                                  </div>
                                  `
                              }
                              $(`#tab${analysisSlicerElementId}${analysisSlicerTabId}`).find('.card-tools.tabCardTools').append(html);
                              $(`#tab${analysisSlicerElementId}${analysisSlicerTabId}`).find('.card-tools.tabCardTools').find('select').each(function(){
                                parent = $(this).parent()
                                $(this).select2({dropdownParent:parent})
                              })
                              $(`#tab${analysisSlicerElementId}${analysisSlicerTabId}`).find('.card-tools.tabCardTools').find('.select2').parent().find(".select2-container").css("max-height","55px");
                              $(`#tab${analysisSlicerElementId}${analysisSlicerTabId}`).find('.card-tools.tabCardTools').find('.select2').parent().find(".select2-container").css("overflow-y","scroll");
                              }
                                slicerChangeUpdatePlots();
                                $(`#analysisPDF${analysisSlicerElementId}${analysisSlicerTabId}`).click(async function(){
                                    function sleep(ms) {
                                        return new Promise(resolve => setTimeout(resolve, ms));
                                      }
                                        var buttonText = $(this).html()
                                        $(this).html(`<i class="fa fa-circle-notch fa-spin"></i> Loading`);
                                        $(this).parent().attr("data-html2canvas-ignore", true);
                                        $('.nav-tabs').attr("data-html2canvas-ignore", true);
                                        $(`#${$(this).parent().parent().next().attr('id')}`).css('border','none')
                                        var layout_old = $(`#${$(this).parent().parent().next().attr('id')}`).attr('data-layout')
                                        $('.tab-content').find('.tab-pane').find('.card-body').find('.tab-content').find('.tab-pane').find('.chartDivSection').find('.charts').find('.card-header').find('.row').find('i').css('display','none')
                                        $('body').css('pointer-events','none')
                                        $('body').css('background-color','black')
                                        $('body').css('opacity',0.5)
                                        $('body').css('overflow-y','hidden')
                                        $(document).scrollTop(0);
                                        await sleep(1000);
                                        page_section = $(`#${$(this).parent().parent().next().attr('id')}`).parent().parent().parent();
                                        HTML_Width = page_section.width();
                                        HTML_Height = page_section.height();
                                        top_left_margin = 5;
                                        PDF_Width = HTML_Width + (top_left_margin * 2);
                                        PDF_Height = (PDF_Width * 1.2) + (top_left_margin * 2);
                                        pdfName=$(`#${$(this).attr('data-tabHeaderID')}`).text()

                                        var wid = $(`#${$(this).parent().parent().next().attr('id')}`).parent().parent().parent()[0].offsetWidth
                                        var hei = $(`#${$(this).parent().parent().next().attr('id')}`).parent().parent().parent()[0].offsetHeight
                                        await html2canvas($(`#${$(this).parent().parent().next().attr('id')}`).parent().parent().parent()[0], { useCors: true, allowTaint: true }).then(function(canvas) {
                                          canvas_image_height= HTML_Height
                                          canvas_image_width=HTML_Width
                                          var imgData = canvas.toDataURL('image/png');
                                          var doc = new jsPDF("l","px",[wid,hei]);
                                          doc.addImage(imgData, 'PNG',0,0,doc.internal.pageSize.width, doc.internal.pageSize.height);
                                          doc.save(pdfName);
                                          $('.tab-content').find('.tab-pane').find('.card-body').find('.tab-content').find('.tab-pane').find('.chartDivSection').find('.charts').find('.card-header').find('.row').find('i').css('display','inline-block')
                                          $(`#${tabDict["pdfButtonID"]}`).html(`<i class="fa fa-file-pdf-o"></i>&nbsp;PDF`)
                                        });
                                        $(this).empty();
                                        $(this).html(buttonText);
                                        if(layout_old != "No layout") {
                                          $(`#${$(this).parent().parent().next().attr('id')}`).css('border',"solid black 0.1px")
                                        }
                                        $('.nav-tabs').removeAttr("data-html2canvas-ignore");
                                        $(this).parent().removeAttr("data-html2canvas-ignore");
                                        $('body').css('pointer-events','')
                                        $('body').css('background-color','')
                                        $('body').css('opacity','')
                                        $('body').css('overflow-y','')
                                  })
                                    $(`#AddComment${analysisSlicerElementId}${analysisSlicerTabId}`).click(function(){
                                      var id_ = ('analysisEditor' + Math.random()).replace('.',"");// $(this).attr('id').split('AddComment')[1];
                                      $(this).parent().parent().next().append(`
                                        <div class="small-box commentboxcard" data-id="${id_}" id = "${id_}" onmouseenter="showTool.call(this)" onmouseleave="hideTool.call(this)" style="min-height:6rem;min-width:6rem;height:6rem;width:9rem;" >
                                          <div class="row"  style="position:absolute; margin-left:100%; display:none;flex-wrap:wrap;">
                                            <i class="fa fa-times deleteCommentBox" title="Delete" style="font-size:1rem;margin-right:0.5rem;margin-left:1px;margin-bottom:2px;"></i>
                                            <i class='fas fa-edit' onclick="ckEditorFunc.call(this)" style="font-size:1rem;margin-right:0.5rem;margin-bottom:2px;"></i>
                                            <i class="fa fa-arrows" style="font-size:1rem;margin-right:0.5rem;"></i>
                                          </div>
                                          <div class="commentbox contentEditable" name="comment" style="margin-top:1rem;max-height: 75%;padding: 0.3em 0.5em 0 0.5em;background-color: transparent;text-align: left;overflow-y: auto;">

                                          </div>
                                        </div>`)
                                      $(".commentboxcard").resizable();
                                      $('.contentEditable').each(function () {
                                          $(this).on('click', function () {
                                            $(this).attr("contenteditable", "true")
                                            $(this).focus()
                                          })
                                          $(this).focusout(function () {
                                              var content = this.innerText
                                              content = content.trim()
                                              if (content.length == 0){
                                                this.innerText = "Enter text here."
                                                $(this).removeAttr("contenteditable");
                                                $(this).trigger("click")
                                              }
                                              else{
                                              $(this).removeAttr("contenteditable");
                                              }
                                          })
                                        })
                                      $('.deleteCommentBox').click(function () {
                                          $(this).parent().parent().remove()
                                      })
                                      $(".commentboxcard").draggable({
                                          cancel: '',
                                          containment: "parent",
                                      });
                                  })
                          },
                          error: function () {
                              Swal.fire({icon: 'error',text: 'Error! Failure in fetching the columns. Please try again.'});
                          }
                          });
                      }
                      fetchAnalysisSlicer(tabSlicerConfig, analysisTabID, tab_ID);

                    //   Updating slicer config
                      $(`#saveTabSlicerConfig${analysisTabID}${tab_ID}`).off('click').on('click', function(){
                          let anlysisElementId = $(this).attr('data-analysis_id');
                          let analysistabNo = $(this).attr('data-tab_id');
                          var analysisSlicerTabDict = {
                            "TabID":tab_ID,
                            "slicerTable":[],
                            "slicerParameter":[],
                            "slicerBoolean" :[],
                            "slicerReload":[],
                            "multipleSlicer":[]
                          }
                          $(`#slicerConfigCard${anlysisElementId}${analysistabNo}`).find('.card').find('.analysisSlicerTable').each(function() {
                              analysisSlicerTabDict["slicerTable"].push($(this).val());
                          });
                          $(`#slicerConfigCard${anlysisElementId}${analysistabNo}`).find('.card').find('.analysisSlicerParameter').each(function() {
                              analysisSlicerTabDict["slicerParameter"].push($(this).val());
                          });
                          $(`#slicerConfigCard${anlysisElementId}${analysistabNo}`).find('.card').find('.analysisSlicerParameter').each(function() {
                              analysisSlicerTabDict["slicerParameter"].push($(this).val());
                          });
                          $(`#slicerConfigCard${anlysisElementId}${analysistabNo}`).find('.card').find('.mulcheckbox').each(function() {
                              if ($(this).is(":checked")){
                                analysisSlicerTabDict["multipleSlicer"].push(true);
                              }else{
                                analysisSlicerTabDict["multipleSlicer"].push(false);
                              }
                          });
                          $(`#slicerConfigCard${anlysisElementId}${analysistabNo}`).find('.card').find('.analysisSlicerBoolean').each(function() {
                            if ($(this).is(":checked")){
                              analysisSlicerTabDict["slicerBoolean"].push("True")
                            }else {
                              analysisSlicerTabDict["slicerBoolean"].push("False")
                            }
                          });
                          fetchAnalysisSlicer(analysisSlicerTabDict, anlysisElementId, (analysistabNo));
                          slicerChangeUpdatePlots();
                      });

                      $(`#slicerConfigCard${analysisTabID}${tab_ID}`).empty()
                        for (let slicer=0; slicer < tabSlicerConfig.slicerTable.length; slicer++) {
                            addSlicers(analysisTabID, tab_ID);
                            $(`#slicerConfigCard${analysisTabID}${tab_ID}`).find('.card').eq(slicer).find(".analysisSlicerTable").empty()
                            for (var table of analysisTableNames) {
                                $(`#slicerConfigCard${analysisTabID}${tab_ID}`).find('.card').eq(slicer).find(".analysisSlicerTable").append(`<option value="${table}">${table}</option>`)
                            };
                            $(`#slicerConfigCard${analysisTabID}${tab_ID}`).find('.card').eq(slicer).find(".analysisSlicerTable").val(tabSlicerConfig.slicerTable[slicer]).trigger('select2:select');
                            $(`#slicerConfigCard${analysisTabID}${tab_ID}`).find('.card').eq(slicer).find(".analysisSlicerTable").val(tabSlicerConfig.slicerTable[slicer]).trigger('change');
                            if(tabSlicerConfig.slicerBoolean != undefined){
                              if (tabSlicerConfig.slicerBoolean.length > 0) {
                                $(`#slicerConfigCard${analysisTabID}${tab_ID}`).find('.card').eq(slicer).find(".analysisSlicerBoolean").prop("checked", tabSlicerConfig.slicerBoolean[slicer])
                              }
                            }
                            if(tabSlicerConfig.multipleSlicer != undefined && tabSlicerConfig.multipleSlicer.length > 0){
                              if( tabSlicerConfig.multipleSlicer[slicer] != undefined){
                                $(`#slicerConfigCard${analysisTabID}${tab_ID}`).find('.card').eq(slicer).find(".mulcheckbox").prop("checked", tabSlicerConfig.multipleSlicer[slicer])
                              }
                            }
                            if($(`#slicerConfigCard${analysisTabID}${tab_ID}`).find('.card').eq(slicer).find(".analysisSlicerParameter").attr('data-slicerParam') != undefined){
                              $(`#slicerConfigCard${analysisTabID}${tab_ID}`).find('.card').eq(slicer).find(".analysisSlicerParameter").attr('data-slicerParam').removeAttr(data-slicerParam)
                            }
                            $(`#slicerConfigCard${analysisTabID}${tab_ID}`).find('.card').eq(slicer).find(".analysisSlicerParameter").attr('data-slicerParam', tabSlicerConfig.slicerParameter[slicer])


                        }

                      $(`#${tabDict["chartDivContainer"]}`).append($(`<div class="hidden" style="height:${tabDict["chartDivContainerHeight"]+"px"}">`)); $(`#${tabDict["deleteButtonID"]}`).click(function(){
                        var tabAnchorID=$(this).attr('data-tabAnchorID')
                        var tabContainerDivID=$(this).attr('data-tabContainerDivID')
                        $(`#${tabAnchorID}`).parent().remove()
                        $(`#${tabContainerDivID}`).remove()
                      })


                      $('.contentEditable').each(function () {
                      $(this).on('click', function () {
                        $(this).attr("contenteditable", "true")
                        $(this).focus()
                      })
                      $(this).focusout(function () {
                        var tab_header = this.innerText
                        tab_header = tab_header.trim()
                        if (tab_header.length == 0){
                          this.innerText = "Set Name"
                          $(this).removeAttr("contenteditable");
                          $(this).addClass("bg-danger")
                          $(this).trigger("click")

                        }
                        else{
                        $(this).removeAttr("contenteditable");
                        $(this).removeClass("bg-danger")
                        }
                    })
                    })

                }

                const editables = document.getElementsByClassName('contentEditable tabname');
                  Array.from(editables).forEach(ele => {
                    ele.addEventListener("blur", (e) => {
                      updateIndex(ele.id, ele.textContent)
                    })
                });

                for(k in analysisData_Raw["subTabChartDetails"]){
                    var chartDict=analysisData_Raw["subTabChartDetails"][k]

                    var parentContainerID=chartDict["ParentContainerID"]
                    var chartJson=chartDict["chartJson"]
                    for(i in chartJson){
                        var filters = chartJson[i].filters
                        var filter_input_final = chartJson[i].filter_input_final
                        var plotType = chartJson[i].chartType;
                        if(plotType=="Textbox"){
                            if(!chartJson[i].hasOwnProperty('id_text_editor')) {
                            $(`#${parentContainerID}`).append(`<div class="small-box commentboxcard" data-id="${id_text_editor}" id = "${id_text_editor}" onmouseenter="showTool.call(this)" onmouseleave="hideTool.call(this)" style="position:absolute;min-height:6rem;min-width:6rem;height:${chartJson[i].height+"px"};width:${chartJson[i].width+"px"};top:${chartJson[i].position.top+"px"};left:${chartJson[i].position.left+"px"};">
                              <div class="row"  style="position:absolute; margin-left:100%; display:none;flex-wrap:wrap;">
                                <i class="fa fa-times deleteCommentBox" title="Delete" style="font-size:1rem;margin-right:0.5rem;margin-left:1px;margin-bottom:2px;"></i>
                                <i class='fas fa-edit' onclick="ckEditorFunc.call(this)" style="font-size:1rem;margin-right:0.5rem;margin-bottom:2px;"></i>
                                <i class="fa fa-arrows" style="font-size:1rem;margin-right:0.5rem;"></i>
                              </div>
                              <div class="commentbox contentEditable" name="comment" style="margin-top:1rem;max-height: 75%;padding: 0.3em 0.5em 0 0.5em;background-color: transparent;text-align: left;overflow-y: auto;">
                              ${chartJson[i].textboxvalue}
                              </div>
                            </div>`)
                          } else {
                            var id_text_editor =  chartJson[i].id_text_editor
                            $(`#${parentContainerID}`).append(`

                                <div class="small-box commentboxcard" onmouseenter="showTool.call(this)" onmouseleave="hideTool.call(this)" data-id="${id_text_editor}" id = "${id_text_editor}" style="position:absolute;min-height:6rem;min-width:6rem;height:${chartJson[i].height+"px"};width:${chartJson[i].width+"px"};top:${chartJson[i].position.top+"px"};left:${chartJson[i].position.left+"px"};">
                                  <div class="row"  style="position:absolute; margin-left:100%; display:none;flex-wrap:wrap;">
                                    <i class="fa fa-times deleteCommentBox" title="Delete" style="font-size:1rem;margin-right:0.5rem;margin-left:1px;margin-bottom:2px;"></i>
                                    <i class='fas fa-edit' onclick="ckEditorFunc.call(this)" style="font-size:1rem;margin-right:0.5rem;margin-bottom:2px;"></i>
                                    <i class="fa fa-arrows" style="font-size:1rem;margin-right:0.5rem;"></i>
                                  </div>
                                  <div class="commentbox contentEditable" name="comment" style="margin-top:1rem;max-height: 75%;padding: 0.3em 0.5em 0 0.5em;background-color: transparent;text-align: left;overflow-y: auto;">
                                  ${chartJson[i].textboxvalue}
                                  </div>
                                </div>`);
                            }
                            $(".commentboxcard").resizable();
                            $('.contentEditable').each(function () {
                                $(this).on('click', function () {
                                  $(this).attr("contenteditable", "true")
                                  $(this).focus()
                                })
                                $(this).focusout(function () {
                                    var content = this.innerText
                                    content = content.trim()
                                    if (content.length == 0){
                                      this.innerText = "Enter text here."
                                      $(this).removeAttr("contenteditable");
                                      $(this).trigger("click")
                                    }
                                    else{
                                    $(this).removeAttr("contenteditable");
                                    }
                                })
                              })
                                $(`#${parentContainerID}`).find('.deleteCommentBox').click(function () {
                                    $(this).parent().parent().remove()
                                })
                                $(`#${parentContainerID}`).find(".commentboxcard").draggable({
                                    cancel: '',
                                    containment: "parent",
                                });
                        }
                        else{
                            var tab_id = parentContainerID
                                      var height = chartJson[i].height;
                                      var width = chartJson[i].width;
                                      var position = chartJson[i].position;
                                      var config_gridlines = chartJson[i].config_gridlines;
                                      var layout = chartJson[i].layout;
                                      var graph_subtype = chartJson[i].graph_subtype;
                                      var chartDivId = chartJson[i].id;
                                      var graphdata = chartJson[i].data;
                                      var x_axis = chartJson[i].x_axis;
                                      var y_axis = chartJson[i].y_axis;

                                      var computed_number = chartJson[i].computed_number;
                                      var is_title = chartJson[i].is_title;
                                      var img_icon = chartJson[i].img_icon;
                                      var title_value = chartJson[i].title_value;
                                      var operation_n = chartJson[i].operation_n;
                                      var agg_distinct = chartJson[i].agg_distinct;

                                      var second_column = chartJson[i].second_column;
                                      var operation = chartJson[i].operation;
                                      var operation_line = chartJson[i].operation_line;
                                      var titlefontsize = chartJson[i].titlefontsize;
                                      var valuefontsize = chartJson[i].font_size;
                                      var chart_title = chartJson[i].chart_title;
                                      var data_value = chartJson[i].data_value;
                                      var config_valuesize = chartJson[i].config_valuesize;
                                      var config_titlesize = chartJson[i].config_titlesize;
                                      var config_data_value = chartJson[i].config_data_value;
                                      var backgroundcolor = chartJson[i].backgroundcolor;
                                      var changed_text = chartJson[i].changed_text;
                                      var chartheader = chartJson[i].chartheader;
                                      var filters=JSON.stringify(chartJson[i].filters);
                                      var line_column=chartJson[i].line_column;
                                      var tableName=chartJson[i].tableName;
                                      var config_color = chartJson[i].config_color;
                                      var config_labels = chartJson[i].config_labels;
                                      var config_xrange = chartJson[i].config_xrange;
                                      var config_yrange = chartJson[i].config_yrange;
                                      var config_x_axis_title = chartJson[i].config_x_axis_title;
                                      var legend_x = chartJson[i].legend_x;
                                      var legend_y = chartJson[i].legend_y;
                                      var config_label_placement = chartJson[i].config_label_placement;
                                      var config_y_axis_title = chartJson[i].config_y_axis_title;
                                      var config_element_color = chartJson[i].config_element_color;
                                      var element_label = chartJson[i].element_label;
                                      var slicerColumnId = tab_id.replace("analysisrow", "selectSlicerConfig_")
                                      var color = chartJson[i].color;
                                      var plot_bg_color = chartJson[i].plot_bg_color;
                                      var global_bg = chartJson[i].global_bg;
                                      var grad_color = chartJson[i].grad_color;
                                      var global_bgcolor = chartJson[i].global_bgcolor;
                                      var global_ind_color = chartJson[i].global_ind_color;
                                      var total_y = chartJson[i].total_y;
                                      var total_L = chartJson[i].total_L;
                                      var data_shadowon = chartJson[i].data_shadowon;
                                      var data_shadecolor = chartJson[i].data_shadecolor;
                                      var data_shadowX = chartJson[i].data_shadowX;
                                      var data_shadowY = chartJson[i].data_shadowY;
                                      var data_shadowblurry = chartJson[i].data_shadowblurry;
                                      var data_borderColor = chartJson[i].data_borderColor;
                                      var data_borderStyle = chartJson[i].data_borderStyle;
                                      var data_borderon = chartJson[i].data_borderon;
                                      var data_borderThickness = chartJson[i].data_borderThickness;
                                      var data_shadowThick = chartJson[i].data_shadowThick;
                                      var header_fontsize = chartJson[i].header_fontsize;
                                      var header_fontweight = chartJson[i].header_fontweight;
                                      var header_fontstyle = chartJson[i].header_fontstyle;
                                      var header_alignment = chartJson[i].header_alignment;
                                      var header_color = chartJson[i].header_color;
                                      var header_bgcolor = chartJson[i].header_bgcolor;
                                      var conditional_table = chartJson[i].conditional_table;
                                      var slicerColumnId = tab_id.replace("analysisrow", "selectSlicerConfig_")
                                      var slicerColumnValue = []
                                      var slicerColumn = []



                                    for (let i = 0; i < $(`.${slicerColumnId}`).length; i++) {
                                        slicerColumnValue.push($(`.${slicerColumnId}`).eq(i).val());
                                        slicerColumn.push($(`.${slicerColumnId}`).eq(i).attr("data-slicerColumn"))
                                    }

                                     var plotDict = {'is_title':is_title,'title_value':title_value,"conditional_table":conditional_table, "img_icon" : img_icon ,"header_alignment":header_alignment,"header_fontstyle":header_fontstyle,"header_fontsize":header_fontsize,"header_fontweight":header_fontweight, "header_color":header_color,"header_bgcolor":header_bgcolor,"data_shadowon":data_shadowon, "data_shadecolor":data_shadecolor, "data_shadowX":data_shadowX, "data_shadowY":data_shadowY, "data_shadowblurry":data_shadowblurry, "data_shadowThick":data_shadowThick, "data_borderColor":data_borderColor, "data_borderStyle":data_borderStyle, "data_borderon":data_borderon, "data_borderThickness":data_borderThickness,'total_y':total_y, 'total_L':total_L,'color':color,'plot_bg_color':plot_bg_color,'global_bg':global_bg,'grad_color':grad_color,'global_bgcolor':global_bgcolor,'global_ind_color':global_ind_color,"element_label":element_label,"config_element_color":config_element_color,"config_data_value":config_data_value,"config_valuesize":config_valuesize,"config_titlesize":config_titlesize, "config_label_placement":config_label_placement,"legend_x":legend_x,"legend_y":legend_y,'computed_number':computed_number,'operation_n':operation_n,"agg_distinct":agg_distinct, "operation": operation, "operation_line": operation_line,"tableName":tableName, "filters":filters,"line_column":line_column,"chartheader": chartheader, "chart_title": chart_title,"data_value":data_value, "x_axis": x_axis, "y_axis": y_axis, "second_column": second_column,  'graph_subtype': graph_subtype, 'tab_id': tab_id, 'height': height, 'width': width, 'data': graphdata, 'layout': layout, 'chartDivId': chartDivId, "position": position, "backgroundcolor": backgroundcolor, "titlefontsize": titlefontsize, "valuefontsize": valuefontsize,"titlefontsize": titlefontsize, "config_color":config_color,"config_xrange":config_xrange,"config_yrange":config_yrange,"config_gridlines":config_gridlines,"config_labels":config_labels,"config_x_axis_title":config_x_axis_title,"config_y_axis_title":config_y_axis_title,"changed_text": changed_text,"filters":filters,'filter_input_final': JSON.stringify(filter_input_final),}
                                    plotFunction(plotDict, slicerColumn="", slicerColumnValue="", slicerColumnId=slicerColumnId,existingDivId=chartDivId)

                                    slicerChangeUpdatePlots();
                        }

                    }
                }
                var i = 1
                setTimeout(() => {
                    $('.chartDivSection').find('.charts').each(function() {
                        var idPlot = $(this).attr('id').split('card')[0]
                        if(interaction.length > 0) {
                            if(interaction[i-1]) {
                                $('#'+idPlot+'interaction').attr('checked','checked')
                            } else {
                                $('#'+idPlot+'interaction').prop('checked',false)
                            }
                        } else {
                            $('#'+idPlot+'interaction').attr('checked','checked')
                        }
                        i = i + 1;
                    })

                },5000)
                if (Object.keys(analysisData_Raw).includes('slicerTabConnectDict')) {
                    slicerTabConnectDict = analysisData_Raw['slicerTabConnectDict'];
                }
                $(`#analysisDashboard${analysisTabID} .nav-tabs a`).first().tab('show')
                $(`#analysisDashboard${saveElementID} .nav-tabs a`).first().tab('show');
              }
              });


            }, error: () => {

            }
          })
        
        var analysisDataRaw;
        var analysisTabConfigDataRaw = {};
        </script>

        <script>

         chartSaveEleId = 'ellipse08589847718203074';
          if(!analysiselementIDList.includes('ellipse08589847718203074')){
              analysiselementIDList.push("ellipse08589847718203074");
          }
          </script>
          <script>
            $("#drilldownmodal").find('.modal-body').find('.nav-item>a').on("click",function(){
              $("#myTabContentJust").find('.tab-pane').css('display', 'none');
              let tabPane = $(this).attr('href');
              $(tabPane).css('display', 'block');
            });
          </script>
        
          <script>
          $('.span_content_editable').each(function () {
          $(this).on('click', function () {
            $(this).attr('data-currentName', $(this).text());
          $(this).attr("contenteditable", "true")
          $(this).focus()
          })
          $(this).focusout(function () {
          var tab_header = this.innerText
          tab_header = tab_header.trim()
          if (tab_header.length == 0){
              this.innerText = "Set Name"
              $(this).removeAttr("contenteditable");
              $(this).addClass("bg-danger")
              $(this).trigger("click")

          }
          else{
          $(this).removeAttr("contenteditable");
          $(this).removeClass("bg-danger")
          if (tab_header != $(this).attr('data-currentName')) {
            $(this).removeAttr("data-currentName");
            $.ajax({
                url: `/users/${urlPath}/ajax/tabConfig/`,

                data: {
                'operation': "update_tab_header_name_populate",
                'id': $(this).parent().parent().attr('data-tab_pk'),
                'user_name':'{{ user.get_username }}',
                'tab_header_name': tab_header,

                },
                type: "POST",
                dataType: "json",
                success: function (data) {


                },
                error: function () {
                Swal.fire({icon: 'error',text: 'Error! Please try again.'});
                }
            });
          }
          }

          })
      })
      var populateTabFuctionalities = function() {
      var tab_data = JSON.parse($(this).attr('data-data_list'));
      var tab_data_ordered = {};
      var count = 0;
      for(let [key,value] of Object.entries(tab_data)) {
        count++;
        for(let [key1,value1] of Object.entries(tab_data)) {
          if(count == parseInt(value1["order"])) {
            tab_data_ordered[key1] = {}
            tab_data_ordered[key1]["order"] = count
            tab_data_ordered[key1]["show"] = value1["show"]
          }
        }
      };
      $('#tabsMultiFuncBodyTable').find('tbody').empty();

      html_tab = ''
      id_gen = 0
      for(let [key,value] of Object.entries(tab_data_ordered)) {
        id_gen++
        html_tab = html_tab + `<tr style="text-align:center;background:#f3f3f3;cursor: move;" data-element_id='${key}'>`
        html_tab = html_tab +`<td minimum=1 maximum='${count}' data-value="${value["order"]}"><span class="ui-icon ui-icon-arrowthick-2-n-s mt-1" data-toggle="tooltip" title="Drag Up/ Down to reorder"></span></td>`
        if(value["show"] == "1") {
          html_tab = html_tab + `
          <td>
            <div class="d-flex">
              <div class="switch-container">
                <input class="float-right switch" type="checkbox" id="input${id_gen}" style="margin-right: 20rem;" name="input${id_gen}" value="input${id_gen}" checked>
                <div class="switch-color"><label class="trigger-label" for="input${id_gen}"></label></div>
                <label class="switch-label" for="input${id_gen}"></label>
              </div>
            </div>
          </td>`
        } else {
          html_tab = html_tab + `
          <td>
            <div class="d-flex">
              <div class="switch-container">
                <input class="float-right switch" type="checkbox" id="input${id_gen}" style="margin-right: 20rem;" name="input${id_gen}" value="input${id_gen}">
                <div class="switch-color"><label class="trigger-label" for="input${id_gen}"></label></div>
                <label class="switch-label" for="input${id_gen}"></label>
              </div>
            </div>
          </td>`
        }
        html_tab = html_tab + `<td><span class="tab_name_config" style="word-break:break-word;white-space:break-spaces;text-align:left;display:block;margin-left:10px;">${$('#'+key+'-tab').text()}</span></td></tr>`


      }
      $('#tabsMultiFuncBodyTable').find('tbody').append(html_tab)

      $("#tabsMultiFuncBodyTable tbody").disableSelection();

      $("#tabsMultiFuncBodyTable tbody").sortable({
        axis: "y",
        containment: "parent",
        cursor: "grabbing",
        handle: "td",
        helper: "original",
        opacity: 0.6,
        update: function(event, ui) {
          var sortedItems = $(this).find("tr");
          sortedItems.each(function(index) {
            $(this).find('td').eq(0).attr("data-value",index + 1);
          });
        },
      });

      $("#tabsMultiFuncBodyTable tbody tr").draggable({
        connectToSortable: "#tabsMultiFuncBodyTable tbody",
        helper: "original",
        revert: "invalid"
      }).draggable("enable");

    }
    var validation = function() {
      if(parseInt($(this).val()) < 1) {
        $(this).val(1).trigger('change')
      }
      if(parseInt($(this).val()) > parseInt($(this).attr('maximum'))) {
        $(this).val(parseInt($(this).attr('maximum'))).trigger('change')
      }
    }
    var saveTabsFunc = function() {
      $('#tabsMultiFunc').find('.modal-footer').find('button').html(`<i class="fa fa-circle-notch fa-spin"></i>`)
      var order_data = {}
      var validation = 0
      var len = $('#tabsMultiFuncBodyTable').find('tbody').find('tr').length;
      for(let j = 0; j < len; j++) {
        validation = 0
        var dummy = parseInt($('#tabsMultiFuncBodyTable').find('tbody').find('tr').eq(j).find('td').eq(0).attr('data-value'));
        for(let i = 0; i < len; i++) {
          var dummy1 = parseInt($('#tabsMultiFuncBodyTable').find('tbody').find('tr').eq(i).find('td').eq(0).attr('data-value'))
          if (dummy == dummy1) {
            validation = validation + 1;
            if(validation > 1) {
              break;
            }
          }
        }
        if(validation > 1) {
          break;
        }
        if(!dummy){
          validation = 2;
          break;
        }
      }
      if(validation < 2) {
        $('#tabsMultiFuncBodyTable').find('tbody').find('tr').each(function() {
          var ele_ids = $(this).attr('data-element_id')
          var show
          if ($(this).find('td').eq(1).find('input').prop('checked')){
            show = "1"
          } else {
            show = "0"
          }
          order_data[ele_ids] = {'tab_name':$(this).find('td').eq(2).text(),
              'data': {
                'order': String($(this).find('td').eq(0).attr('data-value')),
                'show': show
              }
          }
        });
        $.ajax({
        url: `/users/${urlPath}/processGraphModule/`,
        data: {
            'operation': 'saveTabOrder',
            'order_data': JSON.stringify(order_data),
            'pr_code':windowLocation.split('/')[4],
          },
          type: "POST",
          dataType:"json",
          success:function(data){
            $('#tabsMultiFunc').find('.modal-footer').html(`<button onclick="saveTabsFunc.call(this)" type="button" class="btn btn-primary">Save</button>`)
            window.location.reload();
          },
          error: function () {
            $('#tabsMultiFunc').find('.modal-footer').html(`<button onclick="saveTabsFunc.call(this)" type="button" class="btn btn-primary">Save</button>`)
            Swal.fire({icon: 'error',text: 'Error! Please try again.'});
          }
        })
      } else {
        $('#tabsMultiFunc').find('.modal-footer').html(`<button onclick="saveTabsFunc.call(this)" type="button" class="btn btn-primary">Save</button>`)
        Swal.fire({icon: 'warning',text: 'Order cannot be left blank or cannot be the same.'});
      }

    }
      </script>
          
        <script src="{% static 'js/Kore_TI_js/plot_charts/plotly_chartsAnalysisUtilites.min.js' %}"></script>
        <script src="{% static 'js/Kore_TI_js/plot_charts/plotly_chartsAnalysis_modal.min.js' %}"></script>
        <script src="{% static 'js/Kore_TI_js/plot_charts/plotly_chartsAnalysis.min.js' %}"></script>
        <script defer>masterPlotly(analysiselementIDList)</script>
        