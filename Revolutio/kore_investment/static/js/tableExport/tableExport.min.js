!function($){$.fn.extend({tableExport:function(options){var defaults={separator:",",ignoreColumn:[],tableName:"yourTableName",type:"csv",pdfFontSize:14,pdfLeftMargin:20,escape:"true",htmlContent:"false",consoleLog:"false"},options=$.extend(defaults,options),el=this;if("csv"==defaults.type||"txt"==defaults.type){var tdData="";$(el).find("thead").find("tr").each((function(){tdData+="\n",$(this).filter(":visible").find("th").each((function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&(tdData+='"'+parseString($(this))+'"'+defaults.separator)})),tdData=$.trim(tdData),tdData=$.trim(tdData).substring(0,tdData.length-1)})),$(el).find("tbody").find("tr").each((function(){tdData+="\n",$(this).filter(":visible").find("td").each((function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&(tdData+='"'+parseString($(this))+'"'+defaults.separator)})),tdData=$.trim(tdData).substring(0,tdData.length-1)})),"true"==defaults.consoleLog&&console.log(tdData);var base64data="base64,"+$.base64.encode(tdData);window.open("data:application/"+defaults.type+";filename=exportData;"+base64data)}else if("sql"==defaults.type){var tdData="INSERT INTO `"+defaults.tableName+"` (";$(el).find("thead").find("tr").each((function(){$(this).filter(":visible").find("th").each((function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&(tdData+="`"+parseString($(this))+"`,")})),tdData=$.trim(tdData),tdData=$.trim(tdData).substring(0,tdData.length-1)})),tdData+=") VALUES ",$(el).find("tbody").find("tr").each((function(){tdData+="(",$(this).filter(":visible").find("td").each((function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&(tdData+='"'+parseString($(this))+'",')})),tdData=$.trim(tdData).substring(0,tdData.length-1),tdData+="),"})),tdData=$.trim(tdData).substring(0,tdData.length-1),tdData+=";","true"==defaults.consoleLog&&console.log(tdData);var base64data="base64,"+$.base64.encode(tdData);window.open("data:application/sql;filename=exportData;"+base64data)}else if("json"==defaults.type){var jsonHeaderArray=[];$(el).find("thead").find("tr").each((function(){var tdData="",jsonArrayTd=[];$(this).filter(":visible").find("th").each((function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&jsonArrayTd.push(parseString($(this)))})),jsonHeaderArray.push(jsonArrayTd)}));var jsonArray=[];$(el).find("tbody").find("tr").each((function(){var tdData="",jsonArrayTd=[];$(this).filter(":visible").find("td").each((function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&jsonArrayTd.push(parseString($(this)))})),jsonArray.push(jsonArrayTd)}));var jsonExportArray=[];jsonExportArray.push({header:jsonHeaderArray,data:jsonArray}),"true"==defaults.consoleLog&&console.log(JSON.stringify(jsonExportArray));var base64data="base64,"+$.base64.encode(JSON.stringify(jsonExportArray));window.open("data:application/json;filename=exportData;"+base64data)}else if("xml"==defaults.type){var xml='<?xml version="1.0" encoding="utf-8"?>';xml+="<tabledata><fields>",$(el).find("thead").find("tr").each((function(){$(this).filter(":visible").find("th").each((function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&(xml+="<field>"+parseString($(this))+"</field>")}))})),xml+="</fields><data>";var rowCount=1;$(el).find("tbody").find("tr").each((function(){xml+='<row id="'+rowCount+'">';var colCount=0;$(this).filter(":visible").find("td").each((function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&(xml+="<column-"+colCount+">"+parseString($(this))+"</column-"+colCount+">"),colCount++})),rowCount++,xml+="</row>"})),xml+="</data></tabledata>","true"==defaults.consoleLog&&console.log(xml);var base64data="base64,"+$.base64.encode(xml);window.open("data:application/xml;filename=exportData;"+base64data)}else if("excel"==defaults.type||"doc"==defaults.type||"powerpoint"==defaults.type){var excel="<table>";$(el).find("thead").find("tr").each((function(){excel+="<tr>",$(this).filter(":visible").find("th").each((function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&(excel+="<td>"+parseString($(this))+"</td>")})),excel+="</tr>"}));var rowCount=1;$(el).find("tbody").find("tr").each((function(){excel+="<tr>";var colCount=0;$(this).filter(":visible").find("td").each((function(index,data){"none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)&&(excel+="<td>"+parseString($(this))+"</td>"),colCount++})),rowCount++,excel+="</tr>"})),excel+="</table>","true"==defaults.consoleLog&&console.log(excel);var excelFile="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:"+defaults.type+"' xmlns='http://www.w3.org/TR/REC-html40'>";excelFile+="<head>",excelFile+="\x3c!--[if gte mso 9]>",excelFile+="<xml>",excelFile+="<x:ExcelWorkbook>",excelFile+="<x:ExcelWorksheets>",excelFile+="<x:ExcelWorksheet>",excelFile+="<x:Name>",excelFile+="{worksheet}",excelFile+="</x:Name>",excelFile+="<x:WorksheetOptions>",excelFile+="<x:DisplayGridlines/>",excelFile+="</x:WorksheetOptions>",excelFile+="</x:ExcelWorksheet>",excelFile+="</x:ExcelWorksheets>",excelFile+="</x:ExcelWorkbook>",excelFile+="</xml>",excelFile+="<![endif]--\x3e",excelFile+="</head>",excelFile+="<body>",excelFile+=excel,excelFile+="</body>",excelFile+="</html>";var base64data="base64,"+$.base64.encode(excelFile);window.open("data:application/vnd.ms-"+defaults.type+";filename=exportData.doc;"+base64data)}else if("png"==defaults.type)html2canvas($(el),{onrendered:function(canvas){var img=canvas.toDataURL("image/png");window.open(img)}});else if("pdf"==defaults.type){var doc=new jsPDF("p","pt","a4",!0);doc.setFontSize(defaults.pdfFontSize);var startColPosition=defaults.pdfLeftMargin;$(el).find("thead").find("tr").each((function(){$(this).filter(":visible").find("th").each((function(index,data){if("none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)){var colPosition=startColPosition+50*index;doc.text(colPosition,20,parseString($(this)))}}))}));var startRowPosition=20,page=1,rowPosition=0;$(el).find("tbody").find("tr").each((function(index,data){rowCalc=index+1,rowCalc%26==0&&(doc.addPage(),page++,startRowPosition+=10),rowPosition=startRowPosition+10*rowCalc-280*(page-1),$(this).filter(":visible").find("td").each((function(index,data){if("none"!=$(this).css("display")&&-1==defaults.ignoreColumn.indexOf(index)){var colPosition=startColPosition+50*index;doc.text(colPosition,rowPosition,parseString($(this)))}}))})),doc.output("datauri")}function parseString(data){return"true"==defaults.htmlContent?content_data=data.html().trim():content_data=data.text().trim(),"true"==defaults.escape&&(content_data=escape(content_data)),content_data}}})}(jQuery);