var NaN="";for(let i=0;i<createViewIdList.length;i++){const submitButtonCreateForm=$(`#${createViewIdList[i]}_tab_content`).find('form button[name="submit"]');submitButtonCreateForm.on("click",(function(){let idEle=$(this).attr("id").split("whiteSpacewrap")[1];idEle="whiteSpacewrap"+idEle;const connectedListviewId=$(this).attr("connected_listview_id");if(connectedListviewId){const linkedListview=$(this).attr("connected_listview_id");localStorage.setItem("activeTabs",linkedListview)}else localStorage.setItem("activeTabs",createViewIdList[i]);const type=$(this).val();let currentUrl=window.location.pathname;if(item_code_list)for(let j=0;j<item_code_list.length;j++)currentUrl="/users/"+item_code_list[j][idEle]+"/";let pr_code=$(this).parent().parent().find('input[name="pr_code"]').attr("value");if(window.location.pathname.includes("homePage")){let windowLocation1=window.location.pathname,f_occ1=windowLocation1.indexOf("/",windowLocation1.indexOf("/")+1),s_occ1=windowLocation1.indexOf("/",windowLocation1.indexOf("/")+f_occ1+1),t_occ1=windowLocation1.indexOf("/",windowLocation1.indexOf("/")+s_occ1+1),app_code2_=windowLocation1.substring(f_occ1+1,s_occ1),current_dev_mode2_=windowLocation1.substring(s_occ1+1,t_occ1);"Build"!=current_dev_mode2_&&"Edit"!=current_dev_mode2_&&(current_dev_mode2_="User"),currentUrl=`/users/${app_code2_}/${current_dev_mode2_}/${pr_code}/`}const submitFormUrl=currentUrl+"create/",submitFormDraftUrl=currentUrl+"createDraft/";if("Save"===String(type)){$(this).attr("formaction",submitFormUrl);const approvalAssignmentConfig=$(`#${createViewIdList[i]}_tab_content`).find('form input[name="approvalAssignmentConfig"]');if(approvalAssignmentConfig.length>0){const approvalAssignmentConfigValue=approvalAssignmentConfig.val(),approvalAssignmentConfigJSON=JSON.parse(approvalAssignmentConfigValue);if(0===Object.keys(approvalAssignmentConfigJSON).length&&approvalAssignmentConfigJSON.constructor===Object)return Swal.fire({icon:"warning",text:"Approver details have not been added."}),!1}let jsvalidation_createview_config=$(this).attr("data-jsvalidation_createview_config");if(0!=jsvalidation_createview_config.length){if(jsvalidation_createview_config=JSON.parse(jsvalidation_createview_config),val=jsValidationScenario(jsvalidation_createview_config,$(this),createViewIdList[i],pr_code),!val)return Swal.fire({icon:"warning",text:jsvalidation_createview_config.val_message}),val;var isValid=!0;$(`#createview${idEle} [required]`).each((function(){if(""===$(this).val().trim())return isValid=!1,!1})),isValid&&($(`#creation_in_progress_${idEle}`).modal("show"),$(this).closest("body").css("pointer-events","none"))}else jsvalidation_createview_config=[];setTimeout("",5e4)}else"Save as Draft"===String(type)&&$(this).attr("formaction",submitFormDraftUrl);$(this).attr("type","submit")}))}function fetchDataFromMaster(data,itemCode,callback){$.ajax({url:`/users/${urlPath}/${itemCode}/`,async:!1,data:data,type:"POST",dataType:"json",success:function(data){callback(data.data)},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function jsValidationScenario(config,This,elementId,pr_code){let condition_list=[],constraint_dict={},current_ans=-1,previous_ans=-1,previous_ruleset=-1;config=0!=config.length?config.config:[];const itemCode=pr_code;let dtype_dict=JSON.parse($(This).attr("data-dtype"));for(let i=0;i<config.length;i++)config[i].constraint_name in constraint_dict?constraint_dict[config[i].constraint_name].push(config[i]):constraint_dict[config[i].constraint_name]=[config[i]];constraint_dict_copy=constraint_dict;for(let[constraint,configs]of Object.entries(constraint_dict_copy)){ruleset_dict={};for(let i=0;i<configs.length;i++)configs[i].rule_set in ruleset_dict?ruleset_dict[configs[i].rule_set].push(configs[i]):ruleset_dict[configs[i].rule_set]=[configs[i]];constraint_dict[constraint]=ruleset_dict}for(let[constraint,ruleset_configs]of Object.entries(constraint_dict)){temp_test=[];for(let[ruleSet,configs]of Object.entries(ruleset_configs)){previous_ans=-1,previous_ruleset=-1;for(let i=0;i<configs.length;i++){let datatype=dtype_dict[configs[i].column_name];if("static"==configs[i].jstype||"master_based"==configs[i].jstype||"master_field"==configs[i].jstype||"field_based"==configs[i].jstype){if("master_based"==configs[i].jstype)data={operation:"get_master_based_value",config:JSON.stringify(configs[i])},fetchDataFromMaster(data,itemCode,(function(result){value_to_compare=result}));else if("master_field"==configs[i].jstype){input_dic={},value_to_compare="",inner_config=configs[i].filter_config.config;for(let i=0;i<inner_config.length;i++)input_dic[inner_config[i].input_value]=$(`#id_${inner_config[i].input_value}_${elementId}`).val();data={operation:"get_master_field_value",input_value_dic:JSON.stringify(input_dic),config:JSON.stringify(configs[i].filter_config),table:configs[i].table_name,columnname:configs[i].columnname},fetchDataFromMaster(data,itemCode,(function(result){value_to_compare=result}))}else"field_based"==configs[i].jstype?value_to_compare=$(`#id_${configs[i].input_value}_${elementId}`).val():value_to_compare=configs[i].input_value;"IntegerField"==datatype||"BigIntegerField"==datatype?value_to_compare.constructor===Array?value_to_compare=value_to_compare.map((function(x){return parseInt(x)})):value_to_compare=parseInt(value_to_compare):"FloatField"==datatype&&(value_to_compare.constructor===Array?value_to_compare=value_to_compare.map((function(x){return parseFloat(x)})):value_to_compare=parseFloat(value_to_compare))}else if("dynamic"==configs[i].jstype){if(value_to_compare=configs[i].input_value,"curr_date"==value_to_compare){var today=new Date,dd=String(today.getDate()).padStart(2,"0"),mm=String(today.getMonth()+1).padStart(2,"0"),yyyy=today.getFullYear();value_to_compare=yyyy+"-"+mm+"-"+dd}if("curr_user"==value_to_compare){let curr_user=$(This).attr("data-curr_user");value_to_compare=curr_user}}column_value=$(`#id_${configs[i].column_name}_${elementId}`).val(),"IntegerField"==datatype||"BigIntegerField"==datatype?column_value.constructor===Array?column_value=column_value.map((function(x){return parseInt(x)})):column_value=parseInt(column_value):"FloatField"==datatype?column_value.constructor===Array?column_value=column_value.map((function(x){return parseFloat(x)})):column_value=parseFloat(column_value):"MultiselectField"==datatype&&(column_value=[],$(`#${elementId}_${configs[i].column_name}_unique option:selected`).each((function(){column_value.push($(this).text())}))),condition=configs[i].condition,rule_set=configs[i].rule_set,"IN"==condition?(value_to_compare.constructor!==Array&&(value_to_compare=[value_to_compare]),current_ans=column_value.constructor===Array?column_value.some(v=>value_to_compare.includes(v)):!!value_to_compare.includes(column_value)):"NOT IN"==condition?(value_to_compare.constructor!==Array&&(value_to_compare=[value_to_compare]),current_ans=column_value.constructor===Array?!column_value.some(v=>value_to_compare.includes(v)):!value_to_compare.includes(column_value)):"Equal to"==condition?(value_to_compare.constructor===Array&&(value_to_compare=value_to_compare[0]),current_ans=column_value.constructor===Array?column_value.includes(value_to_compare):value_to_compare==column_value):"Not Equal to"==condition?(value_to_compare.constructor===Array&&(value_to_compare=value_to_compare[0]),current_ans=column_value.constructor===Array?!column_value.includes(value_to_compare):value_to_compare!=column_value):"Starts with"==condition?(value_to_compare.constructor===Array&&(value_to_compare=value_to_compare[0]),current_ans=!!column_value.startsWith(value_to_compare)):"Not Starts with"==condition?(value_to_compare.constructor===Array&&(value_to_compare=value_to_compare[0]),current_ans=!column_value.startsWith(value_to_compare)):"Ends with"==condition?(value_to_compare.constructor===Array&&(value_to_compare=value_to_compare[0]),current_ans=!!column_value.endsWith(value_to_compare)):"Not Ends with"==condition?(value_to_compare.constructor===Array&&(value_to_compare=value_to_compare[0]),current_ans=!column_value.endsWith(value_to_compare)):"Contains"==condition?(value_to_compare.constructor===Array&&(value_to_compare=value_to_compare[0]),current_ans=!!column_value.includes(value_to_compare)):"Not Contains"==condition?(value_to_compare.constructor===Array&&(value_to_compare=value_to_compare[0]),current_ans=!!column_value.includes(value_to_compare)):"Greater than"==condition?(value_to_compare.constructor===Array&&(value_to_compare=value_to_compare[0]),current_ans=column_value>value_to_compare):"Greater than equal to"==condition?(value_to_compare.constructor===Array&&(value_to_compare=value_to_compare[0]),current_ans=column_value>=value_to_compare):"Smaller than"==condition?(value_to_compare.constructor===Array&&(value_to_compare=value_to_compare[0]),current_ans=column_value<value_to_compare):"Smaller than equal to"==condition&&(value_to_compare.constructor===Array&&(value_to_compare=value_to_compare[0]),current_ans=column_value<=value_to_compare),-1!=previous_ans&&-1!=previous_ruleset?(current_ans=previous_ruleset==rule_set?current_ans&&previous_ans:current_ans||previous_ans,previous_ruleset=rule_set,previous_ans=current_ans):(previous_ans=current_ans,previous_ruleset=rule_set)}temp_test.push(current_ans)}condition_list.push(temp_test.some(Boolean))}return condition_list.every(Boolean)}function checkRequired_save(){id=$(this).attr("id").replace("savebutton_",""),minCols=$(this).attr("data_min_fields"),minNoCols=parseInt($(this).attr("data_min_no")),flag=0,null!=minCols?(minCols=JSON.parse(minCols),minCols.includes(-1)&&(minCols=[])):minCols=[];let minCount=0,inpReq="";inpReq=minCols.length>0?$(`#createview${id}`).find(".restict_min_class").filter(":visible"):$(`#createview${id}`).find("input,textarea,select").filter(":visible");let colsfire=[];if(minCols.length>0){for(let i=0;i<inpReq.length;i++){let rqVal=$(inpReq[i]).val(),col=$(inpReq[i]).attr("data-field_name");if(""==rqVal||null==rqVal){if(minCols.includes(String(col))){if(minCount>=minNoCols){flag=0;break}flag=1,colsfire.push(col),$("#savebutton_"+id).prop("disabled",!1)}}else minCount+=1}minCount>=minNoCols?flag=0:Swal.fire({icon:"warning",text:`Kindly fill in the value for atleast ${minNoCols} fields out of ${minCols.join()} columns !!`})}else{for(let i=0;i<inpReq.length;i++){let rqVal=$(inpReq[i]).val();if(""==rqVal||null==rqVal){if(minCount>=minNoCols){flag=0;break}flag=1,$("#savebutton_"+id).prop("disabled",!1)}else minCount+=1}minCount>=minNoCols?flag=0:Swal.fire({icon:"warning",text:`Kindly fill in the values for atleast ${minNoCols} fields !!`})}if(0==flag){const type=$(`#savebutton_${id}`).val();let currentUrl=window.location.pathname;currentUrl.includes(`#carouselExampleIndicators${id}`)&&(currentUrl=currentUrl.replace(`#carouselExampleIndicators${id}`,""));let idEle=$(`#savebutton_${id}`).attr("id").split("whiteSpacewrap")[1];if(idEle="whiteSpacewrap"+idEle,item_code_list)for(let j=0;j<item_code_list.length;j++)currentUrl="/users/"+item_code_list[j][idEle]+"/";const submitFormUrl=currentUrl+"create/",submitFormDraftUrl=currentUrl+"createDraft/";"Save"===String(type)?$(`#savebutton_${id}`).attr("formaction",submitFormUrl):"Save as Draft"===String(type)&&$(`#savebutton_${id}`).attr("formaction",submitFormDraftUrl),$("#savebutton_"+id).attr("type","submit"),$("#savebutton_"+id).attr("name","submit"),$("#savebutton_"+id).removeAttr("onclick"),$(`#savebutton_${id}`).click()}}let saveFileButtonCreateForm="";for(let i=0;i<createViewIdList.length;i++){saveFileButtonCreateForm=$(`#savefiledata_${createViewIdList[i]}`),saveFileButtonCreateForm.attr("disabled",!0);let input=$(`#uploadFileInput_${createViewIdList[i]}`);$(`#uploadCSVBtn_${createViewIdList[i]}`).on("click",(function(e){e.preventDefault(),localStorage.setItem("activeTabs",createViewIdList[i]);const dataForm=new FormData($(`#uploadCSVForm_${createViewIdList[i]}`)[0]);$(document).find(`#comparable_file_card_${createViewIdList[i]}`).removeAttr("hidden"),$(document).find(`#comparable_card_${createViewIdList[i]}`).attr("hidden","hidden"),$.ajax({url:`/users/${urlPath}/comparable_get_data/`,data:dataForm,type:"POST",cache:!1,contentType:!1,processData:!1,success:function(data){$.fn.dataTable.isDataTable(`#comparable_file_table_${createViewIdList[i]}`)&&$(`#comparable_file_table_${createViewIdList[i]}`).DataTable().clear().destroy(),$(`#comparable_file_table_body_${createViewIdList[i]}`).empty(),$(`#comparable_file_table_head_${createViewIdList[i]}`).empty();const data1=JSON.parse(data);let html="";for(const[columnName,colVal]of Object.entries(data1[0])){const colName=columnName.replace("_"," ");html+=`<th data-value='${colVal}'>${colName}</th>`}$(`#comparable_file_table_head_${createViewIdList[i]}`).append("<tr>"+html+"</tr>");for(const row in data1){let html="";for(const[columnName,colVal]of Object.entries(data1[row]))columnName.endsWith("For The Period")||columnName.endsWith("Deviation")?html+=`<td bgcolor="#f6f6f6">${colVal}</td>`:html+=`<td>${colVal}</td>`;$(`#comparable_file_table_body_${createViewIdList[i]}`).append("<tr>"+html+"</tr>")}let compFileTable=$(`#comparable_file_table_${createViewIdList[i]}`).DataTable();$.fn.dataTable.isDataTable(`#comparable_file_table_${createViewIdList[i]}`)?(compFileTable.destroy(),compFileTable=$(`#comparable_file_table_${createViewIdList[i]}`).DataTable({autoWidth:!1,scrollY:"50vh",scrollCollapse:!0,scrollX:"110%",sScrollXInner:"100%",ordering:!1,orderCellsTop:!0,responsive:!0,colReorder:{fixedColumnsLeft:1},stateSave:!0,deferRender:!0,paging:!0,lengthMenu:[[1,5,50,-1],[1,5,50,"All"]],pageLength:50,dom:"lfBrtip",buttons:[{extend:"collection",text:"Export",buttons:[{extend:"copy",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"excel",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"csv",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"pdf",title:"",exportOptions:{columns:":visible:not(.noVis)"}}]},{extend:"colvis",className:"scroller"}],columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"},{targets:0,width:"20%",className:"noVis"}]}),setTimeout((function(){$(".dt-center").eq(0).removeClass("sorting_asc"),$(`#comparable_file_table_${createViewIdList[i]}`).DataTable().columns.adjust()}),200),$(`#comparable_file_card_${createViewIdList[i]}`).attr("hidden",!1),$(`#savefiledata_${createViewIdList[i]}`).prop("disabled",!1)):(compFileTable=$(`#comparable_file_table_${createViewIdList[i]}`).DataTable({autoWidth:!1,scrollY:"50vh",scrollCollapse:!0,scrollX:"110%",sScrollXInner:"100%",ordering:!1,orderCellsTop:!0,responsive:!0,colReorder:{fixedColumnsLeft:1},stateSave:!0,deferRender:!0,paging:!0,lengthMenu:[[1,5,50,-1],[1,5,50,"All"]],pageLength:50,dom:"lfBrtip",buttons:[{extend:"collection",text:"Export",buttons:[{extend:"copy",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"excel",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"csv",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"pdf",title:"",exportOptions:{columns:":visible:not(.noVis)"}}]},{extend:"colvis",className:"scroller"}],columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"},{targets:0,width:"20%",className:"noVis"}]}),$(`#comparable_file_card_${createViewIdList[i]}`).attr("hidden",!1),$(`#savefiledata_${createViewIdList[i]}`).prop("disabled",!1))},error:function(){Swal.fire({icon:"error",text:"Error! Failure in exporting data. Please try again."})}})})),$(document).find(`#savefiledata_${createViewIdList[i]}`).off("click").on("click",(function(e){if(input=$(`#uploadFileInput_${createViewIdList[i]}`),e.preventDefault(),""!==String(input.val())){const itemCode=windowLocation.split("/")[4],dataForm=new FormData($(`#uploadCSVForm_${createViewIdList[i]}`)[0]);dataForm.append("customValidationList",$(`#customValidationList${createViewIdList[i]}`).attr("value")),$.ajax({url:`/users/${urlPath}/${itemCode}/create_file/`,data:dataForm,type:"POST",cache:!1,contentType:!1,processData:!1,success:function(data){window.location.reload()},error:function(){Swal.fire({icon:"error",text:"Error! Failure in saving data. Please try again."})}})}})),$(document).find(`#${createViewIdList[i]}_tab_content`).find('form button[name="save"]').on("click",(function(){function compareFetchData(){const compareContext=$(document).find(`#${createViewIdList[i]}_tab_content`).find('form button[name="save"]').attr("data-compare-context");let compareColumns={};$(`#${createViewIdList[i]}_tab_content`).find("form input[datatype='CharField']").each((function(){compareColumns[$(this).attr("name")]=$(this).val()})),$(`#comparable_card_${createViewIdList[i]}`).attr("hidden",!1),compareColumns=JSON.stringify(compareColumns),$.ajax({url:`/users/${urlPath}/comparable_get_data/`,data:{operation:"fetchComparables",comparable_dict:compareContext,character_value:compareColumns},type:"POST",dataType:"json",success:function(data){if($(`#comparable_table_body_${createViewIdList[i]}`).empty(),$(`#comparable_table_head_${createViewIdList[i]}`).empty(),"empty"!==data){$(`#comparable_table_head_${createViewIdList[i]}`).append("<tr style=text-align:center><th>Column Name</th><th>Input Value</th><th>Existing Value</th><th>Deviation</th></tr>");for(const columnName in data){let html="";const aggInputFieldValue=$(`#${createViewIdList[i]}_tab_content`).find(`form input[name="${columnName}"]`).val(),aggSummaryValue=data[columnName],aggDeviationValue=Math.round(Math.abs((aggInputFieldValue-aggSummaryValue)/aggSummaryValue*100))+"%";let colName=columnName.replace("_"," ");colName=colName.charAt(0).toUpperCase()+colName.slice(1),html+=`<td>${colName}</td>`,html+=`<td>${aggInputFieldValue}</td>`,html+=`<td bgcolor="#f6f6f6">${aggSummaryValue}</td>`,html+=`<td bgcolor="#f6f6f6">${aggDeviationValue}</td>`,$(`#comparable_table_body_${createViewIdList[i]}`).append("<tr>"+html+"</tr>")}$.fn.dataTable.isDataTable(`#comparable_table_${createViewIdList[i]}`)?($(`#comparable_table_body_${createViewIdList[i]}`).find("tr").each((function(){$(this).find("td:nth-child(1)").attr("tabindex","0"),$(this).find("td").each((function(){$(this).addClass("dt-center allColumnClass all")}))})),$(`#comparable_table_head_${createViewIdList[i]}`).find("tr").each((function(){$(this).find("td").each((function(){$(this).addClass("dt-center allColumnClass all")}))}))):$(`#comparable_table_${createViewIdList[i]}`).DataTable({autoWidth:!0,scrollY:"50vh",scrollCollapse:!0,scrollX:"110%",sScrollXInner:"100%",ordering:!1,orderCellsTop:!0,responsive:!0,colReorder:{fixedColumnsLeft:1},stateSave:!0,deferRender:!0,paging:!0,lengthMenu:[[1,5,50,-1],[1,5,50,"All"]],pageLength:50,dom:"lfBrtip",sScrollX:"120%",buttons:[{extend:"colvis",className:"scroller"}],columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"},{targets:0,width:"27%",className:"noVis"}]})}else $(`#comparable_table_head_${createViewIdList[i]}`).empty(),$(`#comparable_table_head_${createViewIdList[i]}`).append("<tr><th>No Records Exists</th></tr>");$(`#${createViewIdList[i]}_tab_content`).find('form button[name="submit"]').prop("disabled",!1)},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}$(document).find(`#comparable_file_card_${createViewIdList[i]}`).attr("hidden","hidden"),$(document).find(`#comparable_card_${createViewIdList[i]}`).removeAttr("hidden"),$(`#${createViewIdList[i]}_tab_content`).find("form input[datatype='CharField']").each((function(){$(this).on("change",compareFetchData)})),localStorage.setItem("activeTabs",createViewIdList[i]),compareFetchData()}))}async function viewPdfCreateView(obj){const elementId=obj.getAttribute("data-element-id");function sleep(ms){return new Promise(resolve=>setTimeout(resolve,ms))}$(obj).html('<i class="fa fa-circle-notch fa-spin"></i>'),await sleep(500);var wid=document.getElementById("previewCreateViewBody").offsetWidth,hei=document.getElementById("previewCreateViewBody").offsetHeight;let tabtitle=$(`#${elementId}-tab`).find(".span_content_editable").text();await html2canvas(document.getElementById("previewCreateViewBody"),{allowTaint:!0}).then((function(canvas){var imgData=canvas.toDataURL("image/png"),doc=new jsPDF("l","px",[wid,hei]);doc.addImage(imgData,"PNG",0,0,doc.internal.pageSize.width,doc.internal.pageSize.height),doc.save(`${tabtitle}.pdf`),$(obj).html("Download Pdf")}))}function previewCreateViewPdfSave(obj){const elementId=obj.getAttribute("data-element-id"),templateName=obj.getAttribute("data-template-name"),tableName=obj.getAttribute("data-table-name"),itemCode=windowLocation.split("/")[4],templateListType=["Constraint","Asset Grouping"];let tabtitle=$(`#${elementId}-tab`).find(".span_content_editable").text();$("#previewCreateviewHeader").empty(),$("#previewCreateviewHeader").append(`<h6 class="modal-title"  style="width:100%;color:white;margin:auto;font-weight:bold;">${tabtitle}</h6>\n  <button type="button" class="close" data-dismiss="modal">&times;</button>`),event.preventDefault();let final_html="<div class='form-row'>",html_data=$(`#createview${elementId}`).find(".form-row").each((function(){final_html+=$(this).html()}));final_html+="</div>";let dictOfInputvalues={},arrayOfInputs=$(`#createview${elementId}`).find(".form-row").find("input , select , textarea").each((function(){dictOfInputvalues[$(this).attr("id")+"modal"]=$(this).val()}));for(var key in $("#previewCreateViewBody").empty(),$("#previewCreateViewBody").append(final_html),$("#previewCreateViewBody").css("pointer-events","none"),$("#previewCreateViewBody").find("input , select , textarea").each((function(){$(this).attr("id",$(this).attr("id")+"modal"),$(this).parent().find(".select2-container").css("width","")})),dictOfInputvalues)$("#previewCreateViewBody").find("#"+key).removeAttr("onclick"),$("#previewCreateViewBody").find("#"+key).removeAttr("onchange"),$("#previewCreateViewBody").find("#"+key).val(dictOfInputvalues[key]).trigger("change");$("#previewCreateViewModal").find("#previewCreateView_footer").empty(),$("#previewCreateViewModal").find("#previewCreateView_footer").append(`\n    <button type="button" class="btn btn-primary btn-xs mx-2 rounded px-2" data-dismiss="modal" id='savebuttonpreview_${elementId}'>Submit</button>\n    <button onclick = "viewPdfCreateView(this)" type="button" class="btn btn-primary btn-xs mx-2 rounded px-2">Download Pdf</button>\n    <button type="button" class="btn btn-primary btn-xs mx-2 rounded px-2" data-dismiss="modal">Close</button>\n    `),$("#previewCreateViewModal").modal("show"),$(`#savebuttonpreview_${elementId}`).on("click",(function(){if("Constraint"===String(templateName))$(`#savebuttoninfo${elementId}`).removeAttr("onclick"),$(`#savebuttoninfo${elementId}`).removeAttr("data-preview-mode"),$(`#savebuttoninfo${elementId}`).click();else if("Asset Grouping"===String(templateName))$(`#savebuttonasset${elementId}`).removeAttr("onclick"),$(`#savebuttonasset${elementId}`).removeAttr("data-preview-mode"),$(`#savebuttonasset${elementId}`).click();else{$(`#savebutton_${elementId}`).removeAttr("onclick");const connectedListviewId=$(`#savebutton_${elementId}`).attr("connected_listview_id");if(connectedListviewId){const linkedListview=$(`#savebutton_${elementId}`).attr("connected_listview_id");localStorage.setItem("activeTabs",linkedListview)}else localStorage.setItem("activeTabs",elementId);const type=$(`#savebutton_${elementId}`).val();let currentUrl=window.location.pathname,idEle=$(`#savebutton_${elementId}`).attr("id").split("whiteSpacewrap")[1];if(idEle="whiteSpacewrap"+idEle,item_code_list)for(let j=0;j<item_code_list.length;j++)currentUrl="/users/"+item_code_list[j][idEle]+"/";const submitFormUrl=currentUrl+"create/",submitFormDraftUrl=currentUrl+"createDraft/";"Save"===String(type)?$(`#savebutton_${elementId}`).attr("formaction",submitFormUrl):"Save as Draft"===String(type)&&$(`#savebutton_${elementId}`).attr("formaction",submitFormDraftUrl),$(`#savebutton_${elementId}`).attr("type","submit"),$(`#savebutton_${elementId}`).attr("name","submit"),$(`#savebutton_${elementId}`).click()}}))}function previewCreateViewSave(obj){const elementId=obj.getAttribute("data-element-id"),templateName=obj.getAttribute("data-template-name"),tableName=obj.getAttribute("data-table-name"),itemCode=windowLocation.split("/")[4],templateListType=["Constraint","Asset Grouping"];let tabtitle=$(`#${elementId}-tab`).find(".span_content_editable").text();$("#previewCreateviewHeader").empty(),$("#previewCreateviewHeader").append(`<h6 class="modal-title"  style="width:100%;color:white;margin:auto;font-weight:bold;">${tabtitle}</h6>\n  <button type="button" class="close" data-dismiss="modal">&times;</button>`),$.ajax({url:`/users/${urlPath}/${itemCode}/`,data:{model_name:tableName,operation:"previewCreateViewData"},type:"POST",dataType:"json",success:function(data){const finalContext=JSON.parse(data.context),context=finalContext.context_data;$("#previewCreateViewBody").empty();for(const tableKey in context){let theadHtml="",trowHtml="";$("#previewCreateViewBody").append(`<table id='previewCreateViewTable_${tableKey}'></table>`),$.fn.dataTable.isDataTable(`#previewCreateView_${tableKey}`)&&$(`#previewCreateViewTable_${tableKey}`).DataTable().clear().destroy(),$(`#previewCreateViewTable_${tableKey}`).empty();for(const fieldKey in context[tableKey])theadHtml+=`<th>${context[tableKey][fieldKey]}</th>`;trowHtml+="<tr>";let rowVal="";for(const fieldKey in context[tableKey])templateListType.includes(templateName)?(rowVal=$(`#createview${elementId}`).find(`input[data-name='${fieldKey}']`).val(),rowVal||(rowVal=$(`#createview${elementId}`).find(`select[data-name='${fieldKey}']`).val())):(rowVal="Multi Select"==templateName?$(`#createview${elementId}`).find(`textarea[data-tablename='${tableKey}']`).parent().parent().find(`[id='${elementId}_${fieldKey}_unique']`).val():$(`#createview${elementId}`).find(`textarea[data-tablename='${tableKey}'][id='id_${fieldKey}_${elementId}']`).val(),rowVal||(rowVal=$(`#createview${elementId}`).find(`input[data-tablename='${tableKey}'][id='id_${fieldKey}_${elementId}']`).attr("type"),"undefined"===String(rowVal)?(rowVal=$(`#createview${elementId}`).find(`input[id='id_${fieldKey}_${elementId}']`).attr("type"),rowVal?"checkbox"===String(rowVal)?(rowVal=$(`#createview${elementId}`).find(`input[id='id_${fieldKey}_${elementId}']`),rowVal=rowVal.prop("checked")?"on":"off"):rowVal=$(`#createview${elementId}`).find(`input[id='id_${fieldKey}_${elementId}']`).val():rowVal=$(`#createview${elementId}`).find(`select[data-tablename='${tableKey}'][id='id_${fieldKey}_${elementId}']`).val()):("Multi Select"==templateName?(rowVal=$(`#createview${elementId}`).find(`input[data-tablename='${tableKey}'][id='id_${fieldKey}_${elementId}']`).val(),rowVal.startsWith("{")&&(rowVal=$(`#createview${elementId}`).find(`[id='${elementId}_${fieldKey}_unique']`).val())):rowVal=$(`#createview${elementId}`).find(`input[data-tablename='${tableKey}'][id='id_${fieldKey}_${elementId}']`).val(),rowVal||(rowVal=$(`#createview${elementId}`).find(`select[data-tablename='${tableKey}'][id='id_${fieldKey}_${elementId}']`).val())))),rowVal&&""!==String(rowVal)?trowHtml+=`<td>${rowVal}</td>`:trowHtml+="<td> --- </td>";trowHtml+="</tr>",$(`#previewCreateViewTable_${tableKey}`).append(`<thead><tr id='header_column_${tableKey}' style='border-bottom:2px solid var(--primary-color);width:100%'>\n      ${theadHtml}</tr></thead>\n      <tbody>${trowHtml}</tbody>`),$(`#previewCreateViewTable_${tableKey}`).DataTable({autoWidth:!1,scrollY:200,scrollX:500,scrollCollapse:!0,sScrollXInner:"100%",bInfo:!1,bRetrieve:!0,bProcessing:!0,bDestroy:!0,ordering:!1,orderCellsTop:!0,responsive:!0,colReorder:{fixedColumnsLeft:1},deferRender:!0,paging:!0,lengthMenu:[[1,5,50,-1],[1,5,50,"All"]],pageLength:50,dom:"lfBrtip",buttons:[],columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"},{targets:0,width:"20%",className:"noVis"}]})}$("#previewCreateViewModal").find("#previewCreateView_footer").empty(),$("#previewCreateViewModal").find("#previewCreateView_footer").append(`\n    <button type="button" class="btn btn-primary btn-xs mx-2 rounded px-2" data-dismiss="modal" id='savebuttonpreview_${elementId}'>Submit</button>\n    <button type="button" class="btn btn-primary btn-xs mx-2 rounded px-2" data-dismiss="modal">Close</button>\n    `),setTimeout((function(){$(document).find(".standard_button_click").prop("disabled",!1),$(document).find(".button_standard_save").prop("disabled",!1)}),200),$("#previewCreateViewModal").modal("show"),$(`#savebuttonpreview_${elementId}`).on("click",(function(){if("Constraint"===String(templateName))$(`#savebuttoninfo${elementId}`).removeAttr("onclick"),$(`#savebuttoninfo${elementId}`).removeAttr("data-preview-mode"),$(`#savebuttoninfo${elementId}`).click();else if("Asset Grouping"===String(templateName))$(`#savebuttonasset${elementId}`).removeAttr("onclick"),$(`#savebuttonasset${elementId}`).removeAttr("data-preview-mode"),$(`#savebuttonasset${elementId}`).click();else{$(`#savebutton_${elementId}`).removeAttr("onclick");const connectedListviewId=$(`#savebutton_${elementId}`).attr("connected_listview_id");if(connectedListviewId){const linkedListview=$(`#savebutton_${elementId}`).attr("connected_listview_id");localStorage.setItem("activeTabs",linkedListview)}else localStorage.setItem("activeTabs",elementId);const type=$(`#savebutton_${elementId}`).val();let currentUrl=window.location.pathname,idEle=$(`#savebutton_${elementId}`).attr("id").split("whiteSpacewrap")[1];if(idEle="whiteSpacewrap"+idEle,item_code_list)for(let j=0;j<item_code_list.length;j++)currentUrl="/users/"+item_code_list[j][idEle]+"/";const submitFormUrl=currentUrl+"create/",submitFormDraftUrl=currentUrl+"createDraft/";"Save"===String(type)?$(`#savebutton_${elementId}`).attr("formaction",submitFormUrl):"Save as Draft"===String(type)&&$(`#savebutton_${elementId}`).attr("formaction",submitFormDraftUrl),$(`#savebutton_${elementId}`).attr("type","submit"),$(`#savebutton_${elementId}`).attr("name","submit"),$(`#savebutton_${elementId}`).trigger("click")}})),setTimeout((function(){for(const tableKey in context)$(`#previewCreateViewTable_${tableKey}`).DataTable().columns.adjust()}),200)},error:function(){Swal.fire({icon:"error",text:"Error! Failure in displaying data. Please try again."})}})}for(let i=0;i<createViewIdList.length;i++)$(document).find(`#${createViewIdList[i]}_tab_content`).find('form button[name="previewButton"]').off("click").on("click",(function(){const tableName=$(this).attr("data-table-name"),tabId=$(this).attr("id"),createViewId=tabId.substring(tabId.indexOf("_")+1);let viewrtfcb_mode=$(this).attr("viewrtfcb_mode"),draftCols=$(this).attr("data-draft_cols"),columnAlignment={},columnAlignmentDef=[];$(this).attr("data-column-alignment")?columnAlignment=JSON.parse($(this).attr("data-column-alignment")):columnAlignmentDef.push({targets:"_all",className:"dt-center allColumnClass all"}),draftCols?(draftCols=JSON.parse(draftCols),draftCols=tableName in draftCols?draftCols[tableName]:[]):draftCols=[];const saveDraftpath="#saveDraftbutton_"+createViewId;$.ajax({url:`/users/${urlPath}/constriant_get_data/`,data:{operation:"preview_data_fetch",table_name:tableName,create_viewID:createViewId},type:"POST",dataType:"json",success:function(data){if($.fn.dataTable.isDataTable("#previewTable")&&$("#previewTable").DataTable().clear().destroy(),$("#previewTable").empty(),data.previewList.length>0){$("#previewTable").append("<thead><tr class='header_column' style='border-bottom:2px solid var(--primary-color);width:100%'>"),$("#previewTable").find(".header_column").append('<td style="font-weight:bolder">Actions</td>');for(let[key,value]of Object.entries(data.verboseName))draftCols.length>0?draftCols.includes(key)&&$("#previewTable").find(".header_column").append(`<td style="font-weight:bolder">${value}</td>`):$("#previewTable").find(".header_column").append(`<td style="font-weight:bolder">${value}</td>`);$("#previewTable").append("</thead></tr>"),$("#previewTable").append('<tbody class="tbody"></tbody>');for(let i=0;i<data.previewList.length;i++){$("#previewTable").find(".tbody").append(`<tr class="column_${i}">`),$("#previewTable").find(`.column_${i}`).append(`<td>\n                    <a data-toggle="tooltip" title="Save As Final" class"SaveAsFinal" id="SaveAsFinal${data.table_id[i]}" data-elementID="${data.table_id[i]}" data-table_model_name="${tableName}" value="detail">\n                      <i name="actions" value="Save" class="fa-solid fa-floppy-disk ihover javaSC thin-icon" style="font-size: 15px"></i>\n                    </a>&nbsp;\n                    <a data-toggle="tooltip" class="edit_button" title="Edit record" data-elementID="${data.table_id[i]}" data-table_name="${tableName}" id="EditRecord${data.table_id[i]}" value="update">\n                      <i name="actions" value="Edit" class="fa fa-edit ihover javaSC thin-icon" style="font-size:15px"></i>\n                    </a>&nbsp;\n                    <a data-toggle="tooltip" class="delete_button" title="Delete record" data-elementID="${data.table_id[i]}" data-table_name="$(this).attr('data-table-name')" value="delete"\n                    id="deletedraft${data.table_id[i]}"><i name="actions" value="Delete" class="far fa-trash-alt ihover javaSC" style="font-size:15px"></i></a>\n                  </td>`);for(let vi=0;vi<Object.keys(data.verboseName).length;vi++){const previewKeys=Object.keys(data.previewList[i]),verbAns=Object.keys(data.verboseName)[vi],colVerb=tableName+"__"+verbAns;var fieldArray=[];if(draftCols.length>0){if(draftCols.includes(verbAns))if(fieldArray.push(verbAns),previewKeys.includes(colVerb))if(data.previewList[i][colVerb]){const colVerbValue=data.previewList[i][colVerb],startsWithBracket=colVerbValue.startsWith("<");let tdContent=startsWithBracket&&"True"===viewrtfcb_mode?`<button class="view_data_btn" style="background-color: transparent; border: transparent;" onclick="showRTFDataCreateView.call(this)" data-data="${colVerbValue}">View Data</button>`:colVerbValue;if(colVerbValue.startsWith("<"),"string"==typeof data.previewList[i][colVerb]&&data.previewList[i][colVerb].startsWith("["))$("#previewTable").find(`.column_${i}`).append(`<td class="view_details_wrap"> <button class="view_data_btn table_field_show_button" style="background-color: transparent; border: transparent;" onclick="showTableDataCreateView.call(this)" data-json = '${data.previewList[i][colVerb]}'>View Data</button> </td>`);else{const tdElement=`<td class="view_details_wrap" data-preview-name="${colVerb}">${tdContent}</td>`;$("#previewTable").find(`.column_${i}`).append(tdElement)}}else $("#previewTable").find(`.column_${i}`).append(`<td class="view_details_wrap" data-preview-name="${colVerb}"> - </td>`);else previewKeys.includes(verbAns)?data.previewList[i][verbAns]?$("#previewTable").find(`.column_${i}`).append(`<td class="view_details_wrap" data-preview-name="${verbAns}">${data.previewList[i][verbAns]}</td>`):$("#previewTable").find(`.column_${i}`).append(`<td class="view_details_wrap" data-preview-name="${verbAns}"> - </td>`):$("#previewTable").find(`.column_${i}`).append('<td class="view_details_wrap"> - </td>')}else if(fieldArray.push(verbAns),previewKeys.includes(colVerb))if(data.previewList[i][colVerb]){const colVerbValue=data.previewList[i][colVerb],startsWithBracket=colVerbValue.startsWith("<");let tdContent=startsWithBracket&&"True"===viewrtfcb_mode?`<button class="view_data_btn" style="background-color: transparent; border: transparent;" onclick="showRTFDataCreateView.call(this)" data-data="${colVerbValue}">View Data</button>`:colVerbValue;if(colVerbValue.startsWith("<"),"string"==typeof data.previewList[i][colVerb]&&data.previewList[i][colVerb].startsWith("["))$("#previewTable").find(`.column_${i}`).append(`<td class="view_details_wrap"> <button class="view_data_btn table_field_show_button" style="background-color: transparent; border: transparent;" onclick="showTableDataCreateView.call(this)" data-json = '${data.previewList[i][colVerb]}'>View Data</button> </td>`);else{const tdElement=`<td class="view_details_wrap" data-preview-name="${colVerb}">${tdContent}</td>`;$("#previewTable").find(`.column_${i}`).append(tdElement)}}else $("#previewTable").find(`.column_${i}`).append(`<td class="view_details_wrap" data-preview-name="${colVerb}"> - </td>`);else previewKeys.includes(verbAns)?data.previewList[i][verbAns]?$("#previewTable").find(`.column_${i}`).append(`<td class="view_details_wrap" data-preview-name="${verbAns}">${data.previewList[i][verbAns]}</td>`):$("#previewTable").find(`.column_${i}`).append(`<td class="view_details_wrap" data-preview-name="${verbAns}"> - </td>`):$("#previewTable").find(`.column_${i}`).append('<td class="view_details_wrap"> - </td>')}if(Object.keys(columnAlignment).length){let globalHeader=columnAlignment.global_header,globalContent=columnAlignment.global_content;if(columnAlignment.field_level_config)for(index in columnAlignmentDef=[],draftCols){var fieldChar=draftCols[index],fieldName=fieldChar.replace(`${tableName}__`,"");if(columnAlignment.field_level_config[fieldName]){var header=columnAlignment.field_level_config[fieldName].header,content=columnAlignment.field_level_config[fieldName].content;columnAlignmentDef.push({targets:[Number(index)+1],className:`dt-head-${header} dt-body-${content} allColumnClass all`})}else columnAlignmentDef.push({targets:[Number(index)+1],className:`dt-head-${globalHeader} dt-body-${globalContent} allColumnClass all`})}}columnAlignmentDef.push({targets:[0],className:"dt-center allColumnClass all"}),$("#previewTable").append("</tr>"),$("#previewTable").find(`#deletedraft${data.table_id[i]}`).on("click",(function(){const dataElementID=$(this).attr("data-elementid"),its_tr=$(this).closest("tr");its_tr.remove(),$.ajax({url:`/users/${urlPath}/constriant_get_data/`,data:{element_id:dataElementID,operation:"remove_from_draft_table"},type:"POST",dataType:"json",success:function(data){Swal.fire({icon:"success",text:"Deleted successfully!"})},error:function(){Swal.fire({icon:"error",text:"Error! Failure in executing request. Please try again."})}})})),$("#previewTable").find(`#EditRecord${data.table_id[i]}`).on("click",(function(){const dataElementID=$(this).attr("data-elementid");$("#draftModal").modal("hide"),$(saveDraftpath).attr("data-table-id",dataElementID),$(saveDraftpath).attr("data-entry","Existing");const currentDataElementID=dataElementID;for(const n in data.completeData)if(Object.keys(data.completeData[n])[0]===currentDataElementID){const userInfo=data.completeData[n][currentDataElementID];if("approvalAssignmentConfig"in userInfo){const approvalAssignmentConfig_1=JSON.parse(userInfo.approvalAssignmentConfig);if(Object.keys(approvalAssignmentConfig_1).length>0)if($(`#approvalAssignmentConfig${createViewId}`).val(JSON.stringify(approvalAssignmentConfig_1)),$(`#approvalAssignmentParameterModal${createViewId}`).find(`#selectNatureOfApproval${createViewId}`).val(approvalAssignmentConfig_1.approval_type).trigger("change"),$(`#approvalAssignmentParameterModal${createViewId}`).find(`#selectNatureOfApproval${createViewId}`).val(approvalAssignmentConfig_1.approval_type).trigger("select2:select"),"multi_level"==approvalAssignmentConfig_1.approval_type){if("level_config"in approvalAssignmentConfig_1){$(`#multi_level_parameter${createViewId}`).find(".multi_approval_levels").empty();for(let d in approvalAssignmentConfig_1.level_config){$(`#approvalAssignmentParameterModal${createViewId}`).find(`#add_levels_button${createViewId}`).click();var singleCard=$(`#approvalAssignmentParameterModal${createViewId}`).find(".multi_level_form_group").eq(-1);$(singleCard).find(".selectApproverType").val(approvalAssignmentConfig_1.level_config[d].approver_type).trigger("change"),$(singleCard).find(".selectApproverLevel").val(approvalAssignmentConfig_1.level_config[d].approver_list).trigger("change")}}}else $(`#approvalAssignmentParameterModal${createViewId}`).find(`#selectApproverTypeUAA${createViewId}`).val(approvalAssignmentConfig_1.approver_type).trigger("change"),$(`#approvalAssignmentParameterModal${createViewId}`).find(`#selectApproverUsersUAA${createViewId}`).val(approvalAssignmentConfig_1.approver_list).trigger("change");else $(`#approvalAssignmentParameterModal${createViewId}`).find(`#selectApproverUsersUAA${createViewId}`).val([]).trigger("change")}for(const i in userInfo){let colName="";if(i.startsWith(tableName+"__")?(colName=i.split(tableName+"__"),colName=colName[1]):colName=i,draftCols.length>0){if(draftCols.includes(colName))if("checkbox"===String($(`#id_${colName}_${createViewId}`).attr("type"))&&"on"===String(userInfo[i]))$(`#id_${colName}_${createViewId}`).val("").trigger("change"),$(`#id_${colName}_${createViewId}`).val(userInfo[i]).trigger("select2:select"),$(`#id_${colName}_${createViewId}`).val(userInfo[i]).trigger("change"),$(`#id_${colName}_${createViewId}`).click();else{if(userInfo[i].startsWith("{")){$(`#id_${colName}_${createViewId}`).val(userInfo[i]).trigger("change"),mulval=JSON.parse(userInfo[i]),mulval=Object.keys(mulval);try{$(`#${createViewId}_${colName}_unique`).val(mulval).trigger("change")}catch(err){}}else if($(`#id_${colName}_${createViewId}`).hasClass("select2")){$(`#id_${colName}_${createViewId}`).attr("data-reload",userInfo[i]),$(`#id_${colName}_${createViewId}`).val(userInfo[i]).trigger("select2:select");try{$(`#id_${colName}_${createViewId}`).val(userInfo[i]).trigger("change")}catch(err){}}else if($(`#id_${colName}_${createViewId}[data-tablename='${tableName}']`).parent().find("p[title='RTF editor']").length>0)userInfo[i]&&($(`#id_${colName}_${createViewId}[data-tablename='${tableName}']`).parent().find("p[title='RTF editor']").attr("data-data",userInfo[i]),$(`#id_${colName}_${createViewId}[data-tablename='${tableName}']`).val(userInfo[i]));else if("FileField"==$(`#id_${colName}_${createViewId}`).attr("datatype")){var existingFiles;if($(`#id_${colName}_${createViewId}`).val(userInfo[i]).trigger("change"),(existingFiles=userInfo[i].split(", ")).length){var uploadedFileContainerElement=$(`#${colName}_${createViewId}_upload_modal`).find(".uploaded-files-gallery");for(key of existingFiles)uploadedFileContainerElement.append(`\n                                  <li class="list-group-item d-flex justify-content-between align-items-center">\n                                    ${key}\n                                    <span class="badge previewUploadedFile" style="margin-right:0; margin-left:auto;" data-file-name="${key}"><a href='/media/uploaded_files/${key}' target="_blank"><i class="fas fa-eye fa-2x"></i></a></span>\n                                    <span class="badge downloadUploadedFile" style="margin-right:0;" data-file-name="${key}"><a href='/media/uploaded_files/${key}' target="_blank" download="${key}"><i class="fas fa-download fa-2x"></i></a></span>\n                                    <span class="badge removeUploadedFile" data-file-name="${key}"><i class="fas fa-trash-alt fa-2x" style="color:red;"></i></span>\n                                  </li>\n                                  `),uploadedFileContainerElement.find(".list-group-item").eq(-1).find(".removeUploadedFile").on("click",(function(){$(this).parent().remove()}))}}else $(`#id_${colName}_${createViewId}`).val(userInfo[i]).trigger("change");$(`#${createViewIdList[i]}_tab_content`).find('form input[type="checkbox"]').trigger("click")}}else if("checkbox"===String($(`#id_${colName}_${createViewId}`).attr("type"))&&"on"===String(userInfo[i]))$(`#id_${colName}_${createViewId}`).val(userInfo[i]).trigger("change"),$(`#id_${colName}_${createViewId}`).click();else{if(userInfo[i].startsWith("{")){$(`#id_${colName}_${createViewId}`).val(userInfo[i]).trigger("change"),mulval=JSON.parse(userInfo[i]),mulval=Object.keys(mulval);try{$(`#${createViewId}_${colName}_unique`).val(mulval).trigger("change")}catch(err){}}else if($(`#id_${colName}_${createViewId}`).hasClass("select2")){$(`#id_${colName}_${createViewId}`).attr("data-reload",userInfo[i]),$(`#id_${colName}_${createViewId}`).find(`option[value="${userInfo[i]}"]`).prop("disabled",!1),$(`#id_${colName}_${createViewId}`).val(userInfo[i]).trigger("select2:select");try{$(`#id_${colName}_${createViewId}`).val(userInfo[i]).trigger("change")}catch(err){}}else if($(`#id_${colName}_${createViewId}[data-tablename='${tableName}']`).parent().find("p[title='RTF editor']").length>0)userInfo[i]&&($(`#id_${colName}_${createViewId}[data-tablename='${tableName}']`).parent().find("p[title='RTF editor']").attr("data-data",userInfo[i]),$(`#id_${colName}_${createViewId}[data-tablename='${tableName}']`).val(userInfo[i]));else if("FileField"==$(`#id_${colName}_${createViewId}`).attr("datatype")){var existingFiles;if($(`#id_${colName}_${createViewId}`).val(userInfo[i]).trigger("change"),(existingFiles=userInfo[i].split(", ")).length){var uploadedFileContainerElement=$(`#${colName}_${createViewId}_upload_modal`).find(".uploaded-files-gallery");for(key of existingFiles)uploadedFileContainerElement.append(`\n                                <li class="list-group-item d-flex justify-content-between align-items-center">\n                                  ${key}\n                                  <span class="badge previewUploadedFile" style="margin-right:0; margin-left:auto;" data-file-name="${key}"><a href='/media/uploaded_files/${key}' target="_blank"><i class="fas fa-eye fa-2x"></i></a></span>\n                                  <span class="badge downloadUploadedFile" style="margin-right:0;" data-file-name="${key}"><a href='/media/uploaded_files/${key}' target="_blank" download="${key}"><i class="fas fa-download fa-2x"></i></a></span>\n                                  <span class="badge removeUploadedFile" data-file-name="${key}"><i class="fas fa-trash-alt fa-2x" style="color:red;"></i></span>\n                                </li>\n                                `),uploadedFileContainerElement.find(".list-group-item").eq(-1).find(".removeUploadedFile").on("click",(function(){$(this).parent().remove()}))}}else $(`#id_${colName}_${createViewId}`).val(userInfo[i]).trigger("change");$(`#${createViewIdList[i]}_tab_content`).find('form input[type="checkbox"]').trigger("click")}}}})),$("#previewTable").find(`#SaveAsFinal${data.table_id[i]}`).on("click",(function(){const dataElementID=$(this).attr("data-elementid");$(`#savebutton_${dataElementID}`).removeAttr("onclick"),$("#draftModal").modal("hide");const currentDataElementID=dataElementID;let colName="";for(const n in data.completeData)if(String(Object.keys(data.completeData[n])[0])===currentDataElementID){const userInfo=data.completeData[n][currentDataElementID];if("approvalAssignmentConfig"in userInfo){const approvalAssignmentConfig_1=JSON.parse(userInfo.approvalAssignmentConfig);if(Object.keys(approvalAssignmentConfig_1).length>0)if($(`#approvalAssignmentConfig${createViewId}`).val(JSON.stringify(approvalAssignmentConfig_1)),$(`#approvalAssignmentParameterModal${createViewId}`).find(`#selectNatureOfApproval${createViewId}`).val(approvalAssignmentConfig_1.approval_type).trigger("change"),$(`#approvalAssignmentParameterModal${createViewId}`).find(`#selectNatureOfApproval${createViewId}`).val(approvalAssignmentConfig_1.approval_type).trigger("select2:select"),"multi_level"==approvalAssignmentConfig_1.approval_type){if("level_config"in approvalAssignmentConfig_1){$(`#multi_level_parameter${createViewId}`).find(".multi_approval_levels").empty();for(let d in approvalAssignmentConfig_1.level_config){$(`#approvalAssignmentParameterModal${createViewId}`).find(`#add_levels_button${createViewId}`).click();var singleCard=$(`#approvalAssignmentParameterModal${createViewId}`).find(".multi_level_form_group").eq(-1);$(singleCard).find(".selectApproverType").val(approvalAssignmentConfig_1.level_config[d].approver_type).trigger("change"),$(singleCard).find(".selectApproverLevel").val(approvalAssignmentConfig_1.level_config[d].approver_list).trigger("change")}}}else $(`#approvalAssignmentParameterModal${createViewId}`).find(`#selectApproverTypeUAA${createViewId}`).val(approvalAssignmentConfig_1.approver_type).trigger("change"),$(`#approvalAssignmentParameterModal${createViewId}`).find(`#selectApproverUsersUAA${createViewId}`).val(approvalAssignmentConfig_1.approver_list).trigger("change");else $(`#approvalAssignmentParameterModal${createViewId}`).find(`#selectApproverUsersUAA${createViewId}`).val([]).trigger("change")}for(const i in userInfo)if(i.startsWith(tableName+"__")?(colName=i.split(tableName+"__"),colName=colName[1]):colName=i,draftCols.length>0){if(draftCols.includes(colName))if("checkbox"===String($(`#id_${colName}_${createViewId}`).attr("type"))&&"on"===String(userInfo[i]))$(`#id_${colName}_${createViewId}`).val(userInfo[i]).trigger("change"),$(`#id_${colName}_${createViewId}`).click();else{if(userInfo[i].startsWith("{")){$(`#id_${colName}_${createViewId}`).val(userInfo[i]).trigger("change"),mulval=JSON.parse(userInfo[i]),mulval=Object.keys(mulval);try{$(`#${createViewId}_${colName}_unique`).val(mulval).trigger("change")}catch(err){}}else if($(`#id_${colName}_${createViewId}`).hasClass("select2"))$(`#id_${colName}_${createViewId}`).attr("data-reload",userInfo[i]),$(`#id_${colName}_${createViewId}`).find(`option[value="${userInfo[i]}"]`).prop("disabled",!1),$(`#id_${colName}_${createViewId}`).val(userInfo[i]).trigger("select2:select"),$(`#id_${colName}_${createViewId}`).val(userInfo[i]);else if($(`#id_${colName}_${createViewId}[data-tablename='${tableName}']`).parent().find("p[title='RTF editor']").length>0)userInfo[i]&&($(`#id_${colName}_${createViewId}[data-tablename='${tableName}']`).parent().find("p[title='RTF editor']").attr("data-data",userInfo[i]),$(`#id_${colName}_${createViewId}[data-tablename='${tableName}']`).val(userInfo[i]));else if("FileField"==$(`#id_${colName}_${createViewId}`).attr("datatype")){var existingFiles;if($(`#id_${colName}_${createViewId}`).val(userInfo[i]),(existingFiles=userInfo[i].split(", ")).length){var uploadedFileContainerElement=$(`#${colName}_${createViewId}_upload_modal`).find(".uploaded-files-gallery");for(key of existingFiles)uploadedFileContainerElement.append(`\n                                  <li class="list-group-item d-flex justify-content-between align-items-center">\n                                    ${key}\n                                    <span class="badge previewUploadedFile" style="margin-right:0; margin-left:auto;" data-file-name="${key}"><a href='/media/uploaded_files/${key}' target="_blank"><i class="fas fa-eye fa-2x"></i></a></span>\n                                    <span class="badge downloadUploadedFile" style="margin-right:0;" data-file-name="${key}"><a href='/media/uploaded_files/${key}' target="_blank" download="${key}"><i class="fas fa-download fa-2x"></i></a></span>\n                                    <span class="badge removeUploadedFile" data-file-name="${key}"><i class="fas fa-trash-alt fa-2x" style="color:red;"></i></span>\n                                  </li>\n                                  `),uploadedFileContainerElement.find(".list-group-item").eq(-1).find(".removeUploadedFile").on("click",(function(){$(this).parent().remove()}))}}else $(`#id_${colName}_${createViewId}`).val(userInfo[i]);$(`#${createViewIdList[i]}_tab_content`).find('form input[type="checkbox"]').trigger("click")}}else if("checkbox"===String($(`#id_${colName}_${createViewId}`).attr("type"))&&"on"===String(userInfo[i]))$(`#id_${colName}_${createViewId}`).val(userInfo[i]),$(`#id_${colName}_${createViewId}`).click();else{if(userInfo[i].startsWith("{")){$(`#id_${colName}_${createViewId}`).val(userInfo[i]).trigger("change"),mulval=JSON.parse(userInfo[i]),mulval=Object.keys(mulval);try{$(`#${createViewId}_${colName}_unique`).val(mulval).trigger("change")}catch(err){}}else if($(`#id_${colName}_${createViewId}`).hasClass("select2"))$(`#id_${colName}_${createViewId}`).attr("data-reload",userInfo[i]),$(`#id_${colName}_${createViewId}`).find(`option[value="${userInfo[i]}"]`).prop("disabled",!1),$(`#id_${colName}_${createViewId}`).val(userInfo[i]).trigger("select2:select");else if($(`#id_${colName}_${createViewId}[data-tablename='${tableName}']`).parent().find("p[title='RTF editor']").length>0)userInfo[i]&&($(`#id_${colName}_${createViewId}[data-tablename='${tableName}']`).parent().find("p[title='RTF editor']").attr("data-data",userInfo[i]),$(`#id_${colName}_${createViewId}[data-tablename='${tableName}']`).val(userInfo[i]));else if("FileField"==$(`#id_${colName}_${createViewId}`).attr("datatype")){var existingFiles;if($(`#id_${colName}_${createViewId}`).val(userInfo[i]).trigger("change"),(existingFiles=userInfo[i].split(", ")).length){var uploadedFileContainerElement=$(`#${colName}_${createViewId}_upload_modal`).find(".uploaded-files-gallery");for(key of existingFiles)uploadedFileContainerElement.append(`\n                                <li class="list-group-item d-flex justify-content-between align-items-center">\n                                  ${key}\n                                  <span class="badge previewUploadedFile" style="margin-right:0; margin-left:auto;" data-file-name="${key}"><a href='/media/uploaded_files/${key}' target="_blank"><i class="fas fa-eye fa-2x"></i></a></span>\n                                  <span class="badge downloadUploadedFile" style="margin-right:0;" data-file-name="${key}"><a href='/media/uploaded_files/${key}' target="_blank" download="${key}"><i class="fas fa-download fa-2x"></i></a></span>\n                                  <span class="badge removeUploadedFile" data-file-name="${key}"><i class="fas fa-trash-alt fa-2x" style="color:red;"></i></span>\n                                </li>\n                                `),uploadedFileContainerElement.find(".list-group-item").eq(-1).find(".removeUploadedFile").on("click",(function(){$(this).parent().remove()}))}}else $(`#id_${colName}_${createViewId}`).val(userInfo[i]);$(`#${createViewIdList[i]}_tab_content`).find('form input[type="checkbox"]').trigger("click")}}$(`#savebutton_${createViewId}`).trigger("click")&&$.ajax({url:`/users/${urlPath}/constriant_get_data/`,data:{element_id:dataElementID,operation:"remove_from_draft_to_final"},type:"POST",dataType:"json",success:function(data){},error:function(){Swal.fire({icon:"error",text:"Error! Failure in executing request. Please try again."})}})}))}$("#previewTable thead tr").eq(0).clone(!0).appendTo("#previewTable thead"),$("#previewTable thead tr").eq(1).find("td").eq(0).html(""),$("#previewTable thead tr").eq(0).find("td").eq(0).css("cursor","default"),$("#previewTable thead tr").eq(0).find("td").eq(0).css("background-image","none"),$("#previewTable thead tr").eq(1).find("td").css("padding","5px"),$("#previewTable thead tr").eq(1).find("td").each((function(){$(this).addClass("dt-center");const title=$(this).text();$(this).html('<input type="text" data-input_value="" style="text-align:center;border-bottom:none;border:1px solid #ced4da;width:190px;"placeholder="Search '+title+'" />'),$("input",this).on("keyup change",(function(){$(this).attr("data-input_value",this.value.trim());const regEx1=/^[\w]/,regEx2=/^[^=^\w^\s]|^[==]/,tables=$("#previewTable").DataTable();if(regEx1.test(this.value)||""===String(this.value)){const indexOfTheElement=$(this).parent().index(),colIndexInt=parseInt(indexOfTheElement);String(tables.column(colIndexInt).search())!==String(this.value)&&tables.column(colIndexInt).search(this.value).draw()}else if(regEx2.test(this.value)){tables.draw();const regEx3=/^\W+/;if(regEx3.test(this.value)){const condition=this.value.match(/\W+/g),refinedCondition=this.value.replace(/^\W+/,""),refinedSearchParam=refinedCondition.trim(),rhs=parseInt(refinedSearchParam),indexOfTheElement=$(this).parent().index(),colIndexInt=parseInt(indexOfTheElement);isNaN(rhs)||($.fn.dataTable.ext.search.push((function(settings,searchData,index,rowData,counter){if("previewTable"!==String(settings.nTable.id))return!0;const evalString=`searchData[${colIndexInt}]`+condition[0]+rhs;return!!eval(evalString)})),tables.draw(),$.fn.dataTable.ext.search.pop(),tables.search.pop())}}}))})),$.fn.dataTable.isDataTable("#previewTable")||$("#previewTable").DataTable({autoWidth:!0,scrollY:200,scrollX:500,scrollCollapse:!0,sScrollXInner:"100%",bInfo:!1,bRetrieve:!0,bProcessing:!0,bDestroy:!0,ordering:!1,orderCellsTop:!0,responsive:!0,colReorder:{fixedColumnsLeft:1},deferRender:!0,paging:!0,lengthMenu:[[1,5,50,-1],[1,5,50,"All"]],pageLength:50,dom:"lfBrtip",buttons:[],columnDefs:columnAlignmentDef}),$("#draftModal").modal("show")}else Swal.fire({icon:"warning",text:"No draft records exists!"})},error:function(){Swal.fire({icon:"warning",text:"No draft records exists!"})}}),$(this).attr("type","button")}));for(let i=0;i<createViewIdList.length;i++){const saveDraftButtonCreateForm=$(`#${createViewIdList[i]}_tab_content`).find('form button[name="submit"]');saveDraftButtonCreateForm.on("click",(function(event){const type=$(this).val();let currentUrl=window.location.pathname;if(item_code_list)for(let j=0;j<item_code_list.length;j++)currentUrl=`/users/${urlPath}/`+item_code_list[j][createViewIdList[i]]+"/";const dataTableId=$(this).attr("data-table-id"),dataEntry=$(this).attr("data-entry"),submitFormDraftUrl=currentUrl+"createDraft/"+dataEntry;"Save as Draft"===String(type)&&("New"===String($(this).attr("data-entry"))?$(this).attr("formaction",submitFormDraftUrl+"/id/"):"Existing"===String($(this).attr("data-entry"))&&$(this).attr("formaction",submitFormDraftUrl+"/"+dataTableId+"/")),$(this).attr("type","submit")}))}for(let i=0;i<createViewIdList.length;i++){const resetDraftButtonCreateForm=$(`#${createViewIdList[i]}_tab_content`).find('form button[name="resetDraft"]');resetDraftButtonCreateForm.off("click").on("click",(function(){const tabId=$(this).attr("id"),createViewId=tabId.substring(tabId.indexOf("_")+1),saveDraft=$(`#${createViewId}_tab_content`).find('form button[value="Save as Draft"]'),pastVal=saveDraft.attr("data-entry");let resetStatus="New";"New"===String(pastVal)&&(resetStatus="Existing"),$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"fetch_custom_messages",element_id:createViewIdList[i],message:"reset_draft_message"},type:"POST",dataType:"json",success:function(data){var text="Click 'Yes' to confirm or click 'No' if you do not wish to reset it.";data.data.custom_messages&&(text=data.data.custom_messages.message,icon=data.data.custom_messages.icon),resetAlert(text,icon)},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}});var resetAlert=(text,icon)=>{const confirmReset=null;iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"question",iconHtml:iconHtml,title:`Reset Draft Status: ${pastVal}  => ${resetStatus}.`,text:text,showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(result=>{result.isConfirmed?confirmReset=!0:result.isDenied&&(confirmReset=!1)}),confirmReset&&(saveDraft.attr("data-entry","New"),saveDraft.removeAttr("data-table-id")),$(this).attr("type","button")}}))}for(let i=0;i<createViewIdList.length;i++){const autoComputeBtn=$(`#autoCompute_${createViewIdList[i]}`);if(autoComputeBtn.length>0){const elementId=$(autoComputeBtn).attr("data-elementID"),computedValueList=[];let main_config_dict={},source_dict={};const valuesDic={},datatypeList=[];$("#createview"+elementId).find("div").find("form").find(".form-row").find('[data-computed-field="true"]').each((function(){computedValueList.push($(this).attr("id").replace("id_","").replace("_"+elementId,"")),main_config_dict[$(this).attr("id").replace("id_","").replace("_"+elementId,"")]=JSON.parse($(this).attr("data-comp_input"))}));const tableName=$(autoComputeBtn).attr("data-table-name").replace('["',"").replace('"]',"");var ctoken=$("form").find("input[name='csrfmiddlewaretoken']").attr("value");$.ajaxSetup({beforeSend:function(xhr,settings){xhr.setRequestHeader("X-CSRFToken",ctoken)}});for(let[col,config]of Object.entries(main_config_dict))for(let kk=0;kk<config.length;kk++)config[kk]in source_dict?source_dict[config[kk]].push(col):source_dict[config[kk]]=[col];for(let[key,value]of Object.entries(source_dict))$(`#id_${key}_${createViewIdList[i]}`).on("change dp.change",(function(){for(let i in value){let cols_list=main_config_dict[value[i]],allok="no";for(let ii=0;ii<cols_list.length;ii++){if(""==$(`#id_${cols_list[ii]}_${elementId}`).val()||null==$(`#id_${cols_list[ii]}_${elementId}`).val()||"---"==$(`#id_${cols_list[ii]}_${elementId}`).val()||"----"==$(`#id_${cols_list[ii]}_${elementId}`).val()){allok="no";break}allok="yes"}"yes"==allok&&($("#createview"+elementId).find("div").find("form").find(".form-row").find("input[data-field_name],select[data-field_name]").each((function(){let compVal=$(this).val();""===String(compVal)&&(compVal="NaN");const compCol=$(this).attr("id").replace("id_","").replace("_"+elementId,""),compDatatype=$(this).attr("datatype");valuesDic[compCol]=compVal,datatypeList.push(compDatatype)})),$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{element_id:elementId,operation:"calculate_computed_value_auto",values_dic:JSON.stringify(valuesDic),datatype_list:JSON.stringify(datatypeList),table_name:JSON.stringify(tableName),field_name:value[i]},type:"POST",dataType:"json",success:function(context){if("yes"===String(context.error_msg))for(let i=0;i<context.f_list.length;i++)Swal.fire({icon:"error",text:`Error while calculating : ${context.f_list[i]} - ${context.e_list[i]}`});else if(Object.keys(context.data[0]).includes(value[i])){let outputValue=context.data[0][value[i]];$("#id_"+value[i]+"_"+elementId).val(outputValue).trigger("change")}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}}))}}))}}function calVal(){const valuesDic={},elementId=$(this).attr("data-elementID"),datatypeList=[],tableName=$(this).attr("data-table-name").replace('["',"").replace('"]',""),computedValueList=[];let allOkFlag=1;$("#createview"+elementId).find("div").find("form").find(".form-row").find('[data-computed-field="true"]').each((function(){computedValueList.push($(this).attr("id").replace("id_","").replace("_"+elementId,""))})),$("#createview"+elementId).find("div").find("form").find(".form-row").find("input[data-field_name],select[data-field_name]").each((function(){let compVal=$(this).val();""===String(compVal)&&(compVal="NaN");const compCol=$(this).attr("id").replace("id_","").replace("_"+elementId,""),compDatatype=$(this).attr("datatype");valuesDic[compCol]=compVal,datatypeList.push(compDatatype)})),$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"find_comp_necessary_fields",table_name:JSON.stringify(tableName),comp_fields:JSON.stringify(computedValueList)},type:"POST",dataType:"json",success:function(context){if(Object.keys(context).length>0)for(let i=0;i<context.data.length;i++)""===$("#id_"+context.data[i]+"_"+elementId).val()&&(Swal.fire({icon:"warning",text:`kindly fill in the value in the field ${context.data[i]}.`}),allOkFlag=0);allOkFlag&&$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{element_id:elementId,operation:"calculate_computed_value",values_dic:JSON.stringify(valuesDic),datatype_list:JSON.stringify(datatypeList),table_name:JSON.stringify(tableName)},type:"POST",dataType:"json",success:function(context){if("yes"===String(context.error_msg))for(let i=0;i<context.f_list.length;i++)Swal.fire({icon:"error",text:`Error while calculating : ${context.f_list[i]} - ${context.e_list[i]}`});else for(const[key,value]of Object.entries(context.data[0]))for(let i=0;i<computedValueList.length;i++)String(key)===computedValueList[i]&&$("#id_"+computedValueList[i]+"_"+elementId).val(value).trigger("change")},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function HistoryViewTable(obj){const itemCode=windowLocation.split("/")[4],viewrtfcb_mode=obj.getAttribute("viewrtfcb_mode"),elementId=obj.getAttribute("data-elementid"),tableName=obj.getAttribute("data-table-name");let view_history_display_cols=obj.getAttribute("data_history_display_cols"),columnAlignment={},columnAlignmentDef=[];obj.getAttribute("data-column-alignment")?columnAlignment=JSON.parse(obj.getAttribute("data-column-alignment")):columnAlignmentDef.push({targets:"_all",className:"dt-center allColumnClass all"}),view_history_display_cols?(view_history_display_cols=JSON.parse(view_history_display_cols),view_history_display_cols=tableName in view_history_display_cols?view_history_display_cols[tableName]:[]):view_history_display_cols=[];const queryData={};let tableList=obj.getAttribute("data-table-name");if(tableList&&(tableList=tableList.startsWith("[")&&tableList.endsWith("]")?JSON.parse(tableList):[tableList]),obj.hasAttribute("data_history_cols")){let createQueryData=obj.getAttribute("data_history_cols");if("{}"!==String(createQueryData)){createQueryData=JSON.parse(createQueryData);for(const tname of tableList)if(Object.keys(createQueryData).includes(tname))if(createQueryData[tname].length>0)for(let rc=0;rc<createQueryData[tname].length;rc++){const field=createQueryData[tname][rc];if($(`#id_${field}_${elementId}[data-tablename='${tname}']`).length>0&&"none"!==String($(`#id_${field}_${elementId}[data-tablename='${tname}']`).css("display"))&&"none"!==String($(`#id_${field}_${elementId}[data-tablename='${tname}']`).closest(`#div_id_${field}`).css("display"))&&"none"!==String($(`#id_${field}_${elementId}[data-tablename='${tname}']`).closest(`#div_id_${field}`).parent().css("display"))){let rowVal=$(`#id_${field}_${elementId}[data-tablename='${tname}']`).val();rowVal||(rowVal="NULL"),rowVal&&(Object.prototype.hasOwnProperty.call(queryData,tname)||(queryData[tname]=[]),queryData[tname].push({column_name:field,condition:"Equal to",input_value:rowVal}))}else if($(`input[data-name='${field}']`).length>0&&"none"!==String($(`input[data-name='${field}']`).css("display"))){let rowVal=$(`input[data-name='${field}']`).val();rowVal||(rowVal="NULL"),rowVal&&(Object.prototype.hasOwnProperty.call(queryData,tname)||(queryData[tname]=[]),queryData[tname].push({column_name:field,condition:"Equal to",input_value:rowVal}))}else if("none"!==String($(`select[data-name='${field}']`).length>0&&$(`select[data-name='${field}']`).parent().css("display"))){let rowVal=$(`select[data-name='${field}']`).val();rowVal||(rowVal="NULL"),rowVal&&(Object.prototype.hasOwnProperty.call(queryData,tname)||(queryData[tname]=[]),queryData[tname].push({column_name:field,condition:"Equal to",input_value:rowVal}))}}else queryData[tname]=[];else queryData[tname]=[]}}const template=obj.getAttribute("data-template");$(`#createHistoryView${elementId}`).find(".card-header").find(".card-title").text("View History"),$.ajax({url:`/users/${urlPath}/${itemCode}/`,data:{create_form_data:JSON.stringify(queryData),element_id:elementId,operation:"create_history_view"},type:"POST",dataType:"json",success:function(data){const context=JSON.parse(data.context),verboseList=JSON.parse(data.verboseList);var columnsToDisplay=[];if(view_history_display_cols.length>0&&tableName in verboseList)for(let i in verboseList[tableName])view_history_display_cols.includes(verboseList[tableName][i])&&columnsToDisplay.push(i);let firstKey=Object.keys(context)[0],viewRejectedRecordsData="";if(context.hasOwnProperty(firstKey)&&(viewRejectedRecordsData=context[firstKey]),viewRejectedRecordsData.length>0){const firstRow=viewRejectedRecordsData[0];let tableHTML=`\n            <table id="createhistory_datatable_${firstKey}_${elementId}" class="createhistory_datatable row-border display">\n              <thead>\n                <tr>\n          `;if(columnsToDisplay.length>0)for(const key of Object.keys(firstRow))(columnsToDisplay.includes(key)||"Actions"==key)&&(tableHTML+=`<th>${key}</th>`);else for(const key of Object.keys(firstRow))tableHTML+=`<th>${key}</th>`;tableHTML+="\n                </tr>\n              </thead>\n              <tbody>\n          ";for(const dataRow of viewRejectedRecordsData){if(tableHTML+="<tr>",columnsToDisplay.length>0)for(const value in dataRow)(columnsToDisplay.includes(value)||"Actions"==value)&&("string"==typeof dataRow[value]&&dataRow[value].startsWith("[")?tableHTML+=`<td><button class="view_data_btn table_field_show_button" style="background-color: transparent; border: transparent;" onclick="showHistory_in_tabular.call(this)" data-json='${dataRow[value]}'>View Data</button></td>`:tableHTML+=`<td>${dataRow[value]}</td>`);else for(const value in dataRow)"string"==typeof dataRow[value]&&dataRow[value].startsWith("[")?tableHTML+=`<td><button class="view_data_btn table_field_show_button" style="background-color: transparent; border: transparent;" onclick="showHistory_in_tabular.call(this)" data-json='${dataRow[value]}'>View Data</button></td>`:tableHTML+=`<td>${dataRow[value]}</td>`;tableHTML+="</tr>"}tableHTML+="\n              </tbody>\n            </table>\n          ";const targetElement=$(`#createHistoryView${elementId}`).find(".card-body").find(".card-table_insertion");if(targetElement.empty(),targetElement.append(tableHTML),$(`#createhistory_datatable_${firstKey}_${elementId}`).find("tbody tr").each((function(){const firstCell=$(this).find("td:first-child"),linkContent=`<a data-toggle="tooltip" data-template="${template}" onclick="addTransactionToForm.call(this)" data-element-id="${elementId}" data-verboselist='${JSON.stringify(verboseList)}' class="create_history_edit" data-table-name='${firstKey}' title="Edit record" value="update"><i name="actions" value="Edit" class="fa fa-edit ihover javaSC thin-icon" style="font-size:15px"></i></a>`;firstCell.html(linkContent),$(this).find("td").each((function(){const cellContent=$(this).html();if(cellContent.startsWith("<")&&!cellContent.toLowerCase().startsWith("<a")){const buttonContent="True"===viewrtfcb_mode?`<button class="view_data_btn" style="background-color: transparent; border: transparent;" onclick="showRTFDataCreateView.call(this)" data-data="${cellContent.replace(/"/g,"&quot;")}">View Data</button>`:cellContent;$(this).html(buttonContent)}}))})),$(`#createhistory_datatable_${firstKey}_${elementId}`).find("tbody").find("td").addClass("view_details_wrap"),Object.keys(columnAlignment).length){let globalHeader=columnAlignment.global_header,globalContent=columnAlignment.global_content;if(columnAlignment.field_level_config)for(index in columnAlignmentDef=[],columnsToDisplay){var fieldName=columnsToDisplay[index];if(columnAlignment.field_level_config[fieldName]){var header=columnAlignment.field_level_config[fieldName].header,content=columnAlignment.field_level_config[fieldName].content;columnAlignmentDef.push({targets:[Number(index)],className:`dt-head-${header} dt-body-${content} allColumnClass all`})}else columnAlignmentDef.push({targets:[Number(index)],className:`dt-head-${globalHeader} dt-body-${globalContent} allColumnClass all`})}}columnAlignmentDef.push({targets:["_all"],className:"dt-center allColumnClass all"});var historyTable=$(`#createhistory_datatable_${firstKey}_${elementId}`).DataTable({autoWidth:!0,scrollY:"40vh",scrollX:"500vh",scrollCollapse:!0,sScrollXInner:"100%",bRetrieve:!0,bProcessing:!0,bDestroy:!0,orderCellsTop:!0,responsive:!0,colReorder:{fixedColumnsLeft:1},deferRender:!0,paging:!0,lengthMenu:[[1,5,50,-1],[1,5,50,"All"]],pageLength:50,dom:"lfBrtip",buttons:[],columnDefs:columnAlignmentDef}).columns.adjust();$(`#createHistoryView${elementId}`).css("display","block"),targetElement.css("display","block"),historyTable.columns.adjust()}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function addTransactionToForm(){const currentRow=$(this).closest("tr").find("td"),currentTable=$(this).attr("data-table-name");var verboseList=JSON.parse($(this).attr("data-verboselist")),template=$(this).attr("data-template"),elementId=$(this).attr("data-element-id");const constraintList=[];currentRow.each((function(){var currentVal=$(this).text();const button=document.querySelector(".view_data_btn");if("View Data"==currentVal&&button.classList.contains("table_field_show_button")&&"View Data"===button.innerHTML){const jsonData=button.getAttribute("data-json");currentVal=jsonData}let colName=$(this).closest("tbody").prev("thead").find("> tr > th").eq($(this).index()).text();if(Object.keys(verboseList[currentTable]).includes(colName)&&(colName=verboseList[currentTable][colName]),"Constraint"===String(template))"constraint_parameter"===colName?constraintList.push({col_name:colName,value:currentVal}):"constraint_parameter_value"===colName?constraintList.push({col_name:colName,value:currentVal}):($(`input[data-name='${colName}']`).val(currentVal).trigger("change"),setTimeout(()=>{$(`select[data-name='${colName}']`).val(currentVal).trigger("change"),$(`select[data-name='${colName}']`).val(currentVal).trigger("select2:select")},1e3));else if("Asset Grouping"===String(template))$(`input[data-name='${colName}']`).val(currentVal).trigger("change"),setTimeout(()=>{$(`select[data-name='${colName}']`).val(currentVal).trigger("change"),$(`select[data-name='${colName}']`).val(currentVal).trigger("select2:select")},1e3);else if("checkbox"===String($(`#id_${colName}_${elementId}`).attr("type")))$(`#id_${colName}_${elementId}`).prop("checked",!1),"True"!==String(currentVal)&&"on"!==String(currentVal)&&"1"!==String(currentVal)||$(`#id_${colName}_${elementId}`).prop("checked",!0);else if("text"===String($(`#${elementId}_unique[data-column='${colName}']`).attr("type")))if(currentVal&&currentVal.startsWith("{")&&currentVal.endsWith("}")){const multiData=JSON.parse(currentVal);$(`#${elementId}_unique[data-column='${colName}']`).click(),setTimeout((function(){$(`#masterTable${elementId}`).find("tbody").find(".io").prop("checked",!1),$(`#masterTable${elementId}`).find("tbody").find(".ioI").val(),$(`#masterTable${elementId}`).find("tbody").find("tr").each((function(){const currentRow=$(this).find("td").eq(-1).text();Object.keys(multiData).includes(currentRow)&&($(this).find("td").eq(0).find("input").prop("checked",!0),$(this).find("td").find(".ioI").val(multiData[currentRow]))})),$(`#formModal${elementId}`).find(".modal-footer").find(".savebutton").click()}),130)}else setTimeout((function(){$(`#masterTable${elementId}`).find("tbody").find(".io").prop("checked",!1),$(`#masterTable${elementId}`).find("tbody").find(".ioI").val(),$(`#formModal${elementId}`).find(".modal-footer").find(".savebutton").click()}),130);else if($(`#id_${colName}_${elementId}[data-tablename='${currentTable}']`).hasClass("select2")){$(`#id_${colName}_${elementId}[data-tablename='${currentTable}']`).val(currentVal).trigger("select2:select");try{$(`#id_${colName}_${elementId}[data-tablename='${currentTable}']`).val(currentVal).trigger("change")}catch(err){}}else if($(`#id_${colName}_${elementId}[data-tablename='${currentTable}']`).parent().find("p[title='RTF editor']").length>0){if(currentVal){const dataToSet=$(this).find("button").length?$(this).find("button").attr("data-data"):$(this).html();$(`#id_${colName}_${elementId}[data-tablename='${currentTable}']`).parent().find("p[title='RTF editor']").attr("data-data",dataToSet),$(`#id_${colName}_${elementId}[data-tablename='${currentTable}']`).val($(this).find("button").attr("data-data"))}}else $(`#id_${colName}_${elementId}[data-tablename='${currentTable}']`).val(currentVal).trigger("change")})),constraintList.length>0&&"Constraint"===String(template)&&(setTimeout((function(){$(".constraint_row_column").val(constraintList[0].value).trigger("select2:select"),$(".constraint_row_column").val(constraintList[0].value).trigger("change")}),1200),setTimeout((function(){$(".constraint_row_value").val(constraintList[1].value).trigger("select2:select"),$(".constraint_row_value").val(constraintList[1].value).trigger("change")}),1600))}function ViewRejectedEntryTable(obj){const itemCode=windowLocation.split("/")[4],elementID=obj.getAttribute("data-elementid"),viewrtfcb_mode=obj.getAttribute("viewrtfcb_mode"),tableName=obj.getAttribute("data-table-name");let view_rejected_records_display_cols=obj.getAttribute("data_rejected_records_display_cols"),tableList=obj.getAttribute("data-table-name"),columnAlignment={},columnAlignmentDef=[];view_rejected_records_display_cols?(view_rejected_records_display_cols=JSON.parse(view_rejected_records_display_cols),view_rejected_records_display_cols=tableName in view_rejected_records_display_cols?view_rejected_records_display_cols[tableName]:[]):view_rejected_records_display_cols=[],obj.getAttribute("data-column-alignment")?columnAlignment=JSON.parse(obj.getAttribute("data-column-alignment")):columnAlignmentDef.push({targets:"_all",className:"dt-center allColumnClass all"}),tableList&&(tableList.startsWith("[")||tableList.endsWith("]")||(tableList=JSON.stringify([tableList])));const template=obj.getAttribute("data-template");$(`#createHistoryView${elementID}`).find(".card-header").find(".card-title").text("View Rejected Records"),$.ajax({url:`/users/${urlPath}/${itemCode}/`,data:{table_list:tableList,element_id:elementID,operation:"create_view_rejected_entries"},type:"POST",dataType:"json",success:function(data){if(data.Error)Swal.fire({icon:"error",text:"Error! Workflow cannot be executed. Please check the workflow configuration."});else{let context=JSON.parse(data.context),verboseList=JSON.parse(data.verboseList),commentList=JSON.parse(data.commentList),firstKey=Object.keys(context)[0],viewRejectedRecordsData="";var columnsToDisplay_Rejected=[];if(view_rejected_records_display_cols.length>0&&tableName in verboseList)for(let i in verboseList[tableName])view_rejected_records_display_cols.includes(verboseList[tableName][i])&&columnsToDisplay_Rejected.push(i);if(context.hasOwnProperty(firstKey)&&(viewRejectedRecordsData=context[firstKey]),viewRejectedRecordsData.length>0){const firstRow=viewRejectedRecordsData[0];let tableHTML=`\n              <table id="createhistory_datatable_${firstKey}_${elementID}" class="createhistory_datatable row-border display" style="width:100%;">\n                <thead>\n                  <tr>\n            `;if(columnsToDisplay_Rejected.length>0)for(const key of Object.keys(firstRow))(columnsToDisplay_Rejected.includes(key)||"Actions"==key||"Rejected By"==key||"Comment"==key)&&(tableHTML+=`<th>${key}</th>`);else for(const key of Object.keys(firstRow))tableHTML+=`<th>${key}</th>`;tableHTML+="\n                  </tr>\n                </thead>\n                <tbody>\n            ";for(const dataRow of viewRejectedRecordsData){if(tableHTML+="<tr>",columnsToDisplay_Rejected.length>0)for(const value in dataRow)(columnsToDisplay_Rejected.includes(value)||"Actions"==value||"Rejected By"==value||"Comment"==value)&&("string"==typeof dataRow[value]&&dataRow[value].startsWith("[")?tableHTML+=`<td><button class="view_data_btn table_field_show_button" style="background-color: transparent; border: transparent;" onclick="showRejected_in_tabular.call(this)" data-json='${dataRow[value]}'>View Data</button></td>`:tableHTML+=`<td>${dataRow[value]}</td>`);else for(const value in dataRow)"string"==typeof dataRow[value]&&dataRow[value].startsWith("[")?tableHTML+=`<td><button class="view_data_btn table_field_show_button" style="background-color: transparent; border: transparent;" onclick="showRejected_in_tabular.call(this)" data-json='${dataRow[value]}'>View Data</button></td>`:tableHTML+=`<td>${dataRow[value]}</td>`;tableHTML+="</tr>"}tableHTML+="\n                </tbody>\n              </table>\n            ";const targetElement=$(`#createHistoryView${elementID}`).find(".card-body").find(".card-table_insertion");if(targetElement.empty(),targetElement.append(tableHTML),$(`#createhistory_datatable_${firstKey}_${elementID}`).find("tbody tr").each((function(){const firstCell=$(this).find("td:first-child"),linkContent=`<a data-toggle="tooltip" data-template="${template}" onclick="addTransactionToForm.call(this)" data-element-id="${elementID}" data-verboselist='${JSON.stringify(verboseList)}' class="create_history_edit" data-table-name='${firstKey}' title="Edit record" value="update"><i name="actions" value="Edit" class="fa fa-edit ihover javaSC thin-icon" style="font-size:15px"></i></a>`;firstCell.html(linkContent),$(this).find("td").each((function(){const cellContent=$(this).html();if(cellContent.startsWith("<")&&!cellContent.toLowerCase().startsWith("<a")){const buttonContent="True"===viewrtfcb_mode?`<button class="view_data_btn" style="background-color: transparent; border: transparent;" onclick="showRTFDataCreateView.call(this)" data-data="${cellContent.replace(/"/g,"&quot;")}">View Data</button>`:cellContent;$(this).html(buttonContent)}}))})),Object.keys(commentList).length>0)for(const tab in commentList)if(commentList[tab].length>0)for(let i=0;i<commentList[tab].length;i++)$(`#createhistory_datatable_${tab}_${elementID}`).find("tbody").find("tr").eq(i).find("td").eq(-1).html(`<p style='word-break: break-all;white-space: pre-wrap;'>${commentList[tab][i]}</p>`);$(`#createhistory_datatable_${firstKey}_${elementID}`).find("tbody").find("td").addClass("view_details_wrap");var fieldArray=[];for(let[k,v]of Object.entries(verboseList[firstKey]))$(`#createhistory_datatable_${firstKey}_${elementID} > thead > tr > th`).each((function(){$(this).text().trim()==k.trim()&&fieldArray.push(v)}));if(fieldArray.push("Rejected By"),fieldArray.push("Comment"),Object.keys(columnAlignment).length){let globalHeader=columnAlignment.global_header,globalContent=columnAlignment.global_content;if(columnAlignment.field_level_config)for(index in columnAlignmentDef=[],columnsToDisplay_Rejected){var fieldName=columnsToDisplay_Rejected[index];if(columnAlignment.field_level_config[fieldName]){var header=columnAlignment.field_level_config[fieldName].header,content=columnAlignment.field_level_config[fieldName].content;columnAlignmentDef.push({targets:[Number(index)],className:`dt-head-${header} dt-body-${content} allColumnClass all`})}else columnAlignmentDef.push({targets:[Number(index)],className:`dt-head-${globalHeader} dt-body-${globalContent} allColumnClass all`})}}columnAlignmentDef.push({targets:["_all"],className:"dt-center allColumnClass all"}),$(`#createhistory_datatable_${firstKey}_${elementID}`).DataTable({autoWidth:!0,scrollY:"200vh",scrollX:!0,scrollCollapse:!0,sScrollXInner:"100%",bInfo:!1,bRetrieve:!0,bProcessing:!0,bDestroy:!0,ordering:!0,orderCellsTop:!0,responsive:!0,colReorder:{fixedColumnsLeft:1},deferRender:!0,paging:!0,lengthMenu:[[1,5,50,-1],[1,5,50,"All"]],pageLength:50,dom:"lfBrtip",buttons:[],columnDefs:columnAlignmentDef}).columns.adjust(),$(`#createHistoryView${elementID}`).css("display","block"),targetElement.css("display","block")}}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function showFieldInfo(obj){const elementId=$(obj).attr("data-id");var dataList=$(obj).attr("data-col"),text=$(obj).parent().find("input, select, textarea").val(),extractedValues=JSON.parse(dataList),masterColumn=extractedValues.column,linkedTable=extractedValues.linkedTable,linkedColumn=extractedValues.linkedTableColumn,addlinkedColumn=JSON.stringify(extractedValues.linkedAddColumns);$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"hyperLinkingTables",value:text,masterColumn:masterColumn,linkedTable:linkedTable,linkedColumn:linkedColumn,addlinkedColumn:addlinkedColumn},type:"POST",dataType:"json",success:function(data){if(0!=data.data.length){$(`#show_info_header${elementId}`).empty(),$(`#show_info_header${elementId}`).append(`<h5 class="modal-title">${linkedTable}</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>`);var data=data.data;$(`#show_info_body${elementId}`).empty(),$(`#show_info_body${elementId}`).append(`\n            <table id="exampledata${elementId}">\n                <thead>\n                    <tr>\n                    </tr>\n                </thead>\n                <tbody>\n                </tbody>\n            </table>\n            `);for(var i=0;i<data.length;i++){string="<tr>";for(let[key,value]of Object.entries(data[i]))string+=`<td>${value}</td>`;string+="</tr>",$(`#exampledata${elementId}`).find("tbody").append(string)}for(let[key,value]of Object.entries(data[0]))$(`#exampledata${elementId}`).find("thead tr").eq(0).append(`<th>${key}</th>`);$(`#show_info_${elementId}`).modal("show"),$(`#exampledata${elementId}`).DataTable()}else Swal.fire({icon:"error",text:"No Records found!"})},failure:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function formatState(state){if(!state.id)return state.text;var $state=$("<span onclick='showFieldPopup(this)' ><span></span></span>");return $state.find("span").text(state.text),$state}function showFieldPopup(obj){const elementId=$(obj).parent().parent().parent().parent().parent().parent().find("select").attr("data-id");var dataList=$(obj).parent().parent().parent().parent().parent().parent().find("select").attr("data-table"),text=$(obj).text(),extractedValues=JSON.parse(dataList),masterColumn=$(obj).parent().parent().parent().parent().parent().parent().find("select").attr("data-master"),linkedTable=extractedValues.linkedTable,linkedColumn=extractedValues.linkedColumn,addlinkedColumn=JSON.stringify(extractedValues.linkedAddColumns);$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"hyperLinkingTables",value:text,masterColumn:masterColumn,linkedTable:linkedTable,linkedColumn:linkedColumn,addlinkedColumn:addlinkedColumn},type:"POST",dataType:"json",success:function(data){if(0!=data.data.length){$(`#show_info_header${elementId}`).empty(),$(`#show_info_header${elementId}`).append(`<h5 class="modal-title">${linkedTable}</h5>\n        <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n          <span aria-hidden="true">&times;</span>\n        </button>`);var data=data.data;$(`#show_info_body${elementId}`).empty(),$(`#show_info_body${elementId}`).append(`\n            <table id="exampledata${elementId}">\n                <thead>\n                    <tr>\n                    </tr>\n                </thead>\n                <tbody>\n                </tbody>\n            </table>\n            `);for(var i=0;i<data.length;i++){string="<tr>";for(let[key,value]of Object.entries(data[i]))string+=`<td>${value}</td>`;string+="</tr>",$(`#exampledata${elementId}`).find("tbody").append(string)}for(let[key,value]of Object.entries(data[0]))$(`#exampledata${elementId}`).find("thead tr").eq(0).append(`<th>${key}</th>`);$(`#show_info_${elementId}`).modal("show"),$(`#exampledata${elementId}`).DataTable()}else Swal.fire({icon:"error",text:"No Records found!"});$(obj).parent().parent().parent().parent().parent().parent().find("select").select2("close")},failure:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function concatenationField(event){var singleField=event.data,singleCardColumns=$(singleField).attr("data-concatfield"),singleCardDivider=$(singleField).attr("data-divider"),parsedSingleCardColumns=JSON.parse(singleCardColumns),elementId=$(singleField).attr("data-id"),val="";for(let p in parsedSingleCardColumns){if(""==$("#id_"+parsedSingleCardColumns[p]+"_"+elementId).val()){allOkFlag=0;break}allOkFlag=1,val+=`${$("#id_"+parsedSingleCardColumns[p]+"_"+elementId).val()}${singleCardDivider}`}1==allOkFlag&&$(singleField).val(val.slice(0,-1)).trigger("change")}for(let i=0;i<createViewIdList.length;i++){var conCatfields=$(`#${createViewIdList[i]}_tab_content`).find("[data-concatfield]");if(conCatfields.length>0)for(let k=0;k<conCatfields.length;k++){var singleField=$(conCatfields).eq(k),singleCardColumns=$(singleField).attr("data-concatfield"),singleCardDivider=$(singleField).attr("data-divider"),parsedSingleCardColumns=JSON.parse(singleCardColumns),allOkFlag=1;for(let p in parsedSingleCardColumns)$("#id_"+parsedSingleCardColumns[p]+"_"+createViewIdList[i]).change(singleField,concatenationField)}}function flowUICreator(elementsArray,container,element_id,data,configs){var count=0;for(let k in elementsArray)"nodes"==elementsArray[k].group&&(elementsArray[k].data.id in configs&&(elementsArray[k].data.text=configs[elementsArray[k].data.id]),count++);if(count>=5&&container.css("height","20rem"),"inside"==configs.shapes_options_text)var styles={shape:configs.shapes_options,label:"data(text)","text-valign":"center","font-size":configs["font-size"],color:configs["font-color"],width:configs.shape_width,height:configs.shape_height,"text-wrap":"wrap","text-max-width":`${String(configs.shape_width)}px`};else var styles={shape:configs.shapes_options,label:"data(text)","font-size":configs["font-size"],color:configs["font-color"],width:configs.shape_width,height:configs.shape_height,"text-wrap":"wrap","text-max-width":`${String(configs.shape_width)}px`};var cy=cytoscape({container:container,zoomingEnabled:!1,userZoomingEnabled:!1,elements:elementsArray,style:[{selector:"node",style:styles},{selector:"edge",style:{width:1}}],layout:{name:"dagre",rankDir:"LR",padding:10,spacingFactor:1.25,fit:!0,nodeDimensionsIncludeLabels:!0,avoidOverlap:!0,pan:{x:200,y:100}}});null!=data?cy.nodes().forEach((function(ele,i,eles){for(let k in data)data[k].element_id==ele.id()&&"Pass"==data[k].current_status&&ele.css("background-color","#4bb543")})):(flag=!0,cy.nodes().forEach((function(ele,i,eles){flag&&ele.css("background-color","#4bb543"),element_id==ele.id()&&(flag=!1)})))}function processDesignDiv_createview(obj){var eleId=$(obj).attr("data-id");if($(obj).parent().parent().find(".processflowdiv").toggleClass("displaynone"),!1===$(obj).parent().parent().find(".processflowdiv").hasClass("displaynone"))if($(obj).prev().find(".stepper-wrapper").empty(),null!=$(obj).attr("data-trans")){if(""!=$(obj).attr("data-trans")){var trans_code=$(obj).attr("data-trans"),flag=!0;trans_code.startsWith("[")?(trans_code=(trans_code=JSON.parse(trans_code))[0],flag=!0):"NULL"==trans_code&&(trans_code="",flag=!1),flag&&$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"fetch_process_flow_model_trans",trans_code:trans_code},type:"POST",dataType:"json",success:function(data){flowUICreator(data.data,$(obj).closest(".modal-body").find(".processflowdiv"),eleId,data.flow,JSON.parse($(obj).attr("data-list")))},failure:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}}else $.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"fetch_process_flow_model_xml",sub_pr_code:$(obj).attr("data-sub-process"),pr_code:$(obj).attr("data-process")},type:"POST",dataType:"json",success:function(data){flowUICreator(data.elements_list,$(obj).closest(".card-body").find(".processflowdiv"),eleId,void 0,JSON.parse($(obj).attr("data-list")))},failure:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}});$(obj).toggleClass("rotate")}function boolean_slider_onchange(obj,id,slide,bgColor_notSelected,bgColor_Selected){"yes"==slide?($(id).prop("checked",!0),$(obj).next().css("color",bgColor_Selected),$(obj).closest(".radioGroup").find(".no_bool").next().css("color",`${bgColor_notSelected}`)):($(id).prop("checked",!1),$(obj).next().css("color",bgColor_Selected),$(obj).closest(".radioGroup").find(".yes_bool").next().css("color",`${bgColor_notSelected}`))}function charfield_field_type_settings_onchange(obj,id,val,bg_selcted,not_bg_selected){$(`#${id}`).val(val).trigger("change"),$(obj).closest(".charfield_field_type_settings").find("label").css("color",`${not_bg_selected}`),$(obj).next().css("color",`${bg_selcted}`)}