if("undefined"!==String($("form").find("input[name='csrfmiddlewaretoken']").attr("value"))){const ctoken=$("form").find("input[name='csrfmiddlewaretoken']").attr("value");"undefined"!==String(ctoken)&&$.ajaxSetup({beforeSend:function(xhr,settings){xhr.setRequestHeader("X-CSRFToken",ctoken)}})}var mentions_user_list=[],modify_column={},edited_data={},parsed_json_data=[],transaction_data_to_edit={},result_data={},all_users_list={},freeze_comments_option=!1,search_in_comments_cols,display_in_comments_cols,all_comments_resolved=!1,all_comments_reopened=!1,resolved_ind_comments_list=[],resolve_all_comments,reopen_all_comments,resolve_individual_comments,reopen_individual_comments,allowed_rejection,allowed_approval,allowed_edit,allowed_resend,allowed_delegate,originalVerboseColumnNames,elementIDData,elementID,primaryKeyId,tableName,datatableDict={},fDict2={},cellIndex,cellColLen,formatConfigD1={};let historyViewTemplate;const saveState={};let saveListview;function masterBaseDataFilter(elementTableIDList,elementPage){$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"readListview",element_id:elementTableIDList[0]},type:"POST",dataType:"json",success:function(data){const data1=JSON.parse(data.data[0]);if(saveListview=data1,"undefined"!==String(document.getElementById("form1"))){const ctoken=$("form").find("input[name='csrfmiddlewaretoken']").attr("value");$.ajaxSetup({beforeSend:function(xhr,settings){xhr.setRequestHeader("X-CSRFToken",ctoken)}})}$('a[data-toggle="tab"]').on("shown.bs.tab",(function(){$($.fn.dataTable.tables(!0)).DataTable().columns.adjust()}));for(const i in elementTableIDList){var listViewElementId=elementTableIDList[i];listViewRenderHandler(listViewElementId,elementTableIDList.indexOf(listViewElementId),elementPage)}function funn(elementID){$(`#masterListTablei${elementTabID}`).DataTable({autoWidth:!0,scrollY:"100%",scrollCollapse:!0,scrollX:"110%",orderCellsTop:!0,responsive:!0,colReorder:{fixedColumnsLeft:1},deferRender:!0,paging:!0,lengthMenu:[[1,5,50,-1],[1,5,50,"All"]],stripeClasses:!1,pageLength:50,dom:"lfBrtip",sScrollX:"100%",buttons:[{extend:"collection",text:"Export",buttons:[{extend:"copy",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"excel",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"csv",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"pdf",title:"",exportOptions:{columns:":visible:not(.noVis)"}}]},{extend:"colvis",className:"scroller"}],columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"},{targets:0,width:"20%",className:"noVis"}]})}$(".table").on("click",".remove_filter",(function(){const whichtr=$(this).closest("tr");whichtr.remove()}))},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function listViewRenderHandler(elementTabID,i,elementPage){var pagination=elementPage[i],paginationInt=[],table;isAll=!1;for(let i in pagination)"All"==pagination[i]?(paginationInt.push(-1),isAll=!0):paginationInt.push(parseInt(pagination[i]));paginationInt.sort((function(a,b){return a-b})),isAll?(paginationInt.shift(),paginationInt.push(-1),(pagination=[...paginationInt])[pagination.length-1]="All"):pagination=paginationInt,saveState[elementTabID]=0,originalVerboseColumnNames=Array.from(listViewTableDict[elementTabID].original_verbose_column_names);var renamed_columns_names=listViewTableDict[elementTabID].renamed_columns_list,dataContainingColumnNames=Array.from(listViewTableDict[elementTabID].dataContainingColumnNames);const allowEditColAlign=listViewTableDict[elementTabID].allowEditColAlign;let allowEditColConfig=listViewTableDict[elementTabID].allowEditColConfig,restcol=listViewTableDict[elementTabID].rest_cols;var list_table_header_config=listViewTableDict[elementTabID].list_table_header_config;function getHeader(arr,obj){let header=[],subheader=[];for(let item in obj)header.push(item);for(let i=0;i<header.length;i++)for(let j=0;j<obj[header[i]].length;j++)subheader.push(obj[header[i]][j]);let finalObj={};for(let i=0;i<arr.length;i++)finalObj[arr[i].data]=arr[i].data;let tableData={};for(let item in finalObj)for(let key in obj)obj[key].includes(item)?tableData[key]=obj[key]:tableData[item]=[finalObj[item]];for(let i=0;i<subheader.length;i++){let cond;tableData.hasOwnProperty(subheader[i])&&delete tableData[subheader[i]]}return tableData}list_table_header_config=getHeader(dataContainingColumnNames,list_table_header_config);let tableModelName=listViewTableDict[elementTabID].model_name;$(`#example1${elementTabID}`).find("thead tr").empty();const thead=$(`#example1${elementTabID}`).find("thead tr");$("<tr class='table-header'></tr>").insertBefore(thead);const thead1=$(`#example1${elementTabID}`).find("thead tr.table-header"),tfoot=$(`#example1${elementTabID}`).find("tfoot tr");let allCol_width_def=[{render:function(data,type,full,meta){return $(`#${meta.settings.sInstance}`).hasClass("card-view-template")?"string"==typeof data||data instanceof String?data.includes("<td>")?data:"<div>"+data+"</div>":data:"string"==typeof data||data instanceof String?data.includes("<td>")?data:"<div style='white-space: normal;width: 100%;'>"+data+"</div>":data}},{targets:0,width:"20%",className:"noVis dt-center"}];if($(`#group_by_switch_user_configuration_${elementTabID}`).length>0&&"None"!=$(`#group_by_switch_user_configuration_${elementTabID}`).attr("data-list2")&&""!=$(`#group_by_switch_user_configuration_${elementTabID}`).attr("data-list2")){var user_config=JSON.parse($(`#group_by_switch_user_configuration_${elementTabID}`).attr("data-list2"));dataContainingColumnNames=[];for(let b in user_config.levels)dataContainingColumnNames.push({data:user_config.levels[b]});for(let b in user_config.selected_columns)dataContainingColumnNames.push({data:user_config.selected_columns[b]})}if(0===Object.keys(list_table_header_config).length)if("data-list-group-by"==$(`#example1${elementTabID}`).attr("data-list-group-by")||"data-list-group-by"==$(`#example1${elementTabID}`).attr("data-list-group-by1")){dataContainingColumnNames.unshift({title:"",className:"treegrid-control  dt-center allColumnClass all",data:function(item){return item.children?'<i class="fa-solid fa-plus ihover javaSC"></i>':""}});for(let i=0;i<dataContainingColumnNames.length;i++)dataContainingColumnNames[i].data in renamed_columns_names?($(`<th orginal-name="${dataContainingColumnNames[i].data}">${renamed_columns_names[dataContainingColumnNames[i].data]}</th>`).appendTo(thead),$(`<th orginal-name="${dataContainingColumnNames[i].data}">${renamed_columns_names[dataContainingColumnNames[i].data]}</th>`).appendTo(tfoot)):($(`<th orginal-name="${dataContainingColumnNames[i].data}">${dataContainingColumnNames[i].data}</th>`).appendTo(thead),$(`<th orginal-name="${dataContainingColumnNames[i].data}">${dataContainingColumnNames[i].data}</th>`).appendTo(tfoot))}else if(allowEditColAlign&&allowEditColConfig.length>0){for(let i=0;i<dataContainingColumnNames.length;i++)dataContainingColumnNames[i].data in renamed_columns_names?($(`<th class="${dataContainingColumnNames[i].data}" orginal-name="${dataContainingColumnNames[i].data}">${renamed_columns_names[dataContainingColumnNames[i].data]}</th>`).appendTo(thead),$(`<th class="${dataContainingColumnNames[i].data}" orginal-name="${dataContainingColumnNames[i].data}">${renamed_columns_names[dataContainingColumnNames[i].data]}</th>`).appendTo(tfoot)):($(`<th class="${dataContainingColumnNames[i].data}" orginal-name="${dataContainingColumnNames[i].data}">${dataContainingColumnNames[i].data}</th>`).appendTo(thead),$(`<th class="${dataContainingColumnNames[i].data}" orginal-name="${dataContainingColumnNames[i].data}">${dataContainingColumnNames[i].data}</th>`).appendTo(tfoot));for(let ii=0;ii<allowEditColConfig.length;ii++)allCol_width_def.push({targets:allowEditColConfig[ii].target,className:allowEditColConfig[ii].body}),allCol_width_def.push({targets:allowEditColConfig[ii].target,className:allowEditColConfig[ii].header});allCol_width_def.push({targets:restcol,className:"dt-center"}),allCol_width_def.push({targets:"_all",className:"allColumnClass all"})}else{for(let i=0;i<dataContainingColumnNames.length;i++)dataContainingColumnNames[i].data in renamed_columns_names?($(`<th orginal-name="${dataContainingColumnNames[i].data}">${renamed_columns_names[dataContainingColumnNames[i].data]}</th>`).appendTo(thead),$(`<th orginal-name="${dataContainingColumnNames[i].data}">${renamed_columns_names[dataContainingColumnNames[i].data]}</th>`).appendTo(tfoot)):($(`<th orginal-name="${dataContainingColumnNames[i].data}">${dataContainingColumnNames[i].data}</th>`).appendTo(thead),$(`<th orginal-name="${dataContainingColumnNames[i].data}">${dataContainingColumnNames[i].data}</th>`).appendTo(tfoot));allCol_width_def.push({targets:"_all",className:"dt-center allColumnClass all"})}else{for(let item in list_table_header_config)if(1==list_table_header_config[item].length)list_table_header_config[item][0]in renamed_columns_names&&(list_table_header_config[item][0]=renamed_columns_names[list_table_header_config[item][0]]),$(`<th rowspan="2">${list_table_header_config[item][0]}</th>`).appendTo(thead1);else{$(`<th  colspan="${list_table_header_config[item].length}" style="border-right:1px solid rgba(0, 0, 0, 0.15);border-left:1px solid rgba(0, 0, 0, 0.15);text-align:center">${item}</th>`).appendTo(thead1);for(let j=0;j<list_table_header_config[item].length;j++)list_table_header_config[item][j]in renamed_columns_names&&(list_table_header_config[item][j]=renamed_columns_names[list_table_header_config[item][0]]),$(`<th>${list_table_header_config[item][j]}</th>`).appendTo(thead)}for(let i=0;i<dataContainingColumnNames.length;i++)$(`<th>${dataContainingColumnNames[i].data}</th>`).appendTo(tfoot);allCol_width_def.push({targets:restcol,className:"dt-center"}),allCol_width_def.push({targets:"_all",className:"allColumnClass all"})}var buttonTitleRow=$(`#title_row_formatting_${elementTabID}`),attrData;if(buttonTitleRow.length>0)if(""==(attrData=$(buttonTitleRow).attr("data-list"))||"{}"==attrData);else{var parsedAttrdata,font1=(parsedAttrdata=JSON.parse(attrData)).main.font,fontSize=parsedAttrdata.main.fontSize;if(font1&&fontSize){var fontIndex=font1.indexOf("_"),font2=font1.slice(0,fontIndex),font3=font1.slice(fontIndex+1);$(thead).parent().css("font-size",fontSize),$(thead).parent().css("font-family",`${font2} , ${font3}`),$(thead).find("th").each((function(){if(0===Object.keys(parsedAttrdata.exception).length)$(this).css({color:parsedAttrdata.main.textColor,"background-color":parsedAttrdata.main.bgColor});else{$(this).css({color:parsedAttrdata.main.textColor,"background-color":parsedAttrdata.main.bgColor});for(let i in parsedAttrdata.exception)$(this).html()==i&&$(this).css({color:parsedAttrdata.exception[i].textColor,"background-color":parsedAttrdata.exception[i].bgColor})}}))}}var columnsHiddenTitleRow=$(`#column_hidden_config_${elementTabID}`),attrData;if(columnsHiddenTitleRow.length>0)if(""==(attrData=$(columnsHiddenTitleRow).attr("data-list"))||"{}"==attrData);else{var parsedAttrdata=JSON.parse(attrData);for(let l in parsedAttrdata)$(thead).find("th").each((function(){$(this).html()==parsedAttrdata[l]&&$(this).css("color","rgba(0,0,0,0)")}))}tableModelName=listViewTableDict[elementTabID].model_name;var drop_down_button=$(`#drop_down_button_grouping${elementTabID}`);if(drop_down_button.length>0){var attrData=JSON.parse(drop_down_button.attr("data-list"));for(let j in attrData.dropDown)if($(`#${attrData.dropDown[j]}${elementTabID}`).length>0){var cloneHtml=$(`#${attrData.dropDown[j]}${elementTabID}`).html();$(`#${attrData.dropDown[j]}${elementTabID}`).css("display","none"),drop_down_button.parent().parent().find(".sortable-order").append(`<button class="btn btn-sm btn-primary col-9" onclick="buttonGroupingCall('#${attrData.dropDown[j]}${elementTabID}')">${cloneHtml}</button>`)}}function call(){return"Multi Dropdown View"==temp_type?`/users/${urlPath}/get_datatable_data/`+elementTabID+"/"+tableModelName+"/"+view_name+"/":`/users/${urlPath}/get_datatable_data/`+elementTabID+"/"+tableModelName+"/viewname/"}function quickFilters(element){var mainDiv=$(`#quickFiltersDiv${element.replace("example1","")}`);if(mainDiv.length>0){var filters=mainDiv.children(),filterPrams={};for(let i=0;i<filters.length;i++){var filterVals={};"select_field"==$(filters).eq(i).attr("data-div")?filterVals[$(filters).eq(i).find("select").attr("data-column")]=$(filters).eq(i).find("select").attr("data-val"):"multi_select"==$(filters).eq(i).attr("data-div")?filterVals[$(filters).eq(i).find("select").attr("data-column")]=$(filters).eq(i).find("select").val():"DateField"==$(filters).eq(i).attr("data-div")?filterVals[$(filters).eq(i).find(".dtrangepicker").attr("data-column")]=$(filters).eq(i).find(".dtrangepicker").attr("data-val"):"TimeField"==$(filters).eq(i).attr("data-div")?"true"==$(filters).eq(i).attr("data-sec")?filterVals[$(filters).eq(i).find(".ttrangepicker").attr("data-column")]=$(filters).eq(i).find(".ttrangepicker").attr("data-val"):filterVals[$(filters).eq(i).find(".ttrangepicker_sec").attr("data-column")]=$(filters).eq(i).find(".ttrangepicker_sec").attr("data-val"):"DateTimeRangeField"==$(filters).eq(i).attr("data-div")?filterVals[$(filters).eq(i).find(".dttrangepicker").attr("data-column")]=$(filters).eq(i).find(".dttrangepicker").attr("data-val"):"DateRangeField"==$(filters).eq(i).attr("data-div")?filterVals[$(filters).eq(i).find(".dtrangepicker").attr("data-column")]=$(filters).eq(i).find(".dtrangepicker").attr("data-val"):"DateTimeField"==$(filters).eq(i).attr("data-div")?"true"==$(filters).eq(i).attr("data-sec")?filterVals[$(filters).eq(i).find(".dttrangepicker").attr("data-column")]=$(filters).eq(i).find(".dttrangepicker").attr("data-val"):filterVals[$(filters).eq(i).find(".dttrangepicker_sec").attr("data-column")]=$(filters).eq(i).find(".dttrangepicker_sec").attr("data-val"):"TimeRangeField"==$(filters).eq(i).attr("data-div")?filterVals[$(filters).eq(i).find(".ttrangepicker").attr("data-column")]=$(filters).eq(i).find(".ttrangepicker").attr("data-val"):"range_field"==$(filters).eq(i).attr("data-div")?filterVals[$(filters).eq(i).find(".js-range-slider").attr("data-column")]=$(filters).eq(i).find(".js-range-slider").attr("data-val"):"booleanField"==$(filters).eq(i).attr("data-div")&&(filterVals[$(filters).eq(i).find(".radioGroup").attr("data-column")]=$(filters).eq(i).find(".radioGroup").attr("data-val")),$(filters).eq(i).attr("data-div")in filterPrams?Object.assign(filterPrams[$(filters).eq(i).attr("data-div")],filterVals):Object.assign(filterPrams,{[$(filters).eq(i).attr("data-div")]:filterVals})}return Object.keys(filterPrams).length>0?JSON.stringify(filterPrams):"null"}return"null"}function reportingParametersExtractor(element){if(["Reporting View","List View With History","Approval Template"].includes(templateType)){let reportingParameterContainer=$(`#tableTab${element.replace("example1","")}`),selectedParameters={};return reportingParameterContainer.find("select").each((function(){selectedParameters[$(this).attr("data-parameter-name")]=$(this).val()})),JSON.stringify(selectedParameters)}return null}$(`#example1${elementTabID} thead tr`).eq(0).find("th").eq(0).css("cursor","default","tfoot"),$(`#example1${elementTabID} thead tr`).eq(0).find("th").eq(0).css("background-image","none"),$(`#example1${elementTabID} tfoot tr`).eq(0).find("th").eq(0).css("cursor","default","tfoot"),$(`#example1${elementTabID} tfoot tr`).eq(0).find("th").eq(0).css("background-image","none"),temp_type=$(`#${elementTabID}_tab_content`).attr("data-template-type"),"Multi Dropdown View"==temp_type&&(view_name=$(`#tableTab${elementTabID}`).find("select").val());var flag_datatable_trigger=!0;"data-list-group-by"==$(`#example1${elementTabID}`).attr("data-list-group-by")||"data-list-group-by"==$(`#example1${elementTabID}`).attr("data-list-group-by1")?($(`#editListView${elementTabID}`).css("display","none"),table=$(`#example1${elementTabID}`).DataTable({autoWidth:!0,scrollY:"50vh",scrollCollapse:!0,scrollX:"110%",serverSide:!0,orderCellsTop:!0,pageLength:paginationInt[parseInt(paginationInt.length/2)],responsive:!0,stateSave:!0,stateSaveCallback:function(settings,data){const eId=settings.sInstance.split("example1")[1];saveState[eId]&&(saveListview||(saveListview={}),saveListview[settings.sInstance]=data,saveListview[`example1${eId}`].freeze_dict=fDict2[`example1${eId}`],$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"saveListview",element_id:settings.sInstance.split("example1")[1],dict:JSON.stringify(saveListview)},type:"POST",dataType:"json",success:function(data){saveState[eId]=0},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}}))},stateLoadCallback:function(settings){const eleId=settings.sInstance;if(saveListview){if(Object.prototype.hasOwnProperty.call(saveListview,eleId)){saveListview[eleId].search.search&&$("#removeFilter"+eleId).css("display","block");for(let i=0;i<saveListview[eleId].columns.length;i++){if(""!==String(saveListview[eleId].columns[i].search.search)){$("#removeFilter"+eleId.split("example1")[1]).css("display","inline-block");break}$("#removeFilter"+eleId.split("example1")[1]).css("display","none")}return saveListview[eleId]}return""}return""},stripeClasses:!1,bLengthChange:!1,paging:!0,info:!1,buttons:[{extend:"collection",text:"Export",buttons:[{extend:"copy",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"excel",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"csv",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"pdfHtml5",title:"",customize:function(doc,config){let tableNode;for(let i=0;i<doc.content.length;++i)if("undefined"!==String(doc.content[i].table)){tableNode=doc.content[i];break}const rowIndex=0,tableColumnCount=tableNode.table.body[0].length;tableColumnCount>5&&(doc.pageOrientation="landscape"),tableColumnCount<=15&&(doc.pageSize="A4"),tableColumnCount>15&&tableColumnCount<=25&&(doc.pageSize="B3"),tableColumnCount>25&&tableColumnCount<=40&&(doc.pageSize="A1"),tableColumnCount>40&&(doc.pageSize="A0")}},{text:"XML",attr:{id:elementTabID,model_name:tableModelName},exportOptions:{columns:":visible:not(.noVis)"},action:function(e,dt,type,indexes){const nodeData=dt.nodes()[0],tableDataId=$(nodeData).attr("id");$("#"+tableDataId).tableExport({type:"xml"})}}]},{extend:"colvis",className:"scroller"}],columnDefs:[{render:function(data,type,full,meta){return $(`#${meta.settings.sInstance}`).hasClass("card-view-template")?"string"==typeof data||data instanceof String?data.includes("<td>")?data:"<div>"+data+"</div>":data:"string"==typeof data||data instanceof String?data.includes("<td>")?data:"<div style='white-space: normal;width: 100%;'>"+data+"</div>":data},targets:"_all",className:"dt-center allColumnClass all"}],ajax:{url:call(),type:"POST",data:function(d,settings){return d.filters=quickFilters(`${settings.nTable.id}`),d.reportingParameters=reportingParametersExtractor(`${settings.nTable.id}`),$(`#approval-sort-btn-${settings.nTable.id.replace("example1","")}`).length>0&&(d.approvalSort=$(`#approval-sort-btn-${settings.nTable.id.replace("example1","")}`).attr("data-sort")),d}},columns:dataContainingColumnNames,initComplete:function(){try{const freezeEId=$(this).closest("table").attr("id"),table1=$(`#${freezeEId}`).DataTable();if($(`#${freezeEId}`).on("click","td",(function(){const columns=table1.settings().init().columns;cellColLen=columns.length,cellIndex=table1.cell(this).index().column+1,$(this).click((function(){$(this).toggleClass("cell_highlighted"),$(this).toggleClass("cell_selected")}))})),saveListview[`${freezeEId}`].freeze_dict){fDict2[`${freezeEId}`]=saveListview[`${freezeEId}`].freeze_dict;const table=$(`#${freezeEId}`).DataTable();new $.fn.dataTable.FixedColumns(table,saveListview[`${freezeEId}`].freeze_dict),setTimeout(()=>{$(`#${freezeEId}`).DataTable().draw()},3e3)}}catch(err){}this.api().columns().every((function(){const column=this,title=$(this).text();return $(`<input type="text" data-inputid='inputtext' data-elementid='${elementTabID}' value="" data-input_value="" class="listViewSearch" style="text-align:center;border-bottom:none;border:1px solid #ced4da;border-radius: .35rem;width:10rem;height:2rem"placeholder="Search `+title+'" />').hover((function(){$(this).css("box-shadow","0 2px 8px 1px rgb(64 60 67 / 24%)"),$(this).css("margin-bottom","0.25rem")}),(function(){$(this).css("box-shadow","none"),$(this).css("margin-bottom","unset")})).appendTo($(column.footer()).empty()).on("keyup change",(function(){if(column.search()!==this.value||""===String(this.value)){const val=this.value;""!==String(this.value)?column.search(null===val?"":val,!0,!1).draw():""===String(this.value)&&column.search(this.value).draw()}})),0==column.index()&&$(column.footer()).empty(),!0}));var embededTableId=$(this).closest("table").attr("id");$(`#${embededTableId}`).find(".listviewembededcomputation").select2()},fnDrawCallback:function(oSettings){var embededTableId=$(this).closest("table").attr("id");if($(`#${embededTableId}`).find(".listviewembededcomputation").select2(),table.buttons().container().children().addClass("btn btn-md mx-2 rounded px-2"),$(`#${oSettings.sInstance}`).hasClass("card-view-template")){var labels=[];$(`#${oSettings.sInstance} thead th`).each((function(){labels.push($(this).text())}));var dataList=$(`#${oSettings.sInstance}`).attr("data-list");$(`#${oSettings.sInstance}`).find("tbody").find("tr").each((function(){$(this).find("td").each((function(column){$("<span class='colHeader'>"+labels[column]+":</span>").prependTo($(this))}))})),$(`#${oSettings.sInstance}`).parent().parent().find(".dataTables_scrollHead").css("display","none"),""!=dataList&&(dataList=JSON.parse(dataList),$(`#${oSettings.sInstance}`).find("tbody").attr("style",`display: grid;\n                gap: ${dataList["card-padding"]}px;\n                grid-template-columns: repeat(${dataList["card-no-one-row"]},1fr);\n                `),$(`#${oSettings.sInstance}`).find("tbody").find("tr").each((function(){$(this).attr("style",`width: ${dataList["card-wdith"]}rem;\n                  height:${dataList["card-height"]}rem;\n                  background-color: transparent !important;\n                  box-shadow: ${dataList["card-shadow-h-offset"]}px ${dataList["card-shadow-v-offset"]}px ${dataList["card-shadow-blur"]}px ${dataList["card-shadow-spread"]}px ${dataList["card-shadow-color-rgba"]};\n                  overflow:auto;\n                  border-radius:${dataList["card-border-radius"]}px;\n                  border:${dataList["card-border-width"]}px ${dataList["card-border-style"]} ${dataList["card-border-color-rgba"]};\n                  `)})),$(`#${oSettings.sInstance}`).find("tbody").find("tr").find("td").each((function(){$(this).attr("style",`\n                  display: flex;\n                  white-space: normal;\n                  border: ${dataList["field-border-width"]}px ${dataList["field-border-style"]} ${dataList["field-border-color-rgba"]};\n                  flex-direction:row;\n                  justify-content:${dataList["font-alignment"]};\n                  color:${dataList["font-value-color"]};\n                  font-size:${dataList["font-value-size"]};\n                  `),$(this).find(".colHeader").attr("style",`\n                  color:${dataList["font-header-color"]};\n                  font-size:${dataList["font-header-size"]};\n                  `)})))}if(template_type=$(`#${oSettings.sInstance}`).attr("data-list_type_template"),template_type&&"Approval Template"==template_type){$(`#${oSettings.sInstance}`).find("tbody").find("tr").find("td").each((function(){$(this).parent().find("td").eq(0).find('a[title="Reject record"]').css("pointer-events","none"),$(this).parent().find("td").eq(0).find('a[title="Approve record"]').css("pointer-events","none"),$(this).parent().find("td").eq(0).find('a[title="Delegate Approval"]').css("pointer-events","none"),$(this).parent().find("td").eq(0).find('a[title="Resend record"]').css("pointer-events","none"),$(this).parent().find("td").eq(0).find('a[title="Edit record"]').css("pointer-events","none"),$(this).parent().find("td").eq(0).find('a[title="Approval Wall"]').attr("data-approve","false"),$(this).parent().find("td").eq(0).find('a[title="Approval Wall"]').attr("data-reject","false"),$(this).parent().find("td").eq(0).find('a[title="Approval Wall"]').attr("data-resend","false"),$(this).parent().find("td").eq(0).find('a[title="Approval Wall"]').attr("data-edit","false"),$(this).parent().find("td").eq(0).find('a[title="Approval Wall"]').attr("data-delegate","false")})),$(`#${oSettings.sInstance}`).find("tbody").find("tr").each((function(){$(this).parent().find("tr").find('a[title="Approve record"]').css("pointer-events","none"),$(this).parent().find("tr").find('a[title="Resend record"]').css("pointer-events","none"),$(this).parent().find("tr").find('a[title="Reject record"]').css("pointer-events","none"),$(this).parent().find("tr").find('a[title="Delegate Approval"]').css("pointer-events","none")})),tr_index=[],tr_index_resend=[],tr_index_edit=[],oTableData=oSettings.json.data;var approvalTemplateTableNameField=oSettings.json.table_name_column_verbose_name;$(`#${oSettings.sInstance}`).find("tbody > tr > td").find('a[title="Reject record"]').attr("data-approvalTableNameField",approvalTemplateTableNameField),$(`#${oSettings.sInstance}`).find("tbody > tr > td").find('a[title="Approve record"]').attr("data-approvalTableNameField",approvalTemplateTableNameField),$(`#${oSettings.sInstance}`).find("tbody > tr").find('a[title="Approve record"]').attr("data-approvalTableNameField",approvalTemplateTableNameField),$(`#${oSettings.sInstance}`).find("tbody > tr").find('a[title="Reject record"]').attr("data-approvalTableNameField",approvalTemplateTableNameField);for(let i=0;i<oTableData.length;i++)for(let[k1,v1]of Object.entries(oTableData[i]))oSettings.json.allow_ids.includes(String(v1))&&tr_index.push(i),oSettings.json.allow_ids_resend.includes(String(v1))&&tr_index_resend.push(i),oSettings.json.allow_ids_edit.includes(String(v1))&&tr_index_edit.push(i);for(let i=0;i<tr_index.length;i++)$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Reject record"]').css("pointer-events","all"),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find('a[title="Reject record"]').css("pointer-events","all"),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Approve record"]').css("pointer-events","all"),$(`#${oSettings.sInstance}`).find("tbody").eq(tr_index[i]).find("tr").find('a[title="Approve record"]').css("pointer-events","all"),$(`#${oSettings.sInstance}`).find("tbody").eq(tr_index[i]).find("tr").find('a[title="Delegate Approval"]').css("pointer-events","all"),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Delegate Approval"]').css("pointer-events","all"),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Approval Wall"]').attr("data-approve","true"),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Approval Wall"]').attr("data-reject","true"),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Approval Wall"]').attr("data-delegate","true"),oSettings.json.user_additional_info&&($(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Delegate Approval"]').attr("data-user-info",JSON.stringify(oSettings.json.user_additional_info)),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Delegate Approval"]').attr("data-current-user",oSettings.json.current_user),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Delegate Approval"]').attr("data-current-user",oSettings.json.current_user),$(`#${oSettings.sInstance}`).find("tbody").eq(tr_index[i]).find("tr").find('a[title="Delegate Approval"]').attr("data-user-info",JSON.stringify(oSettings.json.user_additional_info)),$(`#${oSettings.sInstance}`).find("tbody").eq(tr_index[i]).find("tr").find('a[title="Delegate Approval"]').attr("data-current-user",oSettings.json.current_user),$(`#${oSettings.sInstance}`).find("tbody").eq(tr_index[i]).find("tr").find('a[title="Delegate Approval"]').attr("data-current-user",oSettings.json.current_user),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Approval Wall"]').attr("data-current-user",oSettings.json.current_user));for(let i=0;i<tr_index_resend.length;i++)$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index_resend[i]).find("td").find('a[title="Resend record"]').css("pointer-events","all"),$(`#${oSettings.sInstance}`).find("tbody").eq(tr_index_resend[i]).find("tr").find('a[title="Resend record"]').css("pointer-events","all"),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index_resend[i]).find("td").find('a[title="Approval Wall"]').attr("data-resend","true");for(let i=0;i<tr_index_edit.length;i++)$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index_edit[i]).find("td").find('a[title="Edit record"]').css("pointer-events","all"),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index_edit[i]).find("td").find('a[title="Approval Wall"]').attr("data-edit","true")}},treeGrid:{left:20,expandIcon:'<i class="fa-solid fa-plus ihover javaSC"></i>',collapseIcon:'<i class="fa-solid fa-minus ihover javaSC"></i>'}}).columns.adjust(),flag_datatable_trigger=!1):flag_datatable_trigger=!0,row_flag=!0;var extract_file_name=$(`#btn_exDataDownload_${elementTabID}`).find("i").attr("id");if(extract_file_name||(extract_file_name="Revolutio"),flag_datatable_trigger&&(table=$(`#example1${elementTabID}`).DataTable({autoWidth:!0,scrollY:"50vh",scrollCollapse:!0,scrollX:"110%",serverSide:!0,orderCellsTop:!0,colReorder:{fixedColumnsLeft:1},responsive:!0,stateSave:!0,stateSaveCallback:function(settings,data){const eId=settings.sInstance.split("example1")[1];saveState[eId]&&(saveListview||(saveListview={}),saveListview[settings.sInstance]=data,saveListview[`example1${eId}`].freeze_dict=fDict2[`example1${eId}`],$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"saveListview",element_id:settings.sInstance.split("example1")[1],dict:JSON.stringify(saveListview)},type:"POST",dataType:"json",success:function(data){saveState[eId]=0},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}}))},stateLoadCallback:function(settings){const eleId=settings.sInstance;if(saveListview){if(Object.prototype.hasOwnProperty.call(saveListview,eleId)){saveListview[eleId].search.search&&$("#removeFilter"+eleId).css("display","block");for(let i=0;i<saveListview[eleId].columns.length;i++){if(""!==String(saveListview[eleId].columns[i].search.search)){$("#removeFilter"+eleId.split("example1")[1]).css("display","inline-block");break}$("#removeFilter"+eleId.split("example1")[1]).css("display","none")}return saveListview[eleId]}return""}return""},deferRender:!0,paging:!0,bLengthChange:!1,stripeClasses:!1,pageLength:paginationInt[parseInt(paginationInt.length/2)],dom:"lfBrtip",sScrollX:"100%",destroy:!1,buttons:[{extend:"collection",text:"Export",buttons:[{extend:"copy",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"excel",filename:extract_file_name,title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"csv",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"pdfHtml5",title:"",filename:extract_file_name,customize:function(doc,config){let tableNode;for(let i=0;i<doc.content.length;++i)if("undefined"!==String(doc.content[i].table)){tableNode=doc.content[i];break}const rowIndex=0,tableColumnCount=tableNode.table.body[0].length;tableColumnCount>5&&(doc.pageOrientation="landscape"),tableColumnCount<=15&&(doc.pageSize="A4"),tableColumnCount>15&&tableColumnCount<=25&&(doc.pageSize="B3"),tableColumnCount>25&&tableColumnCount<=40&&(doc.pageSize="A1"),tableColumnCount>40&&(doc.pageSize="A0")}},{text:"XML",attr:{id:elementTabID,model_name:tableModelName},exportOptions:{columns:":visible:not(.noVis)"},action:function(e,dt,type,indexes){const nodeData=dt.nodes()[0],tableDataId=$(nodeData).attr("id");$("#"+tableDataId).tableExport({type:"xml"})}}]},{extend:"colvis",className:"scroller"}],columnDefs:allCol_width_def,ajax:{url:call(),type:"POST",data:function(d,settings){return d.filters=quickFilters(`${settings.nTable.id}`),d.reportingParameters=reportingParametersExtractor(`${settings.nTable.id}`),$(`#approval-sort-btn-${settings.nTable.id.replace("example1","")}`).length>0&&(d.approvalSort=$(`#approval-sort-btn-${settings.nTable.id.replace("example1","")}`).attr("data-sort")),d}},columns:dataContainingColumnNames,initComplete:function(){try{const freezeEId=$(this).closest("table").attr("id"),table1=$(`#${freezeEId}`).DataTable();if($(`#${freezeEId}`).on("click","td",(function(){const columns=table1.settings().init().columns;cellColLen=columns.length,cellIndex=table1.cell(this).index().column+1,$(this).click((function(){$(this).toggleClass("cell_highlighted"),$(this).toggleClass("cell_selected")}))})),saveListview[`${freezeEId}`].freeze_dict){fDict2[`${freezeEId}`]=saveListview[`${freezeEId}`].freeze_dict;const table=$(`#${freezeEId}`).DataTable();new $.fn.dataTable.FixedColumns(table,saveListview[`${freezeEId}`].freeze_dict),setTimeout(()=>{$(`#${freezeEId}`).DataTable().draw()},3e3)}}catch(err){}this.api().columns().every((function(){const column=this,title=$(this).text();return $(`<input type="text" data-inputid='inputtext' data-elementid='${elementTabID}' value="" data-input_value="" class="listViewSearch" style="text-align:center;border-bottom:none;border:1px solid #ced4da;border-radius: .35rem;width:10rem;height:2rem"placeholder="Search `+title+'" />').hover((function(){$(this).css("box-shadow","0 2px 8px 1px rgb(64 60 67 / 24%)"),$(this).css("margin-bottom","0.25rem")}),(function(){$(this).css("box-shadow","none"),$(this).css("margin-bottom","unset")})).appendTo($(column.footer()).empty()).on("keyup change",(function(){if(column.search()!==this.value||""===String(this.value)){const val=this.value;""!==String(this.value)?column.search(null===val?"":val,!0,!1).draw():""===String(this.value)&&column.search(this.value).draw()}})),!0}));var embededTableId=$(this).closest("table").attr("id");$(`#${embededTableId}`).find(".listviewembededcomputation").select2()},fnDrawCallback:function(oSettings){let dt,rowCount;$(`#multiple_delete_perm_${elementTabID}`).prop("disabled",!1),$(`#multiple_delete_temp_${elementTabID}`).prop("disabled",!1),$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!1),$(`#approve_multiple_ApprovalTemplate_final_${elementTabID}`).css("display","none"),$(`#reject_multiple_ApprovalTemplate_final_${elementTabID}`).css("display","none"),$(`#multiple_delete_perm_final_${elementTabID}`).css("display","none"),$(`#multiple_delete_temp_final_${elementTabID}`).css("display","none"),$(`#multiple_delete_perm_${elementTabID}`).attr("data-edit-status","off"),$(`#multiple_delete_perm_${elementTabID}`).text("Delete Multiple(Permanent): OFF").trigger("change"),$(`#multiple_delete_temp_${elementTabID}`).attr("data-edit-status","off"),$(`#multiple_delete_temp_${elementTabID}`).text("Delete Multiple(Temporary): OFF").trigger("change"),$(`#approve_multiple_ApprovalTemplate_${elementTabID}`).attr("data-edit-status","off"),$(`#approve_multiple_ApprovalTemplate_${elementTabID}`).text("Approve Multiple: OFF").trigger("change"),$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).attr("data-edit-status","off"),$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).text("Reject Multiple: OFF").trigger("change"),0===$(`#example1${elementTabID}`).DataTable().data().count()&&(row_flag=!1,$(`#approve_all_ApprovalTemplate_${elementTabID}`).prop("disabled","true"),$(`#reject_all_ApprovalTemplate_${elementTabID}`).prop("disabled","true"),$(`#approve_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled","true"),$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled","true")),row_flag&&($(`#approve_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!1),$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!1));var embededTableId=$(this).closest("table").attr("id");if($(`#${embededTableId}`).find(".listviewembededcomputation").select2(),table.buttons().container().children().addClass("btn btn-md mx-2 rounded px-2"),$(`#${oSettings.sInstance}`).hasClass("card-view-template")){var labels=[];$(`#${oSettings.sInstance} thead th`).each((function(){labels.push($(this).text())}));var dataList=$(`#${oSettings.sInstance}`).attr("data-list");$(`#${oSettings.sInstance}`).find("tbody").find("tr").each((function(){$(this).find("td").each((function(column){$("<span class='colHeader'>"+labels[column]+":</span>").prependTo($(this))}))})),$(`#${oSettings.sInstance}`).parent().parent().find(".dataTables_scrollHead").css("display","none"),""!=dataList&&(dataList=JSON.parse(dataList),$(`#${oSettings.sInstance}`).find("tbody").attr("style",`display: grid;\n              gap: ${dataList["card-padding"]}px;\n              grid-template-columns: repeat(${dataList["card-no-one-row"]},1fr);\n              `),$(`#${oSettings.sInstance}`).find("tbody").find("tr").each((function(){$(this).attr("style",`width: ${dataList["card-wdith"]}rem;\n                height:${dataList["card-height"]}rem;\n                background-color: transparent !important;\n                box-shadow: ${dataList["card-shadow-h-offset"]}px ${dataList["card-shadow-v-offset"]}px ${dataList["card-shadow-blur"]}px ${dataList["card-shadow-spread"]}px ${dataList["card-shadow-color-rgba"]};\n                overflow:auto;\n                border-radius:${dataList["card-border-radius"]}px;\n                border:${dataList["card-border-width"]}px ${dataList["card-border-style"]} ${dataList["card-border-color-rgba"]};\n                `)})),$(`#${oSettings.sInstance}`).find("tbody").find("tr").find("td").each((function(){$(this).attr("style",`\n                display: flex;\n                white-space: normal;\n                border: ${dataList["field-border-width"]}px ${dataList["field-border-style"]} ${dataList["field-border-color-rgba"]};\n                flex-direction:row;\n                justify-content:${dataList["font-alignment"]};\n                color:${dataList["font-value-color"]};\n                font-size:${dataList["font-value-size"]};\n                `),$(this).find(".colHeader").attr("style",`\n                color:${dataList["font-header-color"]};\n                font-size:${dataList["font-header-size"]};\n                `)})))}if(template_type=$(`#${oSettings.sInstance}`).attr("data-list_type_template"),template_type&&"Approval Template"==template_type){$(`#${oSettings.sInstance}`).find("tbody").find("tr").find("td").each((function(){$(this).parent().find("td").eq(0).find('a[title="Reject record"]').css("pointer-events","none"),$(this).parent().find("td").eq(0).find('a[title="Approve record"]').css("pointer-events","none"),$(this).parent().find("td").eq(0).find('a[title="Delegate Approval"]').css("pointer-events","none"),$(this).parent().find("td").eq(0).find('a[title="Resend record"]').css("pointer-events","none"),$(this).parent().find("td").eq(0).find('a[title="Edit record"]').css("pointer-events","none"),$(this).parent().find("td").eq(0).find('a[title="Approval Wall"]').attr("data-approve","false"),$(this).parent().find("td").eq(0).find('a[title="Approval Wall"]').attr("data-reject","false"),$(this).parent().find("td").eq(0).find('a[title="Approval Wall"]').attr("data-resend","false"),$(this).parent().find("td").eq(0).find('a[title="Approval Wall"]').attr("data-edit","false"),$(this).parent().find("td").eq(0).find('a[title="Approval Wall"]').attr("data-delegate","false")})),$(`#${oSettings.sInstance}`).find("tbody").find("tr").each((function(){$(this).parent().find("tr").find('a[title="Approve record"]').css("pointer-events","none"),$(this).parent().find("tr").find('a[title="Resend record"]').css("pointer-events","none"),$(this).parent().find("tr").find('a[title="Reject record"]').css("pointer-events","none"),$(this).parent().find("tr").find('a[title="Delegate Approval"]').css("pointer-events","none")})),tr_index=[],tr_index_resend=[],tr_index_edit=[],oTableData=oSettings.json.data;var approvalTemplateTableNameField=oSettings.json.table_name_column_verbose_name;$(`#${oSettings.sInstance}`).find("tbody > tr > td").find('a[title="Reject record"]').attr("data-approvalTableNameField",approvalTemplateTableNameField),$(`#${oSettings.sInstance}`).find("tbody > tr > td").find('a[title="Approve record"]').attr("data-approvalTableNameField",approvalTemplateTableNameField),$(`#${oSettings.sInstance}`).find("tbody > tr").find('a[title="Approve record"]').attr("data-approvalTableNameField",approvalTemplateTableNameField),$(`#${oSettings.sInstance}`).find("tbody > tr").find('a[title="Reject record"]').attr("data-approvalTableNameField",approvalTemplateTableNameField);for(let i=0;i<oTableData.length;i++)for(let[k1,v1]of Object.entries(oTableData[i]))oSettings.json.allow_ids.includes(String(v1))&&tr_index.push(i),oSettings.json.allow_ids_resend.includes(String(v1))&&tr_index_resend.push(i),oSettings.json.allow_ids_edit.includes(String(v1))&&tr_index_edit.push(i);for(let i=0;i<tr_index.length;i++)$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Reject record"]').css("pointer-events","all"),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find('a[title="Reject record"]').css("pointer-events","all"),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Approve record"]').css("pointer-events","all"),$(`#${oSettings.sInstance}`).find("tbody").eq(tr_index[i]).find("tr").find('a[title="Approve record"]').css("pointer-events","all"),$(`#${oSettings.sInstance}`).find("tbody").eq(tr_index[i]).find("tr").find('a[title="Delegate Approval"]').css("pointer-events","all"),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Delegate Approval"]').css("pointer-events","all"),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Approval Wall"]').attr("data-approve","true"),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Approval Wall"]').attr("data-reject","true"),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Approval Wall"]').attr("data-delegate","true"),oSettings.json.user_additional_info&&($(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find('a[title="Delegate Approval"]').attr("data-user-info",JSON.stringify(oSettings.json.user_additional_info)),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Delegate Approval"]').attr("data-user-info",JSON.stringify(oSettings.json.user_additional_info)),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Approval Wall"]').attr("data-user-info",JSON.stringify(oSettings.json.user_additional_info)),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find('a[title="Delegate Approval"]').attr("data-current-user",oSettings.json.current_user),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Delegate Approval"]').attr("data-current-user",oSettings.json.current_user),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index[i]).find("td").find('a[title="Approval Wall"]').attr("data-current-user",oSettings.json.current_user));for(let i=0;i<tr_index_resend.length;i++)$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index_resend[i]).find("td").find('a[title="Resend record"]').css("pointer-events","all"),$(`#${oSettings.sInstance}`).find("tbody").eq(tr_index_resend[i]).find("tr").find('a[title="Resend record"]').css("pointer-events","all"),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index_resend[i]).find("td").find('a[title="Approval Wall"]').attr("data-resend","true");for(let i=0;i<tr_index_edit.length;i++)$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index_edit[i]).find("td").find('a[title="Edit record"]').css("pointer-events","all"),$(`#${oSettings.sInstance}`).find("tbody").find("tr").eq(tr_index_edit[i]).find("td").find('a[title="Approval Wall"]').attr("data-edit","true")}}}).columns.adjust()),$(`#example1${elementTabID}`).DataTable().buttons().container().css("display","none"),setTimeout((function(){$(`#example1${elementTabID}`).DataTable().columns.adjust()}),500),$(`#extract_data_modal_${elementTabID} .modal-footer`).find(".buttons-excel").off("click").on("click",(function(){$(`#example1${elementTabID}`).DataTable().button(".buttons-excel").trigger()})),$(`#extract_data_modal_${elementTabID} .modal-footer`).find(".buttons-pdf").off("click").on("click",(function(){$(`#example1${elementTabID}`).DataTable().button(".buttons-pdf").trigger()})),$(`#extract_data_modal_${elementTabID} .modal-footer`).find(".buttons-copy").off("click").on("click",(function(){$(`#example1${elementTabID}`).DataTable().button(".buttons-copy").trigger()})),paginationInt.length>0){$(`#showEntries${elementTabID}`).empty();for(let p in paginationInt)p==parseInt(paginationInt.length/2)?$(`#showEntries${elementTabID}`).append(`<option value="${paginationInt[p]}" selected>${pagination[p]}</option>`):$(`#showEntries${elementTabID}`).append(`<option value="${paginationInt[p]}">${pagination[p]}</option>`)}dataTableColumnsArray=$(`#example1${elementTabID}`).DataTable().settings().init().columns,$(`#listViewColumnVisibilityDropdown${elementTabID}`).empty();for(let p in dataTableColumnsArray)$(`#listViewColumnVisibilityDropdown${elementTabID}`).append(`<div class="dropdown-item" data-table-id="${elementTabID}" data-column_index="${p}">${dataTableColumnsArray[p].data}</div><div class="dropdown-divider" style="margin:0"></div>`);$(`#listViewColumnVisibilityDropdown${elementTabID}`).find(".dropdown-item").each((function(){$(this).off("click").on("click",(function(e){e.stopPropagation(),$(this).toggleClass("hide"),$(this).hasClass("hide")?$(`#example1${$(this).attr("data-table-id")}`).DataTable().column(parseInt($(this).attr("data-column_index"))).visible(!1):$(`#example1${$(this).attr("data-table-id")}`).DataTable().column(parseInt($(this).attr("data-column_index"))).visible(!0)}))})),$(`#showEntries${elementTabID}`).off("select2:select").on("select2:select",(function(){let connectedLVElementId=$(this).attr("data-elementid");$(`#example1${connectedLVElementId}`).DataTable().page.len(parseInt($(this).val())).draw()})),$("#example1"+elementTabID).on("column-visibility.dt",(function(e,settings,column,state){$("#"+settings.sInstance).DataTable().columns.adjust()})),0===Object.keys(list_table_header_config).length?$(`#example1${elementTabID}_wrapper .dataTables_scrollFoot`).css("top","32px"):$(`#example1${elementTabID}_wrapper .dataTables_scrollFoot`).css("top","14%"),$(`#example1${elementTabID}_wrapper .dataTables_scroll`).css("position","relative"),$(`#example1${elementTabID}_wrapper .dataTables_scrollHead`).css("margin-bottom","40px"),$(`#example1${elementTabID}_wrapper .dataTables_scrollFoot`).css("position","absolute"),$(`#example1${elementTabID} thead tr`).eq(1).find("th").on("change paste keyup","input",(function(){})),datatableDict[elementTabID]=table,$(`#example1${elementTabID}_length`).css("display","inline-block"),$(`#example1${elementTabID}_length`).css("float","none"),$(`#example1${elementTabID}_filter`).css("display","none");var templateType=$(`#${elementTabID}_tab_content`).attr("data-template-type");if(["Reporting View","List View With History","Approval Template"].includes(templateType))if($(`#tableTab${elementTabID}`).find("select").on("select2:select",(function(){let parameterParentContainer=$(this).parent().parent().closest(".card.col-12");parameterParentContainer.find("select").each((function(){if(!$(this).val())return parameterParentContainer.find(".row.saveReportView").find("button").prop("disabled",!0),!1;parameterParentContainer.find(".row.saveReportView").find("button").prop("disabled",!1)}))})),"True"==$(`#tableTab${elementTabID}`).find("select").attr("data-dont_show_detail_btn")){let container=$(`#tableTab${elementTabID}`);$(`#tableTab${elementTabID}`).find("select").on("change",(function(){let selectedParameters={};container.find("select").each((function(){selectedParameters[$(this).attr("data-parameter-name")]=$(this).val()}));let listViewElementId=$(this).parent().parent().parent().parent().attr("id").replace("tableTab","");Object.values(selectedParameters).includes(null)||($(`#example1${listViewElementId}`).DataTable().draw(),$(`#${listViewElementId}_tab_content`).find(".card-body").css("display","block"))}))}else $(`#tableTab${elementTabID}`).find(".row.saveReportView").find("button").on("click",(function(){let listViewElementId=$(this).parent().attr("id").replace("_tableTabSaveBtn","");$(`#example1${listViewElementId}`).DataTable().draw(),$(`#${listViewElementId}_tab_content`).find(".card-body").css("display","block")}));else"Multi Dropdown View"==templateType&&($(`#${elementTabID}_tab_content`).find(".card-body").css("display","block"),$("#tableTab"+elementTabID).find("select").on("select2:select",(function(){var element_id=$(this).closest(".card").attr("id").replace("tableTab",""),viewName=$(this).val();getViewTable(element_id,viewName),$("#"+element_id+"_tab_content").find(".card").eq(1).css("pointer-events","none"),$("#"+element_id+"_tab_content").find(".card").eq(1).prepend('\n          <div id="backgroundBlock" style="\n              z-index: 10;\n              height: 100%;\n              width: 100%;\n              position: fixed;\n              text-align: center;\n              background-color: rgba(0,0,0,0.2);\n          "><i class="fas fa-spinner fa-pulse" style="font-size: xxx-large; top: 50%; position: relative;"></i></div>\n      '),$("#"+element_id+"_tab_content").find(".card").find(".bodyListview").prepend(`<div class='mul_heading'><h4 style="color: var(--primary-color);font-size: 1.1rem;font-weight: 400;border-bottom: 1px solid #00000020;margin-bottom: .75rem;padding-bottom: 0.75rem;">${viewName}</h4></div>`)})));"Approval Template"==$(`#example1${elementTabID}`).attr("data-list_type_template")&&$(`#approval-sort-btn-${elementTabID}`).on("click",(function(){"active"==$(`#approval-sort-btn-${elementTabID}`).attr("data-sort")?$(`#approval-sort-btn-${elementTabID}`).attr("data-sort","inactive"):$(`#approval-sort-btn-${elementTabID}`).attr("data-sort","active"),$(`#example1${elementTabID}`).DataTable().draw()})),$(`#example1${elementTabID} tbody`).on("click","a",(function(e){const idDatatable=$(this).closest("table").attr("id"),table=$("#"+idDatatable).DataTable(),template_type=$(`#${idDatatable}`).attr("data-list_type_template"),tData=$(this.closest("tr")),tab=table.row(tData).data();"id"in tab?primaryKeyId=tab.id:"ID"in tab?primaryKeyId=tab.ID:"iD"in tab?primaryKeyId=tab.iD:"Id"in tab&&(primaryKeyId=tab.Id);let app_tablename="";if("Approval Template"==template_type){var tableFieldName=$(this).attr("data-approvalTableNameField");tableFieldName in tab&&(app_tablename=tab[tableFieldName])}elementID=$(this).closest("table").attr("id").split("example1")[1],elementIDData=$(this).attr("data-elementID"),tableName=$(this).attr("data-table_model_name");let url=windowLocation,url1;if(null!=e.target.attributes[1]&&"detail"===String(e.target.attributes[1].value)){const header=[],value=[],valueRTF=[],attrRTF=[],dataAttr=[];$(`#example1${elementID} thead tr th`).each((function(){header.push($(this).text())}));const curr=$(this).closest("tr");curr.find("td").each((function(){"View Details"===String($(this).find("button").text())?(value.push($(this).find("button").attr("data-name")),dataAttr.push($(this).find("button").attr("data-col")),attrRTF.push("")):"View Data"===String($(this).find("button").text())?(value.push($(this).find("button").attr("data-data")),attrRTF.push($(this).find("button").attr("onclick"))):(value.push($(this).text()),attrRTF.push(""))}));const html='\n        <table id="viewDetailOnModalTable" class="row-border" style="width:100%">\n        <thead>\n          <tr>\n            <th>Column</th>\n            <th>Value</th>\n          </tr>\n        </thead>\n        <tbody>\n        </tbody>\n      </table>\n        ';$("#"+elementIDData+"_tab_content").find("#viewDetailOnModal").find(".modal-body"),$("#"+elementIDData+"_tab_content").find("#viewDetailOnModal").find(".modal-body").empty(),$("#"+elementIDData+"_tab_content").find("#viewDetailOnModal").find(".modal-body").append(html);const ms=[];let ind=0;for(let i=1;i<header.length;i++){let html="<tr>";html+=`<td>${header[i]}</td>`,"{"===String(value[i][0])?(JSON.parse(value[i]),html+=`<td data-name='${value[i]}' data-col='${dataAttr[ind]}'><button id="element_id" class="view_listview_data"  style="background-color:transparent; border:transparent;">View Details</button></td>`,ms.push(header[i].replaceAll(" ","_")),ind+=1):"<"===String(value[i][0])?html+=`<td><button style="background-color:transparent; border:transparent;" class="view_listview_data" data-data='${value[i]}' onclick='${attrRTF[i]}'>View Data</button></td>`:html+=`<td>${value[i]}</td>`,html+="</tr>",$("#"+elementIDData+"_tab_content").find("#viewDetailOnModal").find(".modal-body").find("tbody").append(html)}if(viewDetailOnModalTableFunc(elementIDData),setTimeout(()=>{$("#"+elementIDData+"_tab_content").find("#viewDetailOnModalTable").DataTable().columns.adjust().draw()},300),$("#"+elementIDData+"_tab_content").find("#viewDetailOnModal").css("display","block"),$("#"+elementIDData+"_tab_content").find("#viewDetailOnModal").css("opacity",1),0!==ind)for(let z=0;z<mColBasefilter[elementIDData].length;z++)$("#"+elementIDData+"_tab_content").find("#viewDetailOnModal").find("table tbody").find(`td[data-col=${mColBasefilter[elementIDData][z]}]`).on("click",(function(){const mCol=mColBasefilter[elementIDData][z],tableTextInd={};if(tableTextInd[elementID+"_"+mCol]=[],$(this).attr("data-name")){let ids=[],bool;try{const opop=JSON.parse($(this).attr("data-name"));let rr,r;for(let i=0;i<$("#formModalListL"+`${elementID}`+"_"+mCol).find(".ioL").length;i++)rr=$("#masterListTablei"+elementID+"_"+mCol).find("tbody").find("tr").eq(i).find("td").eq(-1).text(),rr=rr.trim(),"undefined"!==String(opop[rr])&&(ids=[...ids,rr]);bool=!1;for(const i in ids)Number.isInteger(parseInt(ids[i]))&&(ids[i]=parseInt(ids[i]));let coun=0;for(const i in ids)if(Number.isInteger(parseInt(ids[i])))for(let j=0;j<=$("#masterListTablei"+elementID+"_"+mCol).find(".ioL").length;j++)r=$("#masterListTablei"+elementID+"_"+mCol).find("tr").eq(j).find("td").eq(-1).text(),r=r.trim(),String(r)===String(ids[i])&&(coun+=1);coun===ids.length&&(bool=!0)}catch(err){bool=!1}if(bool){const lenn=tableTextInd[elementID+"_"+mCol].length;tableTextInd[elementID+"_"+mCol].splice(0,lenn);for(let i=0;i<=$("#masterListTablei"+elementID+"_"+mCol).find(".ioL").length;i++){let tableText=$("#masterListTablei"+elementID+"_"+mCol).find("tr").eq(i).find("td").eq(-1).text();tableText=tableText.trim();for(const j in ids)String(ids[j])===String(tableText)&&tableTextInd[elementID+"_"+mCol].push(i)}$("#showDetailList"+elementID).find("#listDetailTable"+elementID+"_wrappper").remove(),$("#showDetailList"+elementID).find(".card-body").empty(),$("#showDetailList"+elementID).find(".card-body").append(`\n                <table id="listDetailTable${elementID}" style="width:100%"  class="row-border display compact">\n                  <thead style="width:100%">\n                  </thead>\n\n                  <tbody>\n\n                  </tbody>\n\n                </table>\n                `),$("#listDetailTable"+elementID).find("thead").empty(),$("#listDetailTable"+elementID).find("tbody").empty();let htmlH="<tr>";for(let j=1;j<len[elementID+"_"+mCol];j++){const d=$("#masterListTablei"+elementID+"_"+mCol).find("thead").find("tr").eq(0).find("th").eq(j).text();htmlH+=`<th>${d}</th>`}htmlH+="</tr>",$("#listDetailTable"+elementID).find("thead").append(htmlH);for(let i=0;i<tableTextInd[elementID+"_"+mCol].length;i++)if("View Detail"!==String($("#example1"+elementID+"_wrapper").find("table").find("tbody").find("tr").eq(i).find("td").eq(index).text())){$("#listDetailTable"+elementID).find("tbody").append("<tr></tr>");let sent=$("#masterListTablei"+elementID+"_"+mCol).find("tr").eq(tableTextInd[elementID+"_"+mCol][i]).find("td").eq(1).text();sent=sent.trim(),dataSent.push(sent);for(let j=1;j<len[elementID+"_"+mCol];j++)try{if("Default Value"===String($("#masterListTablei"+elementID+"_"+mCol).find("tr").eq(0).find("th").eq(j).text().trim())){const c=JSON.parse($(this).attr("data-name"));$("#listDetailTable"+elementID).find("tbody").find("tr").eq(i).append(`<td class = "dt-center allColumnClass all">${c[$("#masterListTablei"+elementID+"_"+mCol).find("tr").eq(tableTextInd[elementID+"_"+mCol][i]).find("td").eq(-1).text().trim()]}</td>`)}else{const c=$("#masterListTablei"+elementID+"_"+mCol).find("tr").eq(tableTextInd[elementID+"_"+mCol][i]).find("td").eq(j).text();$("#listDetailTable"+elementID).find("tbody").find("tr").eq(i).append(`<td class = "dt-center allColumnClass all">${c}</td>`)}}catch(err){}}viewDetailTableFuncBase(elementID),$("#showDetailList"+elementID).modal("show"),$("#"+elementIDData+"_tab_content").find("#viewDetailOnModal").css("opacity",0),setTimeout(()=>{$("#listDetailTable"+elementID).DataTable().columns.adjust()},400)}}}))}if($("#"+elementIDData+"_tab_content").find("#viewDetailOnModal").find(".close").on("click",(function(){$("#"+elementIDData+"_tab_content").find("#viewDetailOnModal").css("display","none"),$("#"+elementIDData+"_tab_content").find("#viewDetailOnModal").css("opacity",0)})),null!=e.target.attributes[1]){if("update"===String(e.target.attributes[1].value)){$(this).prop("disabled",!0);var ThisElement=$(this);for(let r=0;r<item_code_list.length;r++)Object.prototype.hasOwnProperty.call(item_code_list[r],elementID)&&(url=`/users/${urlPath}/`+item_code_list[r][elementID]+"/");url1=url+tableName+"/update/"+primaryKeyId+"/";let editName=listViewEditTemplate[elementID];"Model Definition"!==String(editName)&&(historyViewTemplate=$(`#${elementID}_tab_content`).attr("data-template-type")),editName||(editName="Default"),listViewEditRow(url1,primaryKeyId,elementID,elementIDData,tableName,editName,ThisElement,template_type)}if("delete per"===String(e.target.attributes[1].value)){var view_name="";temp_type=$(`#${elementID}_tab_content`).attr("data-template-type"),"Multi Dropdown View"==temp_type&&(view_name=$(`#tableTab${elementID}`).find("select").val()),$.ajax({url:`/users/${urlPath}/DataManagement/`,data:{element_id:elementID.split("__tab__")[0],operation:"fetch_list_view_msgs",messages:JSON.stringify(["confirm_permanent_delete_message","successful_permanent_delete_message"]),view_name:view_name},type:"POST",dataType:"json",success:function(data){message="",icon="",data.confirm_permanent_delete_message&&(message=data.confirm_permanent_delete_message.message,icon=data.confirm_permanent_delete_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),custom_messages=data,Swal.fire({icon:"question",iconHtml:iconHtml,text:message||"Are you sure you want to delete this record?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(result=>{result.isConfirmed&&$.ajax({url:url+tableName+"/delete/"+primaryKeyId+"/",data:{elementid:elementID,operation:"delete_list",custom_messages:JSON.stringify(custom_messages)},type:"POST",dataType:"json",success:function(){$(`#deleteMessageChecker${elementID}`).css("pointer-events","none"),$(`#btn_delete_operation${elementID}`).prop("disabled","disabled"),$(`.close_delete_modal[data-element-id=${elementID}]`).prop("disabled","disabled"),windowLocationAttr.reload()},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}else if("delete temp"===String(e.target.attributes[1].value)){var view_name="";temp_type=$(`#${elementID}_tab_content`).attr("data-template-type"),"Multi Dropdown View"==temp_type&&(view_name=$(`#tableTab${elementID}`).find("select").val()),$.ajax({url:`/users/${urlPath}/DataManagement/`,data:{element_id:elementID.split("__tab__")[0],operation:"fetch_list_view_msgs",messages:JSON.stringify(["confirm_temp_delete_message","successful_temp_delete_message"]),view_name:view_name},type:"POST",dataType:"json",success:function(data){message="",icon="",data.confirm_temp_delete_message&&(message=data.confirm_temp_delete_message.message,icon=data.confirm_temp_delete_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),custom_messages=data,Swal.fire({icon:"question",iconHtml:iconHtml,text:message||"Are you sure you want to delete this record temporarily?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(result=>{result.isConfirmed&&$.ajax({url:url+tableName+"/delete/"+primaryKeyId+"/",data:{operation:"delete_list_temp",elementid:elementID,custom_messages:JSON.stringify(custom_messages)},type:"POST",dataType:"json",success:function(){$(`#deleteMessageChecker${elementID}`).css("pointer-events","none"),$(`#btn_delete_operation${elementID}`).prop("disabled","disabled"),$(`.close_delete_modal[data-element-id=${elementID}]`).prop("disabled","disabled"),windowLocationAttr.reload()},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}else if("approve"===String(e.target.attributes[1].value)){$(`#approvalCommentModal_${elementID}`).find(".modal-title").text("Approval Comment"),$(`#approvalCommentModal_${elementID}`).find(".modal-title").css("color","var(--font-color)"),$(`#approvalCommentModal_${elementID} .modal-body`).find(".delegateApprovalContainer").css("display","none"),$(`#approvalCommentModal_${elementID} .modal-body`).find(".approvers_edit_data").empty(),$(`#approvalCommentModal_${elementID} .modal-body`).find(".approvers_edit_data").css("display","none"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("onclick","approve_ind.call(this)"),CKEDITOR.instances[`approvalCommentText${elementID}`].setData(""),$(`#approvalCommentModal_${elementID}`).modal("show");let approval_type="approve";$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").text("Approve Record"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-approval_id",String(primaryKeyId)),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-tablename",app_tablename),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-approval_type",approval_type),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-element-id",elementID)}else if("delegate_approval"===String(e.target.attributes[1].value)){$(`#approvalCommentModal_${elementID} .modal-body`).find(".approvers_edit_data").empty(),$(`#approvalCommentModal_${elementID} .modal-body`).find(".approvers_edit_data").css("display","none"),$(`#approvalCommentModal_${elementID}`).find(".modal-title").text("Delegate Approval Actions"),$(`#approvalCommentModal_${elementID}`).find(".modal-title").css("color","var(--font-color)");let userInfo=$(this).attr("data-user-info"),currentUserName=$(this).attr("data-current-user");userInfo=userInfo?JSON.parse(userInfo):{};let delegateToDropdownElement=$(`#approvalCommentModal_${elementID} .modal-body`).find(".delegateApprovalContainer").find("select");delegateToDropdownElement.empty();let delegateToHTML="<option value='' selected disabled>Select User</option>";for(let[uName,uLabel]of Object.entries(userInfo))uName!=currentUserName&&(delegateToHTML+=`<option value='${uName}'>${uLabel}</option>`);delegateToDropdownElement.append(delegateToHTML),$(`#approvalCommentModal_${elementID} .modal-body`).find(".delegateApprovalContainer").css("display","block"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("onclick","delegateApproval.call(this)"),CKEDITOR.instances[`approvalCommentText${elementID}`].setData(""),$(`#approvalCommentModal_${elementID}`).modal("show");let approval_type="delegateApproval";$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").text("Delegate"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-approval_id",String(primaryKeyId)),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-approval_type",approval_type),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-element-id",elementID)}else if("reject"===String(e.target.attributes[1].value)){$(`#approvalCommentModal_${elementID} .modal-body`).find(".approvers_edit_data").empty(),$(`#approvalCommentModal_${elementID} .modal-body`).find(".approvers_edit_data").css("display","none"),$(`#approvalCommentModal_${elementID}`).find(".modal-title").text("Rejection Comment"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").text("Reject Record"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("onclick","approve_ind.call(this)"),$(`#approvalCommentModal_${elementID} .modal-body`).find(".delegateApprovalContainer").css("display","none"),CKEDITOR.instances[`approvalCommentText${elementID}`].setData(""),$(`#approvalCommentModal_${elementID}`).modal("show");let approval_type="reject";$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-approval_id",String(primaryKeyId)),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-tablename",app_tablename),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-approval_type",approval_type),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-element-id",elementID)}else if("resend"===String(e.target.attributes[1].value))$(`#approvalCommentModal_${elementID} .modal-body`).find(".approvers_edit_data").empty(),$(`#approvalCommentModal_${elementID} .modal-body`).find(".approvers_edit_data").css("display","none"),$(`#approvalCommentModal_${elementID}`).find(".modal-title").text("Resend Comment"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").text("Resend Record"),$(`#approvalCommentModal_${elementID} .modal-body`).find(".delegateApprovalContainer").css("display","none"),CKEDITOR.instances[`approvalCommentText${elementID}`].setData(""),$(`#approvalCommentModal_${elementID}`).modal("show"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-approval_id",String(primaryKeyId)),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-tablename",app_tablename),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-approval_type","resend"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("onclick","resend_ind.call(this)"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-element-id",elementID);else if("pdf"===String(e.target.attributes[1].value)){const header=[],value=[],dataAttr=[];var finalJSON={};$(`#example1${elementID} thead tr th`).each((function(){header.push($(this).text())}));const curr=$(this).closest("tr");curr.find("td").each((function(){"View Details"===String($(this).find("button").text())?($(this).find("button").attr("data-data")?value.push($(this).find("button").attr("data-data")):value.push($(this).find("button").attr("data-name")),dataAttr.push($(this).find("button").attr("data-col"))):"View Data"===String($(this).find("button").text())?$(this).find("button").attr("data-data")&&value.push($(this).find("button").attr("data-data")):$(this).find(".listviewembededcomputation").length>0||value.push($(this).text())}));for(let i=1;i<header.length;i++)null!=value[i]&&(value[i].includes("NULL")?finalJSON[header[i]]="-":finalJSON[header[i]]=value[i]);$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{final_json:JSON.stringify(finalJSON),data_list:$(e.target).attr("data-list"),table_name:$(e.target).parent().attr("data-table_model_name"),operation:"pdf_generation_single_record"},type:"POST",success:function(response){var a=document.createElement("a");a.href=`data:document/pdf;base64,${response}`,a.download="Transaction Details.pdf",a.click()},error:function(){Swal.fire({icon:"error",text:"Error!. Please try again."})}})}if("approval_wall"===String(e.target.attributes[1].value)){if(resolved_ind_comments_list=[],allowed_rejection=$(e.target).parent().attr("data-reject"),allowed_approval=$(e.target).parent().attr("data-approve"),allowed_edit=$(e.target).parent().attr("data-edit"),allowed_resend=$(e.target).parent().attr("data-resend"),allowed_delegate=$(e.target).parent().attr("data-delegate"),"true"==allowed_approval?($(`#approvalWallModalBody_${elementID}`).find(`#approval_wall_approve_${elementID}`).css("pointer-events","all"),$(`#approvalWallModalBody_${elementID}`).find(`#approval_wall_approve_${elementID}`).css("opacity","1")):($(`#approvalWallModalBody_${elementID}`).find(`#approval_wall_approve_${elementID}`).css("pointer-events","none"),$(`#approvalWallModalBody_${elementID}`).find(`#approval_wall_approve_${elementID}`).css("opacity","0.5")),"true"==allowed_rejection?($(`#approvalWallModalBody_${elementID}`).find(`#approval_wall_reject_${elementID}`).css("pointer-events","all"),$(`#approvalWallModalBody_${elementID}`).find(`#approval_wall_reject_${elementID}`).css("opacity","1")):($(`#approvalWallModalBody_${elementID}`).find(`#approval_wall_reject_${elementID}`).css("pointer-events","none"),$(`#approvalWallModalBody_${elementID}`).find(`#approval_wall_reject_${elementID}`).css("opacity","0.5")),"true"==allowed_resend?($(`#approvalWallModalBody_${elementID}`).find(`#approval_sendtoprevious_${elementID}`).css("pointer-events","all"),$(`#approvalWallModalBody_${elementID}`).find(`#approval_sendtoprevious_${elementID}`).css("opacity","1")):($(`#approvalWallModalBody_${elementID}`).find(`#approval_sendtoprevious_${elementID}`).css("pointer-events","none"),$(`#approvalWallModalBody_${elementID}`).find(`#approval_sendtoprevious_${elementID}`).css("opacity","0.5")),"true"==allowed_delegate){let userInfo=$(e.target).parent().attr("data-user-info"),currentUserName=$(e.target).parent().attr("data-current-user");$(`#approvalWallModalBody_${elementID}`).find(`#approval_delegate_${elementID}`).css("pointer-events","all"),$(`#approvalWallModalBody_${elementID}`).find(`#approval_delegate_${elementID}`).css("opacity","1"),$(`#approvalWallModalBody_${elementID}`).find(`#approval_delegate_${elementID}`).attr("data-user-info",userInfo),$(`#approvalWallModalBody_${elementID}`).find(`#approval_delegate_${elementID}`).attr("data-current-user",currentUserName)}else $(`#approvalWallModalBody_${elementID}`).find(`#approval_delegate_${elementID}`).css("pointer-events","none"),$(`#approvalWallModalBody_${elementID}`).find(`#approval_delegate_${elementID}`).css("opacity","0.5"),$(`#approvalWallModalBody_${elementID}`).find(`#approval_delegate_${elementID}`).removeAttr("data-user-info"),$(`#approvalWallModalBody_${elementID}`).find(`#approval_delegate_${elementID}`).removeAttr("data-current-user");$(`#approvalWallModalBody_${elementID}`).find(".transaction_datatable").empty(),$(`#approvalWallModalBody_${elementID}`).find(`.approval_outer_${elementID}`).empty(),$(`#approvalWallModalBody_${elementID}`).find(".created_by_info").empty(),$(`#approvalWallModalBody_${elementID}`).find(`#approval_status_${elementID}`).find(".card-text").empty(),$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).empty(),$(`#level_config_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`#save_transaction_data_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`#edit_transaction_data_${elementID}`).css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(`#approver_users_${elementID}`).css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(`#approval_status_${elementID}`).css("display","block");const header=[],dataAttr=[];var approval_audit_log_button="";$(`#example1${elementID} thead tr th`).each((function(){header.push($(this).text())}));const curr=$(this).closest("tr");curr.find("td").each((function(){"View Details"===String($(this).find("button").text())&&(str_val=$(this).find("button").attr("data-data"),"approval_audit_log"==$(this).find("button").attr("data-name")&&(approval_audit_log_button=$(this).find("button")))})),$.ajax({url:`/users/${urlPath}/approval_table/`,data:{approval_id:primaryKeyId,element_id:elementID,operation:"fetch_approvalwall_data"},type:"POST",dataType:"json",success:function(data){let url_string=window.location.pathname,f_occ=url_string.indexOf("/",url_string.indexOf("/")+1),s_occ=url_string.indexOf("/",url_string.indexOf("/")+f_occ+1),t_occ=url_string.indexOf("/",url_string.indexOf("/")+s_occ+1),app_code=url_string.substring(f_occ+1,s_occ);display_sections_approval_wall=data.display_sections_approval_wall,display_in_comments_cols=data.display_in_comments_cols,search_in_comments_cols=data.search_in_comments_cols,all_users_list=data.all_users_list;var smtpConfigKey=data.smtpConfigKey;display_sections_approval_wall.includes("approval_status")?$(`#approvalWallModalBody_${elementID}`).find(`#approval_status_${elementID}`).css("display","none"):$(`#approvalWallModalBody_${elementID}`).find(`#approval_status_${elementID}`).css("display","block"),display_sections_approval_wall.includes("approver_type")?$(`#approvalWallModalBody_${elementID}`).find(`#approver_type_${elementID}`).css("display","none"):$(`#approvalWallModalBody_${elementID}`).find(`#approver_type_${elementID}`).css("display","block"),display_sections_approval_wall.includes("type_of_approval")?$(`#approvalWallModalBody_${elementID}`).find(`#type_of_approval_${elementID}`).css("display","none"):$(`#approvalWallModalBody_${elementID}`).find(`#type_of_approval_${elementID}`).css("display","block"),display_sections_approval_wall.includes("approval_code")?$(`#approvalWallModalBody_${elementID}`).find(`#approval_code_${elementID}`).css("display","none"):$(`#approvalWallModalBody_${elementID}`).find(`#approval_code_${elementID}`).css("display","block"),mentions_user_list=JSON.parse(data.mentions_user_list),data.hasOwnProperty("maximum_levels_allowed")&&$(`#approvalWallModalBody_${elementID}`).attr("data-maximum_levels_allowed",data.maximum_levels_allowed),data.hasOwnProperty("maximum_approvers_allowed")&&$(`#approvalWallModalBody_${elementID}`).attr("data-maximum_approvers_allowed",data.maximum_approvers_allowed);var itemTemplate=`<li data-id="{id}"><strong class="username"> ${getFormattedName(search_in_comments_cols)}</strong></li>`,outputTemplate=`<a href="">@${display_in_comments_cols.map(prop=>`{${prop}}`).join(" ")}</a><span>&nbsp;</span>`,editor1,reply_editor,reply_editor1,new_reply_editor;CKEDITOR.on("instanceReady",(function(evt){var editor=evt.editor;editor.on("focus",(function(e){element=e.editor.container.$,$(element).find(".cke_top.cke_reset_all").css("display","block"),$(element).find(".cke_contents.cke_reset").css("height","80px")})),editor.on("blur",(function(e){element=e.editor.container.$,$(element).find(".cke_top.cke_reset_all").css("display","none"),$(element).find(".cke_contents.cke_reset").css("height","44px")}))})),editor1&&editor1.destroy(),editor1=CKEDITOR.replace(`approvalWallCommentText_${elementID}`,{height:44,removeButtons:home_rtf[0],editorplaceholder:"Add a comment...",plugins:"mentions,undo,link,list,basicstyles,justify,richcombo,wysiwygarea,toolbar",extraPlugins:"elementspath,editorplaceholder",toolbar:[{name:"document",items:["Undo"]},{name:"paragraph",items:["NumberedList","BulletedList","-","Outdent","Indent","-","Blockquote","CreateDiv","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"basicstyles",items:["Bold","Italic","Underline","Strike","-","RemoveFormat"]},{name:"links",items:["Mention","Link","Unlink","Anchor"]},{name:"styles",items:["Styles","Format","Font","FontSize"]},{name:"colors",items:["TextColor","BGColor"]},{name:"elementspath",items:["ElementPath"]}],mentions:[{feed:dataFeed,itemTemplate:itemTemplate,outputTemplate:outputTemplate,minChars:0}],removeButtons:"PasteFromWord"}),CKEDITOR.config.bodyClass="custom_cke_class",CKEDITOR.config.removePlugins="exportpdf",CKEDITOR.config.extraPlugins="autocorrect,elementspath",CKEDITOR.instances[`approvalWallCommentText_${elementID}`].setData(""),(editor1=CKEDITOR.instances[`approvalWallCommentText_${elementID}`]).on("change",(function(){const typedText=editor1.getData();""===typedText.trim()?$(`#add_comment_${elementID}`).prop("disabled",!0):$(`#add_comment_${elementID}`).prop("disabled",!1)})),editor1.on("key",(function(event){event.data.keyCode===CKEDITOR.CTRL+13&&$(`#add_comment_${elementID}`).trigger("click")})),result_data=data.data[0];var approver_user_data_list=data.user_list,user_additional_info=data.user_additional_info,created_user_data=data.created_user_data,modified_user_data=data.modified_user_data,type_of_approval=result_data.type_of_approval,approver_type=result_data.approver_type,approval_code=result_data.approval_code,approved_by_current_level=[],current_level=0,audit_log_configs=[],approved_by={},approval_status=result_data.approval_status;freeze_comments_option="Approved"==approval_status||"Rejected"==approval_status;var approver_user=JSON.parse(result_data.approver_user),verbose_table_data=JSON.parse(data.verbose_table_data);if(parsed_json_data=JSON.parse(result_data.json_data),transaction_data_to_edit=JSON.parse(result_data.json_data)[0],resolve_all_comments=data.resolve_all_comments,reopen_all_comments=data.reopen_all_comments,resolve_individual_comments=data.resolve_individual_comments,reopen_individual_comments=data.reopen_individual_comments,!resolve_all_comments||"true"!=allowed_approval&&"true"!=allowed_rejection&&"true"!=allowed_edit?$(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).css("display","none"):($(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).attr("disabled",!1)),result_data.approval_audit_log&&(audit_log_configs=JSON.parse(result_data.approval_audit_log)),$(`#resolve_all_button_${elementID}`).off("click").on("click",(function(){Swal.fire({icon:"question",text:"Are you sure you want to resolve all comments?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(result=>{if(result.isConfirmed){var resolve_all=!0;$.ajax({url:`/users/${urlPath}/approval_table/`,data:{operation:"update_comments_in_approval_table",resolve_all:!0,approval_id:result_data.id,audit_log_configs:JSON.stringify(audit_log_configs)},type:"POST",dataType:"json",success:function(data){$(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).attr("disabled",!0),$(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`.new_discussion_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`.approval_outer_${elementID}`).addClass("mt-5 mb-3"),$(`#approvalWallModalBody_${elementID}`).find(`#comment_status${elementID}`).html("Status: <b>Resolved</b>"),$(`#approvalWallModalBody_${elementID}`).find(`#comment_status${elementID}`).attr("class","resolved_comment"),$(`#approvalWallModalBody_${elementID}`).find(`#add_comment_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(".reply_comments").css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(".approval_comment").css("background","#f8f8f8"),$(`#approvalWallModalBody_${elementID}`).find(".reply-area").css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(".resolve_button_ind").attr("disabled",!1),$(`#approvalWallModalBody_${elementID}`).find(".resolve_button_ind").css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(".comment_status_ind").html("Status: <b>Resolved</b>"),$(`#approvalWallModalBody_${elementID}`).find(".comment_status_ind").attr("class","comment_status_ind resolved_comment"),!reopen_all_comments||"true"!=allowed_approval&&"true"!=allowed_rejection&&"true"!=allowed_edit?$(`#approvalWallModalBody_${elementID}`).find(`#reopen_all_button_${elementID}`).css("display","none"):($(`#approvalWallModalBody_${elementID}`).find(`#reopen_all_button_${elementID}`).css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(`#reopen_all_button_${elementID}`).attr("disabled",!1)),!reopen_individual_comments||"true"!=allowed_approval&&"true"!=allowed_rejection&&"true"!=allowed_edit?$(`#approvalWallModalBody_${elementID}`).find(".reopen_button_ind").css("display","none"):($(`#approvalWallModalBody_${elementID}`).find(".reopen_button_ind").css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(".reopen_button_ind").attr("disabled",!1)),$(".resolve_button_ind").each((function(){ele_id=this.id.split("_ind_")[1],resolved_ind_comments_list.includes(ele_id)||resolved_ind_comments_list.push(ele_id)}))},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}})})),$(`#reopen_all_button_${elementID}`).off("click").on("click",(function(){Swal.fire({icon:"question",text:"Are you sure you want to reopen all comments?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(result=>{if(result.isConfirmed){var reopen_all=!0;$.ajax({url:`/users/${urlPath}/approval_table/`,data:{operation:"update_comments_in_approval_table",reopen_all:!0,approval_id:result_data.id,audit_log_configs:JSON.stringify(audit_log_configs)},type:"POST",dataType:"json",success:function(data){$(`#approvalWallModalBody_${elementID}`).find(`#reopen_all_button_${elementID}`).attr("disabled",!0),$(`#approvalWallModalBody_${elementID}`).find(`#reopen_all_button_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`.new_discussion_${elementID}`).css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(`.new_discussion_${elementID}`).addClass("mt-5 mb-3"),$(`#approvalWallModalBody_${elementID}`).find(`.approval_outer_${elementID}`).removeClass("mt-5 mb-3"),$(`#approvalWallModalBody_${elementID}`).find(`#add_comment_${elementID}`).css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(".reply_comments").css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(".reply-area").css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(".approval_comment").css("background","#ffffff"),$(`#approvalWallModalBody_${elementID}`).find(".reopen_button_ind").attr("disabled",!1),$(`#approvalWallModalBody_${elementID}`).find(".reopen_button_ind").css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`#comment_status${elementID}`).html("Status: <b>Reopened</b>"),$(`#approvalWallModalBody_${elementID}`).find(`#comment_status${elementID}`).attr("class","reopened_comment"),$(`#approvalWallModalBody_${elementID}`).find(".comment_status_ind").html("Status: <b>Reopened</b>"),$(`#approvalWallModalBody_${elementID}`).find(".comment_status_ind").attr("class","comment_status_ind reopened_comment"),!resolve_all_comments||"true"!=allowed_approval&&"true"!=allowed_rejection&&"true"!=allowed_edit?$(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).css("display","none"):($(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).attr("disabled",!1)),!resolve_individual_comments||"true"!=allowed_approval&&"true"!=allowed_rejection&&"true"!=allowed_edit?$(`#approvalWallModalBody_${elementID}`).find(".resolve_button_ind").css("display","none"):($(`#approvalWallModalBody_${elementID}`).find(".resolve_button_ind").css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(".resolve_button_ind").attr("disabled",!1)),resolved_ind_comments_list=[]},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}})})),"true"==allowed_edit&&"true"!=allowed_approval?$(`#approvalWallModalBody_${elementID}`).find(`#edit_transaction_data_${elementID}`).attr("disabled",!1):$(`#approvalWallModalBody_${elementID}`).find(`#edit_transaction_data_${elementID}`).attr("disabled",!0),result_data.modify_column&&(modify_column=JSON.parse(result_data.modify_column)),$(`#approvalWallModalBody_${elementID}`).find(`#add_levels_div_${elementID}`).css("display","none"),parsed_json_data){transaction_data_alignment_class="",""!=data.transaction_data_alignment&&(transaction_data_alignment_class=`text-${data.transaction_data_alignment.toLowerCase()}`);var jsondatahtml=`\n                <table id="aprovalwallJsondata_${elementID}" class="table table-striped table-bordered" cellspacing="0" width="100%">\n                  <thead>\n                    <tr>\n                      <th class="${transaction_data_alignment_class}">Particulars</th>\n                      <th class="${transaction_data_alignment_class}">Details</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                  </tbody>\n                </table>`;$(`#approvalWallModalBody_${elementID}`).find(".transaction_datatable").append(jsondatahtml);var appJSONCols=data.appJSONCols;for(let i in parsed_json_data){string="";for(let[key,value]of Object.entries(parsed_json_data[i]))if(!appJSONCols.includes(key))if("created_by"==String(key)){const targetItem=created_user_data[0];let additionalString="";if(targetItem){const{username:username,...dataWithoutUsername}=targetItem,dataValues=Object.values(dataWithoutUsername).filter(value=>"-"!=value&&""!=value);additionalString=`(${dataValues.join(" ")})`}string+=`<tr>\n                        <td class="view_details_wrap ${transaction_data_alignment_class}" data-columnname="${String(key)}">${verbose_table_data[String(key)]}</td>\n                        <td class="view_details_wrap ${transaction_data_alignment_class}">${String(value)} ${additionalString}</td>\n                      </tr>`}else if("modified_by"==String(key)){const targetItem=modified_user_data[0];let additionalString="";if(targetItem){const{username:username,...dataWithoutUsername}=targetItem,dataValues=Object.values(dataWithoutUsername).filter(value=>"-"!=value&&""!=value);additionalString=`(${dataValues.join(" ")})`}string+=`<tr>\n                        <td class="view_details_wrap ${transaction_data_alignment_class}" data-columnname="${String(key)}">${verbose_table_data[String(key)]}</td>\n                        <td class="view_details_wrap ${transaction_data_alignment_class}">${String(value)} ${additionalString}</td>\n                      </tr>`}else string+=`<tr>\n                        <td class="view_details_wrap ${transaction_data_alignment_class}" data-columnname="${String(key)}">${verbose_table_data[String(key)]}</td>\n                        <td class="view_details_wrap ${transaction_data_alignment_class}">${String(value)}</td>\n                      </tr>`}$(`#aprovalwallJsondata_${elementID}`).find("tbody").append(string);var table=$(`#aprovalwallJsondata_${elementID}`).DataTable({autoWidth:!0,scrollCollapse:!0,responsive:!0,scrollY:"50vh",scrollX:"300",bLengthChange:!1,searching:!1,info:!1,paging:!1,ordering:!1,columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"}]});setTimeout(()=>{table.columns.adjust()},200),$(`#aprovalwallJsondata_${elementID}`).on("column-visibility.dt",(function(e,settings,column,state){$(`#aprovalwallJsondata_${elementID}`).DataTable().columns.adjust()})),$(document).on("shown.bs.modal",(function(e){$.fn.dataTable.tables({visible:!0,api:!0}).columns.adjust()}))}if(result_data.approved_by&&(approved_by=JSON.parse(result_data.approved_by)).hasOwnProperty(current_level)&&(approved_by_current_level=approved_by[current_level]),result_data.approval_level_config){approval_level_config=JSON.parse(result_data.approval_level_config),$(`#level_config_${elementID}`).css("display","block"),current_level=approval_level_config.current_level,approval_levels=approval_level_config.level_config,$(`#approvalWallModalBody_${elementID}`).find(`#approver_users_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`#edit_approvers_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`#save_approvers_${elementID}`).css("display","none"),"true"==allowed_edit?(user_additional=JSON.stringify(user_additional_info),$(`#approvalWallModalBody_${elementID}`).find(`#edit_approval_levels_${elementID}`).css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(`#save_approval_levels_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`#edit_approval_levels_${elementID}`).attr("onclick",`editApprovalLevels(${result_data.id},${result_data.approval_level_config})`),$(`#approvalWallModalBody_${elementID}`).find(`#save_approval_levels_${elementID}`).attr("onclick",`saveLevelChangeComment(${result_data.id},${result_data.approval_level_config})`)):($(`#approvalWallModalBody_${elementID}`).find(`#edit_approval_levels_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`#save_approval_levels_${elementID}`).css("display","none"));for(let i in approval_levels){let approved_by_level=[];if(approved_by[parseInt(i)]&&(approved_by_level=approved_by[parseInt(i)]),non_sortable_class="",bg_color="",parseInt(i)==current_level&&("Pending"==result_data.approval_status?bg_color="background: #ffd700;color:black;":"Rejected"==result_data.approval_status?bg_color="background: rgba(205,74,69,1);color:white;":"Approved"==result_data.approval_status&&(bg_color="background: rgba(85,163,98,1);color:white;")),parseInt(i)<current_level&&(non_sortable_class="no_sort",bg_color="background: darkgrey;color:white;"),string=`<div data-level="${i}" class="approval_level_divs ${non_sortable_class}">\n                <div class="row">\n                  <div class="col-3"><div class="levelclass" style="${bg_color}">Level ${i}</div></div>\n                  <div class="col-9" style="border-left: 1px solid lightgrey;">`,approval_levels[i].hasOwnProperty("approver_type")&&(string+='<div style="border-radius: 0.5rem;padding: 10px;text-align: left;">',string+=`<div><h6 style="margin-bottom:0rem;text-transform:capitalize;font-weight: bold;" data-col="approver_type">${approval_levels[i].approver_type} approvers</h6></div></div>`),approval_levels[i].hasOwnProperty("approval_type")&&(string+='<div style="border-radius: 0.5rem;padding: 10px;text-align: left;display:none;">',string+=`<div><h6 style="margin-bottom:0rem;text-transform:capitalize;font-weight: bold;" data-col="approval_type">${approval_levels[i].approval_type}</h6></div></div>`),approval_levels[i].hasOwnProperty("user_list")){for(user of(string+='<div style="border-radius: 0.5rem;padding: 10px;"><h6 style="margin-bottom: 0.5rem;font-size:13px;text-transform: capitalize;text-align: left;">Approvers</h6>',string+='<div data-col="user_list" >',approval_levels[i].user_list)){let user_initials=getInitials(user);const targetItem=user_additional_info.find(item=>item.username===user);let additionalString="";if(targetItem){const{username:username,id:id,...dataWithoutUsername}=targetItem,dataValues=Object.values(dataWithoutUsername).filter(value=>"-"!=value&&""!=value);additionalString=`(${dataValues.join(" ")})`}approved_by_level.includes(user)?string+=`<div class='align-items-center' style="display:flex;background: white;margin: 6px 0;box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 4px;border: 1px solid lightgray;padding: 8px;border-radius: 5px;"><span class='radio mr-2 d-flex align-items-center justify-content-center' style='height: 20px;width: 20px;background: rgba(85,163,98,1);border-radius: 50%;border: 2px solid rgb(76 148 88);'><i class="fa fa-check" style="color:white"></i></span><h5 class="created_title mb-0 mr-2 ml-2" style="width:6%;"><span class="user_initials">${user_initials}</span></h5><div class="name_card"><h6 style="margin-bottom:1px !important;font-size: 14px;" class="text-left ml-2 username">${user}</h6>`:string+=`<div class='align-items-center' style="display:flex;background: white;margin: 6px 0;box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 4px;border: 1px solid lightgray;padding: 8px;border-radius: 5px;"><span class='radio mr-2 d-flex align-items-center justify-content-center' style='height: 20px;width: 20px;background: #f4f4f4;border-radius: 50%;border: 2px solid grey'></span><h5 class="created_title mb-0 mr-2 ml-2" style="width:6%;"><span class="user_initials">${user_initials}</span></h5><div class="name_card"><h6 style="margin-bottom:1px !important;font-size: 14px;" class="text-left ml-2 username">${user}</h6>`,string+="()"!=additionalString&&""!=additionalString?`<span class="ml-2 user_info" style="color: rgba(0,0,0,.55);font-size: .7rem;">${additionalString}</span></div></div>`:"</div></div>"}string+="</div></div>"}if(approval_levels[i].hasOwnProperty("group_list")){string+='<div style="border-radius: 0.5rem;padding: 10px;"><h6 style="margin-bottom: 0.5rem;font-size:13px;text-transform: capitalize;text-align: left;">Approver Groups</h6>';let groups_list=approval_levels[i].group_list,group_html="";for(group of groups_list)group_html+=`<div style="font-size: 15px;background: var(--primary-color);color: white;padding: 3px 10px;border-radius: 8rem;">${group}</div>`;string+=`<div>\n                  <h6 style="margin-bottom:0rem;box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 4px;background: white;font-size:15px;border: 1px solid lightgray;padding:5px;border-radius:5px;display:flex;align-items:center;justify-content:start;gap:5px;" data-col="group_list">\n                  ${group_html}\n                  </h6></div></div>`}if(approved_by_level.length>0&&!approval_levels[i].hasOwnProperty("user_list")){for(user of(string+='<div style="border-radius: 0.5rem;padding: 10px;"><h6 style="margin-bottom: 0.5rem;font-size:13px;text-transform: capitalize;text-align: left;">Approved By</h6>',approved_by_level)){let user_initials=getInitials(user);const targetItem=user_additional_info.find(item=>item.username===user);let additionalString="";if(targetItem){const{username:username,id:id,...dataWithoutUsername}=targetItem,dataValues=Object.values(dataWithoutUsername).filter(value=>"-"!=value&&""!=value);additionalString=`(${dataValues.join(" ")})`}string+=`<div class='d-flex align-items-center' style="margin: 6px 0;background: white;box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 4px;border: 1px solid lightgray;padding: 5px;border-radius: 5px;"><span class='radio mr-2 d-flex align-items-center justify-content-center' style='height: 20px;width: 20px;background: rgba(85,163,98,1);border-radius: 50%;border: 2px solid rgb(76 148 88);'><i class="fa fa-check" style="color:white"></i></span><h5 class="created_title mb-0 mr-2 ml-2" style="width:6%;"><span>${user_initials}</span></h5><div class="name_card"><h6 style="margin-bottom:1px !important;font-size:14px;" class="text-left ml-2">${user}</h6>`,string+="()"!=additionalString&&""!=additionalString?`<span class="ml-2" style="color: rgba(0,0,0,.55);font-size: .7rem;">${additionalString}</span></div></div>`:"</div></div>"}string+="</div>"}string+="</div></div></div>",$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).append(string)}}created_by=result_data.created_by,created_time=result_data.created_date;var[timestamp,tooltipTimestamp]=convertToTimestamp(created_time),small_time="at"+tooltipTimestamp.split("at")[1],initials=getInitials(created_by);const targetItem=created_user_data[0];let additionalString="";if(targetItem){const{username:username,...dataWithoutUsername}=targetItem,dataValues=Object.values(dataWithoutUsername).filter(value=>"-"!=value&&""!=value);additionalString=`(${dataValues.join(" ")})`}var approval_type=result_data.approval_type,edit_or_create="";"edit"==approval_type?edit_or_create="edited the":"create"==approval_type&&(edit_or_create="created a new"),audit_html=`\n              <div class="approval_card">\n                <div class="approval_info">\n                  <h5 class="approval_title"><span>${initials}</span></h5>\n                  <p class="approval_text">${created_by} ${additionalString} ${edit_or_create} transaction.</p>\n                  <div>\n                    <h6 class="approval_timestamp" data-toggle="tooltip" title="${tooltipTimestamp}">${timestamp}</h6>\n                    <small style="color: #929292;">${small_time}</small>\n                  </div>\n                </div>\n              </div>\n            `,$(`#approvalWallModalBody_${elementID}`).find(`.approval_outer_${elementID}`).prepend(audit_html),$(`#approvalWallModalBody_${elementID}`).find(".created_by_info").prepend(`<h6 class="approval-created-info text-left mb-1" >${created_by} ${additionalString} ${edit_or_create} transaction on ${tooltipTimestamp}</h6>`),$(`#approvalWallModalBody_${elementID}`).find(".created_by_info").prepend(`<h5 class="created_title mb-0 mr-2 ml-2"><span>${initials}</span></h5>`),$("#requester_details").find(".created_title").html(`<span>${initials}</span>`),$("#requester_details").find(".approval-created-info").html(`${created_by} ${additionalString} ${edit_or_create} transaction on ${tooltipTimestamp}`),"Pending"==(approval_status=result_data.approval_status)?($(`#approvalWallModalBody_${elementID}`).find(".created_by_info").prepend(`<h6 class="created_title_status" style="background: #ffd700;width: fit-content;padding: 7px 10px;border-radius: 34px;font-size: 0.9rem;color: black;margin:0;">${approval_status}</h6>`),$(`#approvalWallModalBody_${elementID}`).find(`#approval_status_${elementID}`).find(".card-text").html(`<h6 class="mr-2" style="background: #ffd700;width: fit-content;padding: 7px 10px;border-radius: 34px;font-size: 0.9rem;color: black;margin:0;">${approval_status}</h6>`)):"Rejected"==approval_status?($(`#approvalWallModalBody_${elementID}`).find(".created_by_info").prepend(`<h6 class="created_title_status" style="background: rgba(205,74,69,1);width: fit-content;padding: 7px 10px;border-radius: 34px;font-size: 0.9rem;color: white;margin:0;">${approval_status}</h6>`),$(`#approvalWallModalBody_${elementID}`).find(`#approval_status_${elementID}`).find(".card-text").html(`<h6 class="mr-2" style="background: rgba(205,74,69,1);width: fit-content;padding: 7px 10px;border-radius: 34px;font-size: 0.9rem;color: white;margin:0;">${approval_status}</h6>`)):"Approved"==approval_status&&($(`#approvalWallModalBody_${elementID}`).find(".created_by_info").prepend(`<h6 class="created_title_status" style="background: rgba(85,163,98,1);width: fit-content;padding: 7px 10px;border-radius: 34px;font-size: 0.9rem;color: white;margin:0;">${approval_status}</h6>`),$(`#approvalWallModalBody_${elementID}`).find(`#approval_status_${elementID}`).find(".card-text").html(`<h6 class="mr-2" style="background: rgba(85,163,98,1);width: fit-content;padding: 7px 10px;border-radius: 34px;font-size: 0.9rem;color: white;margin:0;">${approval_status}</h6>`)),$(`#approvalWallModalBody_${elementID}`).find(`#type_of_approval_${elementID}`).find(".card-text").text(`${type_of_approval}`),$(`#approvalWallModalBody_${elementID}`).find(`#approver_type_${elementID}`).find(".card-text").text(`${approver_type}`),$(`#approvalWallModalBody_${elementID}`).find(`#approval_code_${elementID}`).find(".card-text").text(`${approval_code}`),li_html="",approver_user_data_list=approver_user_data_list.filter(item=>item.username!=created_by);for(var i=0;i<approver_user_data_list.length;i++){const targetItem=user_additional_info.find(item=>item.username===approver_user_data_list[i].username);let additionalString="";if(targetItem){const{username:username,id:id,...dataWithoutUsername}=targetItem,dataValues=Object.values(dataWithoutUsername).filter(value=>"-"!=value&&""!=value);additionalString=`(${dataValues.join(" ")})`}if(approved_by_current_level.length>0)if(approved_by_current_level.includes(approver_user_data_list[i].username)){var initials=getInitials(approver_user_data_list[i].username);li_html+=`<li class='m-3 align-items-center li_approvers' style="display:flex"><span class='radio mr-2 d-flex align-items-center justify-content-center' style='height: 20px;width: 20px;background: rgba(85,163,98,1);border-radius: 50%;border: 2px solid rgb(76 148 88);'><i class="fa fa-check" style="color:white"></i></span><h5 class="created_title mb-0 mr-2 ml-2" style="width:6%;"><span>${initials}</span></h5><div style="text-align:left"><h6 style="margin-bottom:1px !important; padding-left: 1rem;" class='approver_${approver_user_data_list[i].username} approvers_username text-left ml-2'>${approver_user_data_list[i].username}</h6>`,"()"!=additionalString&&""!=additionalString&&(li_html+=`<span class="ml-2" style="color: rgba(0,0,0,.55);font-size: .7rem;padding-left: 1rem;">${additionalString}</span></div></li>`)}else{var initials=getInitials(approver_user_data_list[i].username);li_html+=`<li class='m-3 align-items-center li_approvers' style="display:flex"><span class='radio mr-2 d-flex align-items-center justify-content-center' style='height: 20px;width: 20px;background: #f4f4f4;border-radius: 50%;border: 2px solid grey;'></span><h5 class="created_title mb-0 mr-2 ml-2" style="width:6%;"><span>${initials}</span></h5><div style="text-align:left"><h6 style="margin-bottom:1px !important;padding-left: 1rem;" class='approver_${approver_user_data_list[i].username} approvers_username text-left ml-2'>${approver_user_data_list[i].username}</h6>`,"()"!=additionalString&&""!=additionalString&&(li_html+=`<span class="ml-2" style="color: rgba(0,0,0,.55);font-size: .7rem;padding-left: 1rem;">${additionalString}</span></div></li>`)}else{var initials=getInitials(approver_user_data_list[i].username);li_html+=`<li class='m-3 align-items-center li_approvers' style="display:flex"><span class='radio mr-2 d-flex align-items-center justify-content-center' style='height: 20px;width: 20px;background: #f4f4f4;border-radius: 50%;border: 2px solid grey;'></span><h5 class="created_title mb-0 mr-2 ml-2" style="width:6%;"><span>${initials}</span></h5><div style="text-align:left"><h6 style="margin-bottom:1px !important;padding-left: 1rem;" class='approver_${approver_user_data_list[i].username} approvers_username text-left ml-2'>${approver_user_data_list[i].username}</h6>`,"()"!=additionalString&&""!=additionalString&&(li_html+=`<span class="ml-2" style="color: rgba(0,0,0,.55);font-size: .7rem;padding-left: 1rem;">${additionalString}</span></div></li>`)}}if($(`#approvalWallModalBody_${elementID}`).find(`#approver_users_${elementID}`).find("ul").html(li_html),"true"==allowed_edit?(user_additional=JSON.stringify(user_additional_info),$(`#approvalWallModalBody_${elementID}`).find(`#edit_approvers_${elementID}`).css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(`#save_approvers_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`#edit_approvers_${elementID}`).attr("onclick",`editApprovers(${result_data.id}, ${result_data.approver_group}, '${result_data.type_of_approval}')`),$(`#approvalWallModalBody_${elementID}`).find(`#save_approvers_${elementID}`).attr("onclick",`saveApprovers(${result_data.id}, ${result_data.approver_group}, ${JSON.stringify(approver_user_data_list)}, ${result_data.approval_audit_log}, '${result_data.type_of_approval}', '${result_data.approver_type}')`)):($(`#approvalWallModalBody_${elementID}`).find(`#edit_approvers_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`#save_approvers_${elementID}`).css("display","none")),result_data.approval_audit_log)for(let i=0;i<audit_log_configs.length;i++)for(let[key,value]of Object.entries(audit_log_configs[i]))for(let j=0;j<value.length;j++){dictt=value[j];var[timestamp,tooltipTimestamp]=convertToTimestamp(dictt.time),small_time="at"+tooltipTimestamp.split("at")[1],initials=getInitials(dictt.user);const targetItem=user_additional_info.find(item=>item.username===dictt.user);let additionalString="";if(targetItem){const{username:username,id:id,...dataWithoutUsername}=targetItem,dataValues=Object.values(dataWithoutUsername).filter(value=>"-"!=value&&""!=value);additionalString=`(${dataValues.join(" ")})`,(additionalString="()")&&(additionalString="")}if("Comment"==dictt.action){let comment_status="Active",comment_class="active_comment",all_comments_status="",reopen_button_attr,reopen_button_style,resolve_button_attr,resolve_button_style,card_background,reply_display;all_comments_status=dictt.all_comments_status,"resolved_for_all"==all_comments_status?(all_comments_resolved=!0,resolve_button_attr="disabled",resolve_button_style="display:none;",card_background="background:#f8f8f8;",comment_status="Resolved",reply_display="display:none;",comment_class="resolved_comment",reopen_button_attr="disabled",reopen_button_style="display:none;",!reopen_individual_comments||"true"!=allowed_approval&&"true"!=allowed_rejection&&"true"!=allowed_edit||(reopen_button_attr="",reopen_button_style="display:block;")):all_comments_resolved=!1,"reopened_for_all"==all_comments_status?(all_comments_reopened=!0,card_background="background:#ffffff;",comment_status="Reopened",reply_display="display:block;",comment_class="reopened_comment",reopen_button_attr="disabled",reopen_button_style="display:none;",resolve_button_attr="disabled",resolve_button_style="display:none;",!resolve_individual_comments||"true"!=allowed_approval&&"true"!=allowed_rejection&&"true"!=allowed_edit||(resolve_button_attr="",resolve_button_style="display:block;")):all_comments_reopened=!1;let individual_comment_status="";if(individual_comment_status=dictt.individual_comment_status,"resolved_individual_comment"==individual_comment_status?(resolved_ind_comments_list.includes(`${i}${j}`)||resolved_ind_comments_list.push(`${i}${j}`),resolve_button_attr="disabled",resolve_button_style="display:none;",card_background="background:#f8f8f8;",comment_status="Resolved",reply_display="display:none;",comment_class="resolved_comment",reopen_button_attr="disabled",reopen_button_style="display:none;",!reopen_individual_comments||"true"!=allowed_approval&&"true"!=allowed_rejection&&"true"!=allowed_edit||(reopen_button_attr="",reopen_button_style="display:block;")):"reopened_individual_comment"==individual_comment_status&&(value_index=resolved_ind_comments_list.indexOf(`${i}${j}`),resolved_ind_comments_list.splice(value_index,1),card_background="background:#ffffff;",comment_status="Reopened",reply_display="display:block;",comment_class="reopened_comment",reopen_button_attr="disabled",reopen_button_style="display:none;",resolve_button_attr="disabled",resolve_button_style="display:none;",!resolve_individual_comments||"true"!=allowed_approval&&"true"!=allowed_rejection&&"true"!=allowed_edit||(resolve_button_attr="",resolve_button_style="display:block;")),void 0===all_comments_status&&void 0===individual_comment_status&&(card_background="background:#ffffff;",comment_status="Active",reply_display="display:block;",comment_class="active_comment",reopen_button_attr="disabled",reopen_button_style="display:none;",resolve_button_attr="disabled",resolve_button_style="display:none;",!resolve_individual_comments||"true"!=allowed_approval&&"true"!=allowed_rejection&&"true"!=allowed_edit||(resolve_button_attr="",resolve_button_style="display:block;"),resolved_ind_comments_list=[]),audit_html=`\n                      <div>\n\n                        <div class="approval_card approval_comment" style="${card_background}">\n                          <div class="" style="margin: 0px 20px 5px 7px;">\n                            <button class="btn btn-primary mb-2 resolve_button_ind" id="resolve_button_ind_${i}${j}" ${resolve_button_attr} onclick="resolveIndComments('${i}','${j}','Level ${current_level}','${result_data.id}', '${smtpConfigKey}', '${app_code}')" style="font-size: 0.7rem;float:left;${resolve_button_style}"> Mark as Resolved </button>\n                            <button class="btn btn-primary mb-2 reopen_button_ind" id="reopen_button_ind_${i}${j}" ${reopen_button_attr} onclick="reopenIndComments('${i}','${j}','Level ${current_level}','${result_data.id}', '${smtpConfigKey}', '${app_code}')" style="font-size: 0.7rem;float:left;${reopen_button_style}"> Mark as Reopened </button>\n                            <h5 class="comment_status_ind ${comment_class}" id="comment_status_ind_${i}${j}" style="font-size: 0.8rem;font-weight: normal;float:right;">Status: <b>${comment_status}</b></h5>\n                          </div>\n                          <div id="approval_comment_${i}${j}">\n                            <div class="approval_comment_card">\n                              <div class="approval_info">\n                                <h5 class="approval_title"><span>${initials}</span></h5>\n                                <p class="approval_text">${dictt.user} ${additionalString} sent a comment</p>\n                              <div>\n                              <h6 class="approval_timestamp" data-toggle="tooltip" title="${tooltipTimestamp}">${timestamp}</h6>\n                              <small style="color: #929292;">${small_time}</small>\n                            </div>\n                          </div>\n                          <div class="approval_comment_text"><p>${dictt.value.replaceAll("\\t","&nbsp;").replaceAll("\\n","<br>")}</p></div>\n                        </div>\n                      `,dictt.hasOwnProperty("replies")){replies=dictt.replies;for(let k=0;k<replies.length;k++){var[reply_timestamp,reply_tooltipTimestamp]=convertToTimestamp(replies[k].time),reply_initials=getInitials(replies[k].user);audit_html+=`\n                          <div class="reply_comment_card approval_comment_card">\n                            <div class="approval_info">\n                              <h5 class="approval_title"><span>${reply_initials}</span></h5>\n                              <p class="approval_text">${replies[k].user} ${additionalString} replied</p>\n                              <div>\n                                <h6 class="approval_timestamp" data-toggle="tooltip" title="${reply_tooltipTimestamp}">${reply_timestamp}</h6>\n                                <small style="color: #929292;">${small_time}</small>\n                              </div>\n                            </div>\n                            <div class="approval_comment_text"><p>${replies[k].value.replaceAll("\\t","&nbsp;").replaceAll("\\n","<br>")}</p></div>\n                          </div>`}}for(var editorId in audit_html+=`</div><div class="reply-area mt-3" style="${reply_display}">\n                            <textarea id="replycomment_${i}${j}" name="replycomment_${i}${j}"></textarea>\n                            <div style="margin: 15px 0 5px 0;text-align: right;display: flex;align-items: center;justify-content: flex-end;">\n                              <button class="btn btn-primary reply_comments" style="font-size:0.9rem;" disabled data-toggle="tooltip" title="Click this button or press Ctrl+Enter" id="replybutton_${i}${j}" onclick="ReplyToComment('${i}','${j}','${key}','${result_data.id}', '${smtpConfigKey}', '${app_code}')">Reply <i class="fa-solid fa-comment-dots ml-2"></i></button>\n                            </div>\n                          </div>\n                        </div>\n                      </div>`,$(`#approvalWallModalBody_${elementID}`).find(`.approval_outer_${elementID}`).prepend(audit_html),reply_editor=CKEDITOR.replace(`replycomment_${i}${j}`,{height:44,removeButtons:home_rtf[0],editorplaceholder:"Type your reply here...",plugins:"mentions,undo,link,list,basicstyles,justify,richcombo,wysiwygarea,toolbar",extraPlugins:"elementspath,editorplaceholder",toolbar:[{name:"document",items:["Undo"]},{name:"paragraph",items:["NumberedList","BulletedList","-","Outdent","Indent","-","Blockquote","CreateDiv","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"basicstyles",items:["Bold","Italic","Underline","Strike","-","RemoveFormat"]},{name:"links",items:["Mention","Link","Unlink","Anchor"]},{name:"styles",items:["Styles","Format","Font","FontSize"]},{name:"colors",items:["TextColor","BGColor"]},{name:"elementspath",items:["ElementPath"]}],mentions:[{feed:dataFeed,itemTemplate:itemTemplate,outputTemplate:outputTemplate,minChars:0}],removeButtons:"PasteFromWord"}),CKEDITOR.config.removePlugins="exportpdf",CKEDITOR.config.extraPlugins="autocorrect,elementspath",(reply_editor=CKEDITOR.instances[`replycomment_${i}${j}`]).on("change",(function(){let typedText;""===reply_editor.getData().trim()?$(`#replybutton_${i}${j}`).prop("disabled",!0):$(`#replybutton_${i}${j}`).prop("disabled",!1)})),reply_editor.on("key",(function(event){event.data.keyCode===CKEDITOR.CTRL+13&&$(`#replybutton_${i}${j}`).trigger("click")})),CKEDITOR.instances)0===editorId.indexOf("replycomment_")&&CKEDITOR.instances[editorId].setData("")}else if("Mention"==dictt.action){let comment_status="Active",comment_class="active_comment",all_comments_status="",reopen_button_attr,reopen_button_style,resolve_button_attr,resolve_button_style,card_background,reply_display;all_comments_status=dictt.all_comments_status,"resolved_for_all"==all_comments_status?(all_comments_resolved=!0,resolve_button_attr="disabled",resolve_button_style="display:none;",card_background="background:#f8f8f8;",comment_status="Resolved",reply_display="display:none;",comment_class="resolved_comment",reopen_button_attr="disabled",reopen_button_style="display:none;",!reopen_individual_comments||"true"!=allowed_approval&&"true"!=allowed_rejection&&"true"!=allowed_edit||(reopen_button_attr="",reopen_button_style="display:block;")):all_comments_resolved=!1,"reopened_for_all"==all_comments_status?(all_comments_reopened=!0,card_background="background:#ffffff;",comment_status="Reopened",reply_display="display:block;",comment_class="reopened_comment",reopen_button_attr="disabled",reopen_button_style="display:none;",resolve_button_attr="disabled",resolve_button_style="display:none;",!resolve_individual_comments||"true"!=allowed_approval&&"true"!=allowed_rejection&&"true"!=allowed_edit||(resolve_button_attr="",resolve_button_style="display:block;")):all_comments_reopened=!1;let individual_comment_status="";if(individual_comment_status=dictt.individual_comment_status,"resolved_individual_comment"==individual_comment_status?(resolved_ind_comments_list.includes(`${i}${j}`)||resolved_ind_comments_list.push(`${i}${j}`),resolve_button_attr="disabled",resolve_button_style="display:none;",card_background="background:#f8f8f8;",comment_status="Resolved",reply_display="display:none;",comment_class="resolved_comment",reopen_button_attr="disabled",reopen_button_style="display:none;",!reopen_individual_comments||"true"!=allowed_approval&&"true"!=allowed_rejection&&"true"!=allowed_edit||(reopen_button_attr="",reopen_button_style="display:block;")):"reopened_individual_comment"==individual_comment_status&&(value_index=resolved_ind_comments_list.indexOf(`${i}${j}`),resolved_ind_comments_list.splice(value_index,1),card_background="background:#ffffff;",comment_status="Reopened",reply_display="display:block;",comment_class="reopened_comment",reopen_button_attr="disabled",reopen_button_style="display:none;",resolve_button_attr="disabled",resolve_button_style="display:none;",!resolve_individual_comments||"true"!=allowed_approval&&"true"!=allowed_rejection&&"true"!=allowed_edit||(resolve_button_attr="",resolve_button_style="display:block;")),void 0===all_comments_status&&void 0===individual_comment_status&&(card_background="background:#ffffff;",comment_status="Active",reply_display="display:block;",comment_class="active_comment",reopen_button_attr="disabled",reopen_button_style="display:none;",!resolve_individual_comments||"true"!=allowed_approval&&"true"!=allowed_rejection&&"true"!=allowed_edit||(resolve_button_attr="",resolve_button_style="display:block;"),resolved_ind_comments_list=[]),audit_html=`\n                      <div>\n\n                        <div class="approval_card approval_comment" style="${card_background}">\n                          <div class="" style="margin:0 20px 20px 7px;">\n                            <button class="btn btn-primary mb-2 resolve_button_ind" id="resolve_button_ind_${i}${j}" ${resolve_button_attr} onclick="resolveIndComments('${i}','${j}','Level ${current_level}','${result_data.id}', '${smtpConfigKey}', '${app_code}')" style="font-size: 0.7rem;float:left;${resolve_button_style}"> Mark as Resolved </button>\n                            <button class="btn btn-primary mb-2 reopen_button_ind" id="reopen_button_ind_${i}${j}" ${reopen_button_attr} onclick="reopenIndComments('${i}','${j}','Level ${current_level}','${result_data.id}', '${smtpConfigKey}', '${app_code}')" style="font-size: 0.7rem;float:left;${reopen_button_style}"> Mark as Reopened </button>\n                            <h5 class="comment_status_ind ${comment_class}" id="comment_status_ind_${i}${j}" style="font-size: 0.8rem;font-weight: normal;float:right;">Status: <b>${comment_status}</b></h5>\n                          </div>\n                          <div id="approval_comment_${i}${j}">\n                            <div class="approval_comment_card">\n                              <div class="approval_info">\n                                <h5 class="approval_title"><span>${initials}</span></h5>\n                                <p class="approval_text">${dictt.user} ${additionalString} mentioned</p>\n                                <div>\n                                  <h6 class="approval_timestamp" data-toggle="tooltip" title="${tooltipTimestamp}">${timestamp}</h6>\n                                  <small style="color: #929292;">${small_time}</small>\n                                </div>\n                              </div>\n                              <div class="approval_comment_text"><p>${dictt.value.replaceAll("\\t","&nbsp;").replaceAll("\\n","<br>")}</p></div>\n                            </div>`,dictt.hasOwnProperty("replies")){replies=dictt.replies;for(let k=0;k<replies.length;k++){var[reply_timestamp,reply_tooltipTimestamp]=convertToTimestamp(replies[k].time);let small_time="at"+reply_tooltipTimestamp.split("at")[1];var reply_initials=getInitials(replies[k].user);audit_html+=`\n                            <div class="reply_comment_card approval_comment_card">\n                              <div class="approval_info">\n                                <h5 class="approval_title"><span>${reply_initials}</span></h5>\n                                <p class="approval_text">${replies[k].user} ${additionalString} replied</p>\n                                <div>\n                                  <h6 class="approval_timestamp" data-toggle="tooltip" title="${reply_tooltipTimestamp}">${reply_timestamp}</h6>\n                                  <small style="color: #929292;">${small_time}</small>\n                                </div>\n                              </div>\n                              <div class="approval_comment_text"><p>${replies[k].value.replaceAll("\\t","&nbsp;").replaceAll("\\n","<br>")}</p></div>\n                            </div>`}}for(var editorId in audit_html+=`</div><div class="reply-area mt-3" >\n\n                            <textarea id="replycomment_${i}${j}" name="replycomment_${i}${j}"></textarea>\n                            <div style="margin: 15px 0 5px 0;text-align: right;display: flex;align-items: center;justify-content: flex-end;">\n                              <button class="btn btn-primary reply_comments" style="font-size:0.9rem;" disabled data-toggle="tooltip" title="Click this button or press Ctrl+Enter" id="replybutton_${i}${j}" onclick="ReplyToComment('${i}','${j}','${key}','${result_data.id}', '${smtpConfigKey}', '${app_code}')">Reply <i class="fa-solid fa-comment-dots ml-2"></i></button>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                      `,$(`#approvalWallModalBody_${elementID}`).find(`.approval_outer_${elementID}`).prepend(audit_html),reply_editor1=CKEDITOR.replace(`replycomment_${i}${j}`,{height:44,removeButtons:home_rtf[0],editorplaceholder:"Add a comment...",plugins:"mentions,undo,link,list,basicstyles,justify,richcombo,wysiwygarea,toolbar",extraPlugins:"elementspath,editorplaceholder",toolbar:[{name:"document",items:["Undo"]},{name:"paragraph",items:["NumberedList","BulletedList","-","Outdent","Indent","-","Blockquote","CreateDiv","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"basicstyles",items:["Bold","Italic","Underline","Strike","-","RemoveFormat"]},{name:"links",items:["Mention","Link","Unlink","Anchor"]},{name:"styles",items:["Styles","Format","Font","FontSize"]},{name:"colors",items:["TextColor","BGColor"]},{name:"elementspath",items:["ElementPath"]}],mentions:[{feed:dataFeed,itemTemplate:itemTemplate,outputTemplate:outputTemplate,minChars:0}],removeButtons:"PasteFromWord"}),CKEDITOR.config.removePlugins="exportpdf",CKEDITOR.config.extraPlugins="autocorrect,elementspath",(reply_editor1=CKEDITOR.instances[`replycomment_${i}${j}`]).on("change",(function(){let typedText;""===reply_editor1.getData().trim()?$(`#replybutton_${i}${j}`).prop("disabled",!0):$(`#replybutton_${i}${j}`).prop("disabled",!1)})),reply_editor1.on("key",(function(event){event.data.keyCode===CKEDITOR.CTRL+13&&$(`#replybutton_${i}${j}`).trigger("click")})),CKEDITOR.instances)0===editorId.indexOf("replycomment_")&&CKEDITOR.instances[editorId].setData("")}else if("Delegated Approval Actions"==dictt.action)audit_html=`\n                        <div class="approval_card">\n                          <div class="approval_info">\n                            <h5 class="approval_title"><span>${initials}</span></h5>\n                            <p class="approval_text"> ${dictt.user} ${additionalString} ${dictt.value} </p>\n                            <div>\n                              <h6 class="approval_timestamp" data-toggle="tooltip" title="${tooltipTimestamp}">${timestamp}</h6>\n                              <small style="color: #929292;">${small_time}</small>\n                            </div>\n                          </div>\n                        </div>\n                      `,$(`#approvalWallModalBody_${elementID}`).find(`.approval_outer_${elementID}`).prepend(audit_html);else if("Approved By"==dictt.action)audit_html=`\n                      <div class="approval_card">\n                        <div class="approval_info">\n                          <h5 class="approval_title approved_title">\n                            <span class="radio d-flex align-items-center justify-content-center" style="height: 30px;width: 30px;background: rgba(85,163,98,1);border-radius: 50%;border: 2px solid rgb(76 148 88);"><i class="fa fa-check" style="color:white"></i></span>\n                            <span class="ml-2">${initials}</span>\n                          </h5>\n                          <p class="approval_text text-approved">${dictt.user} ${additionalString} approved the transaction.</p>\n                          <div>\n                            <h6 class="approval_timestamp" data-toggle="tooltip" title="${tooltipTimestamp}">${timestamp}</h6>\n                            <small style="color: #929292;">${small_time}</small>\n                          </div>\n                        </div>\n                      </div>\n                    `,$(`#approvalWallModalBody_${elementID}`).find(`.approval_outer_${elementID}`).prepend(audit_html);else if("Rejected By"==dictt.action)audit_html=`\n                      <div class="approval_card">\n                        <div class="approval_info">\n                          <h5 class="approval_title approved_title">\n                            <span class="radio d-flex align-items-center justify-content-center" style="height: 30px;width: 30px;background: rgba(205,74,69,1);border-radius: 50%;border: 2px solid rgba(205,74,69,1);"><i class="fa fa-times" style="color:white"></i></span>\n                            <span class="ml-2">${initials}</span>\n                          </h5>\n                          <p class="approval_text text-rejected">${dictt.user} ${additionalString} rejected the transaction.</p>\n                          <div>\n                            <h6 class="approval_timestamp" data-toggle="tooltip" title="${tooltipTimestamp}">${timestamp}</h6>\n                            <small style="color: #929292;">${small_time}</small>\n                          </div>\n                        </div>\n                      </div>\n                    `,$(`#approvalWallModalBody_${elementID}`).find(`.approval_outer_${elementID}`).prepend(audit_html);else if("Edited By"==dictt.action){var htmlString="";if(v=dictt.value,v&&v.constructor!==Array&&-1!=v.indexOf(" from ")&&-1!=v.indexOf(" to ")){var fromIndex=v.indexOf("from "),toIndex=v.indexOf(" to "),fromContent=v.slice(fromIndex,toIndex).split("from ")[1],toContent=v.slice(toIndex).split(" to ")[1];if(v.startsWith("approval_level_config")){var fromObject=JSON.parse(fromContent.replaceAll("'",'"')),toObject=JSON.parse(toContent.replaceAll("'",'"')),fromTHeadString="",fromTBodyString="";for(let levelNumber in fromObject.level_config){fromTBodyString+=`<tr><td>${levelNumber}</td>`;for(let[kLevel,valLevel]of Object.entries(fromObject.level_config[levelNumber])){if("user_list"==kLevel){tmp=[];for(let jLevel=0;jLevel<valLevel.length;jLevel++)valLevel[jLevel]in user_additional_info?tmp.push(user_additional_info[valLevel[jLevel]]):tmp.push(valLevel[jLevel]);valLevel=tmp}fromTBodyString+=`<td style="text-align:left;">${valLevel}</td>`}fromTBodyString+="</tr>"}fromTHeadString+="<th>Level</th>";for(let header of Object.keys(fromObject.level_config[0]))fromTHeadString+=`<th>${header}</th>`;var fromHTML=`<table class="row-border"><thead><tr>${fromTHeadString}</tr></thead><tbody>${fromTBodyString}</tbody></table>`,toTHeadString="",toTBodyString="";for(let levelNumber in toObject.level_config){toTBodyString+=`<tr><td>${levelNumber}</td>`;for(let[kLevel,valLevel]of Object.entries(toObject.level_config[levelNumber])){if("user_list"==kLevel){tmp=[];for(let jLevel=0;jLevel<valLevel.length;jLevel++)valLevel[jLevel]in user_additional_info?tmp.push(user_additional_info[valLevel[jLevel]]):tmp.push(valLevel[jLevel]);valLevel=tmp}toTBodyString+=`<td style="text-align:left;">${valLevel}</td>`}toTBodyString+="</tr>"}toTHeadString+="<th>Level</th>";for(let header of Object.keys(toObject.level_config[0]))toTHeadString+=`<th>${header}</th>`;var toHTML=`<table class="row-border"><thead><tr>${toTHeadString}</tr></thead><tbody>${toTBodyString}</tbody></table>`,fromHTML=`<table class="row-border"><thead><tr>${fromTHeadString}</tr></thead><tbody>${fromTBodyString}</tbody></table>`}else var fromHTML=fromContent.replaceAll("\\'",""),toHTML=toContent.replaceAll("\\'","");htmlString=`<div style="padding: 10px 35px;"><p style="text-align:center;margin-bottom:0;font-weight: 600;">From</p><p style="word-break:break-word;">${fromHTML}</p><p style="text-align:center;margin-bottom:0;font-weight: 600;">To</p><p style="word-break:break-word;">${toHTML}</p></div>`}column=dictt.value.split("column")[0],audit_html=`\n                        <div class="approval_card edited_content number${j}">\n                          <div class="approval_info">\n                            <h5 class="approval_title"><span>${initials}</span></h5>\n                            <p class="approval_text">${dictt.user} ${additionalString} updated the ${column} column. </p>\n                            <div>\n                              <h6 class="approval_timestamp" data-toggle="tooltip" title="${tooltipTimestamp}">${timestamp}</h6>\n                              <small style="color: #929292;">${small_time}</small>\n                            </div>\n                          </div>\n                          <div>\n                            ${htmlString}\n                          </div>\n                        </div>\n                      `,$(`#approvalWallModalBody_${elementID}`).find(`.approval_outer_${elementID}`).prepend(audit_html);var table=$(`#approvalWallModalBody_${elementID}`).find(`.approval_outer_${elementID}`).find(".edited_content").eq(0).find("table").DataTable({autoWidth:!0,scrollCollapse:!0,responsive:!0,scrollY:"50vh",bLengthChange:!1,searching:!1,info:!1,paging:!1,ordering:!1,columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"}]});setTimeout(()=>{table.columns.adjust()},200)}else if("Resent Back To Previous Approver"==dictt.action){let resendInitials=getInitials(dictt.user);previous_approver="",dictt.value&&(previous_approver=dictt.value.join(",")),audit_html=`\n                      <div class="approval_card">\n                        <div class="approval_info">\n                          <h5 class="approval_title"><span>${resendInitials}</span></h5>\n                          <p class="approval_text">${dictt.user} ${additionalString} has sent this transaction back to the previous approver ${previous_approver}</p>\n                          <div>\n                            <h6 class="approval_timestamp" data-toggle="tooltip" title="${tooltipTimestamp}">${timestamp}</h6>\n                            <small style="color: #929292;">${small_time}</small>\n                          </div>\n                        </div>\n                      </div>\n                      `,$(`#approvalWallModalBody_${elementID}`).find(`.approval_outer_${elementID}`).prepend(audit_html)}else audit_html=`\n                      <div class="approval_card">\n                        <div class="approval_info">\n                          <h5 class="approval_title"><span>${initials}</span></h5>\n                          <p class="approval_text">${dictt.action} ${dictt.user} ${additionalString}</p>\n                          <div>\n                            <h6 class="approval_timestamp" data-toggle="tooltip" title="${tooltipTimestamp}">${timestamp}</h6>\n                            <small style="color: #929292;">${small_time}</small>\n                          </div>\n                        </div>\n                      </div>\n                    `,$(`#approvalWallModalBody_${elementID}`).find(`.approval_outer_${elementID}`).prepend(audit_html)}expand_rollup_comments("approvalWallModalBody_"),$(document).ready((function(){var mobile_media;window.matchMedia("(max-width: 500px)").matches&&($(`#level_config_${elementID}`).parent().is($(".lower-container"))&&$(`#level_config_${elementID}`).insertAfter(".div_transaction"),$(`#approver_users_${elementID}`).parent().is($(".lower-container"))&&$(`#approver_users_${elementID}`).insertAfter(".div_transaction"),$(`#add_levels_div_${elementID}`).parent().is($(".mobile_level_buttons"))||$(`#add_levels_div_${elementID}`).appendTo(".mobile_level_buttons"),$(`#edit_approval_levels_${elementID}`).parent().is($(".mobile_level_buttons"))||$(`#edit_approval_levels_${elementID}`).appendTo(".mobile_level_buttons"),$(`#save_approval_levels_${elementID}`).parent().is($(".mobile_level_buttons"))||$(`#save_approval_levels_${elementID}`).appendTo(".mobile_level_buttons"),$(`#save_approvers_${elementID}`).parent().is($(".mobile_approver_buttons"))||$(`#save_approvers_${elementID}`).appendTo(".mobile_approver_buttons"),$(`#edit_approvers_${elementID}`).parent().is($(".mobile_approver_buttons"))||$(`#edit_approvers_${elementID}`).appendTo(".mobile_approver_buttons"),$(`#edit_transaction_data_${elementID}`).parent().is($(".mobile_transaction_buttons"))||$(`#edit_transaction_data_${elementID}`).appendTo(".mobile_transaction_buttons"),$(`#save_transaction_data_${elementID}`).parent().is($(".mobile_transaction_buttons"))||$(`#save_transaction_data_${elementID}`).appendTo(".mobile_transaction_buttons"),$(".additional_accordion").parent().is($(".upper-container"))&&($(".mobile-additional-accordion").empty(),$(".mobile-additional-accordion").append($(".additional_accordion"))),$(".mobile_level_accordion_arrow").off("click").on("click",(function(){let target=$(this).attr("data-target");"none"==$(`.${target}`).css("display")?($(`.${target}`).slideDown(),$(this).find("i").attr("class","fas fa-chevron-up")):($(`.${target}`).slideUp(),$(this).find("i").attr("class","fas fa-chevron-down"))})))})),$(".closeApprovalWall").on("click",(function(){var modalElement=document.querySelector(".approvalWallModal");for(var instanceName in CKEDITOR.instances){var editorElement;if(CKEDITOR.instances.hasOwnProperty(instanceName))modalElement.querySelector("#"+instanceName)&&CKEDITOR.instances[instanceName].destroy()}$(`#approvalWallModal_${elementID}`).modal("hide")})),all_comments_resolved?($(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).attr("disabled",!0),$(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`.new_discussion_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`.approval_outer_${elementID}`).addClass("mt-5 mb-3"),$(`#approvalWallModalBody_${elementID}`).find(`#comment_status${elementID}`).html("Status: <b>Resolved</b>"),$(`#approvalWallModalBody_${elementID}`).find(`#comment_status${elementID}`).attr("class","resolved_comment"),$(`#approvalWallModalBody_${elementID}`).find(`#add_comment_${elementID}`).css("display","none"),!reopen_all_comments||"true"!=allowed_approval&&"true"!=allowed_rejection&&"true"!=allowed_edit?$(`#approvalWallModalBody_${elementID}`).find(`#reopen_all_button_${elementID}`).css("display","none"):($(`#approvalWallModalBody_${elementID}`).find(`#reopen_all_button_${elementID}`).css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(`#reopen_all_button_${elementID}`).attr("disabled",!1))):all_comments_reopened&&($(`#approvalWallModalBody_${elementID}`).find(`#reopen_all_button_${elementID}`).attr("disabled",!0),$(`#approvalWallModalBody_${elementID}`).find(`#reopen_all_button_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`.new_discussion_${elementID}`).css("display","flex"),$(`#approvalWallModalBody_${elementID}`).find(`.new_discussion_${elementID}`).addClass("mt-5 mb-3"),$(`#approvalWallModalBody_${elementID}`).find(`.approval_outer_${elementID}`).removeClass("mt-5 mb-3"),$(`#approvalWallModalBody_${elementID}`).find(`#comment_status${elementID}`).html("Status: <b>Reopened</b>"),$(`#approvalWallModalBody_${elementID}`).find(`#comment_status${elementID}`).attr("class","reopened_comment"),$(`#approvalWallModalBody_${elementID}`).find(`#add_comment_${elementID}`).css("display","block"),!0!==resolve_all_comments||"true"!=allowed_approval&&"true"!=allowed_rejection&&"true"!=allowed_edit?$(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).css("display","none"):($(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).attr("disabled",!1))),all_comments_resolved||all_comments_reopened||(!0!==resolve_all_comments||"true"!=allowed_approval&&"true"!=allowed_rejection&&"true"!=allowed_edit?$(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).css("display","none"):($(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).attr("disabled",!1)),$(`#approvalWallModalBody_${elementID}`).find(`.new_discussion_${elementID}`).css("display","flex"),$(`#approvalWallModalBody_${elementID}`).find(`.new_discussion_${elementID}`).addClass("mt-5 mb-3"),$(`#approvalWallModalBody_${elementID}`).find(`.approval_outer_${elementID}`).removeClass("mt-5 mb-3"),$(`#approvalWallModalBody_${elementID}`).find(`#comment_status${elementID}`).html("Status: <b>Active</b>"),$(`#approvalWallModalBody_${elementID}`).find(`#comment_status${elementID}`).attr("class","active_comment"),$(`#approvalWallModalBody_${elementID}`).find(`#add_comment_${elementID}`).css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(".reply_comments").css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(".approval_comment").css("background","#ffffff")),reopen_all_comments&&all_comments_resolved&&("true"==allowed_approval||"true"==allowed_edit||"true"==allowed_rejection)?($(`#approvalWallModalBody_${elementID}`).find(`#reopen_all_button_${elementID}`).css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(`#reopen_all_button_${elementID}`).attr("disabled",!1)):$(`#approvalWallModalBody_${elementID}`).find(`#reopen_all_button_${elementID}`).css("display","none"),freeze_comments_option&&($(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).attr("disabled",!0),$(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`.new_discussion_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`.approval_outer_${elementID}`).addClass("mt-5 mb-3"),$(`#approvalWallModalBody_${elementID}`).find(`#comment_status${elementID}`).html(""),$(`#approvalWallModalBody_${elementID}`).find(`#comment_status${elementID}`).attr("class",""),$(`#approvalWallModalBody_${elementID}`).find(`#add_comment_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(".reply_comments").css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(".reply-area").css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(".approval_comment").css("background","#f8f8f8"),$(`#approvalWallModalBody_${elementID}`).find(".comment_status_ind").html(""),$(`#approvalWallModalBody_${elementID}`).find(".comment_status_ind").attr("class","comment_status_ind")),$(`#approvalWallModal_${elementID}`).modal("show"),$(`#add_comment_${elementID}`).off("click").on("click",(function(){if(approval_comment=CKEDITOR.instances[`approvalWallCommentText_${elementID}`].getData(),approval_comment){var usernamesArray=[],mentionPattern=/@(\w+)/g,matches=approval_comment.match(mentionPattern);if(matches){var uniqueUsernames=new Set;matches.forEach((function(match){uniqueUsernames.add(match.substr(1))})),usernamesArray=Array.from(uniqueUsernames)}$.ajax({url:`/users/${urlPath}/approval_table/`,data:{approval_id:result_data.id,current_level:current_level,operation:"add_comment",audit_log_configs:JSON.stringify(audit_log_configs),approval_comment:approval_comment,mentioned_usernames:JSON.stringify(usernamesArray),smtpConfigKey:smtpConfigKey,app_code:app_code},type:"POST",dataType:"json",success:function(data){var count=audit_log_configs.length;all_audit_data=JSON.parse(data.all_audit_data),audit_log_configs.push(all_audit_data[count]),CKEDITOR.instances[`approvalWallCommentText_${elementID}`].setData(""),temp_log=data,approval_audit_log_button&&approval_audit_log_button.attr("data-data",data.all_audit_data);var[timestamp,tooltipTimestamp]=convertToTimestamp(temp_log.time),small_time="at"+tooltipTimestamp.split("at")[1],initials=getInitials(temp_log.user);audit_html=`\n                    <div>\n\n                      <div class="approval_card approval_comment">\n                        <div class="" style="margin: 0 20px 20px 7px;">\n                          <button class="btn btn-primary mb-2 resolve_button_ind" id="resolve_button_ind_${count}0" onclick="resolveIndComments('${count}','0','Level ${current_level}','${result_data.id}', '${smtpConfigKey}', '${app_code}')" style="font-size: 0.7rem;float:left;"> Mark as Resolved </button>\n                          <button class="btn btn-primary mb-2 reopen_button_ind" id="reopen_button_ind_${count}0" style="display: none;font-size: 0.7rem;float:left;" onclick="reopenIndComments('${count}','0','Level ${current_level}','${result_data.id}', '${smtpConfigKey}', '${app_code}')"> Mark as Reopened </button>\n                          <h5 class="comment_status_ind active_comment" id="comment_status_ind_${count}0" style="float:right;font-size: 0.8rem;font-weight: normal;">Status: <b>Active</b></h5>\n                        </div>\n\n                        <div id="approval_comment_${count}0">\n                          <div class="approval_comment_card">\n                            <div class="approval_info">\n                              <h5 class="approval_title"><span>${initials}</span></h5>\n                              <p class="approval_text">${temp_log.user} sent a comment</p>\n                              <div>\n                                <h6 class="approval_timestamp" data-toggle="tooltip" title="${tooltipTimestamp}">${timestamp}</h6>\n                                <small style="color: #929292;">${small_time}</small>\n                              </div>\n                            </div>\n                            <div class="approval_comment_text"><p>${temp_log.value}</p></div>\n                          </div>\n                        </div>\n                        <div class="reply-area mt-3">\n                          <textarea id="replycomment_${count}0" name="replycomment_${count}0"></textarea>\n                          <div style="margin: 15px 0 5px 0;text-align: right;display: flex;align-items: center;justify-content: flex-end;">\n                            <button class="btn btn-primary reply_comments" style="font-size:0.9rem;" disabled data-toggle="tooltip" title="Click this button or press Ctrl+Enter" id="replybutton_${count}0" onclick="ReplyToComment('${count}','0','Level ${current_level}','${result_data.id}', '${smtpConfigKey}', '${app_code}')">Reply <i class="fa-solid fa-comment-dots ml-2"></i></button>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                    `,$(`#approvalWallModalBody_${elementID}`).find(`.approval_outer_${elementID}`).prepend(audit_html),new_reply_editor=CKEDITOR.replace(`replycomment_${count}0`,{height:44,removeButtons:home_rtf[0],editorplaceholder:"Type your reply here...",plugins:"mentions,undo,link,list,basicstyles,justify,richcombo,wysiwygarea,toolbar",extraPlugins:"elementspath,editorplaceholder",toolbar:[{name:"document",items:["Undo"]},{name:"paragraph",items:["NumberedList","BulletedList","-","Outdent","Indent","-","Blockquote","CreateDiv","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"basicstyles",items:["Bold","Italic","Underline","Strike","-","RemoveFormat"]},{name:"links",items:["Mention","Link","Unlink","Anchor"]},{name:"styles",items:["Styles","Format","Font","FontSize"]},{name:"colors",items:["TextColor","BGColor"]},{name:"elementspath",items:["ElementPath"]}],mentions:[{feed:dataFeed,itemTemplate:itemTemplate,outputTemplate:outputTemplate,minChars:0}],removeButtons:"PasteFromWord"}),CKEDITOR.config.removePlugins="exportpdf",CKEDITOR.config.extraPlugins="autocorrect,elementspath",CKEDITOR.instances[`replycomment_${count}0`].setData(""),(new_reply_editor=CKEDITOR.instances[`replycomment_${count}0`]).on("change",(function(){let typedText;""===new_reply_editor.getData().trim()?$(`#replybutton_${count}0`).prop("disabled",!0):$(`#replybutton_${count}0`).prop("disabled",!1)})),new_reply_editor.on("key",(function(event){event.data.keyCode===CKEDITOR.CTRL+13&&$(`#replybutton_${count}0`).trigger("click")}))},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}})),$(`#approval_wall_approve_${elementID}`).click((function(){var modify_column_data={},tablename=result_data.tablename;if(modify_column.hasOwnProperty(tablename)&&(modify_column_data=modify_column[tablename]),Object.keys(modify_column_data).length>0){var approval_json_data_from_approver_edit=`\n                  <table id="aprovalwallJsondataForApproverEdit_${elementID}" class="table table-striped table-bordered" cellspacing="0" width="100%">\n                    <thead>\n                    <tr>\n                      <th>Particulars</th>\n                      <th>Details</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                  </tbody>\n                  </table>`;$(`#approvalCommentModal_${elementID} .modal-body`).find(".approvers_edit_data").css("display","block"),$(`#approvalCommentModal_${elementID} .modal-body`).find(".approvers_edit_data").html(approval_json_data_from_approver_edit),string="";for(let[key,value]of Object.entries(parsed_json_data[0]))if(modify_column_data.hasOwnProperty(key)){edited_data[result_data.id]=modify_column_data,string+=`<tr><td class="view_details_wrap">${String(key)}</td>`;let randomId=(Math.random()+"").replace(".","");string+=`\n                    <td id="${randomId+"_"+String(key).replaceAll(" ","_")}" class="d-flex align-items-center" style="justify-content:center; gap:10px;">\n                      <span>${String(value)}</span>\n                      <div class="process_navbar_popover" data-id="${result_data.id}" data-value="${String(value)}" data-index="1" popover="yes" data-description="" data-column="${String(key)}" data-table="${tablename}" data-data=${JSON.stringify(modify_column_data[String(key)])} data-PopOverSelector="baseMasters" data-PopOverTarget="#yourContentHere" style="display:inline-block;position:relative;border: 1px solid rgba(0,0,0,.06);background: rgba(0,0,0,.09);" style="z-index: 2000;">\n                        <p class="fontclass" style="margin-bottom:0px;">\n                          <i name="actions" value="" data-toggle="tooltip" title="Click to edit" class="far fa-edit ihover javaSC thin-icon" style="font-size: 17px;margin-left:2px;font-weight:800;color:black; " onclick="popoverEdit.call(this)"></i>\n                        </p>\n                      </div>\n                    </td>`,string+="</tr>"}$(`#approvalCommentModal_${elementID}  .modal-body`).find(`#aprovalwallJsondataForApproverEdit_${elementID} tbody`).html(string);var table=$(`#aprovalwallJsondataForApproverEdit_${elementID}`).DataTable({autoWidth:!0,scrollCollapse:!0,responsive:!0,scrollY:"50vh",scrollX:"300",bLengthChange:!1,searching:!1,info:!1,paging:!1,ordering:!1,columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"}]});setTimeout(()=>{table.columns.adjust()},200)}else $(`#approvalCommentModal_${elementID} .modal-body`).find(".approvers_edit_data").empty(),$(`#approvalCommentModal_${elementID} .modal-body`).find(".approvers_edit_data").css("display","none");$(`#approvalCommentModal_${elementID}`).find(".modal-title").text("Approval Edit and Comment"),$(`#approvalCommentModal_${elementID}`).find(".modal-title").css("color","var(--font-color)"),$(`#approvalCommentModal_${elementID} .modal-body`).find(".delegateApprovalContainer").css("display","none"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("onclick","approve_ind.call(this)"),CKEDITOR.instances[`approvalCommentText${elementID}`].setData(""),$(`#approvalCommentModal_${elementID}`).modal("show");let approval_type="approve";$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").text("Approve Record"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-approval_id",String(primaryKeyId)),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-tablename",result_data.tablename),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-approval_type","approve"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-element-id",elementID)})),$(`#approval_wall_reject_${elementID}`).click((function(){$(`#approvalCommentModal_${elementID}`).find(".modal-title").text("Rejection Comment"),$(`#approvalCommentModal_${elementID} .modal-body`).find(".approvers_edit_data").empty(),$(`#approvalCommentModal_${elementID} .modal-body`).find(".approvers_edit_data").css("display","none"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").text("Reject Record"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("onclick","approve_ind.call(this)"),$(`#approvalCommentModal_${elementID} .modal-body`).find(".delegateApprovalContainer").css("display","none"),CKEDITOR.instances[`approvalCommentText${elementID}`].setData(""),$(`#approvalCommentModal_${elementID}`).modal("show");let approval_type="reject";$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-approval_id",String(primaryKeyId)),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-tablename",result_data.tablename),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-approval_type","reject"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-element-id",elementID)})),$(`#approval_sendtoprevious_${elementID}`).click((function(){$(`#approvalCommentModal_${elementID}`).find(".modal-title").text("Resend Comment"),$(`#approvalCommentModal_${elementID} .modal-body`).find(".approvers_edit_data").empty(),$(`#approvalCommentModal_${elementID} .modal-body`).find(".approvers_edit_data").css("display","none"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").text("Resend Record"),$(`#approvalCommentModal_${elementID} .modal-body`).find(".delegateApprovalContainer").css("display","none"),CKEDITOR.instances[`approvalCommentText${elementID}`].setData(""),$(`#approvalCommentModal_${elementID}`).modal("show"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-approval_id",String(primaryKeyId)),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-tablename",result_data.tablename),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-approval_type","resend"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("onclick","resend_ind.call(this)"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-element-id",elementID)})),$(`#approval_delegate_${elementID}`).click((function(){$(`#approvalCommentModal_${elementID}`).find(".modal-title").text("Delegate Approval Actions"),$(`#approvalCommentModal_${elementID} .modal-body`).find(".approvers_edit_data").empty(),$(`#approvalCommentModal_${elementID} .modal-body`).find(".approvers_edit_data").css("display","none"),$(`#approvalCommentModal_${elementID}`).find(".modal-title").css("color","var(--font-color)"),CKEDITOR.instances[`approvalCommentText${elementID}`].setData("");let userInfo=$(this).attr("data-user-info"),currentUserName=$(this).attr("data-current-user");userInfo=userInfo?JSON.parse(userInfo):{};let delegateToDropdownElement=$(`#approvalCommentModal_${elementID} .modal-body`).find(".delegateApprovalContainer").find("select");delegateToDropdownElement.empty();let delegateToHTML="<option value='' selected disabled>Select User</option>";for(let[uName,uLabel]of Object.entries(userInfo))uName!=currentUserName&&(delegateToHTML+=`<option value='${uName}'>${uLabel}</option>`);delegateToDropdownElement.append(delegateToHTML),$(`#approvalCommentModal_${elementID} .modal-body`).find(".delegateApprovalContainer").css("display","block"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("onclick","delegateApproval.call(this)"),$(`#approvalCommentModal_${elementID}`).modal("show");let approval_type="delegateApproval";$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").text("Delegate"),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-approval_id",String(primaryKeyId)),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-approval_type",approval_type),$(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-element-id",elementID)}))},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}"comments"===String(e.target.attributes[1].value)&&$.ajax({url:`/users/${urlPath}/approval_table/`,data:{approval_id:primaryKeyId,element_id:elementID,operation:"fetch_comments_data"},type:"POST",dataType:"json",success:function(data){let url_string=window.location.pathname,f_occ=url_string.indexOf("/",url_string.indexOf("/")+1),s_occ=url_string.indexOf("/",url_string.indexOf("/")+f_occ+1),t_occ=url_string.indexOf("/",url_string.indexOf("/")+s_occ+1),app_code=url_string.substring(f_occ+1,s_occ);var current_level=0,audit_log_configs=[];mentions_user_list=JSON.parse(data.mentions_user_list);var approval_audit_log_data=data.data[0];all_users_list=data.all_users_list,display_in_comments_cols=data.display_in_comments_cols,search_in_comments_cols=data.search_in_comments_cols;var smtpConfigKey=data.smtpConfigKey,itemTemplate=`<li data-id="{id}"><strong class="username"> ${getFormattedName(search_in_comments_cols)}</strong></li>`,outputTemplate=`<a href="">@${display_in_comments_cols.map(prop=>`{${prop}}`).join(" ")}</a><span>&nbsp;</span>`,comment_editor,convo_reply_editor,mentions_reply_editor,new_comment_reply_editor;if(data.approval_level_config&&(approval_level_config=JSON.parse(data.approval_level_config),current_level=approval_level_config.current_level),CKEDITOR.on("instanceReady",(function(evt){var editor=evt.editor;editor.on("focus",(function(e){element=e.editor.container.$,$(element).find(".cke_top.cke_reset_all").css("display","block"),$(element).find(".cke_contents.cke_reset").css("height","80px")})),editor.on("blur",(function(e){element=e.editor.container.$,$(element).find(".cke_top.cke_reset_all").css("display","none"),$(element).find(".cke_contents.cke_reset").css("height","44px")}))})),comment_editor=CKEDITOR.replace(`approvalCommentText_${elementID}`,{height:44,removeButtons:home_rtf[0],editorplaceholder:"Add a comment...",plugins:"mentions,undo,link,list,basicstyles,justify,richcombo,wysiwygarea,toolbar",extraPlugins:"elementspath,editorplaceholder",toolbar:[{name:"document",items:["Undo"]},{name:"paragraph",items:["NumberedList","BulletedList","-","Outdent","Indent","-","Blockquote","CreateDiv","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"basicstyles",items:["Bold","Italic","Underline","Strike","-","RemoveFormat"]},{name:"links",items:["Mention","Link","Unlink","Anchor"]},{name:"styles",items:["Styles","Format","Font","FontSize"]},{name:"colors",items:["TextColor","BGColor"]},{name:"elementspath",items:["ElementPath"]}],mentions:[{feed:dataFeed,itemTemplate:itemTemplate,outputTemplate:outputTemplate,minChars:0}],removeButtons:"PasteFromWord"}),CKEDITOR.config.bodyClass="custom_cke_class",CKEDITOR.config.removePlugins="exportpdf",CKEDITOR.config.extraPlugins="autocorrect,elementspath",CKEDITOR.instances[`approvalCommentText_${elementID}`].setData(""),(comment_editor=CKEDITOR.instances[`approvalCommentText_${elementID}`]).on("change",(function(){const typedText=comment_editor.getData();""===typedText.trim()?$(`#convo_add_comment_${elementID}`).prop("disabled",!0):$(`#convo_add_comment_${elementID}`).prop("disabled",!1)})),comment_editor.on("key",(function(event){event.data.keyCode===CKEDITOR.CTRL+13&&$(`#convo_add_comment_${elementID}`).trigger("click")})),$(`#approvalCommentsModalBody_${elementID}`).find(`.approval_outer_${elementID}`).empty(),approval_audit_log_data.approval_audit_log){audit_log_configs=JSON.parse(approval_audit_log_data.approval_audit_log);for(let i=0;i<audit_log_configs.length;i++)for(let[key,value]of Object.entries(audit_log_configs[i]))for(let j=0;j<value.length;j++){dictt=value[j];var[timestamp,tooltipTimestamp]=convertToTimestamp(dictt.time),small_time="at"+tooltipTimestamp.split("at")[1],initials=getInitials(dictt.user);const targetItem=all_users_list.find(item=>item.username===dictt.user);let additionalString="";if(targetItem){const{username:username,id:id,...dataWithoutUsername}=targetItem,dataValues=Object.values(dataWithoutUsername).filter(value=>"-"!=value&&""!=value);additionalString=`(${dataValues.join(" ")})`,(additionalString="()")&&(additionalString="")}if("Comment"==dictt.action){if(audit_html=`\n                      <div class="approval_card approval_comment">\n                        <div id="approval_comment_${i}${j}">\n                          <div class="approval_comment_card">\n                            <div class="approval_info">\n                              <h5 class="approval_title"><span>${initials}</span></h5>\n                              <p class="approval_text">${dictt.user} ${additionalString} sent a comment</p>\n                              <div>\n                                <h6 class="approval_timestamp" data-toggle="tooltip" title="${tooltipTimestamp}">${timestamp}</h6>\n                                <small style="color: #929292;">${small_time}</small>\n                              </div>\n                            </div>\n                            <div class="approval_comment_text"><p>${dictt.value.replaceAll("\\t","&nbsp;").replaceAll("\\n","<br>")}</p></div>\n                          </div>`,dictt.hasOwnProperty("replies")){replies=dictt.replies;for(let k=0;k<replies.length;k++){var[reply_timestamp,reply_tooltipTimestamp]=convertToTimestamp(replies[k].time),reply_initials=getInitials(replies[k].user);audit_html+=`\n                          <div class="reply_comment_card approval_comment_card">\n                            <div class="approval_info">\n                              <h5 class="approval_title"><span>${reply_initials}</span></h5>\n                              <p class="approval_text">${replies[k].user} ${additionalString} replied</p>\n                              <div>\n                                <h6 class="approval_timestamp" data-toggle="tooltip" title="${reply_tooltipTimestamp}">${reply_timestamp}</h6>\n                                <small style="color: #929292;">${small_time}</small>\n                              </div>\n                            </div>\n                            <div class="approval_comment_text"><p>${replies[k].value.replaceAll("\\t","&nbsp;").replaceAll("\\n","<br>")}</p></div>\n                          </div>`}}for(var editorId in audit_html+=`</div><div class="reply-area mt-3">\n                          <textarea id="convo_replycomment_${i}${j}" name="convo_replycomment_${i}${j}"></textarea>\n                          <div style="margin: 15px 0 5px 0;text-align: right;display: flex;align-items: center;justify-content: flex-end;">\n                            <button class="btn btn-primary reply_comments" style="font-size:0.9rem;" disabled data-toggle="tooltip" title="Click this button or press Ctrl+Enter" id="convo_replybutton_${i}${j}" onclick="ReplyToConvoComment('${i}','${j}','${key}','${approval_audit_log_data.id}', '${smtpConfigKey}', '${app_code}')">Reply <i class="fa-solid fa-comment-dots ml-2"></i></button>\n                          </div>\n                        </div>\n                        <style>\n                        .approval_wall_btn:hover{\n                          background-color: var(--secondary-color) !important;\n                          color:var(--font-hover-color);\n                        }\n                      </style>\n                      </div>`,$(`#approvalCommentsModalBody_${elementID}`).find(`.approval_outer_${element_id}`).prepend(audit_html),convo_reply_editor=CKEDITOR.replace(`convo_replycomment_${i}${j}`,{height:44,removeButtons:home_rtf[0],editorplaceholder:"Type your reply here...",plugins:"mentions,undo,link,list,basicstyles,justify,richcombo,wysiwygarea,toolbar",extraPlugins:"elementspath,editorplaceholder",toolbar:[{name:"document",items:["Undo"]},{name:"paragraph",items:["NumberedList","BulletedList","-","Outdent","Indent","-","Blockquote","CreateDiv","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"basicstyles",items:["Bold","Italic","Underline","Strike","-","RemoveFormat"]},{name:"links",items:["Mention","Link","Unlink","Anchor"]},{name:"styles",items:["Styles","Format","Font","FontSize"]},{name:"colors",items:["TextColor","BGColor"]},{name:"elementspath",items:["ElementPath"]}],mentions:[{feed:dataFeed,itemTemplate:itemTemplate,outputTemplate:outputTemplate,minChars:0}],removeButtons:"PasteFromWord"}),CKEDITOR.config.removePlugins="exportpdf",CKEDITOR.config.extraPlugins="autocorrect,elementspath",(convo_reply_editor=CKEDITOR.instances[`convo_replycomment_${i}${j}`]).on("change",(function(){let typedText;""===convo_reply_editor.getData().trim()?$(`#convo_replybutton_${i}${j}`).prop("disabled",!0):$(`#convo_replybutton_${i}${j}`).prop("disabled",!1)})),convo_reply_editor.on("key",(function(event){event.data.keyCode===CKEDITOR.CTRL+13&&$(`#convo_replybutton_${i}${j}`).trigger("click")})),CKEDITOR.instances)0===editorId.indexOf("convo_replycomment_")&&CKEDITOR.instances[editorId].setData("")}else if("Mention"==dictt.action){if(audit_html=`\n                      <div class="approval_card approval_comment">\n                        <div id="approval_comment_${i}${j}">\n                          <div class="approval_comment_card">\n                            <div class="approval_info">\n                              <h5 class="approval_title"><span>${initials}</span></h5>\n                              <p class="approval_text">${dictt.user} ${additionalString} mentioned</p>\n                              <div>\n                                <h6 class="approval_timestamp" data-toggle="tooltip" title="${tooltipTimestamp}">${timestamp}</h6>\n                                <small style="color: #929292;">${small_time}</small>\n                              </div>\n                            </div>\n                            <div class="approval_comment_text"><p>${dictt.value.replaceAll("\\t","&nbsp;").replaceAll("\\n","<br>")}</p></div>\n                          </div>`,dictt.hasOwnProperty("replies")){replies=dictt.replies;for(let k=0;k<replies.length;k++){var[reply_timestamp,reply_tooltipTimestamp]=convertToTimestamp(replies[k].time);let small_time="at"+reply_tooltipTimestamp.split("at")[1];var reply_initials=getInitials(replies[k].user);audit_html+=`\n                            <div class="reply_comment_card approval_comment_card">\n                              <div class="approval_info">\n                                <h5 class="approval_title"><span>${reply_initials}</span></h5>\n                                <p class="approval_text">${replies[k].user} ${additionalString} replied</p>\n                                <div>\n                                  <h6 class="approval_timestamp" data-toggle="tooltip" title="${reply_tooltipTimestamp}">${reply_timestamp}</h6>\n                                  <small style="color: #929292;">${small_time}</small>\n                                </div>\n                              </div>\n                              <div class="approval_comment_text"><p>${replies[k].value.replaceAll("\\t","&nbsp;").replaceAll("\\n","<br>")}</p></div>\n                            </div>`}}for(var editorId in audit_html+=`</div><div class="reply-area mt-3">\n\n                            <textarea id="convo_replycomment_${i}${j}" name="convo_replycomment_${i}${j}"></textarea>\n                            <div style="margin: 15px 0 5px 0;text-align: right;display: flex;align-items: center;justify-content: flex-end;">\n                              <button class="btn btn-primary reply_comments" style="font-size:0.9rem;" disabled data-toggle="tooltip" title="Click this button or press Ctrl+Enter" id="convo_replybutton_${i}${j}" onclick="ReplyToConvoComment('${i}','${j}','${key}','${approval_audit_log_data.id}', '${smtpConfigKey}', '${app_code}')">Reply <i class="fa-solid fa-comment-dots ml-2"></i></button>\n                            </div>\n                          </div>\n                          <style>\n                          .approval_wall_btn:hover{\n                            background-color: var(--secondary-color) !important;\n                            color:var(--font-hover-color);\n                          }\n                        </style>\n                        </div>\n                      `,$(`#approvalCommentsModalBody_${elementID}`).find(`.approval_outer_${element_id}`).prepend(audit_html),mentions_reply_editor=CKEDITOR.replace(`convo_replycomment_${i}${j}`,{height:44,removeButtons:home_rtf[0],editorplaceholder:"Add a comment...",plugins:"mentions,undo,link,list,basicstyles,justify,richcombo,wysiwygarea,toolbar",extraPlugins:"elementspath,editorplaceholder",toolbar:[{name:"document",items:["Undo"]},{name:"paragraph",items:["NumberedList","BulletedList","-","Outdent","Indent","-","Blockquote","CreateDiv","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"basicstyles",items:["Bold","Italic","Underline","Strike","-","RemoveFormat"]},{name:"links",items:["Mention","Link","Unlink","Anchor"]},{name:"styles",items:["Styles","Format","Font","FontSize"]},{name:"colors",items:["TextColor","BGColor"]},{name:"elementspath",items:["ElementPath"]}],mentions:[{feed:dataFeed,itemTemplate:itemTemplate,outputTemplate:outputTemplate,minChars:0}],removeButtons:"PasteFromWord"}),CKEDITOR.config.removePlugins="exportpdf",CKEDITOR.config.extraPlugins="autocorrect,elementspath",(mentions_reply_editor=CKEDITOR.instances[`convo_replycomment_${i}${j}`]).on("change",(function(){let typedText;""===mentions_reply_editor.getData().trim()?$(`#convo_replybutton_${i}${j}`).prop("disabled",!0):$(`#convo_replybutton_${i}${j}`).prop("disabled",!1)})),mentions_reply_editor.on("key",(function(event){event.data.keyCode===CKEDITOR.CTRL+13&&$(`#convo_replybutton_${i}${j}`).trigger("click")})),CKEDITOR.instances)0===editorId.indexOf("convo_replycomment_")&&CKEDITOR.instances[editorId].setData("")}}}expand_rollup_comments("approvalCommentsModalBody_"),$(".closeCommentsModal").on("click",(function(){var modalElement=document.querySelector(".approvalCommentsModal");for(var instanceName in CKEDITOR.instances){var editorElement;if(CKEDITOR.instances.hasOwnProperty(instanceName))modalElement.querySelector("#"+instanceName)&&CKEDITOR.instances[instanceName].destroy()}$(`#approvalCommentsModal_${elementID}`).modal("hide")})),$(`#convo_add_comment_${elementID}`).off("click").on("click",(function(){if(approval_comment=CKEDITOR.instances[`approvalCommentText_${elementID}`].getData(),approval_comment){var usernamesArray=[],mentionPattern=/@(\w+)/g,matches=approval_comment.match(mentionPattern);if(matches){var uniqueUsernames=new Set;matches.forEach((function(match){uniqueUsernames.add(match.substr(1))})),usernamesArray=Array.from(uniqueUsernames)}$.ajax({url:`/users/${urlPath}/approval_table/`,data:{approval_id:approval_audit_log_data.id,current_level:current_level,operation:"add_comment",audit_log_configs:JSON.stringify(audit_log_configs),approval_comment:approval_comment,mentioned_usernames:JSON.stringify(usernamesArray),smtpConfigKey:smtpConfigKey,app_code:app_code},type:"POST",dataType:"json",success:function(data){var count=audit_log_configs.length;all_audit_data=JSON.parse(data.all_audit_data),audit_log_configs.push(all_audit_data[count]),CKEDITOR.instances[`approvalCommentText_${elementID}`].setData(""),temp_log=data;var[timestamp,tooltipTimestamp]=convertToTimestamp(temp_log.time),small_time="at"+tooltipTimestamp.split("at")[1],initials=getInitials(temp_log.user);audit_html=`\n                      <div class="approval_card approval_comment">\n                        <div id="approval_comment_${count}0">\n                          <div class="approval_comment_card">\n                            <div class="approval_info">\n                              <h5 class="approval_title"><span>${initials}</span></h5>\n                              <p class="approval_text">${temp_log.user} sent a comment</p>\n                              <div>\n                                <h6 class="approval_timestamp" data-toggle="tooltip" title="${tooltipTimestamp}">${timestamp}</h6>\n                                <small style="color: #929292;">${small_time}</small>\n                              </div>\n                            </div>\n                            <div class="approval_comment_text"><p>${temp_log.value}</p></div>\n                          </div>\n                        </div>\n                        <div class="reply-area mt-3">\n                          <textarea id="convo_replycomment_${count}0" name="convo_replycomment_${count}0"></textarea>\n                          <div style="margin: 15px 0 5px 0;text-align: right;display: flex;align-items: center;justify-content: flex-end;">\n                            <button class="btn btn-primary reply_comments" style="font-size:0.9rem;" disabled data-toggle="tooltip" title="Click this button or press Ctrl+Enter" id="convo_replybutton_${count}0" onclick="ReplyToConvoComment('${count}','0','Level ${current_level}','${approval_audit_log_data.id}', '${smtpConfigKey}', '${app_code}')">Reply <i class="fa-solid fa-comment-dots ml-2"></i></button>\n                          </div>\n                        </div>\n                      </div>\n                    `,$(`#approvalCommentsModalBody_${elementID}`).find(`.approval_outer_${elementID}`).prepend(audit_html),new_comment_reply_editor=CKEDITOR.replace(`convo_replycomment_${count}0`,{height:44,removeButtons:home_rtf[0],editorplaceholder:"Type your reply here...",plugins:"mentions,undo,link,list,basicstyles,justify,richcombo,wysiwygarea,toolbar",extraPlugins:"elementspath,editorplaceholder",toolbar:[{name:"document",items:["Undo"]},{name:"paragraph",items:["NumberedList","BulletedList","-","Outdent","Indent","-","Blockquote","CreateDiv","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"basicstyles",items:["Bold","Italic","Underline","Strike","-","RemoveFormat"]},{name:"links",items:["Mention","Link","Unlink","Anchor"]},{name:"styles",items:["Styles","Format","Font","FontSize"]},{name:"colors",items:["TextColor","BGColor"]},{name:"elementspath",items:["ElementPath"]}],mentions:[{feed:dataFeed,itemTemplate:itemTemplate,outputTemplate:outputTemplate,minChars:0}],removeButtons:"PasteFromWord"}),CKEDITOR.config.removePlugins="exportpdf",CKEDITOR.config.extraPlugins="autocorrect,elementspath",CKEDITOR.instances[`convo_replycomment_${count}0`].setData(""),(new_comment_reply_editor=CKEDITOR.instances[`convo_replycomment_${count}0`]).on("change",(function(){let typedText;""===new_comment_reply_editor.getData().trim()?$(`#convo_replybutton_${count}0`).prop("disabled",!0):$(`#convo_replybutton_${count}0`).prop("disabled",!1)})),new_comment_reply_editor.on("key",(function(event){event.data.keyCode===CKEDITOR.CTRL+13&&$(`#convo_replybutton_${count}0`).trigger("click")}))},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}})),"true"==!allowed_approval&&"true"==!allowed_edit&&"true"==!allowed_rejection&&($(`#approvalWallModalBody_${elementID}`).find(`#reopen_all_button_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(".resolve_button_ind").css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(".reopen_button_ind").css("display","none")),$(`#approvalCommentsModal_${elementID}`).modal("show")},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}}));var allowSaveTemplate=!1;$(`#saveTemplateButton${elementTabID}`).on("click",(function(){const eID=$(this).attr("id").split("saveTemplateButton")[1];allowSaveTemplate=!0,saveState[eID]=1,$(`#example1${eID}`).DataTable().state.save()})),$(`#filter_button_list_view${elementTabID}`).click((function(){elementTabID=$(this).attr("data-elementID"),$(`#filtershow${elementTabID}`).css("display","block")})),$(`#close_filter_card_button${elementTabID}`).click((function(){elementTabID=$(this).attr("data-elementID"),$(`#filtershow${elementTabID}`).css("display","none"),$(`.filter-table${elementTabID}`).empty(),$.fn.dataTable.ext.search.pop();const table=$(`#example1${elementTabID}`).DataTable();elementTabID in fDict2&&new $.fn.dataTable.FixedColumns(table,fDict2[`example1${elementTabID}`]),table.draw()})),$(".filter-button_listview").on("click",(function(){$(".standard_button_click").prop("disabled",!1)})),$("#removeFilter"+elementTabID).on("click",(function(){elementTabID=$(this).attr("data-elementid"),$(`.btn_search${elementTabID}`).removeAttr("data-filter-daterange"),datatableDict[elementTabID].columns().every((function(){const column=this,table=$(`#example1${elementTabID}`).DataTable();return elementTabID in fDict2&&new $.fn.dataTable.FixedColumns(table,fDict2[`example1${elementTabID}`]),this.search("").draw(),!0})),$("#removeFilter"+elementTabID).css("display","none")})),$(`.filter_btn${elementTabID}`).click((function(){const elementTabID=$(this).attr("data-elementID"),formFields=listViewTableDict[elementTabID].form_fields,tableName=listViewTableDict[elementTabID].model_name,dataContainingColumnNames=Array.from(listViewTableDict[elementTabID].dataContainingColumnNames),name=$(this).attr("name"),STRING=formFields[name];if(STRING.replace("</tr>","<select"),$(`.filter-table${elementTabID}`).append(STRING),$(`.filter-table${elementTabID}`).find("tr").eq(-1).find("td:nth-child(3)").before(`<td class="div_in_condition dt-center" style='display:none;'><div name='${name}'><select class="form-control select2"  name="${name}" placeholder="${name}" multiple='multiple'></select></div></td>`),"undefined"!==String($(`.filter-table${elementTabID}`).find("tr").eq(-1).find("input[data-type=ForeignKey]")[0])){const columnName=name,tableName=$(`.filter-table${elementTabID}`).find("tr").eq(-1).find("input[data-type=ForeignKey]").attr("data-tablename");$.ajax({url:`/users/${urlPath}/dynamicVa/`,data:{model_name:tableName,column_name:columnName,operation:"ForeignKeyFilter"},type:"POST",dataType:"json",success:function(data){if(0!==Number(Object.keys(data).length)){$(`.filter-table${elementTabID}`).find("tr").eq(-1).find("input[data-type=ForeignKey]").remove(),$(`.filter-table${elementTabID}`).find("tr").eq(-1).find("td").eq(-1).html(`\n          <div style="max-width:25em;">\n            <select class="form-control select2" type="int" name="${columnName}" placeholder="${columnName}"></select>\n          </div>\n          `);for(const[key,value]of Object.entries(data))$(`.filter-table${elementTabID}`).find("tr").eq(-1).find("td").eq(-1).find("select").append(`<option value="${value}">${key}</option>`),$(`.filter-table${elementTabID}`).find("tr").eq(-1).find("td").eq(2).find("select").append(`<option value="${value}">${key}</option>`);$(`.filter-table${elementTabID}`).find("tr").eq(-1).find("td").eq(-1).find("select").each((function(){$(this).select2()})),$(`.filter-table${elementTabID}`).find("tr").eq(-1).find("td").eq(2).find("select").each((function(){$(this).select2()})),$(`.filter-table${elementTabID}`).find("tr").eq(-1).find("td").eq(-2).find("select").find("option").each((function(){"Greater than"!==String($(this).attr("value"))&&"Smaller than"!==String($(this).attr("value"))||$(this).remove()}))}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function removefilter(){$(this).closest("tr").remove()}$(`.filter-table${elementTabID}:last-child`).find("select").each((function(){$(this).select2()})),$(`.filter-table${elementTabID}`).find("tr").find("td").eq(2).find("select").select2({tags:!0,width:"50%"}),$(`.filter-table${elementTabID}`).find("tr").find("td").find("select[data-dropdown_purpose='select_logical_operator']").closest("td").remove(),$(`.filter-table${elementTabID}`).find(".select2bs4").on("change",(function(){const conditionName=$(this).val();!0===["IN","NOT IN"].includes(conditionName)?$(this).closest("tr").find("td").each((function(index,val){index>1&&($(this).css("display","none"),2===index&&($(this).css("display","block"),$(this).find("select").select2({tags:!0,width:"70%"})))})):$(this).closest("tr").find("td").each((function(index,val){index>1&&($(this).css("display","block"),2===index&&($(this).css("display","none"),$(this).find("select").select2({tags:!0,width:"70%"})))}))})),$(`.btn_search${elementTabID}`).off("click").on("click",(function(){const elementTabID=$(this).attr("data-elementID"),standardfiltertable=datatableDict[elementTabID];$("#removeFilter"+elementTabID).css("display","inline-block");const modelName=tableName,table2=$(`.filter-table${elementTabID}`),filterList=[];table2.find("tr").each((function(){const filterRow=[],condition=$(this).find("select").eq(0).val();filterRow.push($(this).find("select").eq(0).attr("name")),filterRow.push($(this).find("select").eq(0).val()),!0===["IN","NOT IN"].includes(condition)?filterRow.push($(this).find("td").eq(2).find("select").val()):"undefined"!==String($(this).find("td").eq(3).find("input").val())?filterRow.push($(this).find("td").eq(3).find("input").val()):filterRow.push($(this).find("select").eq(-1).val()),filterList.push(filterRow)}));const filterDict={model_name:modelName,filter_list:JSON.stringify(filterList),filterform:"f1",elementID:elementTabID};if($(this).attr("data-filter-daterange")&&(filterDict.daterange_list=$(this).attr("data-filter-daterange")),$(`#tableTab${elementTabID}`).length>0){const reportTableData=$(`#example1${elementTabID}`).DataTable().column(1).data().toArray();filterDict.reportview_filter=JSON.stringify(reportTableData)}function datatableReload(data){let index;$(".standard_button_click").prop("disabled",!1);const datareturned=JSON.parse(data),primaryKey=datareturned[0],filteredpk=datareturned[1];for(const i in filteredpk)filteredpk[i]="^"+filteredpk[i]+"$";const combinedsearch=filteredpk.join("|");for(const x in dataContainingColumnNames)String(dataContainingColumnNames[x].data)===String(primaryKey)&&(index=x);standardfiltertable.columns().every((function(){if(String(this.index())===String(index)){const column=this;if(String(column.search())!==String(combinedsearch)){const table=$(`#example1${elementTabID}`).DataTable();elementTabID in fDict2&&new $.fn.dataTable.FixedColumns(table,fDict2[`example1${elementTabID}`]),column.search(combinedsearch||"",!0,!1).draw()}else column.search(combinedsearch).draw()}return!0}))}filter_list_2=JSON.parse(filterDict.filter_list),filter_blank_values=!1,filter_list_2.forEach(b=>{b.forEach(c=>{if("object"==typeof c){if(0===c.length)return void(filter_blank_values=!0)}else if(""===c)return void(filter_blank_values=!0)})}),!1===filter_blank_values?$.ajax({url:`/users/${urlPath}/viewfilter/`,data:filterDict,type:"POST",dataType:"json",success:datatableReload,error:function(){Swal.fire({icon:"error",text:"Error! Please try again."}),$(".standard_button_click").prop("disabled",!1)}}):Swal.fire({icon:"error",text:"Please fill input values in filter."})})),$(".remove_filter").on("click",removefilter),$(".table").on("click",".remove_filter",(function(){const whichtr=$(this).closest("tr");whichtr.remove()}))})),$(`.conditional_delete${elementTabID}`).click((function(){const itemCode=windowLocation.split("/")[4],elementTabID=$(this).attr("data-elementID"),formFields=listViewTableDict[elementTabID].form_fields,tableName=listViewTableDict[elementTabID].model_name,dataContainingColumnNames=Array.from(listViewTableDict[elementTabID].dataContainingColumnNames),name=$(this).attr("name"),STRING=formFields[name];if(STRING.replace("</tr>","<select"),$(`.conditional-delete-table${elementTabID}`).append(STRING),$(`.conditional-delete-table${elementTabID}`).find("tr").eq(-1).find("td:nth-child(3)").before(`<td class="div_in_condition dt-center" style='display:none;'><div name='${name}'><select class="form-control select2"  name="${name}" placeholder="${name}" multiple='multiple'></select></div></td>`),"undefined"!==String($(`.conditional-delete-table${elementTabID}`).find("tr").eq(-1).find("input[data-type=ForeignKey]")[0])){const columnName=name,tableName=$(`.conditional-delete-table${elementTabID}`).find("tr").eq(-1).find("input[data-type=ForeignKey]").attr("data-tablename");$.ajax({url:`/users/${urlPath}/dynamicVa/`,data:{model_name:tableName,column_name:columnName,operation:"ForeignKeyFilter"},type:"POST",dataType:"json",success:function(data){if(0!==Number(Object.keys(data).length)){$(`.conditional-delete-table${elementTabID}`).find("tr").eq(-1).find("input[data-type=ForeignKey]").remove(),$(`.conditional-delete-table${elementTabID}`).find("tr").eq(-1).find("td").eq(-1).html(`\n          <div style="max-width:25em;">\n            <select class="form-control select2" type="int" name="${columnName}" placeholder="${columnName}"></select>\n          </div>\n          `);for(const[key,value]of Object.entries(data))$(`.conditional-delete-table${elementTabID}`).find("tr").eq(-1).find("td").eq(-1).find("select").append(`<option value="${value}">${key}</option>`),$(`.conditional-delete-table${elementTabID}`).find("tr").eq(-1).find("td").eq(2).find("select").append(`<option value="${value}">${key}</option>`);$(`.conditional-delete-table${elementTabID}`).find("tr").eq(-1).find("td").eq(-1).find("select").each((function(){$(this).select2()})),$(`.conditional-delete-table${elementTabID}`).find("tr").eq(-1).find("td").eq(2).find("select").each((function(){$(this).select2()})),$(`.conditional-delete-table${elementTabID}`).find("tr").eq(-1).find("td").eq(-2).find("select").find("option").each((function(){"Greater than"!==String($(this).attr("value"))&&"Smaller than"!==String($(this).attr("value"))||$(this).remove()}))}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}$(`.conditional-delete-table${elementTabID}:last-child`).find("select").each((function(){$(this).select2()})),$(`.conditional-delete-table${elementTabID}`).find("tr").find("td").eq(2).find("select").select2({tags:!0,width:"50%"}),$(`.conditional-delete-table${elementTabID}`).find("tr").find("td").find("select[data-dropdown_purpose='select_logical_operator']").closest("td").remove(),$(`.conditional-delete-table${elementTabID}`).find(".select2bs4").on("change",(function(){const conditionName=$(this).val();!0===["IN","NOT IN"].includes(conditionName)?$(this).closest("tr").find("td").each((function(index,val){index>1&&($(this).css("display","none"),2===index&&($(this).css("display","block"),$(this).find("select").select2({tags:!0,width:"70%"})))})):$(this).closest("tr").find("td").each((function(index,val){index>1&&($(this).css("display","block"),2===index&&($(this).css("display","none"),$(this).find("select").select2({tags:!0,width:"70%"})))}))})),$(`.conditional_delete_search${elementTabID}`).off("click").on("click",(function(){const elementTabID=$(this).attr("data-elementID"),buttonID=$(this).attr("id"),standardfiltertable=datatableDict[elementTabID],modelName=tableName,table2=$(`.conditional-delete-table${elementTabID}`),filterList=[];if(table2.find("tr").each((function(){const filterRow=[],condition=$(this).find("select").eq(0).val();filterRow.push($(this).find("select").eq(0).attr("name")),filterRow.push($(this).find("select").eq(0).val()),!0===["IN","NOT IN"].includes(condition)?filterRow.push($(this).find("td").eq(2).find("select").val()):"undefined"!==String($(this).find("td").eq(3).find("input").val())?filterRow.push($(this).find("td").eq(3).find("input").val()):filterRow.push($(this).find("select").eq(-1).val()),filterList.push(filterRow)})),buttonID===`perm_conditional_delete_${elementTabID}`){var view_name="";temp_type=$(`#${elementTabID}_tab_content`).attr("data-template-type"),"Multi Dropdown View"==temp_type&&(view_name=$(`#tableTab${elementTabID}`).find("select").val()),$.ajax({url:`/users/${urlPath}/DataManagement/`,data:{element_id:elementTabID.split("__tab__")[0],operation:"fetch_list_view_msgs",messages:JSON.stringify(["confirm_conditional_perm_delete_message","success_conditional_perm_delete_message"]),view_name:view_name},type:"POST",dataType:"json",success:function(data){message="",icon="",data.confirm_conditional_perm_delete_message&&(message=data.confirm_conditional_perm_delete_message.message,icon=data.confirm_conditional_perm_delete_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),custom_messages=data,Swal.fire({icon:"question",text:message||"Are you sure you want to permanently delete these records?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(result=>{result.isConfirmed&&$.ajax({url:`/users/${urlPath}/${itemCode}/`,data:{operation:"perm_delete_conditional_list",filter_list:JSON.stringify(filterList),model_name:modelName,elementid:elementTabID,custom_messages:JSON.stringify(custom_messages)},type:"POST",dataType:"json",success:function(){$(`#conditional_delete_modal_${elementTabID}`).hide(),$(`#example1${elementTabID}`).DataTable().draw(),message="",icon="",custom_messages.success_conditional_perm_delete_message&&(message=custom_messages.success_conditional_perm_delete_message.message,icon=custom_messages.success_conditional_perm_delete_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"success",iconHtml:iconHtml,text:message||"Data deleted successfully!"}),$(".modal-backdrop").hide()},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}else if(buttonID===`temp_conditional_delete_${elementTabID}`){var view_name="";temp_type=$(`#${elementTabID}_tab_content`).attr("data-template-type"),"Multi Dropdown View"==temp_type&&(view_name=$(`#tableTab${elementTabID}`).find("select").val()),$.ajax({url:`/users/${urlPath}/DataManagement/`,data:{element_id:elementTabID.split("__tab__")[0],operation:"fetch_list_view_msgs",messages:JSON.stringify(["confirm_conditional_temp_delete_message","success_conditional_temp_delete_message"]),view_name:view_name},type:"POST",dataType:"json",success:function(data){message="",icon="",data.confirm_conditional_temp_delete_message&&(message=data.confirm_conditional_temp_delete_message.message,icon=data.confirm_conditional_temp_delete_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),custom_messages=data,Swal.fire({icon:"question",text:message||"Are you sure you want to temporarily delete these records?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(result=>{result.isConfirmed&&$.ajax({url:`/users/${urlPath}/${itemCode}/`,data:{operation:"temp_delete_conditional_list",filter_list:JSON.stringify(filterList),model_name:modelName,elementid:elementTabID,custom_messages:JSON.stringify(custom_messages)},type:"POST",dataType:"json",success:function(){$(`#conditional_delete_modal_${elementTabID}`).hide(),$(`#example1${elementTabID}`).DataTable().draw(),message="",icon="",custom_messages.success_conditional_temp_delete_message&&(message=custom_messages.success_conditional_temp_delete_message.message,icon=custom_messages.success_conditional_temp_delete_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"success",iconHtml:iconHtml,text:message||"Data has been temporarily deleted."}),$(".modal-backdrop").hide()},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}}))}));let dt=$(`#example1${elementTabID}`).DataTable(),firstColumnHeader=dt.column(0).header(),firstColumnHeaderText;"Select"==$(firstColumnHeader).text()&&dt.column(0).visible(!1);var select_status=!1;$(`#multiple_delete_perm_${elementTabID}`).click((function(){const delete_checkboxes=$(`#example1${elementTabID}`).find(".multiple_select_checkbox");delete_checkboxes.prop("disabled",!1);const status=$(`#multiple_delete_perm_${elementTabID}`).attr("data-edit-status");let dt=$(`#example1${elementTabID}`).DataTable(),firstColumnHeader=dt.column(0).header(),firstColumnHeaderText=$(firstColumnHeader).text();"off"===String(status)?($(`#multiple_delete_perm_${elementTabID}`).attr("data-edit-status","on"),$(`#multiple_delete_perm_${elementTabID}`).text("Delete Multiple(Permanent): ON").trigger("change"),$(`#multiple_delete_perm_final_${elementTabID}`).css("display","inline-block"),$(`#multiple_delete_temp_${elementTabID}`).prop("disabled",!0),$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!0),$(`#approve_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!0)):($(`#multiple_delete_perm_${elementTabID}`).attr("data-edit-status","off"),$(`#multiple_delete_perm_${elementTabID}`).text("Delete Multiple(Permanent): OFF").trigger("change"),$(`#multiple_delete_perm_final_${elementTabID}`).css("display","none"),$(`#multiple_delete_temp_${elementTabID}`).prop("disabled",!1),$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!1),$(`#approve_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!1)),"Select"==firstColumnHeaderText&&(dt.column(0).visible()?dt.column(0).visible(!1):(dt.column(0).visible(!0),select_status=!0)),"none"===delete_checkboxes.css("display")?delete_checkboxes.css("display","inline-block"):delete_checkboxes.css("display","none"),select_status&&$(`#example1${elementTabID}`).find(".multiple_select_checkbox").css("display","inline-block"),"none"===$(`#multiple_select_checkbox_SelectAll_div${elementTabID}`).css("display")?$(`#multiple_select_checkbox_SelectAll_div${elementTabID}`).css("display","inline-block"):$(`#multiple_select_checkbox_SelectAll_div${elementTabID}`).css("display","none")})),$(`#multiple_delete_perm_final_${elementTabID}`).click((function(){const idDatatable=$(`#example1${elementTabID}`).attr("id"),table=$("#"+idDatatable).DataTable(),delete_checkboxes=$(`#example1${elementTabID}`).find(".multiple_select_checkbox"),itemCode=windowLocation.split("/")[4],tableName=listViewTableDict[elementTabID].model_name;var deletion_list=[];let dt=$(`#example1${elementTabID}`).DataTable(),firstColumnHeader=dt.column(0).header(),firstColumnHeaderText=$(firstColumnHeader).text();delete_checkboxes.each((function(){if(this.checked){const tData=$(this.closest("tr")),tab=table.row(tData).data();"id"in tab?primaryKeyId=tab.id:"ID"in tab?primaryKeyId=tab.ID:"iD"in tab?primaryKeyId=tab.iD:"Id"in tab&&(primaryKeyId=tab.Id),deletion_list.push(String(primaryKeyId))}}));var numbersArray=$.map(deletion_list,(function(item){if(item.startsWith("id:")){var match=item.match(/id:(\d+)/);return match?match[1]:null}return null}));numbersArray.length>0&&(deletion_list=numbersArray);var view_name="";temp_type=$(`#${elementTabID}_tab_content`).attr("data-template-type"),"Multi Dropdown View"==temp_type&&(view_name=$(`#tableTab${elementTabID}`).find("select").val()),deletion_list.length>0?$.ajax({url:`/users/${urlPath}/DataManagement/`,data:{element_id:elementTabID.split("__tab__")[0],operation:"fetch_list_view_msgs",messages:JSON.stringify(["confirm_multiple_delete_perm_message","success_multiple_delete_perm_message"]),view_name:view_name},type:"POST",dataType:"json",success:function(data){message="",icon="",data.confirm_multiple_delete_perm_message&&(message=data.confirm_multiple_delete_perm_message.message,icon=data.confirm_multiple_delete_perm_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),custom_messages=data,Swal.fire({icon:"question",iconHtml:iconHtml,text:message||"Are you sure you want to permanently delete these records?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(result=>{result.isConfirmed&&$.ajax({url:`/users/${urlPath}/${itemCode}/`,data:{operation:"multiple_delete_list_perm",deletion_list:JSON.stringify(deletion_list),model_name:tableName,elementid:elementTabID,custom_messages:JSON.stringify(custom_messages)},type:"POST",dataType:"json",success:function(){message="",icon="",custom_messages.success_multiple_delete_perm_message&&(message=custom_messages.success_multiple_delete_perm_message.message,icon=custom_messages.success_multiple_delete_perm_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"success",iconHtml:iconHtml,text:message||"Data deleted successfully."}),$(`#example1${elementTabID}`).DataTable().draw(),$(`#multiple_select_checkbox_SelectAll_div${elementTabID}`).css("display","none"),$(".multiple_select_checkbox").css("display","none"),$(`#multiple_delete_perm_${elementTabID}`).attr("data-edit-status","off"),$(`#multiple_delete_perm_${elementTabID}`).text("Delete Multiple(Permanent): OFF").trigger("change"),$(`#multiple_delete_perm_final_${elementTabID}`).css("display","none"),$(`#multiple_delete_temp_${elementTabID}`).prop("disabled",!1),$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!1),$(`#approve_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!1),"Select"==firstColumnHeaderText&&dt.column(0).visible(!1)},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}}):Swal.fire({icon:"warning",text:"Please select something!"})})),$(`#multiple_delete_temp_${elementTabID}`).click((function(){const delete_checkboxes=$(`#example1${elementTabID}`).find(".multiple_select_checkbox");delete_checkboxes.prop("disabled",!1);const status=$(`#multiple_delete_temp_${elementTabID}`).attr("data-edit-status");let dt=$(`#example1${elementTabID}`).DataTable(),firstColumnHeader=dt.column(0).header();var firstColumnHeaderText=$(firstColumnHeader).text(),select_status=!1;"off"===String(status)?($(`#multiple_delete_temp_${elementTabID}`).attr("data-edit-status","on"),$(`#multiple_delete_temp_${elementTabID}`).text("Delete Multiple(Temporary): ON").trigger("change"),$(`#multiple_delete_temp_final_${elementTabID}`).css("display","inline-block"),$(`#multiple_delete_perm_${elementTabID}`).prop("disabled",!0),$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!0),$(`#approve_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!0)):($(`#multiple_delete_temp_${elementTabID}`).attr("data-edit-status","off"),$(`#multiple_delete_temp_${elementTabID}`).text("Delete Multiple(Temporary): OFF").trigger("change"),$(`#multiple_delete_temp_final_${elementTabID}`).css("display","none"),$(`#multiple_delete_perm_${elementTabID}`).prop("disabled",!1),$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!1),$(`#approve_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!1)),"Select"==firstColumnHeaderText&&(dt.column(0).visible()?dt.column(0).visible(!1):(dt.column(0).visible(!0),select_status=!0)),"none"===delete_checkboxes.css("display")?delete_checkboxes.css("display","inline-block"):delete_checkboxes.css("display","none"),select_status&&$(`#example1${elementTabID}`).find(".multiple_select_checkbox").css("display","inline-block");var iTag,anchor,pointerEvents=dt.$('i[value="approve"]').parent().css("pointer-events");$(`#example1${elementTabID}`).find(".multiple_select_checkbox").each((function(){"none"===$(this).closest("td").find('a[title="Approve record"]').css("pointer-events")&&($(this).prop("disabled",!0),$(this).css("cursor","default")),"none"===pointerEvents&&($(this).prop("disabled",!0),$(this).css("cursor","default"))})),"none"===$(`#multiple_select_checkbox_SelectAll_div${elementTabID}`).css("display")?$(`#multiple_select_checkbox_SelectAll_div${elementTabID}`).css("display","inline-block"):$(`#multiple_select_checkbox_SelectAll_div${elementTabID}`).css("display","none")})),$(`#multiple_delete_temp_final_${elementTabID}`).click((function(){const idDatatable=$(`#example1${elementTabID}`).attr("id"),table=$("#"+idDatatable).DataTable(),itemCode=windowLocation.split("/")[4],tableName=listViewTableDict[elementTabID].model_name,delete_checkboxes=$(`#example1${elementTabID}`).find(".multiple_select_checkbox");var deletion_list=[];let dt=$(`#example1${elementTabID}`).DataTable(),firstColumnHeader=dt.column(0).header(),firstColumnHeaderText=$(firstColumnHeader).text();delete_checkboxes.each((function(){if(this.checked){const tData=$(this.closest("tr")),tab=table.row(tData).data();"id"in tab?primaryKeyId=tab.id:"ID"in tab?primaryKeyId=tab.ID:"iD"in tab?primaryKeyId=tab.iD:"Id"in tab&&(primaryKeyId=tab.Id),deletion_list.push(String(primaryKeyId))}}));var numbersArray=$.map(deletion_list,(function(item){if(item.startsWith("id:")){var match=item.match(/id:(\d+)/);return match?match[1]:null}return null}));numbersArray.length>0&&(deletion_list=numbersArray);var view_name="";temp_type=$(`#${elementTabID}_tab_content`).attr("data-template-type"),"Multi Dropdown View"==temp_type&&(view_name=$(`#tableTab${elementTabID}`).find("select").val()),deletion_list.length>0?$.ajax({url:`/users/${urlPath}/DataManagement/`,data:{element_id:elementTabID.split("__tab__")[0],operation:"fetch_list_view_msgs",messages:JSON.stringify(["confirm_multiple_delete_temp_message","success_multiple_delete_temp_message"]),view_name:view_name},type:"POST",dataType:"json",success:function(data){message="",icon="",data.confirm_multiple_delete_temp_message&&(message=data.confirm_multiple_delete_temp_message.message,icon=data.confirm_multiple_delete_temp_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),custom_messages=data,Swal.fire({icon:"question",iconHtml:iconHtml,text:message||"Are you sure you want to temporarily delete these records?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(result=>{result.isConfirmed&&$.ajax({url:`/users/${urlPath}/${itemCode}/`,data:{operation:"multiple_delete_list_temp",deletion_list:JSON.stringify(deletion_list),model_name:tableName,elementid:elementTabID,custom_messages:JSON.stringify(custom_messages)},type:"POST",dataType:"json",success:function(){message="",icon="",custom_messages.success_multiple_delete_temp_message&&(message=custom_messages.success_multiple_delete_temp_message.message,icon=custom_messages.success_multiple_delete_temp_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"success",iconHtml:iconHtml,text:message||"Data has been temporarily deleted."}),$(`#example1${elementTabID}`).DataTable().draw(),$(`#multiple_select_checkbox_SelectAll_div${elementTabID}`).css("display","none"),$(".multiple_select_checkbox").css("display","none"),$(`#multiple_delete_temp_${elementTabID}`).attr("data-edit-status","off"),$(`#multiple_delete_temp_${elementTabID}`).text("Delete Multiple(Temporary): OFF").trigger("change"),$(`#multiple_delete_temp_final_${elementTabID}`).css("display","none"),$(`#multiple_delete_perm_${elementTabID}`).prop("disabled",!1),$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!1),$(`#approve_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!1),"Select"==firstColumnHeaderText&&dt.column(0).visible(!1)},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}}):Swal.fire({icon:"warning",text:"Please select something!"})})),$(`#approve_all_ApprovalTemplate_${elementTabID}`).click((function(){var view_name="";temp_type=$(`#${elementTabID}_tab_content`).attr("data-template-type"),"Multi Dropdown View"==temp_type&&(view_name=$(`#tableTab${elementTabID}`).find("select").val()),$.ajax({url:`/users/${urlPath}/DataManagement/`,data:{element_id:elementTabID.split("__tab__")[0],operation:"fetch_list_view_msgs",messages:JSON.stringify(["confirm_approve_all_message","success_approve_all_message"]),view_name:view_name},type:"POST",dataType:"json",success:function(data){message="",icon="",data.confirm_approve_all_message&&(message=data.confirm_approve_all_message.message,icon=data.confirm_approve_all_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),custom_messages=data,Swal.fire({icon:"question",iconHtml:iconHtml,text:message||"Are you sure you want to approve all pending records?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(result=>{result.isConfirmed&&($(`#approvalCommentModal_approveAll_${elementTabID}`).modal("show"),$(`#approval_final_send_approveAll_${elementTabID}`).off("click").on("click",(function(){let approval_comment=$(`#approvalCommentText_approveAll_${elementTabID}`).val();$(`#approvalCommentModal_approveAll_${elementTabID}`).modal("hide"),$.ajax({url:`/users/${urlPath}/approval_table/`,data:{operation:"approve_all_approvalTemplate",element_id:elementTabID.split("__tab__")[0],approval_comment:approval_comment},type:"POST",dataType:"json",success:function(data){message="",icon="",custom_messages.success_approve_all_message&&(message=custom_messages.success_approve_all_message.message,icon=custom_messages.success_approve_all_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"success",iconHtml:iconHtml,text:message||"All the records where you are the concerned approver have been approved."}).then(result=>{result.isConfirmed&&windowLocationAttr.reload()})},error:function(){Swal.fire({icon:"warning",text:"There are no records left to approve for this user."})}})})))})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})})),$(`#reject_all_ApprovalTemplate_${elementTabID}`).click((function(){var view_name="";temp_type=$(`#${elementTabID}_tab_content`).attr("data-template-type"),"Multi Dropdown View"==temp_type&&(view_name=$(`#tableTab${elementTabID}`).find("select").val()),$.ajax({url:`/users/${urlPath}/DataManagement/`,data:{element_id:elementTabID.split("__tab__")[0],operation:"fetch_list_view_msgs",messages:JSON.stringify(["confirm_reject_all_message","success_reject_all_message"]),view_name:view_name},type:"POST",dataType:"json",success:function(data){message="",icon="",data.confirm_reject_all_message&&(message=data.confirm_reject_all_message.message,icon=data.confirm_reject_all_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),custom_messages=data,Swal.fire({icon:"question",iconHtml:iconHtml,text:message||"Are you sure you want to reject all pending records?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(result=>{result.isConfirmed&&($(`#approvalCommentModal_rejectAll_${elementTabID}`).modal("show"),$(`#approval_final_send_rejectAll_${elementTabID}`).off("click").on("click",(function(){let approval_comment=$(`#approvalCommentText_rejectAll_${elementTabID}`).val();$(`#approvalCommentModal_rejectAll_${elementTabID}`).modal("hide"),$.ajax({url:`/users/${urlPath}/approval_table/`,data:{operation:"reject_all_approvalTemplate",element_id:elementTabID.split("__tab__")[0],approval_comment:approval_comment},type:"POST",dataType:"json",success:function(){message="",icon="",custom_messages.success_reject_all_message&&(message=custom_messages.success_reject_all_message.message,icon=custom_messages.success_reject_all_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"success",iconHtml:iconHtml,text:message||"All the records where you are the concerned approver have been rejected."}).then(result=>{result.isConfirmed&&windowLocationAttr.reload()})},error:function(){Swal.fire({icon:"warning",text:"There are no records left to reject for this user."})}})})))})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})})),$(`#approve_multiple_ApprovalTemplate_${elementTabID}`).off("click").on("click",(function(){const approve_checkboxes=$(`#example1${elementTabID}`).find(".multiple_select_checkbox");let dt=$(`#example1${elementTabID}`).DataTable(),firstColumnHeader=dt.column(0).header(),firstColumnHeaderText=$(firstColumnHeader).text(),select_status=!1;const status=$(`#approve_multiple_ApprovalTemplate_${elementTabID}`).attr("data-edit-status");"off"===String(status)?($(`#approve_multiple_ApprovalTemplate_${elementTabID}`).attr("data-edit-status","on"),$(`#approve_multiple_ApprovalTemplate_${elementTabID}`).text("Approve Multiple: ON").trigger("change"),$(`#approve_multiple_ApprovalTemplate_final_${elementTabID}`).css("display","inline-block"),$(`#multiple_delete_perm_${elementTabID}`).prop("disabled",!0),$(`#multiple_delete_temp_${elementTabID}`).prop("disabled",!0),$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!0)):($(`#approve_multiple_ApprovalTemplate_${elementTabID}`).attr("data-edit-status","off"),$(`#approve_multiple_ApprovalTemplate_${elementTabID}`).text("Approve Multiple: OFF").trigger("change"),$(`#approve_multiple_ApprovalTemplate_final_${elementTabID}`).css("display","none"),$(`#multiple_delete_perm_${elementTabID}`).prop("disabled",!1),$(`#multiple_delete_temp_${elementTabID}`).prop("disabled",!1),$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!1)),"Select"==firstColumnHeaderText&&(dt.column(0).visible()?dt.column(0).visible(!1):(dt.column(0).visible(!0),select_status=!0)),select_status&&$(`#example1${elementTabID}`).find(".multiple_select_checkbox").css("display","inline-block"),"none"===approve_checkboxes.css("display")?approve_checkboxes.css("display","inline-block"):approve_checkboxes.css("display","none");var iTag,anchor,pointerEvents=dt.$('i[value="approve"]').parent().css("pointer-events");$(`#example1${elementTabID}`).find(".multiple_select_checkbox").each((function(){"none"===$(this).closest("td").find('a[title="Approve record"]').css("pointer-events")&&($(this).prop("disabled",!0),$(this).css("cursor","default")),"none"===pointerEvents&&($(this).prop("disabled",!0),$(this).css("cursor","default"))})),"none"===$(`#multiple_select_checkbox_SelectAll_div${elementTabID}`).css("display")?$(`#multiple_select_checkbox_SelectAll_div${elementTabID}`).css("display","inline-block"):$(`#multiple_select_checkbox_SelectAll_div${elementTabID}`).css("display","none")})),$(`#approve_multiple_ApprovalTemplate_final_${elementTabID}`).off("click").on("click",(function(){const idDatatable=$(`#example1${elementTabID}`).attr("id"),table=$("#"+idDatatable).DataTable();var view_name="";temp_type=$(`#${elementTabID}_tab_content`).attr("data-template-type"),"Multi Dropdown View"==temp_type&&(view_name=$(`#tableTab${elementTabID}`).find("select").val());const approve_checkboxes=$(`#example1${elementTabID}`).find(".multiple_select_checkbox");var approve_list=[];approve_checkboxes.each((function(){if("none"===$(this).closest("td").find('a[title="Approve record"]').css("pointer-events")&&($(this).prop("disabled",!0),$(this).css("cursor","default")),this.checked){const tData=$(this.closest("tr")),tab=table.row(tData).data();"id"in tab?primaryKeyId=tab.id:"ID"in tab?primaryKeyId=tab.ID:"iD"in tab?primaryKeyId=tab.iD:"Id"in tab&&(primaryKeyId=tab.Id),approve_list.push(String(primaryKeyId))}})),approve_list.length>0?$.ajax({url:`/users/${urlPath}/DataManagement/`,data:{element_id:elementTabID.split("__tab__")[0],operation:"fetch_list_view_msgs",messages:JSON.stringify(["confirm_approve_multiple_message","success_approve_multiple_message"]),view_name:view_name},type:"POST",dataType:"json",success:function(data){message="",icon="",data.confirm_approve_multiple_message&&(message=data.confirm_approve_multiple_message.message,icon=data.confirm_approve_multiple_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),custom_messages=data,Swal.fire({icon:"question",iconHtml:iconHtml,text:message||"Are you sure you want to approve selected records for this approver?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(result=>{result.isConfirmed&&($(`#approvalCommentModal_approveMultiple_${elementTabID}`).modal("show"),$(`#approval_final_send_approveMultiple_${elementTabID}`).off("click").on("click",(function(){let approval_comment=$(`#approvalCommentText_approveMultiple_${elementTabID}`).val();$(`#approvalCommentModal_approveMultiple_${elementTabID}`).modal("hide"),$.ajax({url:`/users/${urlPath}/approval_table/`,data:{operation:"approve_all_approvalTemplate",element_id:elementTabID.split("__tab__")[0],approval_comment:approval_comment,approve_list:JSON.stringify(approve_list)},type:"POST",dataType:"json",success:function(){message="",icon="",custom_messages.success_approve_multiple_message&&(message=custom_messages.success_approve_multiple_message.message,icon=custom_messages.success_approve_multiple_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"success",iconHtml:iconHtml,text:message||"All selected records where you are the concerned approver have been approved."}),$(`#example1${elementTabID}`).DataTable().draw(),$(`#multiple_select_checkbox_SelectAll_div${elementTabID}`).css("display","none"),$(".multiple_select_checkbox").css("display","none"),$(`#multiple_delete_perm_${elementTabID}`).prop("disabled",!1),$(`#multiple_delete_temp_${elementTabID}`).prop("disabled",!1),$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!1),$(`#approve_multiple_ApprovalTemplate_${elementTabID}`).attr("data-edit-status","off"),$(`#approve_multiple_ApprovalTemplate_${elementTabID}`).text("Approve Multiple: OFF").trigger("change"),$(`#approve_multiple_ApprovalTemplate_final_${elementTabID}`).css("display","none")},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})})))})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}}):Swal.fire({icon:"warning",text:"Please select something!"})})),$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).off("click").on("click",(function(){let dt=$(`#example1${elementTabID}`).DataTable(),firstColumnHeader=dt.column(0).header(),firstColumnHeaderText=$(firstColumnHeader).text(),select_status=!1;const reject_checkboxes=$(`#example1${elementTabID}`).find(".multiple_select_checkbox"),status=$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).attr("data-edit-status");"off"===String(status)?($(`#reject_multiple_ApprovalTemplate_${elementTabID}`).attr("data-edit-status","on"),$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).text("Reject Multiple:ON").trigger("change"),$(`#reject_multiple_ApprovalTemplate_final_${elementTabID}`).css("display","inline-block"),$(`#multiple_delete_perm_${elementTabID}`).prop("disabled",!0),$(`#multiple_delete_temp_${elementTabID}`).prop("disabled",!0),$(`#approve_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!0)):($(`#reject_multiple_ApprovalTemplate_${elementTabID}`).attr("data-edit-status","off"),$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).text("Reject Multiple:OFF").trigger("change"),$(`#reject_multiple_ApprovalTemplate_final_${elementTabID}`).css("display","none"),$(`#multiple_delete_perm_${elementTabID}`).prop("disabled",!1),$(`#multiple_delete_temp_${elementTabID}`).prop("disabled",!1),$(`#approve_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!1)),"Select"==firstColumnHeaderText&&(dt.column(0).visible()?dt.column(0).visible(!1):(dt.column(0).visible(!0),select_status=!0)),select_status&&$(`#example1${elementTabID}`).find(".multiple_select_checkbox").css("display","inline-block"),"none"===reject_checkboxes.css("display")?reject_checkboxes.css("display","inline-block"):reject_checkboxes.css("display","none");var iTag,anchor,pointerEvents=dt.$('i[value="approve"]').parent().css("pointer-events");$(`#example1${elementTabID}`).find(".multiple_select_checkbox").each((function(){"none"===$(this).closest("td").find('a[title="Approve record"]').css("pointer-events")&&($(this).prop("disabled",!0),$(this).css("cursor","default")),"none"===pointerEvents&&($(this).prop("disabled",!0),$(this).css("cursor","default"))})),"none"===$(`#multiple_select_checkbox_SelectAll_div${elementTabID}`).css("display")?$(`#multiple_select_checkbox_SelectAll_div${elementTabID}`).css("display","inline-block"):$(`#multiple_select_checkbox_SelectAll_div${elementTabID}`).css("display","none")})),$(`#reject_multiple_ApprovalTemplate_final_${elementTabID}`).off("click").on("click",(function(){const idDatatable=$(`#example1${elementTabID}`).attr("id"),table=$("#"+idDatatable).DataTable();let firstColumnHeader=table.column(0).header(),firstColumnHeaderText=$(firstColumnHeader).text();var view_name="";temp_type=$(`#${elementTabID}_tab_content`).attr("data-template-type"),"Multi Dropdown View"==temp_type&&(view_name=$(`#tableTab${elementTabID}`).find("select").val());const reject_checkboxes=$(`#example1${elementTabID}`).find(".multiple_select_checkbox");var reject_list=[];reject_checkboxes.each((function(){if("none"===$(this).closest("td").find('a[title="Approve record"]').css("pointer-events")&&($(this).prop("disabled",!0),$(this).css("cursor","default")),this.checked){const tData=$(this.closest("tr")),tab=table.row(tData).data();"id"in tab?primaryKeyId=tab.id:"ID"in tab?primaryKeyId=tab.ID:"iD"in tab?primaryKeyId=tab.iD:"Id"in tab&&(primaryKeyId=tab.Id),reject_list.push(String(primaryKeyId))}})),reject_list.length>0?$.ajax({url:`/users/${urlPath}/DataManagement/`,data:{element_id:elementTabID.split("__tab__")[0],operation:"fetch_list_view_msgs",messages:JSON.stringify(["confirm_reject_multiple_message","success_reject_multiple_message"]),view_name:view_name},type:"POST",dataType:"json",success:function(data){message="",icon="",data.confirm_reject_multiple_message&&(message=data.confirm_reject_multiple_message.message,icon=data.confirm_reject_multiple_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),custom_messages=data,Swal.fire({icon:"question",iconHtml:iconHtml,text:message||"Are you sure you want to reject selected records for this approver?",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(result=>{result.isConfirmed&&($(`#approvalCommentModal_rejectMultiple_${elementTabID}`).modal("show"),$(`#approval_final_send_rejectMultiple_${elementTabID}`).off("click").on("click",(function(){let approval_comment=$(`#approvalCommentText_rejectMultiple_${elementTabID}`).val();$(`#approvalCommentModal_rejectMultiple_${elementTabID}`).modal("hide"),$.ajax({url:`/users/${urlPath}/approval_table/`,data:{operation:"reject_all_approvalTemplate",element_id:elementTabID.split("__tab__")[0],approval_comment:approval_comment,reject_list:JSON.stringify(reject_list)},type:"POST",dataType:"json",success:function(){message="",icon="",custom_messages.success_reject_multiple_message&&(message=custom_messages.success_reject_multiple_message.message,icon=custom_messages.success_reject_multiple_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"success",iconHtml:iconHtml,text:message||"All selected records where you are the concerned approver have been rejected."}),$(`#example1${elementTabID}`).DataTable().draw(),$(`#multiple_select_checkbox_SelectAll_div${elementTabID}`).css("display","none"),$(".multiple_select_checkbox").css("display","none"),$(`#multiple_delete_perm_${elementTabID}`).prop("disabled",!1),$(`#multiple_delete_temp_${elementTabID}`).prop("disabled",!1),$(`#approve_multiple_ApprovalTemplate_${elementTabID}`).prop("disabled",!1),$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).attr("data-edit-status","off"),$(`#reject_multiple_ApprovalTemplate_${elementTabID}`).text("Reject Multiple: OFF").trigger("change"),$(`#reject_multiple_ApprovalTemplate_final_${elementTabID}`).css("display","none"),"Select"==firstColumnHeaderText&&dt.column(0).visible(!1)},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})})))})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}}):Swal.fire({icon:"warning",text:"Please select something!"})})),$(`#filter_date${elementTabID}`).on("change",(function(){"Custom"===String(this.value)?$(`#startandenddate${elementTabID}`).css("display","block"):$(`#startandenddate${elementTabID}`).css("display","none")})),$(`#daterange_filter${elementTabID}`).off("click").on("click",(function(){const modelName=listViewTableDict[elementTabID].model_name,daterangeList=[];let datefield="created_date",customdatefield=$(this).attr("daterange_field");String($(this).attr("daterange_table"))===String(modelName)&&customdatefield&&(datefield=customdatefield),$("#removeFilter"+elementTabID).css("display","inline-block");const dataselected=$(`#filter_date${elementTabID}`).val();"Custom"===String(dataselected)?(daterangeList.push(datefield),daterangeList.push(dataselected),daterangeList.push($(`#startdate${elementTabID}`).val()),daterangeList.push($(`#enddate${elementTabID}`).val())):(daterangeList.push("created_date"),daterangeList.push(dataselected));const table2=$(`.filter-table${elementTabID}`),filterList=[];table2.find("tr").each((function(){const filterRow=[],condition=$(this).find("select").eq(0).val();filterRow.push($(this).find("select").eq(0).attr("name")),filterRow.push($(this).find("select").eq(0).val()),!0===["IN","NOT IN"].includes(condition)?filterRow.push($(this).find("td").eq(2).find("select").val()):"undefined"!==String($(this).find("td").eq(3).find("input").val())?filterRow.push($(this).find("td").eq(3).find("input").val()):filterRow.push($(this).find("select").eq(-1).val()),filterList.push(filterRow)}));const filterDict={model_name:modelName,filter_list:JSON.stringify(filterList),daterange_list:JSON.stringify(daterangeList),filterform:"f1",elementID:elementTabID};if($(`#tableTab${elementTabID}`).length>0){const reportTableData=$(`#example1${elementTabID}`).DataTable().column(1).data().toArray();filterDict.reportview_filter=JSON.stringify(reportTableData)}function datatableReload(data){$(".standard_button_click").prop("disabled",!1);const standardfiltertable=datatableDict[elementTabID],datareturned=JSON.parse(data),primaryKey=datareturned[0],filteredpk=datareturned[1];for(const i in filteredpk)filteredpk[i]="^"+filteredpk[i]+"$";const combinedsearch=filteredpk.join("|");for(const x in dataContainingColumnNames)if(String(dataContainingColumnNames[x].data)===String(primaryKey))var index=x;standardfiltertable.columns().every((function(){if(String(this.index())===String(index)){const column=this;String(column.search())!==String(combinedsearch)?column.search(combinedsearch||"",!0,!1).draw():column.search(combinedsearch).draw()}return!0}))}$(`.btn_search${elementTabID}`).attr("data-filter-daterange",JSON.stringify(daterangeList)),$.ajax({url:`/users/${urlPath}/viewfilter/`,data:filterDict,type:"POST",dataType:"json",success:datatableReload,error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}))}function disable_checkboxes_conditions(elementTabID){var checkboxes;$(`#example1${elementTabID}`).find(".multiple_select_checkbox").each((function(){"none"===$(this).closest("td").find('a[title="Approve record"]').css("pointer-events")&&($(this).prop("disabled",!0),$(this).css("cursor","default"))}))}function checkforselection(elementTabID,obj){var closestTable,checkboxes=$(obj).closest("table").find(".multiple_select_checkbox");checkboxes.filter(":checked").length===checkboxes.length?$(`#multiple_select_checkbox_SelectAll${elementTabID}`).prop("checked",!0):$(`#multiple_select_checkbox_SelectAll${elementTabID}`).prop("checked",!1)}function select_all_multiple(elementTabID,obj){var checkboxes=$(`#example1${elementTabID}`).find(".multiple_select_checkbox");$(`#multiple_select_checkbox_SelectAll${elementTabID}`).is(":checked")?(checkboxes.prop("checked",!0),checkboxes.each((function(){!0===$(this).prop("disabled")&&$(this).prop("checked",!1)}))):checkboxes.prop("checked",!1)}function listViewEditRow(urlForAjax,pk,elementID,elementIDData,tableName,editName,ThisElement,template_type){let view_name="";temp_type=$(`#${elementIDData}_tab_content`).attr("data-template-type"),"Multi Dropdown View"==temp_type&&(view_name=$(`#tableTab${elementIDData}`).find("select").val()),$.ajax({url:urlForAjax,data:{operation:"send_form_data_single_row_from_backend_to_front_end",primary_key:pk,model_name:tableName,element_id:elementIDData,edit_name:editName,listflowcolumnname:listflowcolumnname,view_name:view_name},dataType:"json",type:"POST",success:function(data){const modalId="#list_view_edit_modal_"+elementID,modalbody=$(modalId).find(".modal-body");if(ThisElement.prop("disabled",!1),data.hasOwnProperty("maximum_levels_allowed")&&$(modalId).attr("data-maximum_levels_allowed",data.maximum_levels_allowed),data.hasOwnProperty("maximum_approvers_allowed")&&$(modalId).attr("data-maximum_approvers_allowed",data.maximum_approvers_allowed),modalbody.empty(),"Flow Definition"===String(editName)){function removeFuncflow(){$("#flow_table").DataTable().destroy(),$(this).closest("tr").remove();const table=$("#flow_table").DataTable({rowReorder:{update:!1},ordering:!1,paging:!1,searching:!1,bPaginate:!1,info:!1,bLengthChange:!1})}modalbody.append(data.form_render),modalbody.find(":submit").closest("div").prepend(htmlflow),modalbody.find(`#${listflowcolumn}`).css("display","none"),modalbody.find("select").each((function(){$(this).select2({tags:!0})}));let flowcolumndata=data.flowcolumndata;if(""!==String(flowcolumndata)){flowcolumndata=JSON.parse(flowcolumndata);for(const i in flowcolumndata)$("#flow_table_body").append('<tr><td class="workflow_steps_table"><center>'+flowcolumndata[i]+'</center></td><td><center>\n              <span class="table_remove_flow" id="removeerow" disabled>\n                <a data-toggle="tooltip" title="Delete element" value="delete"><i name="actions" value="delete" class="far fa-trash-alt ihover javaSC thin-icontrash" style="font-size: 18px "></i></a>\n              </span>\n              </center></td></tr>');$(".table_remove_flow").click(removeFuncflow)}$("#flow_table").DataTable({rowReorder:{update:!1},ordering:!1,paging:!1,searching:!1,bPaginate:!1,info:!1,bLengthChange:!1}),$(".selectflow").on("change",(function(){$("#flow_table_body").find("tr").length>0&&$("#flow_table").DataTable().destroy(),$("#flow_table_body").append('<tr><td class="workflow_steps_table"><center>'+$(this).val()+'</center></td><td><center>\n          <span class="table_remove_flow" id="removeerow" disabled>\n            <a data-toggle="tooltip" title="Delete element" value="delete"><i name="actions" value="delete" class="far fa-trash-alt ihover javaSC thin-icontrash" style="font-size: 18px "></i></a>\n          </span>\n          </center></td></tr>');const table=$("#flow_table").DataTable({rowReorder:{update:!1},ordering:!1,paging:!1,searching:!1,bPaginate:!1,info:!1,bLengthChange:!1});$(".table_remove_flow").click(removeFuncflow)}))}else if("Model Definition"===String(editName)){modalbody.append(htmlmodeldef),$("#id_model_name_processmodeldef").val(data.model_name),$("#id_model_description_processmodeldef").val(data.model_description);const modelsysteminteractions=JSON.parse(data.modelsysteminteractions),modeldesc=JSON.parse(data.modeldesc),modelstakeholders=JSON.parse(data.modelstakeholders),modelgovdoc=JSON.parse(data.modelgovdoc);if($("#id_model_methodology_mapping_description_processmodeldef").val(modeldesc.model_methodology_mapping_description),$("#id_model_methodology_parameters_processmodeldef").val(modeldesc.model_methodology_parameters),$("#id_model_data_management_methods_processmodeldef").val(modeldesc.model_data_management_methods),$("#id_model_variables_processmodeldef").val(modeldesc.model_variables),$("#id_model_output_format_processmodeldef").val(modeldesc.model_output_format),$("#id_model_inputs_processmodeldef").val(modeldesc.model_inputs),$("#id_recalib_freq_processmodeldef").val(modeldesc.model_recalibration_frequency),$("#id_val_freq_processmodeldef").val(modeldesc.model_validation_frequency),modelgovdoc.length>0){$("#test_tablemodeldefdocument tr").last().remove();for(const i in modelgovdoc){const RowNodocument=$("#edit_tablemodeldefdocument").find("table tr").last().prevObject.length,templateStringmodeldef=`<tr>\n                <td class="pt-3-half" contenteditable="true" id="${"document_model_def"+RowNodocument}" required>\n                <input type="text" value=${modelgovdoc[i].model_document_type}>\n                </td>\n                <td class="pt-3-half" contenteditable="true" id="${"upload_model_defdocument"+RowNodocument}"" required>\n                  <div class="custom-file">\n                  <input type="file" id="myfile" name="${"myfile"+RowNodocument}" class="custom-file-input modeldeffile">\n                  <label class="custom-file-label">Choose file</label>\n              </div>\n                </td>\n                <td><button type="button" name=${modelgovdoc[i].model_document} class="downloadmodeldoc" style="background-color:transparent; border:transparent;">Download Existing File</button></td>\n                <td>\n                    <span class="table-addmodeldefdocument" id=${"adddocument_"+RowNodocument}><button type="button"\n                            class="btn  btn-primary btn-rounded btn-sm my-0">+</button></span>\n                </td>\n                <td><center>\n                    <span class="table-removemodeldefdocument" id=${"removedocument_"+RowNodocument}><button type="button" style="background-color:black"\n                            class="btn btn-danger btn-rounded btn-sm my-0">-</button></span>\n                            </center></td>\n                </tr>`;table=document.getElementById("test_tablemodeldefdocument");const index=$(this).parents("tr").index(),row=table.insertRow(index);row.innerHTML=templateStringmodeldef,$("#remove_"+RowNodocument).click(removeFuncmodel),$("#add_"+RowNodocument).click(addFuncmodeldocument)}}if($(".downloadmodeldoc").on("click",(function(){const filenamemodel=$(this).attr("name"),myForm=document.createElement("FORM");myForm.name="myForm",myForm.id="download_pdf",myForm.method="POST",myForm.enctype="multipart/form-data";const ctoken=$("form").find("input[name='csrfmiddlewaretoken']").attr("value");myForm.innerHTML=`<input type="hidden" name="csrfmiddlewaretoken" value=${ctoken}><input type="hidden" name="listOrDelete" value="download_uploaded_file"><input type="hidden" name="filename" value=${filenamemodel}>`,$(".container-fluid").append(myForm),$("#download_pdf").trigger("submit"),$("#download_pdf").remove()})),modelsysteminteractions.length>0){$("#test_tablemodeldef tr").last().remove();for(const i in modelsysteminteractions){const RowNo=$("#edit_tablemodeldef").find("table tr").last().prevObject.length,templateStringmodeldef=`<tr>\n              <td class="pt-3-half" contenteditable="true" id="${"system_type_model_def_"+RowNo}" required>\n              <input type="text" value=${modelsysteminteractions[i].system_type} pattern="^[a-zA-Z_.-]*$" title="Only Alphabets, _ ,- are accepted">\n              </td>\n              <td class="pt-3-half" contenteditable="true" id="${"system_name_model_def"+RowNo}" required>\n              <input type="text" value=${modelsysteminteractions[i].system_name} pattern="^[a-zA-Z_.-]*$" title="Only Alphabets, _ ,- are accepted">\n              </td>\n              <td class="pt-3-half" contenteditable="true" id="${"steps_model_def"+RowNo}" required>\n              <input type="text" value=${modelsysteminteractions[i].step_number} /pattern="^[a-zA-Z_.-]*$" title="Only Alphabets, _ ,- are accepted">\n              </td>\n              <td>\n                  <span class="table-addmodeldef" id=${"add_"+RowNo}><button type="button"\n                          class="btn  btn-primary btn-rounded btn-sm my-0">Add</button></span>\n              </td>\n              <td>\n                  <span class="table-removemodeldef" id=${"remove_"+RowNo}><button type="button" style="background-color:black"\n                          class="btn btn-danger btn-rounded btn-sm my-0">Remove</button></span>\n              </td>\n              </tr>`,table=document.getElementById("test_tablemodeldef"),index=$(this).parents("tr").index(),row=table.insertRow(index);row.innerHTML=templateStringmodeldef,$("#remove_"+RowNo).click(removeFuncmodel),$("#add_"+RowNo).click(addFuncmodel)}}else $(".table-removemodeldef").click(removeFuncmodel),$(".table-addmodeldef").click(addFuncmodel);if(modelstakeholders.length>0){for(const i in modelstakeholders)$("#modeldefstakeholders_table_body").append("<tr><td><center>"+`<input type="text" name="steps" value="${modelstakeholders[i].steps}" maxlength="255" id="id_model_description_processmodeldef" class="textinput textInput form-control is-invalid" readonly>`+"</center></td>"+`<td class="stakeholdersselect" data-selected="${modelstakeholders[i].stakeholders}"><center>`+htmlusers+"</center></td>"+`<td class="stakeholdersselect" data-selected="${modelstakeholders[i].approvers}"><center>`+htmlusers+"</center></td></tr>");$(".stakeholdersselect").each((function(){$(this).find("select").val($(this).data("selected"))}))}function removeFuncmodel(){$(this).closest("tr").detach()}function addFuncmodeldocument(){const RowNodocument=$("#edit_tablemodeldefdocument").find("table tr").last().prevObject.length,templateStringmodeldefdocument=`<tr>\n              <td class="pt-3-half" contenteditable="true" id="${"document_model_def"+RowNodocument}" required>\n              <input type="text">\n              </td>\n              <td class="pt-3-half" contenteditable="true" id="${"upload_model_defdocument"+RowNodocument}"" required>\n              <div class="custom-file">\n              <input type="file" id="myfile" name="${"myfile"+RowNodocument}" class="custom-file-input modeldeffile">\n              <label class="custom-file-label">Choose file</label>\n          </div>\n              </td>\n              <td></td>\n              <td>\n                  <span class="table-addmodeldefdocument" id=${"adddocument_"+RowNodocument}><button type="button"\n                          class="btn  btn-primary btn-rounded btn-sm my-0">+</button></span>\n              </td>\n              <td><center>\n                  <span class="table-removemodeldefdocument" id=${"removedocument_"+RowNodocument}><button type="button" style="background-color:black"\n                          class="btn btn-danger btn-rounded btn-sm my-0">-</button></span>\n                          </center></td>\n              </tr>`,table=document.getElementById("test_tablemodeldefdocument"),index=$(this).parents("tr").index()+1,row=table.insertRow(index);row.innerHTML=templateStringmodeldefdocument,$("#removedocument_"+RowNodocument).click(removeFuncmodel),$("#adddocument_"+RowNodocument).click(addFuncmodeldocument)}function addFuncmodel(){const RowNo=$("#edit_tablemodeldef").find("table tr").last().prevObject.length,templateStringmodeldef=`<tr>\n              <td class="pt-3-half" contenteditable="true" id="${"system_type_model_def_"+RowNo}" required>\n              <input type="text" pattern="^[a-zA-Z_.-]*$" title="Only Alphabets, _ ,- are accepted">\n              </td>\n              <td class="pt-3-half" contenteditable="true" id="${"system_name_model_def"+RowNo}" required>\n              <input type="text" pattern="^[a-zA-Z_.-]*$" title="Only Alphabets, _ ,- are accepted">\n              </td>\n              <td class="pt-3-half" contenteditable="true" id="${"steps_model_def"+RowNo}" required>\n              <input type="text" pattern="^[a-zA-Z_.-]*$" title="Only Alphabets, _ ,- are accepted">\n              </td>\n              <td>\n                  <span class="table-addmodeldef" id=${"add_"+RowNo}><button type="button"\n                          class="btn  btn-primary btn-rounded btn-sm my-0">+</button></span>\n              </td>\n              <td><center>\n                  <span class="table-removemodeldef" id=${"remove_"+RowNo}><button type="button" style="background-color:black"\n                          class="btn btn-danger btn-rounded btn-sm my-0">-</button></span>\n              </center></td>\n              </tr>`,table=document.getElementById("test_tablemodeldef"),index=$(this).parents("tr").index()+1,row=table.insertRow(index);row.innerHTML=templateStringmodeldef,$("#remove_"+RowNo).click(removeFuncmodel),$("#add_"+RowNo).click(addFuncmodel)}$(".table-removemodeldefdocument").click(removeFuncmodel),$(".table-addmodeldefdocument").click(addFuncmodeldocument),table=$("#model_stakeholders_table").DataTable({searching:!1,ordering:!1,info:!1,bPaginate:!1,bLengthChange:!1}),$("#loadbuttontemplate").on("click",(function(){$.ajax({url:`/users/${urlPath}/model_def_get_data/`,data:{template_name:$(".selectworkflowtemplate").val(),operation:"fetch_steps_model_def"},type:"POST",dataType:"json",success:function(data){let templateWorkflowSteps=data.templateWorkflowSteps;templateWorkflowSteps=JSON.parse(templateWorkflowSteps.replace(/&quot;/g,'"')),$("#modeldefstakeholders_table_body").empty();for(const i in templateWorkflowSteps)$("#modeldefstakeholders_table_body").append("<tr><td><center>"+`<input type="text" name="steps" value="${templateWorkflowSteps[i]}" maxlength="255" id="id_model_description_processmodeldef" class="textinput textInput form-control is-invalid" readonly>`+"</center></td><td><center>"+htmlusers+"</center></td><td><center>"+htmlusers+"</center></td></tr>")}})})),$(".modeldeffile").change((function(e){const fileName=e.target.files[0].name;$(this).parent().find(".custom-file-label").html(fileName)})),$("#savebuttontemplate").on("click",(function(){const datadictdef={};modalbody.find(":input[type=text],select,input[type=file]").each((function(){datadictdef[$(this).attr("name")]=$(this).val()}));const stakeholdersTableArray=[];$("table#model_stakeholders_table tr").each((function(){const arrayOfThisRow=[],tableData=$(this).find(":input[type=text],select,input[type=file]");tableData.length>0&&(tableData.each((function(){arrayOfThisRow.push($(this).val())})),stakeholdersTableArray.push(arrayOfThisRow))}));const systeminteractionsTableArray=[];$("table#test_tablemodeldef tr").each((function(){const arrayOfThisRow2=[],tableData2=$(this).find(":input[type=text],select,input[type=file]");tableData2.length>0&&(tableData2.each((function(){arrayOfThisRow2.push($(this).val())})),systeminteractionsTableArray.push(arrayOfThisRow2))}));const modeldocTableArray=[];$("table#test_tablemodeldefdocument tr").each((function(){const arrayOfThisRow3=[],tableData3=$(this).find(":input[type=text],select,input[type=file]");tableData3.length>0&&(tableData3.each((function(){arrayOfThisRow3.push($(this).val())})),modeldocTableArray.push(arrayOfThisRow3))}));const form=$("form#documentform")[0],formData=new FormData(form),filenamearray=[];$("form#documentform").find(":input[type=file]").each((function(){filenamearray.push($(this).attr("name"))})),formData.append("datadictdef",JSON.stringify(datadictdef)),formData.append("stakeholdersTableArray",JSON.stringify(stakeholdersTableArray)),formData.append("systeminteractionsTableArray",JSON.stringify(systeminteractionsTableArray)),formData.append("modeldocTableArray",JSON.stringify(modeldocTableArray)),formData.append("filenamearray",JSON.stringify(filenamearray)),$.ajax({url:`/users/${urlPath}/standard_update_save_master_form_modeldef/`,data:formData,type:"POST",contentType:!1,processData:!1,success:function(data){windowLocationAttr.reload()},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}))}else if("Constraint"===String(editName)){modalbody.append(html4),modalbody.find("select").each((function(){$(this).select2()})),$(".selectTable").on("change",(function(){$.ajax({url:`/users/${urlPath}/constriant_get_data/`,data:{table_name:$(this).val(),operation:"fetch_table_columns_constraint"},type:"POST",dataType:"json",success:function(data){$(".selectColumn").empty(),$(".selectMapping").empty(),$(".selectValue").empty();for(const i in data.columnList)$(".selectColumn").append(`<option value="${data.columnList[i]}">${data.columnList[i]}</option>`),$(".selectMapping").append(`<option value="${data.columnList[i]}">${data.columnList[i]}</option>`)},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})})),$(".selectConstraintType").on("change",(function(){const reader=$(".selectConstraintType option:selected").attr("data-type");"Array"===String(reader)?($(this).parent().parent().find("div").eq(3).find("select").empty(),$(this).parent().parent().find("div").eq(3).find("select").attr("disabled","disabled"),$(this).parent().parent().find("div").eq(3).find("select").empty(),$(this).parent().parent().find("div").eq(1).find("span").show()):($(this).parent().parent().find("div").eq(1).find("span").show(),$(this).parent().parent().find("div").eq(3).find("select").empty(),$(this).parent().parent().find("div").eq(3).find("select").removeAttr("disabled"),"Grouped"===String(reader)?($(".selectValue").prop("multiple",!0),$(".selectValue").css("overflow-y","scroll"),$(".selectValue").select2(),$(this).parent().parent().find("div").eq(3).find(".select2-selection--multiple").css({"max-height":"4rem",overflow:"auto"})):($(".selectValue").prop("multiple",!1),$(".selectValue").select2(),$(this).parent().parent().find("div").eq(3).find(".select2-selection--multiple").css({"max-height":"4rem",overflow:"visible"})))})),$(".selectConstraintType").off("select2").on("select2:select",(function(){$(".selectColumn").append('<option value="" selected disabled>Select Constraint Parameter</option');const valuer=$(this).parent().parent().find(".form-group").eq(5).find("select option:selected").attr("data-type");"Array"===valuer?$(this).parent().parent().find("div").eq(3).find("label").find("span").hide():($(this).parent().parent().find("div").eq(3).find("label").find("span").show(),"Array"===String(null!==$(".selectColumn:selected")&&$(this).attr("data-type"))&&($(".selectValue").append('<option value=""disabled>Select Constraint Parameter Value</option'),$(this).parent().parent().find("div").eq(3).find("label").find("span").hide()))}));let rulesSet="";$(".selectColumn").on("change",(function(){const colvar=$(this).val(),columnType=$(this).parent().parent().find(".form-group").eq(5).find("select option:selected").attr("data-type"),tableVAR=$(".selectTable").val();$.ajax({url:`/users/${urlPath}/constriant_get_data/`,data:{table_name:tableVAR,column_name:colvar,operation:"fetch_table_columns_val_constraint"},type:"POST",dataType:"json",success:function(data){if("Array"===columnType)$(".selectValue").empty();else{$(".selectValue").empty();for(const i in data.columnList)$(".selectValue").append(new Option(data.columnList[i],data.columnList[i],!1,!1))}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})})),rulesSet=data.columnList.rule_set,$(".constraint_usecase").val(data.columnList.use_case).trigger("change"),$(".condition_type").on("change",(function(){const conditionDatatype=$(this).val(),conditionAdder=$(this).parent().parent().find(".form-group").eq(7);"Character"===String(conditionDatatype)?(conditionAdder.find(".condition_name").empty(),conditionAdder.find(".condition_name").append(new Option("Starts With","Starts With",!1,!1)),conditionAdder.find(".condition_name").append(new Option("Ends With","Ends With",!1,!1)),conditionAdder.find(".condition_name").append(new Option("Contains","Contains",!1,!1)),conditionAdder.find(".condition_name").append(new Option("Not Contains","Not Contains",!1,!1)),conditionAdder.find(".condition_name").append(new Option("Equal to","Equal to",!1,!1)),conditionAdder.find(".condition_name").append(new Option("Not Equal to","Not Equal to",!1,!1)),conditionAdder.find(".condition_name").append(new Option("In","In",!1,!1)),conditionAdder.find(".condition_name").append(new Option("Not In","Not In",!1,!1))):"Numeric"===String(conditionDatatype)&&(conditionAdder.find(".condition_name").empty(),conditionAdder.find(".condition_name").append(new Option("Equal to","Equal to",!1,!1)),conditionAdder.find(".condition_name").append(new Option("Not Equal to","Not Equal to",!1,!1)),conditionAdder.find(".condition_name").append(new Option("Greater than","Greater than",!1,!1)),conditionAdder.find(".condition_name").append(new Option("Smaller than","Smaller than",!1,!1)),conditionAdder.find(".condition_name").append(new Option("Greater than equal to","Greater than equal to",!1,!1)),conditionAdder.find(".condition_name").append(new Option("Smaller than equal to","Smaller than equal to",!1,!1)),conditionAdder.find(".condition_name").append(new Option("In","In",!1,!1)),conditionAdder.find(".condition_name").append(new Option("Not In","Not In",!1,!1)))})),$(".condition_name").on("change",()=>{let constraint_condition=$(".condition_name").val(),tRow=$(".condition_type").parent().parent().find(".form-group");"In"==constraint_condition||"Not In"==constraint_condition?tRow.eq(8).find(".select_input_value").hasClass("select2-hidden-accessible")||(tRow.eq(8).find(".select_input_value").remove(),tRow.eq(8).append('<select  class="select_input_value select2 form-control" name="inputs[]" multiple="true"></select>'),tRow.eq(8).find(".select_input_value").select2({tags:!0,placeholder:"Enter Threshold"})):tRow.eq(8).find(".select_input_value").hasClass("select2-hidden-accessible")&&(tRow.eq(8).find(".select_input_value").select2("destroy"),tRow.eq(8).find(".select_input_value").remove(),tRow.eq(8).append('<input style="max-height: 40px;overflow: hidden;" class=" select_input_value form-control p-2 textInput" placeholder="Enter Threshold">'))}),"Array"===$(".selectConstraintType").attr("data-type")?($(".selectTable").val(data.columnList.table_name).trigger("change"),$(".selectConstraintName").val(data.columnList.constraint_name).trigger("change"),$(".selectConstraintType").val(data.columnList.constraint_type).trigger("change"),$(".select_input_value").val(data.columnList.threshold).trigger("change"),$(".status_type").val(data.columnList.applicability_status).trigger("change"),$(".selectValue").val("").trigger("change"),$(".columnReminder").hide(),$(".valueReminder").hide(),$(".condition_name").val(data.columnList.condition).trigger("change"),setTimeout((function(){$(".selectColumn").val(data.columnList.constraint_parameter).trigger("change"),$(".selectMapping").val(data.columnList.unique_constraint_column).trigger("change"),$(".valueReminder").hide(),setTimeout((function(){$(".condition_name").val(data.columnList.condition).trigger("change"),$(".valueReminder").hide()}),500)}),250)):($(".selectTable").val(data.columnList.table_name).trigger("change"),$(".selectConstraintName").val(data.columnList.constraint_name).trigger("change"),$(".selectConstraintType").val(data.columnList.constraint_type).trigger("change"),$(".select_input_value").val(data.columnList.threshold).trigger("change"),$(".condition_name").val(data.columnList.condition).trigger("change"),$(".condition_type").val(data.columnList.condition_datatype).trigger("change"),$(".status_type").val(data.columnList.applicability_status).trigger("change"),$(".selectValue").val(data.columnList.constraint_parameter_value).trigger("change"),setTimeout((function(){$(".selectColumn").val(data.columnList.constraint_parameter).trigger("change"),$(".columnReminder").hide(),$(".valueReminder").hide(),$(".selectMapping").val(data.columnList.unique_constraint_column).trigger("change"),$(".condition_type").val(data.columnList.condition_datatype).trigger("change"),setTimeout((function(){$(".selectConstraintType option:selected").attr("data-type"),$(".selectValue").val(data.columnList.constraint_parameter_value).trigger("change"),$(".condition_type").val(data.columnList.condition_datatype).trigger("change"),$(".condition_name").val(data.columnList.condition).trigger("change")}),500)}),1e3));const lengthListtable=$(`#listtable${listConstraintID}`);if(lengthListtable.find("div").each((function(){selectedFields.includes($(this).attr("data-name"))?$(this).hide():additionalCol.includes($(this).attr("data-name"))&&$(this).hide()})),Object.prototype.hasOwnProperty.call(data,"drop_list")){const dropList=data.drop_list;lengthListtable.find("div").each((function(){const colName=$(this).attr("data-name");dropList.includes(colName)&&$(this).css("display","none")}))}$("#savebuttonListinfo").on("click",(function(){let saveDic={};$(`#listtable${listConstraintID}`),$(`#listtable${listConstraintID}`).each((function(){let useCaseName="";const columnType=$(this).find(".form-group").eq(5).find("select option:selected").attr("data-type");"use_case"===String($(`#listtable${listConstraintID}`).find("div").eq(-1).attr("data-name"))?(useCaseName=data.columnList.use_case,useCaseName=$(this).find(".form-group").eq(10).find("input").val()):useCaseName=data.columnList.use_case,saveDic="Array"===String(columnType)?{rule_set:rulesSet,table_name:$(this).find(".form-group").eq(0).find("select").val(),constraint_parameter:$(this).find(".form-group").eq(1).find("select").val(),unique_constraint_column:$(this).find(".form-group").eq(2).find("select").val(),constraint_name:$(this).find(".form-group").eq(4).find("input").val(),constraint_type:$(this).find(".form-group").eq(5).find("select").val(),constraint_parameter_value:$(this).find(".form-group").eq(1).find("select").val(),condition_datatype:$(this).find(".form-group").eq(6).find("select").val(),condition:$(this).find(".form-group").eq(7).find("select").val(),threshold:$(this).find(".form-group").eq(8).find(".select_input_value").val(),applicability_status:$(this).find(".form-group").eq(9).find("select").val(),use_case:useCaseName}:"Grouped"===String(columnType)?{rule_set:rulesSet,table_name:$(this).find(".form-group").eq(0).find("select").val(),constraint_parameter:$(this).find(".form-group").eq(1).find("select").val(),unique_constraint_column:$(this).find(".form-group").eq(2).find("select").val(),constraint_name:$(this).find(".form-group").eq(4).find("input").val(),constraint_type:$(this).find(".form-group").eq(5).find("select").val(),constraint_parameter_value:JSON.stringify($(this).find(".form-group").eq(3).find("select").val()),use_case:useCaseName,condition_datatype:$(this).find(".form-group").eq(6).find("select").val(),condition:$(this).find(".form-group").eq(7).find("select").val(),threshold:$(this).find(".form-group").eq(8).find(".select_input_value").val(),applicability_status:$(this).find(".form-group").eq(9).find("select").val()}:{rule_set:rulesSet,table_name:$(this).find(".form-group").eq(0).find("select").val(),constraint_parameter:$(this).find(".form-group").eq(1).find("select").val(),unique_constraint_column:$(this).find(".form-group").eq(2).find("select").val(),constraint_name:$(this).find(".form-group").eq(4).find("input").val(),constraint_type:$(this).find(".form-group").eq(5).find("select").val(),constraint_parameter_value:$(this).find(".form-group").eq(3).find("select").val(),use_case:useCaseName,condition_datatype:$(this).find(".form-group").eq(6).find("select").val(),condition:$(this).find(".form-group").eq(7).find("select").val(),threshold:$(this).find(".form-group").eq(8).find(".select_input_value").val(),applicability_status:$(this).find(".form-group").eq(9).find("select").val()};for(const key in saveDic)selectedFields.includes(key)&&delete saveDic[key]}));const url=windowLocation;$.ajax({url:url+tableName+"/update_save_constraint/"+pk+"/",data:{saveDic:JSON.stringify(saveDic),operation:"editConstraintTemplate",element_id:elementID},type:"POST",dataType:"json",success:function(data){window.location.href=url},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}))}else{const data_append=$(data.form.html).find(".container-fluid").find(".font-weight-light").find(".card");var str="<script>";str=str+"$('#list_view_edit_modal_"+elementID+"').find('input[datatype=\"DateField\"]').each(function () {\n          $(this).datepicker({\n            dateFormat: 'yy-mm-dd',\n            changeMonth: true,\n            changeYear: true,\n            constrainInput: true,\n          }).css('z-index', '1051')\n        })\n\n        $('#list_view_edit_modal_"+elementID+'\').find(\'input[datatype="DateTimeField"], input[datatype="TimeField"]\').each(function () {\n          var config = JSON.parse($(this).attr(\'data-dp-config\'));\n          $(this).datetimepicker({\n              "showClose": true,\n              "showClear": true,\n              "showTodayButton": true,\n              "format": config.options.format,\n              "locale": "en"\n          });\n          $(this).datetimepicker({\n              "showClose": true,\n              "showClear": true,\n              "showTodayButton": true,\n              "format": config.options.format,\n              "locale": "en"\n          });\n        })\n\n\n\n        $(\'#list_view_edit_modal_'+elementID+"').find('.dtrangepicker').each(function () {\n          $(this).daterangepicker({\n            locale: {\n                      format: 'YYYY-MM-DD',\n                  }\n           });\n        })\n\n        $('#list_view_edit_modal_"+elementID+"').find('.dttrangepicker').each(function () {\n          $(this).daterangepicker({\n            timePicker: true,\n            timePicker24Hour: true,\n            timePickerSeconds: true,\n            locale: {\n                      format: 'YYYY-MM-DD HH:mm:ss',\n                  }\n           })\n        });\n\n        $('#list_view_edit_modal_"+elementID+"').find('.ttrangepicker').each(function () {\n          $(this).daterangepicker({\n            timePicker: true,\n            timePicker24Hour: true,\n            timePickerIncrement: 1,\n            timePickerSeconds: true,\n            locale: {\n                format: 'HH:mm:ss'\n            }\n           }).on('show.daterangepicker', function (ev, picker) {\n            picker.container.find(\".calendar-table\").hide();\n            });\n        })\n\n        $('.popoverclass_card').popover({\n          trigger: 'focus'\n        })\n\n\n        listview_auto_compute('"+elementID+"')\n        ",str+="<\/script>";const data_script=$(data.form.script);if(""!=$(data.form.html).find("style").text()){var data_style=$(data.form.html).find("style").text();data_style="<style>"+data_style+"</style>",modalbody.append(data_style)}modalbody.append(data_append),$(modalbody).find(`#processFlowDesignDiv${elementID}`).parent().find(".fa-angle-down").attr("data-trans",data.data.transaction_id),modalbody.append(data_script),modalbody.find("input[data-cases], textarea[data-cases], select[data-cases]").on("change",(function(){let casesArray=Object.keys(JSON.parse($(this).attr("data-cases")));modalbody.find("input[data-jsattr], select[data-jsattr], textarea[data-jsattr]").each((function(){let JSAttrConfig=JSON.parse($(this).attr("data-jsattr"));checkCaseDependence(casesArray,JSAttrConfig)&&jsFunc_.call(this)}))}));let multi_level=!1;for(let[k,v]of Object.entries(data.data))"type_of_approval"==k&&"multi_level"==v&&(multi_level=!0);var autoPopulateConstantFields=[];modalbody.find("input[data-jsattr], select[data-jsattr], textarea[data-jsattr]").each((function(){let JSAttrConfig=JSON.parse($(this).attr("data-jsattr"));for(let i=0;i<JSAttrConfig.length;i++){const attrConfig=JSAttrConfig[i];["Show-hide","Styling attribute","Auto-populate Constant"].includes(attrConfig.parentvalue)&&jsFunc_.call(this,initialRun=!0),"Auto-populate Constant"==attrConfig.parentvalue&&autoPopulateConstantFields.push($(this).attr("name").split("__")[1])}})),modalbody.append(str),$(modalbody).find(".form-group").find(".form-group, .custom-control.custom-checkbox").each((function(i,el){let fieldName=$(this).attr("id").replace("div_id_","");for(let[key,value]of Object.entries(data.data))if(key==fieldName){if(data.auto_populate_precedence&&autoPopulateConstantFields.includes(fieldName)&&!data.auto_populate_precedence_on_scenario){null!=$(this).find("select")&&$(this).find("select").select2();continue}if(null!=$(this).find("input")&&($(this).find("input").hasClass("dtrangepicker")?null!=value&&value.length>0?(startdate=value.split(" - ")[0],enddate=value.split(" - ")[1],$(this).find("input").data("daterangepicker").setStartDate(startdate),$(this).find("input").data("daterangepicker").setEndDate(enddate)):$(this).find("input").val(""):$(this).find("input").hasClass("dttrangepicker")?null!=value&&value.length>0?(startdate=value.split(" - ")[0],enddate=value.split(" - ")[1],$(this).find("input").data("daterangepicker").setStartDate(startdate),$(this).find("input").data("daterangepicker").setEndDate(enddate)):$(this).find("input").val(""):$(this).find("input").hasClass("ttrangepicker")?null!=value&&value.length>0?(startdate=value.split(" - ")[0],enddate=value.split(" - ")[1],$(this).find("input").data("daterangepicker").setStartDate(startdate),$(this).find("input").data("daterangepicker").setEndDate(enddate)):$(this).find("input").val(""):$(this).find("input").hasClass("custom-file-input")?$(this).find(".custom-file-label").html(value):$(this).find("input").hasClass("checkboxinput")?value&&$(this).find("input").prop("checked",!0):value&&($(this).find("input").val(value).trigger("change"),$(this).find("input").attr("data-exisingValueEdit",value)),$(this).find("input").hasClass("check_validForm_now")&&$(this).find("input").on("change",checkValidationNow),"Approval Template"==template_type&&($(this).find("input").prop("readonly",!0),"approver_group"!=fieldName&&"approver_user"!=fieldName||(multi_level?($(this).find("input").parent().find("p").css("pointer-events","none"),$(this).find("input").parent().css("cursor","not-allowed")):"[]"==value?($(this).find("input").parent().find("p").css("pointer-events","none"),$(this).find("input").parent().css("cursor","not-allowed")):$(this).find("input").parent().find("p").css("pointer-events","all")))),null!=$(this).find("select")){if(value){if($(this).find("select").hasClass("user_logo"))$(this).find("select").select2({templateResult:formatState1,templateSelection:formatState2}),$(this).find("select").val(value).trigger("change");else if(value.startsWith("[")&&value.endsWith("]")&&!value.startsWith("[{")&&!value.endsWith("}]")){value_temp=JSON.parse(value),va_temp=[];const contains=value_temp.some(element=>{element.includes("all")?va_temp.push("all"):va_temp.push(element)});value_temp=va_temp,value.length>0&&$(this).find("select").val(value_temp).select2().trigger("change")}else"approval_audit_log"!==fieldName&&($(this).find(`select > option[value='${value}']`).length>0?$(this).find("select").val(value).select2().trigger("change"):$(this).find("select[data-is-serverside-fetch='yes']")?(serverSideDataSearch(key,elementID),$(this).find("select").append(`<option value="${value}" selected>${value}</option>`),$(this).find("select").select2().trigger("change")):$(this).find("select").select2());$(this).find("select").attr("data-exisingValueEdit",value)}else $(this).find("select").hasClass("user_logo")?$(this).find("select").select2({templateResult:formatState1,templateSelection:formatState2}):$(this).find("select").each((function(){$(this).select2()}));$(this).find("select").hasClass("check_validForm_now")&&$(this).find("select").on("change.select2",checkValidationNow),"Approval Template"==template_type&&$(this).find("select").prop("readonly",!0)}null!=$(this).find("textarea")&&($(this).find("textarea").val(value).trigger("change"),"Approval Template"==template_type&&($(this).find("textarea").prop("readonly",!0),"approval_level_config"==fieldName&&(""==value?($(this).find("textarea").parent().find("p").css("pointer-events","none"),$(this).find("textarea").parent().css("cursor","not-allowed")):$(this).find("textarea").parent().find("p").css("pointer-events","all"))),"approval_level_config"==fieldName&&(data.hasOwnProperty("app_table_cols")?$(this).find("textarea").parent().find("p").attr("data-app_table_cols",JSON.stringify(data.app_table_cols)):$(this).find("textarea").parent().find("p").attr("data-app_table_cols",JSON.stringify(["username","first_name","last_name"])),data.hasOwnProperty("app_table_sep")?$(this).find("textarea").parent().find("p").attr("data-app_table_sep",data.app_table_sep):$(this).find("textarea").parent().find("p").attr("data-app_table_sep"," "))),$(this).find("p[title='RTF editor']").length>0&&value&&$(this).find("p[title='RTF editor']").attr("data-data",value),$(this).find("textarea").hasClass("check_validForm_now")&&$(this).find("textarea").on("change",checkValidationNow),!data.auto_populate_precedence&&autoPopulateConstantFields.includes(fieldName)&&value&&$(this).find("input, select, textarea").attr("data-existingValuePrecedence",value),data.auto_populate_precedence_on_scenario?$(this).find("input, select, textarea").attr("data-autoPopPrecedenceScenario","true"):$(this).find("input, select, textarea").attr("data-autoPopPrecedenceScenario","false")}}));var fileFieldsData=data.file_fields_data;function concatenationField(event){var singleField=event.data,singleCardColumns=$(singleField).attr("data-concatfield"),singleCardDivider=$(singleField).attr("data-divider"),parsedSingleCardColumns=JSON.parse(singleCardColumns),elementId=$(singleField).attr("data-id"),val="";for(let p in parsedSingleCardColumns){if(""==$("#id_"+parsedSingleCardColumns[p]+"_"+elementId).val()){allOkFlag=0;break}allOkFlag=1,val+=`${$("#id_"+parsedSingleCardColumns[p]+"_"+elementId).val()}${singleCardDivider}`}1==allOkFlag&&$(singleField).val(val.slice(0,-1)).trigger("change")}$(modalbody).find('input[datatype="FileField"],input[datatype="ImageField"]').each((function(){var identifier=$(this).attr("id").replace("id_",""),fieldName=identifier.replace(`_${elementID}`,""),existingFiles={};fileFieldsData[fieldName]&&(existingFiles=fileFieldsData[fieldName]),formFileUploadHandlerLV(identifier,existingFiles=existingFiles)}));var conCatfields=$(modalbody).find("[data-concatfield]");if(conCatfields.length>0)for(let k=0;k<conCatfields.length;k++){var singleField=$(conCatfields).eq(k),singleCardColumns=$(singleField).attr("data-concatfield"),singleCardDivider=$(singleField).attr("data-divider"),elementId=$(singleField).attr("data-id"),parsedSingleCardColumns=JSON.parse(singleCardColumns),allOkFlag=1;for(let p in parsedSingleCardColumns)$("#id_"+parsedSingleCardColumns[p]+"_"+elementId).change(singleField,concatenationField)}modalbody.find("input, select, textarea").on("change",(function(){jsChange.call(this)}));try{for(let j=0;j<names[elementID].length;j++)"yes"==$("#id_"+`${names[elementID][j]}`+"_"+elementID).attr("data-is-serverside-fetch")?serverSideDataSearch(names[elementID][j],elementID):updateParent(elementID,names[elementID][j])}catch(err){}embeddedComputeHandler(elementID)}$(modalId).modal({backdrop:"static",keyboard:!1}),$(modalId).modal("show"),modalbody.find("button[name='submit']").on("click",(function(){$(`#creation_in_progress_${elementID}`).modal("show"),$("body").css("pointer-events","none");let url=windowLocation;for(let r=0;r<item_code_list.length;r++)Object.prototype.hasOwnProperty.call(item_code_list[r],elementID)&&(url=`/users/${urlPath}/`+item_code_list[r][elementID]+"/");modalbody.find("form").append(`<input type="hidden" name="primary_key" value="${pk}">`);var view_name="";if(temp_type=$(`#${elementID}_tab_content`).attr("data-template-type"),"Multi Dropdown View"==temp_type&&(view_name=$(`#tableTab${elementID}`).find("select").val(),modalbody.find("form").append(`<input type="hidden" name="view_name" value="${view_name}">`)),"Flow Definition"===String(editName)){const workflowSteps=[];$(".workflow_steps_table").each((function(){workflowSteps.push($(this).text())}));const datadict={};modalbody.find(":input[type=text],select,input[type=file]").each((function(){datadict[$(this).attr("name")]=$(this).val()})),$.ajax({url:url+tableName+"/update_save_flow_def/"+pk+"/",data:{operation:"saveflowdef",datadict:JSON.stringify(datadict),listflowcolumnname:listflowcolumnname,mastertableflow:mastertableflow,masterColumnflow:masterColumnflow,listflowcolumndata:JSON.stringify(workflowSteps)},type:"POST",dataType:"json",success:function(){},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}else{let editSubmitFormUrl;editSubmitFormUrl="List View With History"===String(historyViewTemplate)?url+tableName+"/update_save_history/"+pk+"/":url+tableName+"/update_save/"+pk+"/",$(this).attr("formaction",editSubmitFormUrl)}$(this).attr("type","submit")}))},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function fnShowHideListView(elementTabID){const table=datatableDict[elementTabID];let allowSaveTemplate;"Expand"===String(event.target.value)?(event.target.value="Contract",allowSaveTemplate=!0,document.getElementById(`example1_expand${elementTabID}`).innerHTML="Contract",table.columns(".allColumnClass").visible(allowSaveTemplate),table.columns.adjust().draw(!1),table.state.save()):(event.target.value="Expand",document.getElementById(`example1_expand${elementTabID}`).innerHTML="Expand",table.columns(".allColumnClass").visible(!1),allowSaveTemplate=!0,table.columns([0,1,2,3,4]).visible(allowSaveTemplate,!1),table.columns.adjust().draw(!1),table.state.save())}function editModeListView(elementID){const status=$(`#editListView${elementID}`).attr("data-edit-status");"off"===String(status)?($(`#editListView${elementID}`).attr("data-edit-status","on"),$(`#editListView${elementID}`).text("Edit Mode:ON").trigger("change"),$(`#saveEditListView${elementID}`).css("display","inline-block"),$(`#example1${elementID}`).find("tbody").find("tr").find("td:not(:nth-child(1),:nth-child(2))").find("div").attr("contenteditable",!0),$(`#example1${elementID}`).find("tbody").find("tr").find("td:not(:nth-child(1),:nth-child(2))").attr("contenteditable",!0),$(`#example1${elementID}`).find("tbody").find("tr").find("td:not(:nth-child(1),:nth-child(2))").addClass("edit"),$(`#example1${elementID}`).find("tbody").find("tr").find("td:not(:nth-child(1),:nth-child(2))").find("div").addClass("edit"),$(`#example1${elementID}`).find("tbody").find("tr").find("td:not(:nth-child(1),:nth-child(2))").find("div").attr("data-elementID",elementID),$(`#example1${elementID}`).find("tbody").find("tr").find("td:not(:nth-child(1),:nth-child(2))").find("[data-button-view-detail]").attr("onclick","")):($(`#example1${elementID}`).find("tbody").find("tr").find("td").find("div").attr("contenteditable",!1),$(`#example1${elementID}`).find("tbody").find("tr").find("td").attr("contenteditable",!1),$(`#example1${elementID}`).find("tbody").find("tr").find("td:not(:nth-child(1),:nth-child(2))").find("div").removeAttr("data-elementID"),$(`#saveEditListView${elementID}`).css("display","none"),$(`#example1${elementID}`).find("tbody").find("tr").find("td:not(:nth-child(1),:nth-child(2))").removeClass("edit"),$(`#example1${elementID}`).find("tbody").find("tr").find("td:not(:nth-child(1),:nth-child(2))").find("div").removeClass("edit"),$(`#editListView${elementID}`).attr("data-edit-status","off"),$(`#editListView${elementID}`).text("Edit Mode:OFF").trigger("change"),$(`#example1${elementID}`).find("tbody").find("tr").find("td:not(:nth-child(1),:nth-child(2))").find(".multi_select_dropdown_listview").remove(),$(`#example1${elementID}`).find("tbody").find("tr").find("td:not(:nth-child(1),:nth-child(2))").find(".dropdown-content-list-view").remove(),$(`#example1${elementID}`).find("tbody").find("tr").find("td:not(:nth-child(1),:nth-child(2))").find("div").css("display","block"),$(`#example1${elementID}`).find("tbody").find("tr").find("td:not(:nth-child(1),:nth-child(2))").find("[data-button-view-detail]").attr("onclick","displayMultiSelectDetailValues.call(this)"))}function findreplacesave(obj){const elementID=obj.getAttribute("data-elementID"),itemCode=obj.getAttribute("pr_code"),modelName=obj.getAttribute("data-table-name"),is_find=obj.getAttribute("is_find");let columnName=$("option:selected",`#selectcolumn${elementID}`).attr("name"),replacecolumnName=$("option:selected",`#selectreplacecolumn${elementID}`).attr("name");const column=$("option:selected",`#selectreplacecolumn${elementID}`).val(),datatype=$("option:selected",`#selectreplacecolumn${elementID}`).attr("data-type"),fdict={};let check_html_find,check_html_replace;$("#text_basedip_"+elementID).is(":checked")?fdict.find=$(`#find${elementID}`).val():fdict.find=$(`#show_textinputfind${elementID}`).val(),fdict.replace=$(`#replace${elementID}`).val(),fdict.find_case=$(`#selectcase${elementID}`).val(),"ForeignKey"===String(datatype)&&(fdict.find=$("option:selected",`#find${elementID}`).attr("name"),fdict.replace=$("option:selected",`#replace${elementID}`).attr("name")),fdict.is_find=obj.getAttribute("is_find"),fdict.datatype=datatype,/<|>/.test(fdict.find)|/<|>/.test(fdict.replace)?Swal.fire({icon:"error",text:"Unauthorised input. Please check and try again."}):$.ajax({url:`/users/${urlPath}/${itemCode}/`,data:{model_name:modelName,element_id:elementID,column_name:columnName,replacecolumnName:replacecolumnName,fdict:JSON.stringify(fdict),template:$(obj).attr("template"),operation:"find_and_replace"},type:"POST",dataType:"json",success:function(data){if($(`#findtext${elementID}`).empty(),$(`#findtext${elementID}`).append(`<p style='color:red;'>${data.message}</p>`),$(`#findtext${elementID}`).append(`<div>\n        <table class="table" id="findtable${elementID}" style="width:100%">\n          <thead>\n            <tr>\n            </tr>\n          </thead>\n          <tbody class="font-weight-normal">\n          </tbody>\n        </table>\n        </div>`),"True"!=is_find){if("Data updated successfully."===String(data.message)){$(`#example1${elementID}`).DataTable().draw();for(let rowIndx=0;rowIndx<Object.keys(data.rows[column]).length;rowIndx++)for(i in $(`#findtable${elementID}`).find("tbody").append("<tr></tr>"),data.rows)0==rowIndx&&$(`#findtable${elementID}`).find("thead").find("tr").append(`<th scope="col">${i}</th>`),i==column?"MultiSelect"==String(datatype)?$(`#findtable${elementID}`).find("tbody").find("tr").last().append(`<td style="background-color: antiquewhite;">${data.rows[i][rowIndx]}</td>`):$(`#findtable${elementID}`).find("tbody").find("tr").last().append(`<td style="background-color: antiquewhite;"><strike class="text-muted">${data.rows[i][rowIndx]}</strike>&nbsp;${$(`#replace${elementID}`).val()}</td>`):$(`#findtable${elementID}`).find("tbody").find("tr").last().append(`<td>${data.rows[i][rowIndx]}</td>`)}}else{for(let rowIndx=0;rowIndx<Object.keys(data.rows[column]).length;rowIndx++)for(i in $(`#findtable${elementID}`).find("tbody").append("<tr></tr>"),data.rows)0==rowIndx&&$(`#findtable${elementID}`).find("thead").find("tr").append(`<th scope="col">${i}</th>`),i==column?$(`#findtable${elementID}`).find("tbody").find("tr").last().append(`<td style="background-color: antiquewhite;">${data.rows[i][rowIndx]}</td>`):$(`#findtable${elementID}`).find("tbody").find("tr").last().append(`<td>${data.rows[i][rowIndx]}</td>`);$(`#findtable${elementID}`).DataTable({scrollX:!0,autoWidth:!0})}},error:function(data){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function listviewClearall(elementID){const itemCode=windowLocation.split("/")[4],modelName=$(`#listview_clearall_${elementID}`).attr("model_name");var view_name="";temp_type=$(`#${elementID}_tab_content`).attr("data-template-type"),"Multi Dropdown View"==temp_type&&(view_name=$(`#tableTab${elementID}`).find("select").val()),$.ajax({url:`/users/${urlPath}/DataManagement/`,data:{element_id:elementID.split("__tab__")[0],operation:"fetch_list_view_msgs",messages:JSON.stringify(["confirm_delete_message","successful_delete_message","unable_delete_foreignkey_message","unable_delete_notable_message"]),view_name:view_name},type:"POST",dataType:"json",success:function(data){message="",icon="",data.confirm_delete_message&&(message=data.confirm_delete_message.message,icon=data.confirm_delete_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),custom_messages=data,Swal.fire({icon:"question",iconHtml:iconHtml,text:message||"This will delete all the records from the table. Are you sure?\n\nClick 'Yes' to confirm or click 'No' if you do not wish to reset it.",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(result=>{result.isConfirmed&&$.ajax({url:`/users/${urlPath}/${itemCode}/`,data:{operation:"listview_clearAll",model_name:modelName,elementid:elementID},type:"POST",dataType:"json",success:function(data){"success"===String(data.status)?(message="",icon="",custom_messages.successful_delete_message&&(message=custom_messages.successful_delete_message.message,icon=custom_messages.successful_delete_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"success",iconHtml:iconHtml,text:message||"Data deleted successfully!"}).then(result=>{result.isConfirmed&&windowLocationAttr.reload()})):"foreignkey_detected"===String(data.status)?(message="",icon="",custom_messages.unable_delete_foreignkey_message&&(message=custom_messages.unable_delete_foreignkey_message.message,icon=custom_messages.unable_delete_foreignkey_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"warning",iconHtml:iconHtml,text:message||`Other tables have Foreign Key references to ${modelName}, unable to delete data.`})):(message="",icon="",custom_messages.unable_delete_notable_message&&(message=custom_messages.unable_delete_notable_message.message,icon=custom_messages.unable_delete_notable_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"warning",iconHtml:iconHtml,text:message||"Table does not exist."}))},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function freezepanesave(This){const elementID=$(This).attr("data-elementid");if($(`#freeze_left_${elementID}`).is(":checked")&&$(`#freeze_right_${elementID}`).is(":checked"))Swal.fire({icon:"warning",text:"Kindly select only one checkbox to freeze panes."});else{if($(`#freeze_left_${elementID}`).is(":not(:checked)")&&$(`#freeze_right_${elementID}`).is(":not(:checked)")&&Swal.fire({icon:"warning",text:"Kindly select atleast one checkbox to freeze panes."}),$(`#freeze_left_${elementID}`).is(":checked"))try{fDict2[`example1${elementID}`].left=parseInt(cellIndex)}catch(err){fDict2[`example1${elementID}`]={left:0,right:0},fDict2[`example1${elementID}`].left=parseInt(cellIndex)}if($(`#freeze_right_${elementID}`).is(":checked"))try{fDict2[`example1${elementID}`].right=parseInt(cellColLen-cellIndex+1)}catch(err){fDict2[`example1${elementID}`]={left:0,right:0},fDict2[`example1${elementID}`].right=parseInt(cellColLen-cellIndex+1)}$(".cell_highlighted").removeClass("cell_selected"),$(".cell_highlighted").removeClass("cell_highlighted");const table=$(`#example1${elementID}`).DataTable();new $.fn.dataTable.FixedColumns(table,fDict2[`example1${elementID}`]),$(`#freeze_pane_modal_${elementID}`).modal("hide")}}function freezePaneButton(This){const elementID=$(This).attr("data-elementID");$(".freezeCheckbox").prop("checked",!1),$(`#freeze_pane_modal_${elementID}`).modal("show")}function unfreezepanesave(This){const elementID=$(This).attr("data-elementid");$(`#freeze_left_${elementID}`).is(":checked")&&(fDict2[`example1${elementID}`].left=0),$(`#freeze_right_${elementID}`).is(":checked")&&(fDict2[`example1${elementID}`].right=0);const table=$(`#example1${elementID}`).DataTable();new $.fn.dataTable.FixedColumns(table,fDict2[`example1${elementID}`]),$(`#freeze_pane_modal_${elementID}`).modal("hide")}function datatableAdjustBtn(){setTimeout(()=>{$(`#example1${$(this).attr("data-elementID")}`).DataTable().draw()},100)}function calValList(){const valuesDic={},elementID=$(this).attr("data-id"),datatypeList=[],tableName=$(this).attr("data-table-name"),computedValueList=[];$("#modalBody"+elementID).find("form").find(".form-row").find('[data-computed-field="true"]').each((function(){computedValueList.push($(this).attr("id").replace("id_","").replace("_"+elementID,""))})),$("#modalBody"+elementID).find("form").find(".form-row").find("input[data-field_name],select[data-field_name]").each((function(){let compVal=$(this).val();const compDatatype=$(this).attr("datatype");let compCol=$(this).attr("id").replace("id_","").replace("_"+elementID,"");""!==String(compVal)&&"NULL"!==String(compVal)||(compVal="NaN"),valuesDic[compCol]=compVal,datatypeList.push(compDatatype)})),$.ajax({url:`/users/${urlPath}/constriant_get_data/`,data:{element_id:elementID,operation:"calculate_computed_value",values_dic:JSON.stringify(valuesDic),datatype_list:JSON.stringify(datatypeList),table_name:JSON.stringify(tableName)},type:"POST",dataType:"json",success:function(context){if("yes"===String(context.error_msg))for(let i=0;i<context.f_list.length;i++)Swal.fire({icon:"error",text:`Calculation error in : ${context.f_list[i]} - ${context.e_list[i]}`});else for(const[key,value]of Object.entries(context.data[0]))for(let i=0;i<computedValueList.length;i++)String(key)===computedValueList[i]&&$("#id_"+computedValueList[i]+"_"+elementID).val(value).trigger("change")},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function formatterButton(This){let elementID=$(This).attr("data-elementid"),modelName=$(This).attr("data-table-name"),tabHeaderName=$('a[data-toggle="tab"].active.l3items').find("span").text(),elementID2=elementID,itemCode=$(This).attr("pr_code"),view_name="";temp_type=$(`#${elementID}_tab_content`).attr("data-template-type"),"Multi Dropdown View"==temp_type&&(view_name=$(`#tableTab${elementID}`).find("select").val()),$(`#formatterTable1_${elementID}`).empty(),$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"dropFieldList",tableName:modelName},type:"POST",dataType:"json",success:function(data){$(`#formatColumn1_${elementID}`).empty();for(let i=0;i<data.fieldNameList.length;i++)$(`#formatColumn1_${elementID}`).append(new Option(modelName+"-"+data.fieldList[i],modelName+"-"+data.fieldNameList[i]))},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}}),$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"load_formatter_config_L3",tab_header_name:tabHeaderName,element_id:elementID2.split("__")[0],itemCode:itemCode,modelName:modelName,view_name:view_name},type:"POST",dataType:"json",success:function(data){if(data.formatter_tables.includes(modelName)&&data.formatter_tables.length>0)for(let i=0;i<data.formatter_tables.length;i++)if(modelName==data.formatter_tables[i]){$(`#formatColumn1_${elementID}`).empty();for(let j=0;j<data.fieldList.length;j++)$(`#formatColumn1_${elementID}`).append(new Option(data.formatter_tables[i]+"-"+data.fieldList[j],data.formatter_tables[i]+"-"+data.fieldNameList[j]))}if("formatter_config"in data){let colList=[],valList={};$(`#formatterTable1_${elementID}`).empty();for(let[key,value]of Object.entries(data.formatter_config))valList[key]=value,value=JSON.stringify(value),modelName==key.split("-")[0]&&colList.push(key),modelName==key.split("-")[0]&&$(`#formatterTable1_${elementID}`).append(`<tr>\n                                <td style="text-align: center;" data-col_id="">${key.split("-")[0]}</td>\n                                <td style="text-align: center;" data-col_id="">${key.split("-")[1]}</td>\n                                <td style="text-align: center;">\n                                  <i class="far fa-edit"" onclick="showFormatter.call(this)" style="color:var(--primary-color);cursor: pointer;" data-col_id="${key.split("-")[1]}" data-element_id="${elementID}" data-table_name = "${key.split("-")[0]}" data-title="Add formatter" data-col_config='${value}'></i>\n                                </td>\n                              </tr>`);$(`#formatColumn1_${elementID}`).val(colList),$(`#configFormat1_${elementID}`).attr(`data-config_formatter1_${elementID2}`,JSON.stringify(valList)),formatConfigD1=valList}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}}),$(`#fmodal1_${elementID}`).modal("show")}function formatterColChange(This){let dataList=$(This).val(),elementID=$(This).attr("id").replace("formatColumn1_",""),elementID2=elementID,multi=$(".tab-pane.fade.active.show").find(".changeTab").text(),deletedCol="";$(`#formatterTable1_${elementID}`).empty();for(let i=0;i<dataList.length;i++)$(`#formatterTable1_${elementID}`).append(`<tr>\n                      <td style="text-align: center;" data-col_id="">${dataList[i].split("-")[0]}</td>\n                      <td style="text-align: center;" data-col_id="">${dataList[i].split("-")[1]}</td>\n                      <td style="text-align: center;">\n                        <i class="far fa-edit"" onclick="showFormatter.call(this)" style="color:var(--primary-color);cursor: pointer;" data-col_id="${dataList[i].split("-")[1]}" data-col_config='${JSON.stringify(formatConfigD1[dataList[i]])}' data-element_id="${elementID}" data-table_name = "${dataList[i].split("-")[0]}" data-title="Add formatter"></i>\n                      </td>\n                    </tr>`);if(multi)$(`#formatColumn1_${elementID}`).off("select2:unselect").on("select2:unselect",(function(e){deletedCol=e.params.data.text,delete formatConfigD1[deletedCol],$(`#configFormat1_${elementID}`).attr(`data-config_formatter1_${elementID2}`,JSON.stringify(formatConfigD1))}));else{let keyList,difference=Object.keys(formatConfigD1).filter(x=>!dataList.includes(x));for(let i=0;i<difference.length;i++)delete formatConfigD1[difference[i]];$(`#configFormat1_${elementID}`).attr(`data-config_formatter1_${elementID2}`,JSON.stringify(formatConfigD1))}}function showFormatter(){let colName=$(this).attr("data-col_id"),tableName=$(this).attr("data-table_name"),elementID=$(this).attr("data-element_id"),elementID2=elementID;$(`#Dformat1_${elementID}`).css("display","none"),$(`#SFormat1_${elementID}`).css("display","none"),$(`#syFormat1_${elementID}`).css("display","none"),$(`#DTFormat1_${elementID}`).css("display","none"),$(`#TimefFormat1_${elementID}`).css("display","none"),$(`#fmodal2_${elementID}`).modal("show"),$(`#formatOption1_${elementID}`).val("").trigger("change"),$(`#sepFormat1_${elementID}`).prop("checked",!1),$(`#decimalFormat1_${elementID}`).val("").trigger("change"),$(`#formatDate1_${elementID}`).val("").trigger("change"),$(`#formatTime1_${elementID}`).val("").trigger("change"),$(`#symbolFormat1_${elementID}`).empty(),$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"get_currency_list"},type:"POST",dataType:"json",success:function(data){$(`#symbolFormat1_${elementID}`).append('<option value="" disabled selected> None </option>');for(let i=0;i<data.country_list.length;i++)$(`#symbolFormat1_${elementID}`).append(`<option value="${data.country_list[i]}"> ${data.country_list[i]} ${data.curr_list[i]} </option>`)},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}}),setTimeout(()=>{$(`#formatOption1_${elementID}`).val("").trigger("change"),$(`#formatOption_${elementID}`).val("").trigger("select2:select")},200);let clickedConfig1={},con;"undefined"!=$(this).attr("data-col_config")&&(clickedConfig1=JSON.parse($(this).attr("data-col_config")),"number"==clickedConfig1.formatter&&(setTimeout(()=>{$(`#formatOption1_${elementID}`).val("number").trigger("change"),$(`#formatOption1_${elementID}`).val("number").trigger("select2:select")},200),setTimeout(()=>{""!=clickedConfig1.decimal&&$(`#decimalFormat1_${elementID}`).val(clickedConfig1.decimal).trigger("change"),clickedConfig1.separator&&$(`#sepFormat1_${elementID}`).prop("checked",!0)},300)),"currency"==clickedConfig1.formatter&&(setTimeout(()=>{$(`#formatOption1_${elementID}`).val("currency").trigger("change"),$(`#formatOption1_${elementID}`).val("currency").trigger("select2:select")},200),setTimeout(()=>{""!=clickedConfig1.currency.decimal&&$(`#decimalFormat1_${elementID}`).val(clickedConfig1.currency.decimal).trigger("change"),clickedConfig1.currency.symbol&&$(`#symbolFormat1_${elementID}`).val(clickedConfig1.currency.symbol).trigger("change")},300)),"date"==clickedConfig1.formatter&&(setTimeout(()=>{$(`#formatOption1_${elementID}`).val("date").trigger("change"),$(`#formatOption1_${elementID}`).val("date").trigger("select2:select")},200),setTimeout(()=>{""!=clickedConfig1.date&&$(`#formatDate1_${elementID}`).val(clickedConfig1.date).trigger("change")},300)),"time"==clickedConfig1.formatter&&(setTimeout(()=>{$(`#formatOption1_${elementID}`).val("time").trigger("change"),$(`#formatOption1_${elementID}`).val("time").trigger("select2:select")},200),setTimeout(()=>{""!=clickedConfig1.time&&$(`#formatTime1_${elementID}`).val(clickedConfig1.time).trigger("change")},300)),"percentage"==clickedConfig1.formatter&&(setTimeout(()=>{$(`#formatOption1_${elementID}`).val("percentage").trigger("change"),$(`#formatOption1_${elementID}`).val("percentage").trigger("select2:select")},200),setTimeout(()=>{""!=clickedConfig1.percentage.decimal&&$(`#decimalFormat1_${elementID}`).val(clickedConfig1.percentage.decimal).trigger("change")},300)),"scientific"==clickedConfig1.formatter&&(setTimeout(()=>{$(`#formatOption1_${elementID}`).val("scientific").trigger("change"),$(`#formatOption1_${elementID}`).val("scientific").trigger("select2:select")},200),setTimeout(()=>{""!=clickedConfig1.scientific.decimal&&$(`#decimalFormat1_${elementID}`).val(clickedConfig1.scientific.decimal).trigger("change")},300))),$(`#btn_formatSave1_${elementID}`).off("click").on("click",(function(){let decimal="",currency={},scientific={},percentage={},dDate="",dTime="";"scientific"==$(`#formatOption1_${elementID}`).val()||"percentage"==$(`#formatOption1_${elementID}`).val()||"currency"==$(`#formatOption1_${elementID}`).val()||"date"==$(`#formatOption1_${elementID}`).val()||"time"==$(`#formatOption1_${elementID}`).val()?decimal=null:(decimal=$(`#decimalFormat1_${elementID}`).val(),""==decimal&&(decimal=null)),"currency"==$(`#formatOption1_${elementID}`).val()?(currency.decimal=$(`#decimalFormat1_${elementID}`).val(),currency.symbol=$(`#symbolFormat1_${elementID}`).val()):currency=null,"scientific"==$(`#formatOption1_${elementID}`).val()?scientific.decimal=$(`#decimalFormat1_${elementID}`).val():scientific=null,"percentage"==$(`#formatOption1_${elementID}`).val()?percentage.decimal=$(`#decimalFormat1_${elementID}`).val():percentage=null,dDate="date"==$(`#formatOption1_${elementID}`).val()?$(`#formatDate1_${elementID}`).val():null,dTime="time"==$(`#formatOption1_${elementID}`).val()?$(`#formatTime1_${elementID}`).val():null,formatConfigD1[tableName+"-"+colName]={formatter:$(`#formatOption1_${elementID}`).val(),decimal:decimal,separator:$(`#sepFormat1_${elementID}`).is(":checked"),currency:currency,scientific:scientific,percentage:percentage,date:dDate,time:dTime,table_name:tableName}})),$(`#fmodal2_${elementID}`).on("hidden.bs.modal",(function(){$(`#configFormat1_${elementID}`).attr(`data-config_formatter1_${elementID2}`,JSON.stringify(formatConfigD1))}))}function formatOptionChange(){let elementID=$(this).attr("id").replace("formatOption1_","");"number"==$(this).val()?($(`#Dformat1_${elementID}`).css("display","block"),$(`#SFormat1_${elementID}`).css("display","block"),$(`#syFormat1_${elementID}`).css("display","none"),$(`#DTFormat1_${elementID}`).css("display","none"),$(`#TimefFormat1_${elementID}`).css("display","none")):"currency"==$(this).val()?($(`#Dformat1_${elementID}`).css("display","block"),$(`#syFormat1_${elementID}`).css("display","block"),$(`#SFormat1_${elementID}`).css("display","none"),$(`#DTFormat1_${elementID}`).css("display","none"),$(`#TimefFormat1_${elementID}`).css("display","none")):"percentage"==$(this).val()||"scientific"==$(this).val()?($(`#Dformat1_${elementID}`).css("display","block"),$(`#SFormat1_${elementID}`).css("display","none"),$(`#syFormat1_${elementID}`).css("display","none"),$(`#DTFormat1_${elementID}`).css("display","none"),$(`#TimefFormat1_${elementID}`).css("display","none")):"date"==$(this).val()?($(`#Dformat1_${elementID}`).css("display","none"),$(`#SFormat1_${elementID}`).css("display","none"),$(`#syFormat1_${elementID}`).css("display","none"),$(`#DTFormat1_${elementID}`).css("display","block"),$(`#TimefFormat1_${elementID}`).css("display","none")):"time"==$(this).val()?($(`#Dformat1_${elementID}`).css("display","none"),$(`#SFormat1_${elementID}`).css("display","none"),$(`#syFormat1_${elementID}`).css("display","none"),$(`#DTFormat1_${elementID}`).css("display","none"),$(`#TimefFormat1_${elementID}`).css("display","block")):""==$(this).val()&&($(`#Dformat1_${elementID}`).css("display","none"),$(`#SFormat1_${elementID}`).css("display","none"),$(`#syFormat1_${elementID}`).css("display","none"),$(`#DTFormat1_${elementID}`).css("display","none"),$(`#TimefFormat1_${elementID}`).css("display","none"))}function saveFormatconfig(){let elementID=$(this).attr("element_id").split("__")[0],tabHeaderName=$('a[data-toggle="tab"].active.l3items').find("span").text(),itemCode=$(this).attr("pr_code"),view_name="";temp_type=$(`#${elementID}_tab_content`).attr("data-template-type"),"Multi Dropdown View"==temp_type&&(view_name=$(`#tableTab${elementID}`).find("select").val()),$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"save_formatter_config_L3",tab_header_name:tabHeaderName,element_id:elementID,itemCode:itemCode,format_config:JSON.stringify(formatConfigD1),view_name:view_name},type:"POST",dataType:"json",success:function(data){message="",icon="",data.save_formatters_message&&(message=data.save_formatters_message.message,icon=data.save_formatters_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"success",iconHtml:iconHtml,text:message||"Configuration saved successfully!"}).then(result=>{result.isConfirmed&&windowLocationAttr.reload()})},error:function(){Swal.fire({icon:"error",text:"Error! Failure in saving configuration. Please check your configuration and try again try again."})}})}function addCompButton(This){let elementID=$(This).attr("data-elementID"),modelName=$(This).attr("data-table-name");$(`#existingComp_${elementID}`).prop("checked",!1),$(`#newComp_${elementID}`).prop("checked",!1),$(`#fieldmdl_${elementID}`).val("").trigger("change"),$(`#compField_verbose_name_${elementID}`).val("").trigger("change"),$(`#comp_Comp_Field_${elementID}`).val("").trigger("change"),$(`#compfield_datatype_${elementID}`).val("").trigger("change"),$(`#comp_null_field_edit_${elementID}`).val("").trigger("change"),$(`#comp_unique_${elementID}`).val("").trigger("change"),$(`#dropdown_${elementID}`).css("display","none"),$(`#addCompFields_${elementID}`).modal("show"),$(`#existingComp_${elementID}`).change((function(){$(`#dropdown1_${elementID}`).val("").trigger("change"),this.checked&&$(`#newComp_${elementID}`).is(":checked")?(Swal.fire({icon:"warning",text:"Kindly select only one option."}),$(`#existingComp_${elementID}`).prop("checked",!1)):this.checked?$(`#dropdown_${elementID}`).css("display","block"):$(`#dropdown_${elementID}`).css("display","none")})),$(`#newComp_${elementID}`).change((function(){this.checked&&$(`#existingComp_${elementID}`).is(":checked")?(Swal.fire({icon:"warning",text:"Kindly select only one option."}),$(`#newComp_${elementID}`).prop("checked",!1)):this.checked&&($(`#fieldmdl_${elementID}`).val("").trigger("change"),$(`#compField_verbose_name_${elementID}`).val("").trigger("change"),$(`#compfield_datatype_${elementID}`).val("").trigger("change"),$(`#comp_null_field_edit_${elementID}`).val("").trigger("change"),$(`#comp_unique_${elementID}`).val("").trigger("change"),$(`#comp_Comp_Field_${elementID}`).val("").trigger("change"))})),$(`#comp_EBDisplayButtonID_${elementID}`).off("click").on("click",(function(){listViewComp=!0,listViewModelName=modelName,listViewCompCol=$(this).parent().parent().parent().find(`#fieldmdl_${elementID}`).val(),$("#EBDisplayModel").css("z-index",1052),$("#EBDisplayModel").modal("show"),reloadCompConfig(listViewModelName+listViewCompCol)})),$("#EBDisplayModel").on("hide.bs.modal",(function(){listViewComp=!1,$("#where_condition").css("display","block"),$("#export_data_equ").css("display","block"),$("#EBDisplayModel").css("z-index",1050)})),$("#EBDisplayModel").on("show.bs.modal",(function(){$("#where_condition").css("display","none"),$("#export_data_equ").css("display","none")})),$("#save_workflow_equ").off("click").on("click",(function(){SaveCompFlow(listViewModelName+listViewCompCol)})),$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{model_name:modelName,operation:"get_fields_comp"},type:"POST",dataType:"json",success:function(data){$(`#dropdown1_${elementID}`).empty(),$(`#dropdown1_${elementID}`).append('<option value="" selected disabled>Select Column</option>'),$.each(Object.keys(data),(function(key,value){const ftype=data[value].internal_type,vname=data[value].verbose_name;"IntegerField"!=ftype&&"BigIntegerField"!=ftype&&"FloatField"!=ftype||$(`#dropdown1_${elementID}`).append(`<option data-type="${ftype}" name="${value}" value="${vname}" data-act-name="${value}">${vname}</option>`)}))},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}}),$(`#dropdown1_${elementID}`).off("select2:select").on("select2:select",(function(){$.ajax({url:`/users/${urlPath}/DataManagement/`,data:{model_name:modelName,field_name:$(this).find(":selected").attr("data-act-name"),operation:"attr_details"},type:"POST",dataType:"json",success:function(data){let nvalue="",uvalue="";nvalue=(data=JSON.parse(data)).Nullable?"Yes":"No",uvalue=data.Unique?"Yes":"No",Object.keys(data).length>0&&($(`#fieldmdl_${elementID}`).val(data.Field_name).trigger("change"),$(`#compField_verbose_name_${elementID}`).val(data["Front End Name"]).trigger("change"),$(`#compfield_datatype_${elementID}`).val(data["Data Type"]).trigger("change"),$(`#comp_null_field_edit_${elementID}`).val(nvalue).trigger("change"),$(`#comp_unique_${elementID}`).val(uvalue).trigger("change"),"true"==String(data["Computed Value"])?$(`#comp_Comp_Field_${elementID}`).val("Yes").trigger("change"):"false"==String(data["Computed Value"])&&$(`#comp_Comp_Field_${elementID}`).val("No").trigger("change"))},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})})),$(`#btn_removeCompField_${elementID}`).off("click").on("click",(function(){var view_name="";temp_type=$(`#${elementID}_tab_content`).attr("data-template-type"),"Multi Dropdown View"==temp_type&&(view_name=$(`#tableTab${elementID}`).find("select").val()),$.ajax({url:`/users/${urlPath}/DataManagement/`,data:{element_id:elementID.split("__tab__")[0],operation:"fetch_list_view_msgs",messages:JSON.stringify(["remove_computed_message","remove_select_column_computed_message","remove_new_computed_message","remove_existing_computed_message","remove_existing_computed_message","confirm_remove_computed_message"]),view_name:view_name},type:"POST",dataType:"json",success:function(data){if($(`#existingComp_${elementID}`).is(":not(:checked)")&&(message="",icon="",data.remove_existing_computed_message&&(message=data.remove_existing_computed_message.message,icon=data.remove_existing_computed_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"warning",iconHtml:iconHtml,text:message||"Please select the existing field checkbox and the field name."})),$(`#newComp_${elementID}`).is(":checked")&&(message="",icon="",data.remove_new_computed_message&&(message=data.remove_new_computed_message.message,icon=data.remove_new_computed_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"warning",iconHtml:iconHtml,text:message||"Unable to perform the operation in the new field."})),$(`#existingComp_${elementID}`).is(":checked")&&null==$(`#dropdown1_${elementID}`).val()&&(message="",icon="",data.remove_select_column_computed_message&&(message=data.remove_select_column_computed_message.message,icon=data.remove_select_column_computed_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"warning",iconHtml:iconHtml,text:message||"Kindly select a column."})),$(`#existingComp_${elementID}`).is(":checked")&&null!=$(`#dropdown1_${elementID}`).val()){message="",icon="",data.confirm_remove_computed_message&&(message=data.confirm_remove_computed_message.message,icon=data.confirm_remove_computed_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`);var confirmDelete=null;if(Swal.fire({icon:"warning",iconHtml:iconHtml,text:message||"Remove the computed field calculation?\n\nClick 'Yes' to confirm or 'No' if you do not wish to remove it.",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(result=>{result.isConfirmed?confirmDelete=!0:result.isDenied&&(confirmDelete=!1)}),confirmDelete=!0){tablename=$(this).parent().parent().find(`#fieldmdl_${elementID}`).val();let fieldDict={},fieldList=[];fieldDict.fieldName=$(`#fieldmdl_${elementID}`).val(),fieldDict.fieldVerboseName=$(`#compField_verbose_name_${elementID}`).val(),fieldDict.fieldDatatype=$(`#compfield_datatype_${elementID}`).val(),fieldDict.fieldNull=$(`#comp_null_field_edit_${elementID}`).val(),fieldDict.fieldUnique=$(`#comp_unique_${elementID}`).val(),fieldDict.computedValue="No",fieldDict.fieldDefault="0",fieldList.push(fieldDict),$.ajax({url:`/users/${urlPath}/DataManagement/`,data:{tablename:modelName,fieldDict:JSON.stringify(fieldList),operation:"removeCompField"},type:"POST",dataType:"json",success:function(){$.ajax({url:`/users/${urlPath}/DataManagement/`,data:{pr_code:windowLocation.split("/")[4],operation:"regenCompField"},type:"POST",dataType:"json",success:function(){var view_name="";temp_type=$(`#${elementID}_tab_content`).attr("data-template-type"),"Multi Dropdown View"==temp_type&&(view_name=$(`#tableTab${elementID}`).find("select").val()),$.ajax({url:`/users/${urlPath}/DataManagement/`,data:{element_id:elementID.split("__tab__")[0],operation:"fetch_list_view_msgs",messages:JSON.stringify(["remove_computed_message"]),view_name:view_name},type:"POST",dataType:"json",success:function(data){message="",icon="",data.remove_computed_message&&(message=data.remove_computed_message.message,icon=data.remove_computed_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"success",iconHtml:iconHtml,text:message||"Operation successful!"}).then(result=>{result.isConfirmed&&windowLocationAttr.reload()})},error:function(){Swal.fire({icon:"success",text:"Error! Please try again."})}})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})})),$(`#btn_formatCompField_${elementID}`).off("click").on("click",(function(){let operation="";$(`#existingComp_${elementID}`).is(":checked")&&(operation="editattributes"),$(`#newComp_${elementID}`).is(":checked")&&(operation="addelement");let fieldDict={},fieldList=[];fieldDict.fieldName=$(`#fieldmdl_${elementID}`).val(),fieldDict.fieldVerboseName=$(`#compField_verbose_name_${elementID}`).val(),fieldDict.fieldDatatype=$(`#compfield_datatype_${elementID}`).val(),fieldDict.fieldNull=$(`#comp_null_field_edit_${elementID}`).val(),fieldDict.fieldUnique=$(`#comp_unique_${elementID}`).val(),fieldDict.computedValue="Yes",fieldDict.fieldDefault="0",fieldList.push(fieldDict),$.ajax({url:`/users/${urlPath}/DataManagement/`,data:{tablename:modelName,fieldDict:JSON.stringify(fieldList),operation:operation},type:"POST",dataType:"json",success:function(){$.ajax({url:`/users/${urlPath}/DataManagement/`,data:{pr_code:windowLocation.split("/")[4],operation:"regenCompField"},type:"POST",dataType:"json",success:function(data){var view_name="";temp_type=$(`#${elementID}_tab_content`).attr("data-template-type"),"Multi Dropdown View"==temp_type&&(view_name=$(`#tableTab${elementID}`).find("select").val()),$.ajax({url:`/users/${urlPath}/DataManagement/`,data:{element_id:elementID.split("__tab__")[0],operation:"fetch_list_view_msgs",messages:JSON.stringify(["add_computed_message"]),view_name:view_name},type:"POST",dataType:"json",success:function(data){message="",icon="",data.add_computed_message&&(message=data.add_computed_message.message,icon=data.add_computed_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"success",iconHtml:iconHtml,text:message||"Operation successful!"}).then(result=>{result.isConfirmed&&windowLocationAttr.reload()})},error:function(){Swal.fire({icon:"success",text:"Error! Please try again."})}})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}))}function FilePreviewButton(e){let prid=String($(e).closest("table").attr("id")).substring(8),fileName=$(e).find("u").text();$(`#FilePreviewModal_${prid}`).find(".modal-header").find("h5").text(fileName),$(`#FilePreviewModal_${prid}`).find(".modal-body").text("Loading..."),$(`#FilePreviewModal_${prid}`).modal("show");let format=fileName.substring(fileName.lastIndexOf(".")+1,fileName.length),imageformats=["PNG","JPEG","JPG","BMP"];$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"get_file_preview",file_name:fileName},type:"POST",dataType:"html",success:function(data){if($(`#FilePreviewModal_${prid}`).find(".modal-body").empty(),"https"==fileName.slice(0,5)){if("https://www.youtube.com/"==fileName.slice(0,24)||"https://youtu.be/"==fileName.slice(0,17)){let youtubeId=fileName.slice(-11),video;$(`<iframe allowfullscreen width="100%" height="500"\n        src="https://www.youtube.com/embed/${youtubeId}">\n        </iframe>`).appendTo(".filetoappend")}else if("https://vimeo.com/"==fileName.slice(0,18)){let vimeoId=fileName.slice(18,27),video;$(`<iframe allowfullscreen width="100%" height="500"\n          src="https://player.vimeo.com/video/${vimeoId}">\n          </iframe>`).appendTo(".filetoappend")}else $(`#FilePreviewModal_${prid}`).find(".modal-body").text("Enter Only Youtube or Vimeo video Shareable Links");$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").prop("disabled",!0),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").prop("download",""),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").removeAttr("href")}else if(imageformats.includes(format.toUpperCase())){let img=$("<img>");img.attr("src",`data:image/${format};base64,`+data),img.appendTo(".filetoappend"),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").prop("disabled",!1),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").prop("download",fileName),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").attr("href",`data:image/${format};base64,`+data)}else if("mp4"==format){let video;$(`<video width="100%" height="100%" controls controlsList="nodownload">\n        <source src="http://127.0.0.1:8080/media/uploaded_files/${fileName}" type="video/mp4">\n      Your browser does not support the video tag.\n      </video>`).appendTo(".filetoappend"),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").prop("disabled",!1),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").prop("download",fileName),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").attr("href",`http://127.0.0.1:8080/media/uploaded_files/${fileName}`)}else if("webm"==format){let video;$(`<video width="100%" height="100%" controls controlsList="nodownload">\n        <source src="http://127.0.0.1:8080/media/uploaded_files/${fileName}" type="video/webm">\n      Your browser does not support the video tag.\n      </video>`).appendTo(".filetoappend"),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").prop("disabled",!1),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").prop("download",fileName),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").attr("href",`http://127.0.0.1:8080/media/uploaded_files/${fileName}`)}else if("ogv"==format){let video;$(`<video width="100%" height="100%" controls controlsList="nodownload">\n        <source src="http://127.0.0.1:8080/media/uploaded_files/${fileName}" type="video/ogg">\n      Your browser does not support the video tag.\n      </video>`).appendTo(".filetoappend"),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").prop("disabled",!1),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").prop("download",fileName),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").attr("href",`http://127.0.0.1:8080/media/uploaded_files/${fileName}`)}else if("pdf"==format){let pdfc;$(`<embed\n        src="data:application/pdf;base64,${data}#toolbar=0"\n        type="application/pdf"\n        frameBorder="0"\n        scrolling="auto"\n        height="100%"\n        width="100%"\n        ></embed>`).appendTo(".filetoappend"),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").prop("disabled",!1),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").prop("download",fileName),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").attr("href",`data:image/${format};base64,`+data)}else $(`#FilePreviewModal_${prid}`).find(".modal-body").text(`Preview not available for .${format} file`),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").prop("disabled",!1),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").prop("download",fileName),$(`#FilePreviewModal_${prid}`).find(".modal-footer").find("a").attr("href",`data:document/${format};base64,`+data)},error:function(){$(`#FilePreviewModal_${prid}`).find(".modal-body").text("Some error or preview not supported."),Swal.fire({icon:"error",text:"Error! Please try again."})}})}function HyperLinkingTables(obj){const elementId=obj.getAttribute("data-id");var dataList=obj.getAttribute("data-list"),text=$(obj).text(),extractedValues=JSON.parse(dataList),masterColumn=extractedValues.masterColumn,linkedTable=extractedValues.linkedTable,linkedColumn=extractedValues.linkedColumn,addlinkedColumn=JSON.stringify(extractedValues.LinkedAdditional);$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"hyperLinkingTables",value:text,masterColumn:masterColumn,linkedTable:linkedTable,linkedColumn:linkedColumn,addlinkedColumn:addlinkedColumn},type:"POST",dataType:"json",success:function(data){$(`#hyper_linking_header${elementId}`).empty(),$(`#hyper_linking_header${elementId}`).append(`<h5 class="modal-title">${linkedTable}</h5>\n      <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n        <span aria-hidden="true">&times;</span>\n      </button>`);var data=data.data;$(`#hyper_linking_body${elementId}`).empty(),$(`#hyper_linking_body${elementId}`).append(`\n          <table id="exampledata${elementId}" class="display compact" style="width:100%;">\n              <thead>\n                  <tr>\n                  </tr>\n              </thead>\n              <tbody>\n              </tbody>\n          </table>\n          `);for(var i=0;i<data.length;i++){string="<tr>";for(let[key,value]of Object.entries(data[i]))string+=`<td>${value}</td>`;string+="</tr>",$(`#exampledata${elementId}`).find("tbody").append(string)}for(let[key,value]of Object.entries(data[0]))$(`#exampledata${elementId}`).find("thead tr").eq(0).append(`<th>${key}</th>`);$(`#hyper_linking_modal${elementId}`).modal("show"),$(`#exampledata${elementId}`).DataTable({autoWidth:!1,scrollY:"35vh",scrollX:"100%",scrollCollapse:!0,ordering:!1,orderCellsTop:!0,responsive:!0,deferRender:!0,paging:!0,lengthMenu:[[1,5,50,-1],[1,5,50,"All"]],stripeClasses:!1,pageLength:50,dom:"lfBrtip",buttons:[{extend:"collection",text:"Export",buttons:[{extend:"copy",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"excel",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"csv",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"pdf",title:"",exportOptions:{columns:":visible:not(.noVis)"}}]},{extend:"colvis",className:"scroller"}],columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"}]})},failure:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function emptyListViewModal(){var element_id;const modalId="#list_view_edit_modal_"+$(this).attr("data-element_id"),modalbody=$(modalId).find(".modal-body");modalbody.empty();let url_string=window.location.pathname,f_occ=url_string.indexOf("/",url_string.indexOf("/")+1),s_occ=url_string.indexOf("/",url_string.indexOf("/")+f_occ+1),t_occ=url_string.indexOf("/",url_string.indexOf("/")+s_occ+1),app_code2=url_string.substring(f_occ+1,s_occ),current_dev_mode2=url_string.substring(s_occ+1,t_occ);"Build"!=current_dev_mode2&&"Edit"!=current_dev_mode2&&(current_dev_mode2="User"),$.ajax({url:`/users/${app_code2}/${current_dev_mode2}/processGraphModule/`,data:{operation:"generate_script"},type:"POST",dataType:"json",success:function(data){var script_div='<div id = "create_view_script">'+data.script+"</div>";$("body").append(script_div),$("body").removeAttr("modal_pk"),$("body").removeAttr("modal_table_name"),$("body").removeAttr("modal_element_id"),$("body").removeAttr("modal_url")},failure:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function checkCaseDependence(casesArray,JSAttrConfig){for(let i=0;i<JSAttrConfig.length;i++){const attrConfig=JSAttrConfig[i];if(attrConfig.hasOwnProperty("cases")&&casesArray.some(item=>attrConfig.cases.includes(item)))return!0}return!1}function getViewTable(elementID,view_name){let prCode=window.location.pathname.split("/")[4],tabHeaderName=$('a[data-toggle="tab"].active.l3items').find("span").text();$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"fetchviewtable",elementID:elementID,view_name:view_name,prCode:prCode,tabHeaderName:tabHeaderName},type:"POST",dataType:"json",success:function(data){if($(`#${data.ele_id}_tab_content`).empty(),$(`#${data.ele_id}_tab_content`).append(data.html),$(`#group_by_switch_user_configuration_${data.ele_id}`).attr("data-user",data.user_name),Object.keys(data.user_config_values).length>0?($(`#group_by_switch_user_configuration_${data.ele_id}`).attr("data-list2",JSON.stringify(data.user_config_values)),$(`#example1${data.ele_id}`).attr("data-list-group-by1","data-list-group-by")):($(`#group_by_switch_user_configuration_${data.ele_id}`).attr("data-list2",""),$(`#example1${data.ele_id}`).attr("data-list-group-by1","")),$("#bokehForm1"+data.ele_id).find("select").each((function(){parent=$(this).parent(),$(this).select2({dropdownParent:parent})})),$("#bokehForm1"+data.ele_id).prepend(`<input type="hidden" name="csrfmiddlewaretoken" value="${$("form").find("input[name='csrfmiddlewaretoken']").attr("value")}">`),$("#popup"+data.ele_id).find("form").prepend(`<input type="hidden" name="csrfmiddlewaretoken" value="${$("form").find("input[name='csrfmiddlewaretoken']").attr("value")}">`),$(`#tableTab${data.ele_id}`).find("div").find("select").val(view_name).trigger("change"),$("#"+data.ele_id+"_tab_content").find(".card").find(".bodyListview").find(".mul_heading").find("h4").text(view_name),masterBaseDataFilter([data.ele_id],[data.pagination]),masterUploadFunc([data.ele_id]),masterStandardButtonFunc(),masterPlotly([data.ele_id]),$("select.select2:not(.modal select.select2)").each((function(){parent=$(this).parent(),$(this).select2({dropdownParent:parent})})),$(".modal select.select2").each((function(){$(this).select2()})),data.html.includes("plotCharts"+data.ele_id)){let chartSaveEleIdList_=[data.ele_id];for(let i in chartSaveEleIdList_)$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"saveChartConfigList",element_id:chartSaveEleIdList_[i]},type:"POST",dataType:"json",success:function(data){if($(`#plotSection${chartSaveEleIdList_[i]}`).find(".nav-link").length<2&&$(`#analysisAddTab${chartSaveEleIdList_[i]}`).trigger("click"),""!=data.save&&null!=data.save){let saveData=data.save;for(let j=0;j<saveData.length;j++)saveData[j].ElementID==chartSaveEleIdList_[i]&&saveData[j].hasOwnProperty("dropdown")&&view_name==saveData[j].dropdown&&($("#plotSection"+chartSaveEleIdList_[i]).css("display","block"),data.save=saveData[j],savedChartConfigFunc(data,"",chartSaveEleIdList_[i]))}},error:()=>{Swal.fire({icon:"error",text:"Error! Please try again."})}})}$("#backgroundBlock").remove(),$("body").css("pointer-events","all");var quickFiltersDiv=$(`#quickFiltersDiv${elementID}`);if(quickFiltersDiv.length>0){const itemCode=windowLocation.split("/")[4];var quickFiltersDivChildren=quickFiltersDiv.children();for(let k=0;k<quickFiltersDivChildren.length;k++)"range_field"==quickFiltersDivChildren.eq(k).attr("data-div")?ajaxQuickFilters("range_field",quickFiltersDivChildren.eq(k),elementID):"date_picker"==quickFiltersDivChildren.eq(k).attr("data-div")?(quickFiltersDivChildren.eq(k).find(".dtrangepicker").on("apply.daterangepicker",(function(ev,picker){$(this).val(picker.startDate.format("YYYY-MM-DD")+" - "+picker.endDate.format("YYYY-MM-DD")),$(this).attr("data-val",$(this).val()),$(`#example1${elementID}`).DataTable().draw()})),quickFiltersDivChildren.eq(k).find(".dtrangepicker").on("cancel.daterangepicker",(function(ev,picker){$(this).val(""),$(this).attr("data-val",$(this).val()),$(`#example1${elementID}`).DataTable().draw()}))):"select_field"==quickFiltersDivChildren.eq(k).attr("data-div")?ajaxQuickFilters("select_field",quickFiltersDivChildren.eq(k),elementID):"multi_select"==quickFiltersDivChildren.eq(k).attr("data-div")&&ajaxQuickFilters("multi_select",quickFiltersDivChildren.eq(k),elementID)}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function checkGroupViewname(elementID){let prCode=window.location.pathname.split("/")[4],tabHeaderName=$('a[data-toggle="tab"].active.l3items').find("span").text();$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"disable_col_val_multidropdown",elementID:elementID,prCode:prCode,tabHeaderName:tabHeaderName},type:"POST",dataType:"json",success:function(data){for(let[key,value]of Object.entries(data))"no"==value&&($(`#tableTab${elementID}`).find(`select option[value="${key}"]`).attr("disabled",!0),card_name=$(`#${elementID}_tab_content`).find(".card-body.bodyListview").find(".mul_heading").text(),card_name==key&&($(`#${elementID}_tab_content`).find(".card-body.bodyListview").empty(),$(`#${elementID}_tab_content`).find(".card-body.bodyListview").append('<h4 style="font-size: 1.1rem;font-weight: 400;">You do not have access to the view. Please contact your administrator.</h4>')))},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function showtextinput(obj){const elementID=obj.getAttribute("data-elementID");let is_selected;$("#text_basedip_"+elementID).is(":checked")?($(".show_textinput_div_"+elementID).css("display","none"),$("#findlabel"+elementID).parent().css("display","flex"),$("#findlabel"+elementID).css("display","block"),$("#findlistL3"+elementID).css("display","block"),$("#find"+elementID).css("display","block")):($(".show_textinput_div_"+elementID).css("display","flex"),$("#findlabel"+elementID).parent().css("display","none"),$("#findlabel"+elementID).css("display","none"),$("#findlistL3"+elementID).css("display","none"),$("#find"+elementID).css("display","none"))}function multiSelectDatatableInitializer(elementId,columnAlignmentDef=[]){columnAlignmentDef.length||(columnAlignmentDef=[{targets:"_all",className:"dt-center allColumnClass all"}]),$(`#listDetailTable${elementId}`).DataTable({autoWidth:!0,scrollY:"50vh",scrollCollapse:!0,scrollX:"300",orderCellsTop:!0,responsive:!0,colReorder:{fixedColumnsLeft:1},deferRender:!0,paging:!0,lengthMenu:[[1,5,50,-1],[1,5,50,"All"]],stripeClasses:!1,pageLength:50,dom:"lfrtip",sScrollX:"100%",scrollX:!0,buttons:[{extend:"collection",text:"Export",buttons:[{extend:"copy",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"excel",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"csv",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"pdf",title:"",exportOptions:{columns:":visible:not(.noVis)"}}]},{extend:"colvis",className:"scroller"}],columnDefs:columnAlignmentDef})}function displayMultiSelectDetailValues(){var m_col=$(this).attr("data-col"),columnAlignment={};let columnAlignmentDef=[];$(this).attr("data-column-alignment")?(columnAlignment=$(this).attr("data-column-alignment"),columnAlignment=JSON.parse(columnAlignment)):columnAlignmentDef.push({targets:"_all",className:"dt-center allColumnClass all"});var element_id=$(this).attr("data-element-id");if($(this).attr("data-name"))for(let k=0;k<1;k++){let ids=[],bool;try{let opop=JSON.parse($(this).attr("data-name")),rr;for(let i=0;i<$("#formModalListL"+`${element_id}_${m_col}`).find(".ioL").length;i++)rr=$("#masterListTablei"+element_id+"_"+m_col).find("tbody").find("tr").eq(i).find("td").eq(-1).text(),rr=rr.trim(),null!=opop[rr]&&(ids=[...ids,rr]);for(i in bool=!1,ids)Number.isInteger(parseInt(ids[i]))&&(ids[i]=parseInt(ids[i]));let r,coun=0;for(i in ids)if(Number.isInteger(parseInt(ids[i])))for(let j=0;j<=$("#masterListTablei"+element_id+"_"+m_col).find(".ioL").length;j++)r=$("#masterListTablei"+element_id+"_"+m_col).find("tr").eq(j).find("td").eq(-1).text(),r=r.trim(),r==ids[i]&&(coun+=1);coun==ids.length&&(bool=!0)}catch(err){bool=!1}if(bool){lenn=tableTextIndex[element_id+`_${m_col}`].length,tableTextIndex[element_id+`_${m_col}`].splice(0,lenn);for(let i=0;i<=$("#masterListTablei"+element_id+"_"+m_col).find(".ioL").length;i++)for(j in tableText=$("#masterListTablei"+element_id+"_"+m_col).find("tr").eq(i).find("td").eq(-1).text(),ids)ids[j]==tableText&&tableTextIndex[element_id+`_${m_col}`].push(i);$("#showDetailList"+element_id).find("#listDetailTable"+element_id+"_wrappper").remove(),$("#showDetailList"+element_id).find(".card-body").empty(),$("#showDetailList"+element_id).find(".card-body").append(`\n            <table id="listDetailTable${element_id}" style="width:100%" class="row-border display compact">\n              <thead style="width:100%">\n              </thead>\n\n              <tbody>\n\n              </tbody>\n\n            </table>\n            `),$("#listDetailTable"+element_id).find("thead").empty(),$("#listDetailTable"+element_id).find("tbody").empty();var htmlH="<tr>";for(let j=1;j<len[element_id+`_${m_col}`];j++){let d;htmlH+=`<th>${$("#masterListTablei"+element_id+"_"+m_col).find("thead").find("tr").eq(0).find("th").eq(j).text()}</th>`}htmlH+="</tr>",$("#listDetailTable"+element_id).find("thead").append(htmlH);for(let i=0;i<tableTextIndex[element_id+`_${m_col}`].length;i++)if("View Detail"!=$("#example1"+element_id+"_wrapper").find("table").find("tbody").find("tr").eq(i).find("td").eq(index).text()){$("#listDetailTable"+element_id).find("tbody").append("<tr></tr>");let sent=$("#masterListTablei"+element_id+"_"+m_col).find("tr").eq(tableTextIndex[element_id+`_${m_col}`][i]).find("td").eq(1).text();for(let j=1;j<len[element_id+`_${m_col}`];j++)try{if("Default Value"==$("#masterListTablei"+element_id+"_"+m_col).find("tr").eq(0).find("th").eq(j).text().trim()){var c=JSON.parse($(this).attr("data-name"));$("#listDetailTable"+element_id).find("tbody").find("tr").eq(i).append(`<td class = "dt-center allColumnClass all view_details_wrap">${c[$("#masterListTablei"+element_id+"_"+m_col).find("tr").eq(tableTextIndex[element_id+`_${m_col}`][i]).find("td").eq(-1).text().trim()]}</td>`)}else{var c=$("#masterListTablei"+element_id+"_"+m_col).find("tr").eq(tableTextIndex[element_id+`_${m_col}`][i]).find("td").eq(j).text();$("#listDetailTable"+element_id).find("tbody").find("tr").eq(i).append(`<td class = "dt-center allColumnClass all view_details_wrap">${c}</td>`)}}catch(err){}}if($("#showDetailList"+element_id).modal("show"),Object.keys(columnAlignment).length>0){var globalHeader="center",globalContent="center";for(let j=1;j<len[element_id+`_${m_col}`];j++){let k=$("#masterListTablei"+element_id+"_"+m_col).find("thead").find("tr").eq(0).find("th").eq(j).text();var index=j;if(columnAlignment.field_level_config)if(columnAlignment.field_level_config[k])if(columnAlignment.field_level_config[k].header&&columnAlignment.field_level_config[k].header){var header=value.header,content=value.content;columnAlignmentDef.push({targets:[index],className:`dt-head-${header} dt-body-${content} allColumnClass all`})}else columnAlignmentDef.push({targets:[index],className:"dt-head-center dt-body-center allColumnClass all"});else columnAlignmentDef.push({targets:[index],className:"dt-head-center dt-body-center allColumnClass all"});else columnAlignmentDef.push({targets:[index],className:"dt-head-center dt-body-center allColumnClass all"})}}multiSelectDatatableInitializer(element_id,columnAlignmentDef)}}}function buttonGroupingCall(element){$(element).click()}function flowUICreator(elementsArray,container,element_id,data,configs){var count=0;for(let k in elementsArray)"nodes"==elementsArray[k].group&&(elementsArray[k].data.id in configs&&(elementsArray[k].data.text=configs[elementsArray[k].data.id]),count++);if(count>=5&&container.css("height","20rem"),"inside"==configs.shapes_options_text)var styles={shape:configs.shapes_options,label:"data(text)","text-valign":"center","font-size":configs["font-size"],color:configs["font-color"],width:configs.shape_width,height:configs.shape_height,"text-wrap":"wrap","text-max-width":`${String(configs.shape_width)}px`};else var styles={shape:configs.shapes_options,label:"data(text)","font-size":configs["font-size"],color:configs["font-color"],width:configs.shape_width,height:configs.shape_height,"text-wrap":"wrap","text-max-width":`${String(configs.shape_width)}px`};var cy=cytoscape({container:container,zoomingEnabled:!1,userZoomingEnabled:!1,elements:elementsArray,style:[{selector:"node",style:styles},{selector:"edge",style:{width:1}}],layout:{name:"dagre",rankDir:"LR",padding:10,spacingFactor:1.25,fit:!0,nodeDimensionsIncludeLabels:!0,avoidOverlap:!0,pan:{x:200,y:100}}});null!=data?cy.nodes().forEach((function(ele,i,eles){for(let k in data)data[k].element_id==ele.id()&&"Pass"==data[k].current_status&&ele.css("background-color","#4bb543")})):(flag=!0,cy.nodes().forEach((function(ele,i,eles){flag&&ele.css("background-color","#4bb543"),element_id==ele.id()&&(flag=!1)})))}function processDesignDiv(obj){var eleId=$(obj).attr("data-id");if($(obj).parent().parent().find(".processflowdiv").toggleClass("displaynone"),!1===$(obj).parent().parent().find(".processflowdiv").hasClass("displaynone"))if($(obj).prev().find(".stepper-wrapper").empty(),null!=$(obj).attr("data-trans")){if(""!=$(obj).attr("data-trans")){var trans_code=$(obj).attr("data-trans"),flag=!0;trans_code.startsWith("[")?(trans_code=(trans_code=JSON.parse(trans_code))[0],flag=!0):"NULL"==trans_code&&(trans_code="",flag=!1),flag&&$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"fetch_process_flow_model_trans",trans_code:trans_code},type:"POST",dataType:"json",success:function(data){flowUICreator(data.data,$(obj).closest(".modal-body").find(".processflowdiv"),eleId,data.flow,JSON.parse($(obj).attr("data-list")))},failure:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}}else $.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"fetch_process_flow_model_xml",sub_pr_code:$(obj).attr("data-sub-process"),pr_code:$(obj).attr("data-process")},type:"POST",dataType:"json",success:function(data){flowUICreator(data.elements_list,$(obj).closest(".card-body").find(".processflowdiv"),eleId,void 0,JSON.parse($(obj).attr("data-list")))},failure:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}});$(obj).toggleClass("rotate")}function quickFiltersDatableTrigger(elementTabID,obj){null!=$(obj).val()&&null==$(obj).attr("multiple")&&$(obj).attr("data-val",$(obj).val()),$(`#example1${elementTabID}`).DataTable().draw()}function onChangeBoolQuickFilters(obj,id){"no_bool"==id?$(obj).parent().attr("data-val","false"):$(obj).parent().attr("data-val","true"),$(`#example1${$(obj).attr("data-id")}`).DataTable().draw()}function resetAllQuickFilters(obj){var element_id=$(obj).attr("data-id"),mainDiv,divs=$(`#quickFiltersDiv${element_id}`).children();for(let i=0;i<divs.length;i++)"select_field"==$(divs).eq(i).attr("data-div")?($(divs).eq(i).find("select").attr("data-val",""),$(divs).eq(i).find("select").val("").trigger("change")):"multi_select"==$(divs).eq(i).attr("data-div")?$(divs).eq(i).find("select").val("").trigger("change"):"DateField"==$(divs).eq(i).attr("data-div")?($(divs).eq(i).find(".dtrangepicker").attr("data-val",""),$(divs).eq(i).find(".dtrangepicker").val("")):"DateTimeRangeField"==$(divs).eq(i).attr("data-div")?($(divs).eq(i).find(".dttrangepicker").attr("data-val",""),$(divs).eq(i).find(".dttrangepicker").val("")):"TimeField"==$(divs).eq(i).attr("data-div")?"true"==$(divs).eq(i).attr("data-sec")?($(divs).eq(i).find(".ttrangepicker").attr("data-val",""),$(divs).eq(i).find(".ttrangepicker").val("")):($(divs).eq(i).find(".ttrangepicker_sec").attr("data-val",""),$(divs).eq(i).find(".ttrangepicker_sec").val("")):"DateRangeField"==$(divs).eq(i).attr("data-div")?($(divs).eq(i).find(".dtrangepicker").attr("data-val",""),$(divs).eq(i).find(".dtrangepicker").val("")):"DateTimeField"==$(divs).eq(i).attr("data-div")?"true"==$(divs).eq(i).attr("data-sec")?($(divs).eq(i).find(".dttrangepicker").attr("data-val",""),$(divs).eq(i).find(".dttrangepicker").val("")):($(divs).eq(i).find(".dttrangepicker_sec").attr("data-val",""),$(divs).eq(i).find(".dttrangepicker_sec").val("")):"TimeRangeField"==$(divs).eq(i).attr("data-div")?($(divs).eq(i).find(".ttrangepicker").attr("data-val",""),$(divs).eq(i).find(".ttrangepicker").val("")):"range_field"==$(divs).eq(i).attr("data-div")?($(divs).eq(i).find(".js-range-slider").attr("data-val",""),$(divs).eq(i).find(".js-range-slider").data("ionRangeSlider").reset()):"booleanField"==$(divs).eq(i).attr("data-div")&&($(divs).eq(i).find(".radioGroup").attr("data-val",""),$(divs).eq(i).find("input").prop("checked",!1));$(`#example1${$(obj).attr("data-id")}`).DataTable().draw()}function ajaxQuickFilters(field_id,field,element_id){const itemCode=windowLocation.split("/")[4];"range_field"==field_id?$.ajax({url:`/users/${urlPath}/${itemCode}/`,data:{columnName:`${field.find(".js-range-slider").attr("data-column")}`,tableName:`${field.attr("data-table")}`,operation:"quick_filers_columns"},type:"POST",dataType:"json",success:function(data){var maxNo=Math.max(...data.data),minNo=Math.min(...data.data);field.find(".js-range-slider").ionRangeSlider({min:minNo,max:maxNo,prettify_enabled:!0,prettify_separator:",",onFinish:function(data){field.find(".js-range-slider").attr("data-val",field.find(".js-range-slider").val()),$(`#example1${element_id}`).DataTable().draw()}})},error:function(data){Swal.fire({icon:"error",text:"Error! Please try again."})}}):"select_field"==field_id?$.ajax({url:`/users/${urlPath}/${itemCode}/`,data:{columnName:`${field.find("select").attr("data-column")}`,tableName:`${field.attr("data-table")}`,operation:"quick_filers_columns"},type:"POST",dataType:"json",success:function(data){field.find("select").empty(),field.find("select").append("<option value=''disabled selected >Select column</option>");var newData=[...new Set(data.data)];for(let j in newData)field.find("select").append(`<option value='${newData[j]}'>${newData[j]}</option>`)},error:function(data){Swal.fire({icon:"error",text:"Error! Please try again."})}}):"multi_select"==field_id&&$.ajax({url:`/users/${urlPath}/${itemCode}/`,data:{columnName:`${field.find("select").attr("data-column")}`,tableName:`${field.attr("data-table")}`,operation:"quick_filers_columns"},type:"POST",dataType:"json",success:function(data){field.find("select").empty();var newData=[...new Set(data.data)];for(let j in newData)field.find("select").append(`<option value='${newData[j]}'>${newData[j]}</option>`)},error:function(data){Swal.fire({icon:"error",text:"Error! Please try again."})}})}for(let i in element_table_IDList){var quickFiltersDiv=$(`#quickFiltersDiv${element_table_IDList[i]}`);if(quickFiltersDiv.length>0){const itemCode=windowLocation.split("/")[4];var quickFiltersDivChildren=quickFiltersDiv.children();for(let k=0;k<quickFiltersDivChildren.length;k++)"range_field"==quickFiltersDivChildren.eq(k).attr("data-div")?ajaxQuickFilters("range_field",quickFiltersDivChildren.eq(k),element_table_IDList[i]):"DateField"==quickFiltersDivChildren.eq(k).attr("data-div")?(quickFiltersDivChildren.eq(k).find(".dtrangepicker").on("apply.daterangepicker",(function(ev,picker){$(this).val(picker.startDate.format("YYYY-MM-DD")+" - "+picker.endDate.format("YYYY-MM-DD")),$(this).attr("data-val",$(this).val()),$(`#example1${element_table_IDList[i]}`).DataTable().draw()})),quickFiltersDivChildren.eq(k).find(".dtrangepicker").on("cancel.daterangepicker",(function(ev,picker){$(this).val(""),$(this).attr("data-val",$(this).val()),$(`#example1${element_table_IDList[i]}`).DataTable().draw()}))):"DateTimeRangeField"==quickFiltersDivChildren.eq(k).attr("data-div")?(quickFiltersDivChildren.eq(k).find(".dttrangepicker").on("apply.daterangepicker",(function(ev,picker){$(this).val(picker.startDate.format("YYYY-MM-DD HH:mm:ss")+" - "+picker.endDate.format("YYYY-MM-DD HH:mm:ss")),$(this).attr("data-val",$(this).val()),$(`#example1${element_table_IDList[i]}`).DataTable().draw()})),quickFiltersDivChildren.eq(k).find(".dttrangepicker").on("cancel.daterangepicker",(function(ev,picker){$(this).val(""),$(this).attr("data-val",$(this).val()),$(`#example1${element_table_IDList[i]}`).DataTable().draw()}))):"TimeField"==quickFiltersDivChildren.eq(k).attr("data-div")?"true"==quickFiltersDivChildren.eq(k).attr("data-sec")?(quickFiltersDivChildren.eq(k).find(".ttrangepicker").on("apply.daterangepicker",(function(ev,picker){$(this).val(picker.startDate.format("HH:mm:ss")+" - "+picker.endDate.format("HH:mm:ss")),$(this).attr("data-val",$(this).val()),$(`#example1${element_table_IDList[i]}`).DataTable().draw()})),quickFiltersDivChildren.eq(k).find(".ttrangepicker").on("cancel.daterangepicker",(function(ev,picker){$(this).val(""),$(this).attr("data-val",$(this).val()),$(`#example1${element_table_IDList[i]}`).DataTable().draw()}))):(quickFiltersDivChildren.eq(k).find(".ttrangepicker_sec").on("apply.daterangepicker",(function(ev,picker){$(this).val(picker.startDate.format("HH:mm")+" - "+picker.endDate.format("HH:mm")),$(this).attr("data-val",$(this).val()),$(`#example1${element_table_IDList[i]}`).DataTable().draw()})),quickFiltersDivChildren.eq(k).find(".ttrangepicker_sec").on("cancel.daterangepicker",(function(ev,picker){$(this).val(""),$(this).attr("data-val",$(this).val()),$(`#example1${element_table_IDList[i]}`).DataTable().draw()}))):"DateRangeField"==quickFiltersDivChildren.eq(k).attr("data-div")?(quickFiltersDivChildren.eq(k).find(".dtrangepicker").on("apply.daterangepicker",(function(ev,picker){$(this).val(picker.startDate.format("YYYY-MM-DD")+" - "+picker.endDate.format("YYYY-MM-DD")),$(this).attr("data-val",$(this).val()),$(`#example1${element_table_IDList[i]}`).DataTable().draw()})),quickFiltersDivChildren.eq(k).find(".dtrangepicker").on("cancel.daterangepicker",(function(ev,picker){$(this).val(""),$(this).attr("data-val",$(this).val()),$(`#example1${element_table_IDList[i]}`).DataTable().draw()}))):"DateTimeField"==quickFiltersDivChildren.eq(k).attr("data-div")?"true"==quickFiltersDivChildren.eq(k).attr("data-sec")?(quickFiltersDivChildren.eq(k).find(".dttrangepicker").on("apply.daterangepicker",(function(ev,picker){$(this).val(picker.startDate.format("YYYY-MM-DD HH:mm:ss")+" - "+picker.endDate.format("YYYY-MM-DD HH:mm:ss")),$(this).attr("data-val",$(this).val()),$(`#example1${element_table_IDList[i]}`).DataTable().draw()})),quickFiltersDivChildren.eq(k).find(".dttrangepicker").on("cancel.daterangepicker",(function(ev,picker){$(this).val(""),$(this).attr("data-val",$(this).val()),$(`#example1${element_table_IDList[i]}`).DataTable().draw()}))):(quickFiltersDivChildren.eq(k).find(".dttrangepicker_sec").on("apply.daterangepicker",(function(ev,picker){$(this).val(picker.startDate.format("YYYY-MM-DD HH:mm")+" - "+picker.endDate.format("YYYY-MM-DD HH:mm")),$(this).attr("data-val",$(this).val()),$(`#example1${element_table_IDList[i]}`).DataTable().draw()})),quickFiltersDivChildren.eq(k).find(".dttrangepicker_sec").on("cancel.daterangepicker",(function(ev,picker){$(this).val(""),$(this).attr("data-val",$(this).val()),$(`#example1${element_table_IDList[i]}`).DataTable().draw()}))):"TimeRangeField"==quickFiltersDivChildren.eq(k).attr("data-div")?(quickFiltersDivChildren.eq(k).find(".ttrangepicker").on("apply.daterangepicker",(function(ev,picker){$(this).val(picker.startDate.format("HH:mm:ss")+" - "+picker.endDate.format("HH:mm:ss")),$(this).attr("data-val",$(this).val()),$(`#example1${element_table_IDList[i]}`).DataTable().draw()})),quickFiltersDivChildren.eq(k).find(".ttrangepicker").on("cancel.daterangepicker",(function(ev,picker){$(this).val(""),$(this).attr("data-val",$(this).val()),$(`#example1${element_table_IDList[i]}`).DataTable().draw()}))):"select_field"==quickFiltersDivChildren.eq(k).attr("data-div")?ajaxQuickFilters("select_field",quickFiltersDivChildren.eq(k),element_table_IDList[i]):"multi_select"==quickFiltersDivChildren.eq(k).attr("data-div")&&ajaxQuickFilters("multi_select",quickFiltersDivChildren.eq(k),element_table_IDList[i])}}function dropdownContentListView(obj){var row_id=$(obj).parent().parent().closest("tr").find("td").eq(1).text(),value=$(obj).text(),field_name=$(obj).parent().parent("td").closest("table").find("th").eq($(obj).parent().parent().index()).text();row_edited_dict[row_id]?row_edited_dict[row_id][field_name]=value:(row_edited_dict[row_id]={},row_edited_dict[row_id][field_name]=value),$(obj).parent().parent().find(".edit").text($(obj).text()),$(obj).parent().removeClass("show")}function dropdownContentListView_multi_select(obj){values={};for(let i in $(obj).val())values[$(obj).val()[i]]="";$(obj).attr("data-val",JSON.stringify(values))}function embeddedComputeHandler(listViewElementID){var embededComputationBtn=$(`#list_view_edit_modal_${listViewElementID}`).find(".modal-body").find(`#calval_embededComputation_${listViewElementID}`),compjs=$(`#list_view_edit_modal_${listViewElementID}`).find(".modal-body").find(".compjs");if(embededComputationBtn.length>0){var attrdata=$(embededComputationBtn).attr("data-list");const elementId=$(embededComputationBtn).attr("data-elementid");if(""!=attrdata||"{}"!=attrdata){let compModelName="",parsedAttrData=JSON.parse(attrdata),allOkFlag=1,allok="";for(let y in parsedAttrData){compModelName=y;for(let j in parsedAttrData[y])if("auto_trigger"==parsedAttrData[y][j][2]){let tableName=j,valuesDic={},listOfInputs=[],datatypeList=[],compDatatype="";listOfInputs.push(...parsedAttrData[y][j][0]);let lastInput=listOfInputs.slice(-1),okay="no";for(let g in listOfInputs)okay="no",$(`#id_${listOfInputs[g]}_${elementId}`).on("change dp.change",(function(){okay="no";for(let r in listOfInputs)allok="no",allok=""==$(`#id_${listOfInputs[r]}_${elementId}`).val()||null==$(`#id_${listOfInputs[r]}_${elementId}`).val()?"no":"yes";if(okay="yes"==allok?"yes":"no","yes"==okay){for(let i in listOfInputs){allOkFlag=1;let compCol=$(`#id_${listOfInputs[i]}_${elementId}`).attr("id").replace("id_","").replace("_"+elementId,""),compVal=$(`#id_${listOfInputs[i]}_${elementId}`).val();if(""==compVal||null==compVal){allOkFlag=0;break}compDatatype=$(`#id_${listOfInputs[i]}_${elementId}`).attr("datatype"),valuesDic[compCol]="IntegerField"==compDatatype||"BigIntegerField"==compDatatype?parseInt(compVal):"FloatField"==compDatatype?parseFloat(compVal):compVal}datatypeList.push(compDatatype),1==allOkFlag&&$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{element_id:elementId,operation:"calculate_embeded_computation",values_dic:JSON.stringify(valuesDic),datatype_list:JSON.stringify(datatypeList),table_name:JSON.stringify(tableName),compModelName:JSON.stringify(compModelName)},type:"POST",dataType:"json",success:function(context){if("full_output"==parsedAttrData[y][j][3])if("no"==context.error_msg){let data=context.data;"Success"==data.element_error_message?data.output_display_type:Swal.fire({icon:"error",text:data.element_error_message})}else{let error=context.e_list.slice(-1);Swal.fire({icon:"error",text:error})}else if("no"==context.error_msg){for(let k in parsedAttrData[y][j][1])for(let l in context.data.content[0])if(parsedAttrData[y][j][1][k]==l){let targetColumnDataType=$(`#id_${parsedAttrData[y][j][1][k]}_${elementId}`).attr("datatype");"IntegerField"==targetColumnDataType||"BigIntegerField"==targetColumnDataType?$(`#id_${parsedAttrData[y][j][1][k]}_${elementId}`).val(parseInt(context.data.content[0][l])).trigger("change"):"FloatField"==targetColumnDataType?$(`#id_${parsedAttrData[y][j][1][k]}_${elementId}`).val(parseFloat(context.data.content[0][l])).trigger("change"):$(`#id_${parsedAttrData[y][j][1][k]}_${elementId}`).val(context.data.content[0][l]).trigger("change")}}else{let error=context.e_list.slice(-1);Swal.fire({icon:"error",text:error})}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}}))}}}}if(compjs.length>0)for(let i=0;i<compjs.length;i++){let attrdata=$(compjs).attr("data-jsattr");const elementId=$(compjs).attr("id").split("_").pop();if(""!=attrdata||"[]"!=attrdata){let compModelName="",parsedAttrData=JSON.parse(attrdata),allOkFlag=1,allok="";for(let y in parsedAttrData)if("Validation based message"==parsedAttrData[y].parentvalue){let tableName=parsedAttrData[y].table,msg_txt=parsedAttrData[y].msg_text,condition=parsedAttrData[y].finaljsattr[0][0].condition.styleValidation,normal_txt_color=parsedAttrData[y].finaljsattr[0][0].text_color,regex=/\{(\w+)\}/g,result=[],match=[],valuesDic={},datatypeList=[],compDatatype="",eq_model_name=parsedAttrData[y].eqid,curr_col=parsedAttrData[y].finaljsattr[0][0].table_column;for(;match=regex.exec(msg_txt);)result.push(match[1]);let set=new Set(result);result=Array.from(set);let listOfInputs=[];listOfInputs.push(...parsedAttrData[y].compute_fields);let okay="no";for(let g in listOfInputs)okay="no",$(`#id_${listOfInputs[g]}_${elementId}`).on("change",(function(){okay="no";for(let r in listOfInputs)allok="no",allok=""==$(`#id_${listOfInputs[r]}_${elementId}`).val()||null==$(`#id_${listOfInputs[r]}_${elementId}`).val()?"no":"yes";if(okay="yes"==allok?"yes":"no","yes"==okay){for(let i in listOfInputs){allOkFlag=1;let compCol=$(`#id_${listOfInputs[i]}_${elementId}`).attr("id").replace("id_","").replace("_"+elementId,""),compVal=$(`#id_${listOfInputs[i]}_${elementId}`).val();if(""==compVal||null==compVal){allOkFlag=0;break}compDatatype=$(`#id_${listOfInputs[i]}_${elementId}`).attr("datatype"),valuesDic[compCol]=compVal,datatypeList.push(compDatatype)}1==allOkFlag&&$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{element_id:elementId,operation:"computation_js_execute_model",column:curr_col,table_name:tableName,msg_col:JSON.stringify(result),msg_txt:msg_txt,condition:JSON.stringify(condition),eq_model_name:eq_model_name,valuesDic:JSON.stringify(valuesDic),datatypeList:JSON.stringify(datatypeList)},type:"POST",dataType:"json",success:function(data){"Success"==data.error_msg?data.final_msg?($(`#id_${data.column}_${data.element_id}`).parent().find("small").remove(),$(`#id_${data.column}_${data.element_id}`).parent().append(`<small style='color:${normal_txt_color}'>${data.final_msg}</small>`)):($(`#id_${data.column}_${data.element_id}`).parent().find("small").remove(),$(`#id_${data.column}_${data.element_id}`).parent().append(`<small style='color:${normal_txt_color}'>No data found for selected inputs</small>`)):$(`#id_${data.column}_${data.element_id}`).parent().find("small").remove()},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}}))}}}}function approve_ind(){let approveButton=$(this);approveButton.prop("disabled",!0);let tablename=approveButton.attr("data-tablename"),id=approveButton.attr("data-approval_id"),listViewTabElementId=approveButton.attr("data-element-id"),approval_comment=CKEDITOR.instances[`approvalCommentText${listViewTabElementId}`].getData(),approval_type=approveButton.attr("data-approval_type");"approve"==approval_type?$.ajax({url:`/users/${urlPath}/approval_table/`,data:{tableName:tablename,approval_id:id,operation:"approve_ind",type_of_query:"update",edited_data:JSON.stringify(edited_data),approval_comment:approval_comment},type:"POST",dataType:"json",success:function(data){"fail"==data.response?($(`#approvalCommentModal_${listViewTabElementId}`).modal("hide"),Swal.fire({icon:"info",text:`Error approving the records! ${data.error}`}),$(`#approvalWallModal_${elementID}`).modal("hide")):($(`#approvalCommentModal_${listViewTabElementId}`).modal("hide"),$(`#example1${listViewTabElementId}`).DataTable().draw(),Swal.fire({icon:"success",text:"Record approved successfully!"}),$(`#approvalWallModal_${elementID}`).modal("hide")),approveButton.prop("disabled",!1)},error:function(){approveButton.prop("disabled",!1),Swal.fire({icon:"error",text:"Error! Failure in executing selected approval. Please try again."})}}):"reject"==approval_type&&$.ajax({url:`/users/${urlPath}/approval_table/`,data:{tableName:tablename,approval_id:id,operation:"reject_ind",type_of_query:"update",approval_comment:approval_comment},type:"POST",dataType:"json",success:function(data){$(`#approvalCommentModal_${listViewTabElementId}`).modal("hide"),$(`#example1${listViewTabElementId}`).DataTable().draw(),$(`#approvalWallModal_${elementID}`).modal("hide"),Swal.fire({icon:"success",text:"Record rejected successfully!"}),approveButton.prop("disabled",!1)},error:function(){Swal.fire({icon:"error",text:"Error! Failure in executing selected rejection. Please try again."}),approveButton.prop("disabled",!1)}})}function resend_ind(){let approveButton=$(this);approveButton.prop("disabled",!0);let listViewTabElementId=$(this).attr("data-element-id"),approval_comment=CKEDITOR.instances[`approvalCommentText${listViewTabElementId}`].getData(),primaryKeyId=$(this).attr("data-approval_id");$.ajax({url:`/users/${urlPath}/approval_table/`,data:{approval_id:primaryKeyId,operation:"resend_ind",approval_comment:approval_comment},type:"POST",dataType:"json",success:function(data){$(`#approvalCommentModal_${listViewTabElementId}`).modal("hide"),$(`#example1${listViewTabElementId}`).DataTable().draw(),$(`#approvalWallModal_${elementID}`).modal("hide"),Swal.fire({icon:"success",text:"Record send to previous approver for approval!"}),approveButton.prop("disabled",!1)},error:function(){Swal.fire({icon:"error",text:"Error! Failure in sending the transaction back to previous approver(s)."}),approveButton.prop("disabled",!1)}})}function dataCurrentFeed(opts,callback){var matchProperty="username",data=mentions_user_list.filter((function(item){return 0==item.username.indexOf(opts.query.toLowerCase())}));callback(data=data.sort((function(a,b){return a.username.localeCompare(b.username,void 0,{sensitivity:"accent"})})))}function delegateApproval(){let approveButton=$(this);approveButton.prop("disabled",!0);let listViewTabElementId=$(this).attr("data-element-id"),primaryKeyId=$(this).attr("data-approval_id"),delegateTo=$(`#approvalCommentModal_${listViewTabElementId} .modal-body`).find(".delegateApprovalContainer").find("select").val(),delegateToLabel=$(`#approvalCommentModal_${listViewTabElementId} .modal-body`).find(".delegateApprovalContainer").find("select > option:selected").text();if(delegateTo){let approval_comment=CKEDITOR.instances[`approvalCommentText${listViewTabElementId}`].getData();$.ajax({url:`/users/${urlPath}/approval_table/`,data:{approval_id:primaryKeyId,approval_comment:approval_comment,delegate_to:delegateTo,operation:"delegate_approval_action"},type:"POST",dataType:"json",success:function(data){$(`#approvalCommentModal_${listViewTabElementId}`).modal("hide"),$(`#example1${listViewTabElementId}`).DataTable().draw(),$(`#approvalWallModal_${elementID}`).modal("hide"),Swal.fire({icon:"success",text:`Approval decision for the record successfully delegated to ${delegateToLabel}!`}),approveButton.prop("disabled",!1)},error:function(){Swal.fire({icon:"error",text:"Error! Failure in delegating approval actions."}),approveButton.prop("disabled",!1)}})}else Swal.fire({icon:"error",text:"Error! Please select the user to delegate the approval actions to."})}function popoverEdit(){$(document).off("focusin.modal"),$(this).closest(".process_navbar_popover").popover({container:"body",delay:{show:10,hide:0},trigger:"click",html:!0,placement:"left",template:'<div class="popover card" style="z-index:2000;"><div class="arrow"></div><h3 class="popover-header" style="background: #565a5e;color:white;text-align:center"></h3><div class="card-body"</div></div>',html:!0,sanitize:!1,content:function(){$(".popover").find(".card-body").empty();var string='<div class="row" white-space="nowrap">',list=["fas fa-compass","fas fa-atom","fas fa-sitemap","fas fa-highlighter","fas fa-globe","fas fa-paperclip","fas fa-project-diagram","fas fa-print","fas fa-table","fas fa-i-cursor","fas fa-indent","fas fa-list-alt","fas fa-list-ul","\tfas fa-outdent","\tfar fa-building","fas fa-compass","fas fa-globe","fas fa-paperclip","fas fa-project-diagram","fas fa-bullseye","fas fa-calendar","far fa-clipboard","far fa-compass"];let config_=JSON.parse($(this).attr("data-data")),data_value=$(this).attr("data-value"),id_=$(this).closest("td").attr("id"),index=$(this).attr("data-index"),column=$(this).attr("data-column"),id=$(this).attr("data-id"),url_string=window.location.pathname,f_occ=url_string.indexOf("/",url_string.indexOf("/")+1),s_occ=url_string.indexOf("/",url_string.indexOf("/")+f_occ+1),t_occ=url_string.indexOf("/",url_string.indexOf("/")+s_occ+1),app_code2=url_string.substring(f_occ+1,s_occ),current_dev_mode2=url_string.substring(s_occ+1,t_occ),modes=["Build","Edit"],url="";if("Build"!=current_dev_mode2&&"Edit"!=current_dev_mode2&&(current_dev_mode2="User"),"ForeignKey"==config_["data-type"])$.ajax({url:`/users/${app_code2}/${current_dev_mode2}/dynamicVal/`,data:{operation:"ForeignKeyFilter1",model_name:$(this).attr("data-table"),column_name:$(this).attr("data-column"),populate:"yes"},type:"POST",dataType:"json",success:function(data){$(".popover").find(".card-body").empty(),string+='\n            <div class="col-12">\n              <select class="selectize form-control value">';for(const[key,value]of Object.entries(data))string+=`<option value="${parseInt(value)}">${key}</option>`;string+=`</select>\n            </div>\n            <div class="col-12" style="margin-top:7px;">\n              <i data-index="${index}" data-id="${id}" data-column="${column}" name="actions" value="" class="far fa-save ihover javaSC " style="font-size: 14px;margin-left:5px; float:right; cursor:pointer;" onclick="changeValue.call(this,'${id_}')"></i>\n              <i name="actions" value="" class="fas fa-remove ihover javaSC " style="font-size: 14px;margin-left:5px; float:right; cursor:pointer;" onclick="closePopover.call(this,'${id_}')"></i>\n            </div>\n          </div>`,$(".popover").find(".card-body").append(string),$(".popover").find(".card-body").find("select").each((function(){parent=$(this).parent(),$(this).select2({dropdownParent:parent})})),$(".popover").find(".card-body").find(".value").val(parseInt(data_value)).trigger("change")},error:function(){Swal.fire({icon:"error",text:"Error! Failure in fetching data options. Please try again."})}});else if("CharField"==config_["data-type"]){let url_string=window.location.pathname,f_occ=url_string.indexOf("/",url_string.indexOf("/")+1),s_occ=url_string.indexOf("/",url_string.indexOf("/")+f_occ+1),t_occ=url_string.indexOf("/",url_string.indexOf("/")+s_occ+1),app_code2=url_string.substring(f_occ+1,s_occ),current_dev_mode2=url_string.substring(s_occ+1,t_occ),modes=["Build","Edit"],url="";"Build"!=current_dev_mode2&&"Edit"!=current_dev_mode2&&(current_dev_mode2="User"),$.ajax({url:`/users/${app_code2}/${app_code2}/dynamicVal/`,data:{operation:"ChoiceField",model_name:$(this).attr("data-table"),column_name:$(this).attr("data-column"),populate:"yes"},type:"POST",dataType:"json",success:function(data){if("yes"==data.choice){$(".popover").find(".card-body").empty(),string+='\n              <div class="col-12">\n                <select class="selectize form-control value">';for(const i in data.data)string+=`<option value="${data.data[i]}">${data.data[i]}</option>`;string+=`</select>\n              </div>\n              <div class="col-12" style="margin-top:7px;">\n                <i name="actions" data-id="${id}" data-index="${index}" data-column="${column}" value="" class="far fa-save ihover javaSC " style="font-size: 14px;margin-left:5px; float:right; cursor:pointer;" onclick="changeValue.call(this,'${id_}')"></i>\n                <i name="actions" value="" class="fas fa-remove ihover javaSC " style="font-size: 14px;margin-left:5px; float:right; cursor:pointer;" onclick="closePopover.call(this,'${id_}')"></i>\n              </div>\n            </div>`}else string+=`\n              <div class="col-12">\n                <input class="form-control value" value="${data_value}">\n              </div>\n              <div class="col-12" style="margin-top:7px;">\n                <i name="actions" data-id="${id}" data-index="${index}" data-column="${column}" value="" class="far fa-save ihover javaSC " style="font-size: 14px;margin-left:5px; float:right; cursor:pointer;" onclick="changeValue.call(this,'${id_}')"></i>\n                <i name="actions" value="" class="fas fa-remove ihover javaSC " style="font-size: 14px;margin-left:5px; float:right; cursor:pointer;" onclick="closePopover.call(this,'${id_}')"></i>\n              </div>\n            </div>`;$(".popover").find(".card-body").empty(),$(".popover").find(".card-body").append(string),$(".popover").find(".card-body").find("select").each((function(){parent=$(this).parent(),$(this).select2({dropdownParent:parent})})),$(".popover").find(".card-body").find(".value").val(data_value).trigger("change")},error:function(){Swal.fire({icon:"error",text:"Error! Failure in fetching data options. Please try again."})}})}else"FloatField"==config_["data-type"]?(string+=`\n        <div class="col-12">\n          <input type="number" step="0.000000001" class="form-control value" value="${data_value}">\n        </div>\n        <div class="col-12" style="margin-top:7px;">\n          <i name="actions" data-id="${id}" data-index="${index}" data-column="${column}" value="" class="far fa-save ihover javaSC " style="font-size: 14px;margin-left:5px; float:right; cursor:pointer;" onclick="changeValue.call(this,'${id_}')"></i>\n          <i name="actions" value="" class="fas fa-remove ihover javaSC " style="font-size: 14px;margin-left:5px; float:right; cursor:pointer;" onclick="closePopover.call(this,'${id_}')"></i>\n        </div>\n      </div>`,$(".popover").find(".card-body").append(string)):"TextField"==config_["data-type"]||"TextArea"==config_["data-type"]?(string+=`\n        <div class="col-12">\n          <textarea class="form-control value" value="${data_value}"></textarea>\n        </div>\n        <div class="col-12" style="margin-top:7px;">\n          <i name="actions" data-id="${id}" data-index="${index}" data-column="${column}" value="" class="far fa-save ihover javaSC " style="font-size: 14px;margin-left:5px; float:right; cursor:pointer;" onclick="changeValue.call(this,'${id_}')"></i>\n          <i name="actions" value="" class="fas fa-remove ihover javaSC " style="font-size: 14px;margin-left:5px; float:right; cursor:pointer;" onclick="closePopover.call(this,'${id_}')"></i>\n        </div>\n      </div>`,$(".popover").find(".card-body").append(string)):"IntegerField"==config_["data-type"]||"BigIntegerField"==config_["data-type"]?(string+=`\n        <div class="col-12">\n          <input type="number" step=1 class="form-control value" value="${data_value}">\n        </div>\n        <div class="col-12" style="margin-top:7px;">\n          <i name="actions" data-id="${id}" data-index="${index}" data-column="${column}" value="" class="far fa-save ihover javaSC " style="font-size: 14px;margin-left:5px; float:right; cursor:pointer;" onclick="changeValue.call(this,'${id_}')"></i>\n          <i name="actions" value="" class="fas fa-remove ihover javaSC " style="font-size: 14px;margin-left:5px; float:right; cursor:pointer;" onclick="closePopover.call(this,'${id_}')"></i>\n        </div>\n      </div>`,$(".popover").find(".card-body").append(string)):"DateField"==config_["data-type"]?(string+=`\n        <div class="col-12">\n          <input type="date" class="form-control value" value="${data_value}">\n        </div>\n        <div class="col-12" style="margin-top:7px;">\n          <i name="actions" data-id="${id}" data-index="${index}" data-column="${column}" value="" class="far fa-save ihover javaSC " style="font-size: 14px;margin-left:5px; float:right; cursor:pointer;" onclick="changeValue.call(this,'${id_}')"></i>\n          <i name="actions" value="" class="fas fa-remove ihover javaSC " style="font-size: 14px;margin-left:5px; float:right; cursor:pointer;" onclick="closePopover.call(this,'${id_}')"></i>\n        </div>\n      </div>`,$(".popover").find(".card-body").append(string)):"DateTimeField"==config_["data-type"]&&(string+=`\n        <div class="col-12">\n          <input type="date" step="1" class="form-control value" value="${data_value}">\n        </div>\n        <div class="col-12" style="margin-top:7px;">\n          <i name="actions" data-id="${id}" data-index="${index}" data-column="${column}" value="" class="far fa-save ihover javaSC " style="font-size: 14px;margin-left:5px; float:right; cursor:pointer;" onclick="changeValue.call(this,'${id_}')"></i>\n          <i name="actions" value="" class="fas fa-remove ihover javaSC " style="font-size: 14px;margin-left:5px; float:right; cursor:pointer;" onclick="closePopover.call(this,'${id_}')"></i>\n        </div>\n      </div>`,$(".popover").find(".card-body").append(string));"ForeignKey"!=config_["data-type"]&&$(".popover").find(".card-body").val(data_value).trigger("change");let html_mand="";return 0!=config_["data-null"]&&"0"!=config_["data-null"]||(html_mand="<span style='color:red;margin-left:5px;'>*</span>"),$(".popover").find(".popover-header").html(column+html_mand),""}}).on("click",(function(){var self=this;$(this).hasClass("show")?$(this).popover("hide"):$(this).popover("show")}))}function changeValue(id){let index=parseInt($(this).attr("data-index")),column=$(this).attr("data-column"),id_=$(this).attr("data-id");("0"==edited_data[id_][`${column}`]["data-null"]||0==edited_data[id_][`${column}`])&&[void 0,null,""," "].includes($(this).closest(".row").find(".value").val())?Swal.fire({icon:"warning",text:"The value cannot be empty as it is a mandatory field."}):($("#"+id).find("span").text(`${$(this).closest(".row").find(".value").val()}`),$("#"+id).find(".process_navbar_popover").attr("data-value",$(this).closest(".row").find(".value").val()),edited_data[id_][`${column}`].value=$(this).closest(".row").find(".value").val(),$(this).closest(".popover").popover("hide"))}function closePopover(id){$(this).closest(".popover").popover("hide")}function group_by_action_save_user_config(obj){var modal=$(`#group_by_switch_user_configuration_modal_${$(obj).attr("data-id")}`),view_name="";if("Multi Dropdown View"==$(obj).attr("data-template")&&(view_name=$(`#tableTab${$(obj).attr("data-id")}`).find("select").val()),"Approval Template"==$(obj).attr("data-template")){var values;if($(modal).find(".modal-footer").find("button").html('<i class="fa fa-circle-notch fa-spin"></i>'),(values={}).group_by_switch=$(modal).find(`#group_by_action_checkbox_user_config_${$(obj).attr("data-id")}`).prop("checked"),!$(modal).find(`#group_by_action_checkbox_user_config_${$(obj).attr("data-id")}`).prop("checked")){var levels=$(modal).find(".group_by_action_levels").find(".levels");values.levels=[];for(let i=0;i<levels.length;i++){var singleLevel,levelName=(singleLevel=$(modal).find(".group_by_action_levels").find(".levels").eq(i)).find("p").text();values.levels.push($(singleLevel).find("select").val())}values.operations=[];var operation=$(modal).find(".group_by_action_columns").find(".operation_div").find(".operation");for(let k=0;k<operation.length;k++){var singleOperation=$(modal).find(".group_by_action_columns").find(".operation_div").find(".operation").eq(k);values.operations.push($(singleOperation).find("select").val())}values.selected_columns=$(modal).find(".group_by_action_columns").find("select").eq(0).val(),values["data-json-table"]=$(modal).find(".group_by_approval_temp_div").find("select").val()}var element_id=$(obj).attr("data-id").split("__tab__")[0]}else{var values;if($(modal).find(".modal-footer").find("button").html('<i class="fa fa-circle-notch fa-spin"></i>'),(values={}).group_by_switch=$(modal).find(`#group_by_action_checkbox_user_config_${$(obj).attr("data-id")}`).prop("checked"),!$(modal).find(`#group_by_action_checkbox_user_config_${$(obj).attr("data-id")}`).prop("checked")){var levels=$(modal).find(".group_by_action_levels").find(".levels");values.levels=[];for(let i=0;i<levels.length;i++){var singleLevel,levelName=(singleLevel=$(modal).find(".group_by_action_levels").find(".levels").eq(i)).find("p").text();values.levels.push($(singleLevel).find("select").val())}values.operations=[];var operation=$(modal).find(".group_by_action_columns").find(".operation_div").find(".operation");for(let k=0;k<operation.length;k++){var singleOperation=$(modal).find(".group_by_action_columns").find(".operation_div").find(".operation").eq(k);values.operations.push($(singleOperation).find("select").val())}values.selected_columns=$(modal).find(".group_by_action_columns").find("select").eq(0).val()}var element_id=$(obj).attr("data-id").split("__tab__")[0]}$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"update_user_configuration_group_by",values:JSON.stringify(values),table_name:`${$(obj).attr("data-table-name")}`,template:`${$(obj).attr("data-template")}`,view_name:view_name,element_id:element_id,pr_code:windowLocation.split("/")[4]},type:"POST",success:function(data){$(modal).find(".modal-footer").find("button").html("Save"),window.location.reload()},error:()=>{Swal.fire({icon:"error",text:"Error! Please try again."})}})}function group_by_switch_user_configuration(obj){var Id_element=$(obj).attr("data-id");"Multiple table"==$(obj).attr("data-template")&&(Id_element=$(obj).attr("data-modal-id"));var modal=$(`#group_by_switch_user_configuration_modal_${Id_element}`),selectedTable=$(obj).attr("data-table-name");$(modal).find(".group_by_action_levels").find(".levels").remove(),$(modal).find(".group_by_action_columns").find(".operation_div").find(".operation").remove(),$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"reload_user_configuration_group_by",element_id:$(obj).attr("data-id")},type:"POST",success:function(data){var else_trigger=!1;if(""!=data.data){var data_user_config=data.data;$(obj).attr("data-table-name")in data_user_config?($(modal).find(`#group_by_action_checkbox_user_config_${Id_element}`).prop("checked",data_user_config[$(obj).attr("data-table-name")].group_by_switch),data_user_config[$(obj).attr("data-table-name")].group_by_switch?(else_trigger=!0,$(modal).find(".add_level").prop("disabled",!0),$(modal).find(".group_by_action_columns").find("select").eq(0).val([]).trigger("change"),$(modal).find(".group_by_action_columns").find("select").eq(0).prop("disabled",!0),$(modal).find(".group_by_approval_temp_div").find("select").prop("disabled",!0)):$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"fecthing_verbose_name_group_by",template:$(obj).attr("data-template"),model_name:selectedTable},type:"POST",dataType:"json",success:function(data){var else_tag=!1;if("data-json-table"in data_user_config[$(obj).attr("data-table-name")]){var table_list=data.table_list;$(modal).find(".group_by_approval_temp_div").find("select").empty(),$(modal).find(".group_by_approval_temp_div").find("select").append('<option value="">No Table</option>');for(let k in table_list)$(modal).find(".group_by_approval_temp_div").find("select").append(`<option value="${table_list[k]}">${table_list[k]}</option>`);$(modal).find(".group_by_approval_temp_div").find("select").val(data_user_config[$(obj).attr("data-table-name")]["data-json-table"]).trigger("change");var data=data.data,columnOptions="";for(j in data)columnOptions+=`<option data-type="${data[j]["data-type"]}" value="${data[j].originalName}__-ApprovalTable">${data[j].verboseName} -ApprovalTable</option>`;var columnOptions1="";for(j in data)columnOptions1+=`<option data-type="${data[j]["data-type"]}" value="${data[j].originalName}__-ApprovalTable">${data[j].verboseName} -ApprovalTable</option>`;$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"fecthing_verbose_name_group_by",template:$(obj).attr("data-template"),model_name:data_user_config[$(obj).attr("data-table-name")]["data-json-table"]},type:"POST",dataType:"json",success:function(data){var data=data.data;for(j in data)columnOptions+=`<option data-type="${data[j]["data-type"]}" value="${data[j].originalName}__-${data_user_config[$(obj).attr("data-table-name")]["data-json-table"]}">${data[j].verboseName} -${data_user_config[$(obj).attr("data-table-name")]["data-json-table"]}</option>`;for(j in data)columnOptions1+=`<option data-type="${data[j]["data-type"]}" value="${data[j].originalName}__-${data_user_config[$(obj).attr("data-table-name")]["data-json-table"]}">${data[j].verboseName} -${data_user_config[$(obj).attr("data-table-name")]["data-json-table"]}</option>`;var lastCard=$(modal).find(".group_by_action_columns").find("select").eq(0);$(lastCard).empty(),$(lastCard).append(columnOptions1),$(lastCard).select2(),$(lastCard).val(data_user_config[$(obj).attr("data-table-name")].selected_columns).trigger("change");for(let k in data_user_config[$(obj).attr("data-table-name")].operations)$(modal).find(".group_by_action_columns").find(".operation_div").find(".operation").eq(k).find("select").val(data_user_config[$(obj).attr("data-table-name")].operations[k]).trigger("change");var count=0;for(let m in data_user_config[$(obj).attr("data-table-name")].levels){var level2=`<div class="levels">\n                        <p style="font-weight: bold;padding-top:1rem;">Level ${count+1}:</p>\n                        <div class="row">\n                          <div class="col-11">\n                            <select class="select2 form-control"></select>\n                          </div>\n                          <div class="col-1">\n                            <button type="button" class="btn btn-tool" onclick="group_by_remove_content_user_config(this)" data-id="${Id_element}"><i class="fas fa-remove" style="color:var(--primary-color);"></i></button>\n                          </div>\n                        </div>\n                      </div>\n                        `;$(modal).find(".group_by_action_levels").append(level2);var lastCard=$(modal).find(".group_by_action_levels").find(".levels").eq(-1);$(lastCard).find("select").empty(),$(lastCard).find("select").append('<option value="" disabled selected>Select Columns</option>'),$(lastCard).find("select").append(columnOptions),$(lastCard).find("select").each((function(){$(this).select2()})),$(lastCard).find("select").val(data_user_config[$(obj).attr("data-table-name")].levels[m]).trigger("change"),count++}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}else else_tag=!0;if(else_tag){var data=data.data,columnOptions="";for(j in data)columnOptions+=`<option data-type="${data[j]["data-type"]}" value="${data[j].originalName}">${data[j].verboseName}</option>`;var columnOptions1="";for(j in data)columnOptions1+=`<option data-type="${data[j]["data-type"]}" value="${data[j].originalName}">${data[j].verboseName}</option>`;var lastCard=$(modal).find(".group_by_action_columns").find("select").eq(0);$(lastCard).empty(),$(lastCard).append(columnOptions1),$(lastCard).select2(),$(lastCard).val(data_user_config[$(obj).attr("data-table-name")].selected_columns).trigger("change");for(let k in data_user_config[$(obj).attr("data-table-name")].operations)$(modal).find(".group_by_action_columns").find(".operation_div").find(".operation").eq(k).find("select").val(data_user_config[$(obj).attr("data-table-name")].operations[k]).trigger("change");var count=0;for(let m in data_user_config[$(obj).attr("data-table-name")].levels){var level2=`<div class="levels">\n                      <p style="font-weight: bold;padding-top:1rem;">Level ${count+1}:</p>\n                      <div class="row">\n                        <div class="col-11">\n                          <select class="select2 form-control"></select>\n                        </div>\n                        <div class="col-1">\n                          <button type="button" class="btn btn-tool" onclick="group_by_remove_content_user_config(this)" data-id="${Id_element}"><i class="fas fa-remove" style="color:var(--primary-color);"></i></button>\n                        </div>\n                      </div>\n                    </div>\n                      `;$(modal).find(".group_by_action_levels").append(level2);var lastCard=$(modal).find(".group_by_action_levels").find(".levels").eq(-1);$(lastCard).find("select").empty(),$(lastCard).find("select").append('<option value="" disabled selected>Select Columns</option>'),$(lastCard).find("select").append(columnOptions),$(lastCard).find("select").each((function(){$(this).select2()})),$(lastCard).find("select").val(data_user_config[$(obj).attr("data-table-name")].levels[m]).trigger("change"),count++}}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})):$(`#tableTab${$(obj).attr("data-id")}`).find("select").val()in data_user_config?($(modal).find(`#group_by_action_checkbox_user_config_${Id_element}`).prop("checked",data_user_config[$(`#tableTab${$(obj).attr("data-id")}`).find("select").val()].group_by_switch),data_user_config[$(`#tableTab${$(obj).attr("data-id")}`).find("select").val()].group_by_switch?(else_trigger=!0,$(modal).find(".add_level").prop("disabled",!0),$(modal).find(".group_by_action_columns").find("select").eq(0).val([]).trigger("change"),$(modal).find(".group_by_action_columns").find("select").eq(0).prop("disabled",!0)):$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"fecthing_verbose_name_group_by",template:$(obj).attr("data-template"),model_name:selectedTable},type:"POST",dataType:"json",success:function(data){var data=data.data,columnOptions="";for(j in data)columnOptions+=`<option data-type="${data[j]["data-type"]}" value="${data[j].originalName}">${data[j].verboseName}</option>`;var columnOptions1="";for(j in data)columnOptions1+=`<option data-type="${data[j]["data-type"]}" value="${data[j].originalName}">${data[j].verboseName}</option>`;var lastCard=$(modal).find(".group_by_action_columns").find("select").eq(0);$(lastCard).empty(),$(lastCard).append(columnOptions1),$(lastCard).select2(),$(lastCard).val(data_user_config[$(`#tableTab${$(obj).attr("data-id")}`).find("select").val()].selected_columns).trigger("change");for(let k in data_user_config[$(`#tableTab${$(obj).attr("data-id")}`).find("select").val()].operations)$(modal).find(".group_by_action_columns").find(".operation_div").find(".operation").eq(k).find("select").val(data_user_config[$(`#tableTab${$(obj).attr("data-id")}`).find("select").val()].operations[k]).trigger("change");var count=0;for(let m in data_user_config[$(`#tableTab${$(obj).attr("data-id")}`).find("select").val()].levels){var level2=`<div class="levels">\n                  <p style="font-weight: bold;padding-top:1rem;">Level ${count+1}:</p>\n                  <div class="row">\n                    <div class="col-11">\n                      <select class="select2 form-control"></select>\n                    </div>\n                    <div class="col-1">\n                      <button type="button" class="btn btn-tool" onclick="group_by_remove_content_user_config(this)" data-id="${Id_element}"><i class="fas fa-remove" style="color:var(--primary-color);"></i></button>\n                    </div>\n                  </div>\n                </div>\n                  `;$(modal).find(".group_by_action_levels").append(level2);var lastCard=$(modal).find(".group_by_action_levels").find(".levels").eq(-1);$(lastCard).find("select").empty(),$(lastCard).find("select").append('<option value="" disabled selected>Select Columns</option>'),$(lastCard).find("select").append(columnOptions),$(lastCard).find("select").each((function(){$(this).select2()})),$(lastCard).find("select").val(data_user_config[$(`#tableTab${$(obj).attr("data-id")}`).find("select").val()].levels[m]).trigger("change"),count++}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})):else_trigger=!0}else else_trigger=!0;else_trigger&&$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"fecthing_verbose_name_group_by",template:$(obj).attr("data-template"),model_name:selectedTable},type:"POST",dataType:"json",success:function(data){var columnOptions="",tableList=data.table_list,data=data.data;for(j in data)columnOptions+=`<option data-type="${data[j]["data-type"]}" value="${data[j].originalName}">${data[j].verboseName}</option>`;var lastCard=$(modal).find(".group_by_action_columns").find("select").eq(0);if($(lastCard).empty(),$(lastCard).append(columnOptions),$(lastCard).select2(),$("Approval Template"==$(obj).attr("data-template"))){$(modal).find(".group_by_approval_temp_div").find("select").empty(),$(modal).find(".group_by_approval_temp_div").find("select").append('<option value="">No table</option>');for(let n in tableList)$(modal).find(".group_by_approval_temp_div").find("select").append(`<option value="${tableList[n]}">${tableList[n]}</option>`)}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})},error:()=>{Swal.fire({icon:"error",text:"Error! Please try again."})}}),$(modal).find("select").each((function(){$(this).select2()})),$(modal).modal("show"),$(modal).find(".group_by_approval_temp_div").find("select").on("select2:select",(function(){var obj1=this,elementID=$(obj1).attr("data-id"),modal=$(`#group_by_switch_user_configuration_modal_${elementID}`);""!=$(this).val()?$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"fecthing_verbose_name_group_by",template:$(obj1).attr("data-template"),model_name:"ApprovalTable"},type:"POST",dataType:"json",success:function(data){var columnOptions="",data=data.data;for(j in data)columnOptions+=`<option data-type="${data[j]["data-type"]}" value="${data[j].originalName}__-ApprovalTable">${data[j].verboseName} -ApprovalTable</option>`;$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"fecthing_verbose_name_group_by",template:$(obj1).attr("data-template"),model_name:$(obj1).val()},type:"POST",dataType:"json",success:function(data){var lastCard=$(modal).find(".group_by_action_columns").find("select").eq(0),data=data.data;for(j in data)columnOptions+=`<option data-type="${data[j]["data-type"]}" value="${data[j].originalName}__-${$(obj1).val()}">${data[j].verboseName} -${$(obj1).val()}</option>`;if($(lastCard).empty(),$(lastCard).append(columnOptions),$(lastCard).select2(),null!=$(obj1).attr("data-list")){var data_list=JSON.parse($(obj1).attr("data-list"));$(lastCard).val(data_list.selected_columns).trigger("change");var count=$(modal).find(".group_by_action_levels").find(".levels").length;for(let i in data_list.levels){var level2=`<div class="levels">\n                    <p style="font-weight: bold;padding-top:1rem;">Level ${parseInt(count)+1}:</p>\n                    <div class="row">\n                      <div class="col-11">\n                        <select class="select2 form-control"></select>\n                      </div>\n                      <div class="col-1">\n                        <button type="button" class="btn btn-tool" onclick="group_by_remove_content(this)"><i class="fas fa-remove" style="color:var(--primary-color);"></i></button>\n                      </div>\n                    </div>\n                    </div>\n                    `;$(modal).find(".group_by_action_levels").append(level2);var lastCard1=$(modal).find(".group_by_action_levels").find(".levels").eq(-1);$(lastCard1).find("select").empty(),$(lastCard1).find("select").append('<option value="" disabled selected>Select Columns</option>'),$(lastCard1).find("select").append(columnOptions),$(lastCard1).find("select").each((function(){$(this).select2()})),$(lastCard1).find("select").val(data_list.levels[i]).trigger("change"),count++}for(let k in data_list.operations)$("#group_by_action").find(".group_by_action_columns").find(".operation_div").find(".operation").eq(k).find("select").val(data_list.operations[k]).trigger("change")}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}}):$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"fecthing_verbose_name_group_by",template:$(obj1).attr("data-template"),model_name:"ApprovalTable"},type:"POST",dataType:"json",success:function(data){var columnOptions="",data=data.data;for(j in data)columnOptions+=`<option data-type="${data[j]["data-type"]}" value="${data[j].originalName}">${data[j].verboseName}</option>`;var lastCard=$(modal).find(".group_by_action_columns").find("select").eq(0);$(lastCard).empty(),$(lastCard).append(columnOptions),$(lastCard).select2()},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}))}function group_by_action_checkbox_onchange_user_config(obj){var modal=$(`#group_by_switch_user_configuration_modal_${$(obj).attr("data-id")}`);$(obj).prop("checked")?($(modal).find(".add_level").prop("disabled",!0),$(modal).find(".group_by_action_levels").find(".levels").remove(),$(modal).find(".group_by_action_columns").find(".operation_div").find(".operation").remove(),$(modal).find(".group_by_action_columns").find(".operation_div").find("select").eq(0).val([]).trigger("change"),$(modal).find(".group_by_action_columns").find("select").eq(0).prop("disabled",!0),$(modal).find(".group_by_approval_temp_div").find("select").prop("disabled",!0)):($(modal).find(".add_level").prop("disabled",!1),$(modal).find(".group_by_action_columns").find("select").eq(0).val([]).trigger("change"),$(modal).find(".group_by_action_columns").find("select").eq(0).prop("disabled",!1),$(modal).find(".group_by_approval_temp_div").find("select").prop("disabled",!1))}function group_by_action_add_levels_user_config(obj){var modal=$(`#group_by_switch_user_configuration_modal_${$(obj).attr("data-id")}`),count=$(modal).find(".group_by_action_levels").find(".levels").length,level2=`<div class="levels">\n    <p style="font-weight: bold;padding-top:1rem;">Level ${count+1}:</p>\n    <div class="row">\n      <div class="col-11">\n        <select class="select2 form-control"></select>\n      </div>\n      <div class="col-1">\n        <button type="button" class="btn btn-tool" onclick="group_by_remove_content_user_config(this)" data-id="${$(obj).attr("data-id")}"><i class="fas fa-remove" style="color:var(--primary-color);"></i></button>\n      </div>\n    </div>\n  </div>\n    `;if(count>=5)Swal.fire({text:"Max levels can be only 5",icon:"warning"});else{var selectedTable=$(obj).attr("data-table-name");$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"fecthing_verbose_name_group_by",template:$(obj).attr("data-template"),model_name:selectedTable},type:"POST",dataType:"json",success:function(data){if($(modal).find(".group_by_approval_temp_div").find("select").length>0&&""!=$(modal).find(".group_by_approval_temp_div").find("select").val()){$(modal).find(".group_by_action_levels").append(level2);var data=data.data;for(j in data)columnOptions+=`<option data-type="${data[j]["data-type"]}" value="${data[j].originalName}__-${selectedTable}">${data[j].verboseName} -${selectedTable}</option>`;var lastCard=$(modal).find(".group_by_action_levels").find(".levels").eq(-1);$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"fecthing_verbose_name_group_by",template:$(obj).attr("data-template"),model_name:$(modal).find(".group_by_approval_temp_div").find("select").val()},type:"POST",dataType:"json",success:function(data){var data=data.data;for(j in data)columnOptions+=`<option data-type="${data[j]["data-type"]}" value="${data[j].originalName}__-${$(modal).find(".group_by_approval_temp_div").find("select").val()}">${data[j].verboseName} -${$(modal).find(".group_by_approval_temp_div").find("select").val()}</option>`;$(lastCard).find("select").empty(),$(lastCard).find("select").append('<option value="" disabled selected>Select Columns</option>'),$(lastCard).find("select").append(columnOptions),$(lastCard).find("select").each((function(){$(this).select2()}))},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}else{var columnOptions="";$(modal).find(".group_by_action_levels").append(level2);var data=data.data;for(j in data)columnOptions+=`<option data-type="${data[j]["data-type"]}" value="${data[j].originalName}">${data[j].verboseName}</option>`;var lastCard=$(modal).find(".group_by_action_levels").find(".levels").eq(-1);$(lastCard).find("select").empty(),$(lastCard).find("select").append('<option value="" disabled selected>Select Columns</option>'),$(lastCard).find("select").append(columnOptions),$(lastCard).find("select").each((function(){$(this).select2()}))}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}}function group_by_action_reset_user_config(obj){var modal=$(`#group_by_switch_user_configuration_modal_${$(obj).attr("data-id")}`);$(modal).find(".group_by_action_levels").find(".levels").remove(),$(modal).find(".group_by_action_columns").find(".operation_div").find(".operation").remove(),$(modal).find(".group_by_action_columns").find("select").eq(0).val([]).trigger("change")}function group_by_action_columns_operation_user_config(obj){var modal=$(`#group_by_switch_user_configuration_modal_${$(obj).attr("data-id")}`),dict_a={};$(modal).find(".group_by_action_columns").find(".operation_div").find(".operation").each((function(){dict_a[$(this).find("p").attr("data-list")]=$(this).find("select").val()})),$(modal).find(".group_by_action_columns").find(".operation_div").find(".operation").remove();var value=$(obj).val(),optionvalues=[];if(value.length>0){for(let k in value){var columnOptions="",seldatatype=$(modal).find(".group_by_action_columns").find("select").eq(0).find(`option[value='${value[k]}']`).attr("data-type");"IntegerField"!==seldatatype&&"BigIntegerField"!==seldatatype&&"FloatField"!==seldatatype&&"AutoField"!==seldatatype?optionvalues=["Count","Count Distinct","First","Last","Earliest","Latest","Value"]:"IntegerField"!==seldatatype&&"BigIntegerField"!==seldatatype&&"FloatField"!==seldatatype&&"AutoField"!==seldatatype||(optionvalues=["Sum","Count","Count Distinct","Average","Skewness","Kurtosis","Median","Variance","Standard Deviation","Minimum","Maximum","Percentage of Total","Value"]);for(let i in optionvalues)columnOptions+=`\n        <option value="${optionvalues[i]}">${optionvalues[i]}</option>\n        `;var operation=`<div class="operation">\n        <p style="font-weight: bold;padding-top:1rem;" data-list="${value[k]}">Operation - ${$(modal).find(".group_by_action_columns").find("select").eq(0).find(`option[value='${value[k]}']`).text()}:</p>\n        <select class="select2 form-control">\n          <option value="----">----</option>\n          ${columnOptions}\n        </select>\n      </div>\n      `;$(modal).find(".group_by_action_columns").find(".operation_div").append(operation)}$(modal).find(".group_by_action_columns").find(".operation_div").find(".operation").each((function(){dict_a.hasOwnProperty($(this).find("p").attr("data-list"))&&$(this).find("select").val(dict_a[$(this).find("p").attr("data-list")]).trigger("change")}))}$(modal).find(".group_by_action_columns").find(".operation_div").find(".operation").find("select").each((function(){$(this).select2()}))}function group_by_remove_content_user_config(obj){var modal=$(`#group_by_switch_user_configuration_modal_${$(obj).attr("data-id")}`);$(obj).closest(".levels").remove();var count=0;$(modal).find(".group_by_action_levels").find(".levels").each((function(){count++,$(this).find("p").text(`Level ${count}`)}))}function validateUploadedFileLV(file){return!0}function formFileUploadHandlerLV(fileInputRawId,existingFiles={}){$(`#id_${fileInputRawId}`).on("click",()=>{$(this).closest(".btn-outline-secondary").trigger("click")});var fileInputId=fileInputRawId+"_upload_input",uploadedFileDropElement=document.getElementById(fileInputId).closest(".file-upload-wrapper"),uploadedFileContainerElement=$(`#${fileInputRawId}_upload_modal`).find(".uploaded-files-gallery"),uploadedFilesFormData=new FormData;function addUploadedFilehandler(file,container){uploadedFilesFormData.append(file.name,file),container.append(`\n    <li class="list-group-item d-flex justify-content-between align-items-center">\n      ${file.name}\n      <span class="badge previewUploadedFile" style="margin-right:0;margin-left:auto;" data-file-name="${file.name}"><a href='${URL.createObjectURL(file)}' target="_blank"><i class="fas fa-eye fa-2x"></i></a></span>\n      <span class="badge downloadUploadedFile" style="margin-right:0;" data-file-name="${file.name}"><a href='${URL.createObjectURL(file)}' target="_blank" download="${file.name}"><i class="fas fa-download fa-2x"></i></a></span>\n      <span class="badge removeUploadedFile" data-file-name="${file.name}"><i class="fas fa-trash-alt fa-2x" style="color:red;"></i></span>\n    </li>\n    `),container.find(".list-group-item").eq(-1).find(".removeUploadedFile").on("click",(function(){uploadedFilesFormData.delete($(this).attr("data-file-name")),$(this).parent().remove(),0==container.find(".list-group-item").length&&$(`#${fileInputId}`).val("")}))}if(uploadedFilesFormData.append("operation","saveUploadedFiles"),uploadedFileDropElement.addEventListener("dragover",(function(e){e.preventDefault()})),uploadedFileDropElement.addEventListener("dragleave",(function(e){e.preventDefault()})),$(`#${fileInputId}`).on("change",(function(e){if(e.target.files.length){var uploadedFiles=e.target.files;for(upf of uploadedFiles)validateUploadedFileLV(upf)?addUploadedFilehandler(upf,uploadedFileContainerElement):Swal.fire({icon:"error",text:`Error! ${upf.name} does not conform to the field input rules.`})}})),uploadedFileDropElement.addEventListener("drop",(function(e){if(e.preventDefault(),e.dataTransfer.files.length){var uploadedFiles=e.dataTransfer.files;for(upf of uploadedFiles)validateUploadedFileLV(upf)?addUploadedFilehandler(upf,uploadedFileContainerElement):Swal.fire({icon:"error",text:`Error! ${upf.name} does not conform to the field input rules.`})}})),$(`#${fileInputRawId}_upload_modal`).find("button.resetUploadedFiles").on("click",(function(){for(const key of uploadedFilesFormData.keys())"operation"!==key&&uploadedFilesFormData.delete(key);uploadedFileContainerElement.empty(),$(`#${fileInputId}`).val(""),$(`#id_${fileInputRawId}`).val("").trigger("change")})),$(`#${fileInputRawId}_upload_modal`).find("button.closeUploadedFiles").on("click",(function(){$(`#${fileInputRawId}_upload_modal`).modal("hide")})),$(`#${fileInputRawId}_upload_modal`).find("button.saveUploadedFiles").on("click",(function(){var uploadedFileString="";uploadedFileContainerElement.find("li").each((function(){uploadedFileString+=$(this).text().trim(),uploadedFileString+=", "})),uploadedFileString=uploadedFileString.replace(/, $/,""),$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:uploadedFilesFormData,type:"POST",cache:!1,contentType:!1,processData:!1,success:function(data){"file_invalid"==data.msg?(Swal.fire({text:"Incorrect file uploaded.",icon:"error"},$(".removeUploadedFile").trigger("click")),$(`#${fileInputRawId}_upload_modal`).modal("hide"),uploadSaveButtonElement.prop("disabled",!1),$(`#id_${fileInputRawId}`).val("").trigger("change")):($(`#${fileInputRawId}_upload_modal`).modal("hide"),$(`#id_${fileInputRawId}`).val(uploadedFileString).trigger("change"))},error:()=>{Swal.fire({icon:"error",text:"Error! Please try again."})}})})),Object.keys(existingFiles).length)for(key of Object.keys(existingFiles))uploadedFileContainerElement.append(`\n      <li class="list-group-item d-flex justify-content-between align-items-center">\n        ${key}\n        <span class="badge previewUploadedFile" style="margin-right:0; margin-left:auto;" data-file-name="${key}"><a href='/media/uploaded_files/${key}' target="_blank"><i class="fas fa-eye fa-2x"></i></a></span>\n        <span class="badge downloadUploadedFile" style="margin-right:0;" data-file-name="${key}"><a href='/media/uploaded_files/${key}' target="_blank" download="${key}"><i class="fas fa-download fa-2x"></i></a></span>\n        <span class="badge removeUploadedFile" data-file-name="${key}"><i class="fas fa-trash-alt fa-2x" style="color:red;"></i></span>\n      </li>\n      `)}function viewDetailOnModalTableFunc(elementID){$("#"+elementID+"_tab_content").find("#viewDetailOnModalTable").DataTable({autoWidth:!0,scrollY:"50vh",scrollCollapse:!0,scrollX:"300",order:[],orderCellsTop:!0,responsive:!0,colReorder:{fixedColumnsLeft:1},deferRender:!0,paging:!0,lengthMenu:[[1,5,50,-1],[1,5,50,"All"]],stripeClasses:!1,pageLength:50,dom:"lfBrtip",sScrollX:"100%",buttons:[{extend:"collection",text:"Export",buttons:[{extend:"copy",title:"",exportOptions:{}},{extend:"excel",title:"",exportOptions:{}},{extend:"csv",title:"",exportOptions:{}},{extend:"pdf",title:"",exportOptions:{}}]}],columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"},{targets:0,width:"20%",className:"noVis"}]})}function viewDetailTableFuncBase(elementID){$("#listDetailTable"+elementID).DataTable({autoWidth:!0,scrollY:"50vh",scrollCollapse:!0,scrollX:"300",orderCellsTop:!0,responsive:!0,colReorder:{fixedColumnsLeft:1},deferRender:!0,paging:!0,lengthMenu:[[1,5,50,-1],[1,5,50,"All"]],stripeClasses:!1,pageLength:50,dom:"lfBrtip",sScrollX:"100%",buttons:[{extend:"collection",text:"Export",buttons:[{extend:"copy",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"excel",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"csv",title:"",exportOptions:{columns:":visible:not(.noVis)"}},{extend:"pdf",title:"",exportOptions:{columns:":visible:not(.noVis)"}}]},{extend:"colvis",className:"scroller"}],columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"},{targets:0,width:"20%",className:"noVis"}]})}function serverSideDataSearch(fieldName,blockElementId){let fieldIdentifier=`id_${fieldName}_${blockElementId}`,tableIdentifier=`id_${fieldName}_${blockElementId}_serverside_table`,fieldObject=$(`#${fieldIdentifier}`),tableObject=$(`#${tableIdentifier}`),pageLength=fieldObject.attr("data-serverside-page-length");pageLength=Number(pageLength);let dataType=fieldObject.attr("data-type"),fetchConfig={},isMultiSelect=!1;if("ForeignKey"==dataType){let sourceModelName=fieldObject.attr("data-tablename"),sourceFieldName=fieldObject.attr("name"),conditionObject={};if(fieldObject.attr("data-jsattr")){var jsAttrArray=JSON.parse(fieldObject.attr("data-jsattr"));for(let i=0;i<jsAttrArray.length;i++)if("Foreign-key-relation"==jsAttrArray[i].parentvalue&&jsAttrArray[i].finaljsattr[2][0].hasOwnProperty("condition")&&cases(jsAttrArray[i],blockElementId)){conditionObject=jsAttrArray[i].finaljsattr[2][0].condition;break}}fetchConfig.type="foreignkey",fetchConfig.field_config={model_name:sourceModelName,field_name:sourceFieldName,condition:conditionObject}}else if("MultiselectField"==fieldObject.attr("data-fieldType")){isMultiSelect=!0;let modelName=fieldObject.attr("name").replace(`__${fieldName}`,"");fetchConfig.type="multi-select",fetchConfig.field_config={model_name:modelName,field_name:fieldName}}else if(fieldObject.attr("data-jsattr")){let conditionObject={},sourceModelName=fieldObject.attr("data-table"),sourceFieldName=fieldObject.attr("data-column");var jsAttrArray=JSON.parse(fieldObject.attr("data-jsattr"));for(let i=0;i<jsAttrArray.length;i++)if("Foreign-key-relation"==jsAttrArray[i].parentvalue&&jsAttrArray[i].finaljsattr[2][0].hasOwnProperty("condition")&&cases(jsAttrArray[i],blockElementId)){conditionObject=jsAttrArray[i].finaljsattr[2][0].condition;break}fetchConfig.type="js-foreignkey",fetchConfig.field_config={model_name:sourceModelName,field_name:sourceFieldName,condition:conditionObject}}$.fn.dataTable.isDataTable(`#${tableIdentifier}`)&&tableObject.DataTable().clear().destroy();var table=tableObject.DataTable({scrollY:"50vh",scrollCollapse:!0,scrollX:"120%",sScrollX:"120%",serverSide:!0,ordering:!1,orderCellsTop:!0,responsive:!0,select:!0,colReorder:{fixedColumnsLeft:1},stateSave:!1,deferRender:!0,paging:!0,pageLength:pageLength,bLengthChange:!1,dom:"lfrtip",buttons:[],ajax:{url:`${window.location.pathname}serverside_search/`,type:"POST",data:function(d,settings){return d.fetch_config=JSON.stringify(fetchConfig),d.searchValue=$(`#${tableIdentifier}_filter input`).val(),d}},columns:[{data:null,defaultContent:"",className:"select-checkbox",orderable:!1},{data:fieldName,title:fieldName}],columnDefs:[{targets:"_all",width:"2%",className:"dt-left allColumnClass all"},{targets:0,orderable:!1,className:"select-checkbox",render:function(data,type,full,meta){let content="";return content=isMultiSelect?`<input type="checkbox" class="big_data_select_checkbox" data-row-id="${full.id}" data-value="${full[fieldName]}">`:'<input type="checkbox" class="big_data_select_checkbox">',content+="\n          <style>\n            .big_data_select_checkbox {\n              position: relative;\n              cursor: pointer;\n              accent-color: var(--primary-color);\n              transform: scale(1.05);\n            }\n            .big_data_select_checkbox::before {\n                content: '';\n                position: absolute;\n                left: 1.2px;\n                top: 1.2px;\n                width: 11px;\n                height: 11px;\n                border: 0px solid #838383;\n                border-radius: 0.8px;\n                background-color: transparent;\n            }\n            .big_data_select_checkbox:hover::before {\n                background-color: #f8f9fa;\n            }\n            .big_data_select_checkbox:checked::before {\n                accent-color: var(--primary-color);\n            }\n            .big_data_select_checkbox:checked:hover::before {\n                background-color: transparent;\n            }\n          </style>",content}}],select:{style:"os",selector:"td:first-child"}}).columns.adjust();let selectecValuesMS={},selectecValue=[];$(`#${tableIdentifier}`).on("change",".big_data_select_checkbox",(function(){if(isMultiSelect)if($(this).is(":checked")){var value=$(this).attr("data-value");selectecValuesMS[$(this).attr("data-row-id")]="",selectecValue.push(value)}else{delete selectecValuesMS[$(this).attr("data-row-id")];var index=selectecValue.indexOf(value);index>-1&&selectecValue.splice(index,1)}else{if($(this).is(":checked")){var value=$(this).closest("td").next("td").text();$(`#${fieldIdentifier} > option[value='${value}']`).length>0?$(`#${fieldIdentifier}`).val(value).trigger("change"):($(`#${fieldIdentifier}`).append(`<option value="${value}" selected>${value}</option>`),$(`#${fieldIdentifier}`).select2().trigger("change"))}$(`#${fieldIdentifier}_serverside_modal`).modal("hide")}})),isMultiSelect&&$(`#${fieldIdentifier}_serverside_save`).off("click").on("click",(function(){$(`#${fieldIdentifier}`).val(JSON.stringify(selectecValuesMS)).trigger("change");let connectecSelectTag=$(`#${fieldIdentifier}`).attr("data-connectedselectfield");for(let i=0;i<selectecValue.length;i++){const element=selectecValue[i];$(`#${connectecSelectTag}`).append(`<option value="${element}" selected>${element}</option>`)}$(`#${connectecSelectTag}`).select2().trigger("change"),$(`#${fieldIdentifier}_serverside_modal`).modal("hide")}))}function expandComments(){var comment_id=$(this).closest(".approval_comment_card").parent().attr("id").split("approval_comment_")[1];$(this).closest(".approval_card.approval_comment").find(".reply_comment_card").slideDown(),$(this).closest(`#approvalWallModalBody_${elementID}`).length>0&&(resolved_ind_comments_list.includes(comment_id)||$(this).closest(".approval_card.approval_comment").find(".comment_status_ind").hasClass("resolved_comment")||freeze_comments_option)||$(this).closest(".approval_card.approval_comment").find(".reply-area").slideDown(),$(this).html('<i class="fas fa-chevron-circle-up"></i>'),$(this).attr("class","rollup_comments"),$(this).attr("data-toggle","tooltip"),$(this).attr("title","Rollup comment thread"),$(".rollup_comments").off("click").on("click",rollUpComments)}function rollUpComments(){$(this).closest(".approval_card.approval_comment").find(".reply_comment_card,.reply-area").slideUp(),$(this).html('<i class="fas fa-chevron-circle-down"></i>'),$(this).attr("class","expand_comments"),$(this).attr("data-toggle","tooltip"),$(this).attr("title","Expand comment thread"),$(".expand_comments").off("click").on("click",expandComments)}function expand_rollup_comments(modalElement){var comment_threads_count;if(1==$(`#${modalElement}${elementID}`).find(`.approval_outer_${elementID}`).find(".approval_card.approval_comment").length){let comment_reply_cards;if($(`#${modalElement}${elementID}`).find(`.approval_outer_${elementID}`).find(".approval_card.approval_comment").find(".reply_comment_card").length>=2){$(`#${modalElement}${elementID}`).find(`.approval_outer_${elementID}`).find(".approval_card.approval_comment").find(".reply_comment_card,.reply-area").slideUp();let span_html='<span class="expand_comments" data-toggle="tooltip" title="Expand comment thread"><i class="fas fa-chevron-circle-down"></i></span>';$(`#${modalElement}${elementID}`).find(`.approval_outer_${elementID}`).find(".approval_card.approval_comment").find(".approval_comment_card:not(.reply_comment_card)").find(".approval_info").prepend(span_html)}}else $(`#${modalElement}${elementID}`).find(`.approval_outer_${elementID}`).find(".approval_card.approval_comment").each((function(){let comment_reply_cards;if($(this).find(".reply_comment_card").length>=1){$(this).find(".reply_comment_card,.reply-area").slideUp();let span_html='<span class="expand_comments" data-toggle="tooltip" title="Expand comment thread"><i class="fas fa-chevron-circle-down"></i></span>';$(this).find(".approval_comment_card:not(.reply_comment_card)").find(".approval_info").prepend(span_html)}}));$(".expand_comments").off("click").on("click",expandComments),$(".rollup_comments").off("click").on("click",rollUpComments)}function getFormattedName(data){if(data.includes("first_name")&&data.includes("last_name")&&data.includes("username")&&data.includes("email")){const fullName=[data.includes("first_name")?"{first_name}":"",data.includes("last_name")?"{last_name}":""].join(" "),username=[data.includes("username")?"{username}":""],email=[data.includes("email")?"{email}":""];return`${fullName} <br> <span style="font-size: 80%">${username}, ${email}</span>`}if(data.includes("first_name")||data.includes("last_name")){const fullName=[data.includes("first_name")?"{first_name}":"",data.includes("last_name")?"{last_name}":""].join(" "),email=data.includes("email")?'<span style="font-size: 80%">{email}</span>':"",username=data.includes("username")?'<span style="font-size: 80%">{username}</span>':"";return`${fullName}<br>${username}${email}`}if(data.includes("username")&&data.includes("email")){const username=data.includes("username")?"{username}":"",email=data.includes("email")?'<span style="font-size: 80%">{email}</span>':"";return`${username} <br> ${email}`}return data.map(prop=>`{${prop}}`).join(" ")}function dataFeed(opts,callback){var matchProperties=search_in_comments_cols,data=mentions_user_list.filter((function(item){return matchProperties.some((function(property){return 0==item[property].toLowerCase().indexOf(opts.query.toLowerCase())}))}));callback(data=data.sort((function(a,b){return a.username.localeCompare(b.username,void 0,{sensitivity:"accent"})})))}function convertToTimestamp(datetimeString){const inputFormat1="YYYY-MM-DD HH:mm:ss",inputFormat2="YYYY-MM-DDTHH:mm:ss.SSS",outputFormat="DD MMMM YY",tooltipOutputFormat={day:"2-digit",month:"long",year:"numeric",hour:"numeric",minute:"numeric",hour12:!0};let datetimeObj;datetimeObj=datetimeString.includes("T")?new Date(datetimeString):new Date(datetimeString.replace(/-/g,"/"));const day=datetimeObj.getDate(),month=new Intl.DateTimeFormat("en-US",{month:"long"}).format(datetimeObj),year=datetimeObj.getFullYear(),timestamp=day.toString().padStart(2,"0")+" "+month.substring(0,3)+" "+year.toString().substring(2,4),tooltipTimestamp=datetimeObj.toLocaleString("en-US",tooltipOutputFormat);return[timestamp,tooltipTimestamp]}function getInitials(username,user_type){if(initials="",user_data_list=all_users_list,user_data_list.length>0){for(const user of user_data_list){const user=user_data_list.find(user=>user.username===username);if(user&&user.first_name&&""!==user.first_name&&(initials+=user.first_name[0]),user&&user.last_name&&""!==user.last_name&&(initials+=user.last_name[0]),""!=initials)return initials.toUpperCase()}return`${username[0].toUpperCase()}`}}function openComments(){var elementID=$(this).closest("table").attr("id").replace("example1","");let rowData=$(this).closest("table").DataTable().row($(this).closest("tr")).data(),primaryKeyId="";"id"in rowData?primaryKeyId=rowData.id:"ID"in rowData?primaryKeyId=rowData.ID:"iD"in rowData?primaryKeyId=rowData.iD:"Id"in rowData&&(primaryKeyId=rowData.Id),$.ajax({url:`/users/${urlPath}/approval_table/`,data:{approval_id:primaryKeyId,element_id:elementID,operation:"fetch_comments_data"},type:"POST",dataType:"json",success:function(data){let url_string=window.location.pathname,f_occ=url_string.indexOf("/",url_string.indexOf("/")+1),s_occ=url_string.indexOf("/",url_string.indexOf("/")+f_occ+1),t_occ=url_string.indexOf("/",url_string.indexOf("/")+s_occ+1),app_code=url_string.substring(f_occ+1,s_occ);var current_level=0,audit_log_configs=[];mentions_user_list=JSON.parse(data.mentions_user_list);var approval_audit_log_data=data.data[0];all_users_list=data.all_users_list,display_in_comments_cols=data.display_in_comments_cols,search_in_comments_cols=data.search_in_comments_cols;var smtpConfigKey=data.smtpConfigKey,itemTemplate=`<li data-id="{id}"><strong class="username"> ${getFormattedName(search_in_comments_cols)}</strong></li>`,outputTemplate=`<a href="">@${display_in_comments_cols.map(prop=>`{${prop}}`).join(" ")}</a><span>&nbsp;</span>`,comment_editor,convo_reply_editor,mentions_reply_editor,new_comment_reply_editor;if(data.approval_level_config&&(approval_level_config=JSON.parse(data.approval_level_config),current_level=approval_level_config.current_level),CKEDITOR.on("instanceReady",(function(evt){var editor=evt.editor;editor.on("focus",(function(e){element=e.editor.container.$,$(element).find(".cke_top.cke_reset_all").css("display","block"),$(element).find(".cke_contents.cke_reset").css("height","80px")})),editor.on("blur",(function(e){element=e.editor.container.$,$(element).find(".cke_top.cke_reset_all").css("display","none"),$(element).find(".cke_contents.cke_reset").css("height","44px")}))})),comment_editor=CKEDITOR.replace(`approvalCommentText_${elementID}`,{height:44,removeButtons:home_rtf[0],editorplaceholder:"Add a comment...",plugins:"mentions,undo,link,list,basicstyles,justify,richcombo,wysiwygarea,toolbar",extraPlugins:"elementspath,editorplaceholder",toolbar:[{name:"document",items:["Undo"]},{name:"paragraph",items:["NumberedList","BulletedList","-","Outdent","Indent","-","Blockquote","CreateDiv","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"basicstyles",items:["Bold","Italic","Underline","Strike","-","RemoveFormat"]},{name:"links",items:["Mention","Link","Unlink","Anchor"]},{name:"styles",items:["Styles","Format","Font","FontSize"]},{name:"colors",items:["TextColor","BGColor"]},{name:"elementspath",items:["ElementPath"]}],mentions:[{feed:dataFeed,itemTemplate:itemTemplate,outputTemplate:outputTemplate,minChars:0}],removeButtons:"PasteFromWord"}),CKEDITOR.config.bodyClass="custom_cke_class",CKEDITOR.config.removePlugins="exportpdf",CKEDITOR.config.extraPlugins="autocorrect,elementspath",CKEDITOR.instances[`approvalCommentText_${elementID}`].setData(""),(comment_editor=CKEDITOR.instances[`approvalCommentText_${elementID}`]).on("change",(function(){const typedText=comment_editor.getData();""===typedText.trim()?$(`#convo_add_comment_${elementID}`).prop("disabled",!0):$(`#convo_add_comment_${elementID}`).prop("disabled",!1)})),comment_editor.on("key",(function(event){event.data.keyCode===CKEDITOR.CTRL+13&&$(`#convo_add_comment_${elementID}`).trigger("click")})),$(`#approvalCommentsModalBody_${elementID}`).find(`.approval_outer_${elementID}`).empty(),approval_audit_log_data.approval_audit_log){audit_log_configs=JSON.parse(approval_audit_log_data.approval_audit_log);for(let i=0;i<audit_log_configs.length;i++)for(let[key,value]of Object.entries(audit_log_configs[i]))for(let j=0;j<value.length;j++){dictt=value[j];var[timestamp,tooltipTimestamp]=convertToTimestamp(dictt.time),small_time="at"+tooltipTimestamp.split("at")[1],initials=getInitials(dictt.user);const targetItem=all_users_list.find(item=>item.username===dictt.user);let additionalString="";if(targetItem){const{username:username,id:id,...dataWithoutUsername}=targetItem,dataValues=Object.values(dataWithoutUsername).filter(value=>"-"!=value&&""!=value);additionalString=`(${dataValues.join(" ")})`,(additionalString="()")&&(additionalString="")}if("Comment"==dictt.action){if(audit_html=`\n                <div class="approval_card approval_comment">\n                  <div id="approval_comment_${i}${j}">\n                    <div class="approval_comment_card">\n                      <div class="approval_info">\n                        <h5 class="approval_title"><span>${initials}</span></h5>\n                        <p class="approval_text">${dictt.user} ${additionalString} sent a comment</p>\n                        <div>\n                          <h6 class="approval_timestamp" data-toggle="tooltip" title="${tooltipTimestamp}">${timestamp}</h6>\n                          <small style="color: #929292;">${small_time}</small>\n                        </div>\n                      </div>\n                      <div class="approval_comment_text"><p>${dictt.value.replaceAll("\\t","&nbsp;").replaceAll("\\n","<br>")}</p></div>\n                    </div>`,dictt.hasOwnProperty("replies")){replies=dictt.replies;for(let k=0;k<replies.length;k++){var[reply_timestamp,reply_tooltipTimestamp]=convertToTimestamp(replies[k].time),reply_initials=getInitials(replies[k].user);audit_html+=`\n                    <div class="reply_comment_card approval_comment_card">\n                      <div class="approval_info">\n                        <h5 class="approval_title"><span>${reply_initials}</span></h5>\n                        <p class="approval_text">${replies[k].user} ${additionalString} replied</p>\n                        <div>\n                          <h6 class="approval_timestamp" data-toggle="tooltip" title="${reply_tooltipTimestamp}">${reply_timestamp}</h6>\n                          <small style="color: #929292;">${small_time}</small>\n                        </div>\n                      </div>\n                      <div class="approval_comment_text"><p>${replies[k].value.replaceAll("\\t","&nbsp;").replaceAll("\\n","<br>")}</p></div>\n                    </div>`}}for(var editorId in audit_html+=`</div><div class="reply-area mt-3">\n                    <textarea id="convo_replycomment_${i}${j}" name="convo_replycomment_${i}${j}"></textarea>\n                    <div style="margin: 15px 0 5px 0;text-align: right;display: flex;align-items: center;justify-content: flex-end;">\n                      <button class="btn btn-primary reply_comments" style="font-size:0.9rem;" disabled data-toggle="tooltip" title="Click this button or press Ctrl+Enter" id="convo_replybutton_${i}${j}" onclick="ReplyToConvoComment('${i}','${j}','${key}','${approval_audit_log_data.id}', '${smtpConfigKey}', '${app_code}')">Reply <i class="fa-solid fa-comment-dots ml-2"></i></button>\n                    </div>\n                  </div>\n                  <style>\n                  .approval_wall_btn:hover{\n                    background-color: var(--secondary-color) !important;\n                    color:var(--font-hover-color);\n                  }\n                </style>\n                </div>`,$(`#approvalCommentsModalBody_${elementID}`).find(`.approval_outer_${element_id}`).prepend(audit_html),convo_reply_editor=CKEDITOR.replace(`convo_replycomment_${i}${j}`,{height:44,removeButtons:home_rtf[0],editorplaceholder:"Type your reply here...",plugins:"mentions,undo,link,list,basicstyles,justify,richcombo,wysiwygarea,toolbar",extraPlugins:"elementspath,editorplaceholder",toolbar:[{name:"document",items:["Undo"]},{name:"paragraph",items:["NumberedList","BulletedList","-","Outdent","Indent","-","Blockquote","CreateDiv","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"basicstyles",items:["Bold","Italic","Underline","Strike","-","RemoveFormat"]},{name:"links",items:["Mention","Link","Unlink","Anchor"]},{name:"styles",items:["Styles","Format","Font","FontSize"]},{name:"colors",items:["TextColor","BGColor"]},{name:"elementspath",items:["ElementPath"]}],mentions:[{feed:dataFeed,itemTemplate:itemTemplate,outputTemplate:outputTemplate,minChars:0}],removeButtons:"PasteFromWord"}),CKEDITOR.config.removePlugins="exportpdf",CKEDITOR.config.extraPlugins="autocorrect,elementspath",(convo_reply_editor=CKEDITOR.instances[`convo_replycomment_${i}${j}`]).on("change",(function(){let typedText;""===convo_reply_editor.getData().trim()?$(`#convo_replybutton_${i}${j}`).prop("disabled",!0):$(`#convo_replybutton_${i}${j}`).prop("disabled",!1)})),convo_reply_editor.on("key",(function(event){event.data.keyCode===CKEDITOR.CTRL+13&&$(`#convo_replybutton_${i}${j}`).trigger("click")})),CKEDITOR.instances)0===editorId.indexOf("convo_replycomment_")&&CKEDITOR.instances[editorId].setData("")}else if("Mention"==dictt.action){if(audit_html=`\n                <div class="approval_card approval_comment">\n                  <div id="approval_comment_${i}${j}">\n                    <div class="approval_comment_card">\n                      <div class="approval_info">\n                        <h5 class="approval_title"><span>${initials}</span></h5>\n                        <p class="approval_text">${dictt.user} ${additionalString} mentioned</p>\n                        <div>\n                          <h6 class="approval_timestamp" data-toggle="tooltip" title="${tooltipTimestamp}">${timestamp}</h6>\n                          <small style="color: #929292;">${small_time}</small>\n                        </div>\n                      </div>\n                      <div class="approval_comment_text"><p>${dictt.value.replaceAll("\\t","&nbsp;").replaceAll("\\n","<br>")}</p></div>\n                    </div>`,dictt.hasOwnProperty("replies")){replies=dictt.replies;for(let k=0;k<replies.length;k++){var[reply_timestamp,reply_tooltipTimestamp]=convertToTimestamp(replies[k].time);let small_time="at"+reply_tooltipTimestamp.split("at")[1];var reply_initials=getInitials(replies[k].user);audit_html+=`\n                      <div class="reply_comment_card approval_comment_card">\n                        <div class="approval_info">\n                          <h5 class="approval_title"><span>${reply_initials}</span></h5>\n                          <p class="approval_text">${replies[k].user} ${additionalString} replied</p>\n                          <div>\n                            <h6 class="approval_timestamp" data-toggle="tooltip" title="${reply_tooltipTimestamp}">${reply_timestamp}</h6>\n                            <small style="color: #929292;">${small_time}</small>\n                          </div>\n                        </div>\n                        <div class="approval_comment_text"><p>${replies[k].value.replaceAll("\\t","&nbsp;").replaceAll("\\n","<br>")}</p></div>\n                      </div>`}}for(var editorId in audit_html+=`</div><div class="reply-area mt-3">\n\n                      <textarea id="convo_replycomment_${i}${j}" name="convo_replycomment_${i}${j}"></textarea>\n                      <div style="margin: 15px 0 5px 0;text-align: right;display: flex;align-items: center;justify-content: flex-end;">\n                        <button class="btn btn-primary reply_comments" style="font-size:0.9rem;" disabled data-toggle="tooltip" title="Click this button or press Ctrl+Enter" id="convo_replybutton_${i}${j}" onclick="ReplyToConvoComment('${i}','${j}','${key}','${approval_audit_log_data.id}', '${smtpConfigKey}', '${app_code}')">Reply <i class="fa-solid fa-comment-dots ml-2"></i></button>\n                      </div>\n                    </div>\n                    <style>\n                    .approval_wall_btn:hover{\n                      background-color: var(--secondary-color) !important;\n                      color:var(--font-hover-color);\n                    }\n                  </style>\n                  </div>\n                `,$(`#approvalCommentsModalBody_${elementID}`).find(`.approval_outer_${element_id}`).prepend(audit_html),mentions_reply_editor=CKEDITOR.replace(`convo_replycomment_${i}${j}`,{height:44,removeButtons:home_rtf[0],editorplaceholder:"Add a comment...",plugins:"mentions,undo,link,list,basicstyles,justify,richcombo,wysiwygarea,toolbar",extraPlugins:"elementspath,editorplaceholder",toolbar:[{name:"document",items:["Undo"]},{name:"paragraph",items:["NumberedList","BulletedList","-","Outdent","Indent","-","Blockquote","CreateDiv","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"basicstyles",items:["Bold","Italic","Underline","Strike","-","RemoveFormat"]},{name:"links",items:["Mention","Link","Unlink","Anchor"]},{name:"styles",items:["Styles","Format","Font","FontSize"]},{name:"colors",items:["TextColor","BGColor"]},{name:"elementspath",items:["ElementPath"]}],mentions:[{feed:dataFeed,itemTemplate:itemTemplate,outputTemplate:outputTemplate,minChars:0}],removeButtons:"PasteFromWord"}),CKEDITOR.config.removePlugins="exportpdf",CKEDITOR.config.extraPlugins="autocorrect,elementspath",(mentions_reply_editor=CKEDITOR.instances[`convo_replycomment_${i}${j}`]).on("change",(function(){let typedText;""===mentions_reply_editor.getData().trim()?$(`#convo_replybutton_${i}${j}`).prop("disabled",!0):$(`#convo_replybutton_${i}${j}`).prop("disabled",!1)})),mentions_reply_editor.on("key",(function(event){event.data.keyCode===CKEDITOR.CTRL+13&&$(`#convo_replybutton_${i}${j}`).trigger("click")})),CKEDITOR.instances)0===editorId.indexOf("convo_replycomment_")&&CKEDITOR.instances[editorId].setData("")}}}expand_rollup_comments("approvalCommentsModalBody_"),$(".closeCommentsModal").on("click",(function(){var modalElement=document.querySelector(".approvalCommentsModal");for(var instanceName in CKEDITOR.instances){var editorElement;if(CKEDITOR.instances.hasOwnProperty(instanceName))modalElement.querySelector("#"+instanceName)&&CKEDITOR.instances[instanceName].destroy()}$(`#approvalCommentsModal_${elementID}`).modal("hide")})),$(`#convo_add_comment_${elementID}`).off("click").on("click",(function(){if(approval_comment=CKEDITOR.instances[`approvalCommentText_${elementID}`].getData(),approval_comment){var usernamesArray=[],mentionPattern=/@(\w+)/g,matches=approval_comment.match(mentionPattern);if(matches){var uniqueUsernames=new Set;matches.forEach((function(match){uniqueUsernames.add(match.substr(1))})),usernamesArray=Array.from(uniqueUsernames)}$.ajax({url:`/users/${urlPath}/approval_table/`,data:{approval_id:approval_audit_log_data.id,current_level:current_level,operation:"add_comment",audit_log_configs:JSON.stringify(audit_log_configs),approval_comment:approval_comment,mentioned_usernames:JSON.stringify(usernamesArray),smtpConfigKey:smtpConfigKey,app_code:app_code},type:"POST",dataType:"json",success:function(data){var count=audit_log_configs.length;all_audit_data=JSON.parse(data.all_audit_data),audit_log_configs.push(all_audit_data[count]),CKEDITOR.instances[`approvalCommentText_${elementID}`].setData(""),temp_log=data;var[timestamp,tooltipTimestamp]=convertToTimestamp(temp_log.time),small_time="at"+tooltipTimestamp.split("at")[1],initials=getInitials(temp_log.user);audit_html=`\n                <div class="approval_card approval_comment">\n                  <div id="approval_comment_${count}0">\n                    <div class="approval_comment_card">\n                      <div class="approval_info">\n                        <h5 class="approval_title"><span>${initials}</span></h5>\n                        <p class="approval_text">${temp_log.user} sent a comment</p>\n                        <div>\n                          <h6 class="approval_timestamp" data-toggle="tooltip" title="${tooltipTimestamp}">${timestamp}</h6>\n                          <small style="color: #929292;">${small_time}</small>\n                        </div>\n                      </div>\n                      <div class="approval_comment_text"><p>${temp_log.value}</p></div>\n                    </div>\n                  </div>\n                  <div class="reply-area mt-3">\n                    <textarea id="convo_replycomment_${count}0" name="convo_replycomment_${count}0"></textarea>\n                    <div style="margin: 15px 0 5px 0;text-align: right;display: flex;align-items: center;justify-content: flex-end;">\n                      <button class="btn btn-primary reply_comments" style="font-size:0.9rem;" disabled data-toggle="tooltip" title="Click this button or press Ctrl+Enter" id="convo_replybutton_${count}0" onclick="ReplyToConvoComment('${count}','0','Level ${current_level}','${approval_audit_log_data.id}', '${smtpConfigKey}', '${app_code}')">Reply <i class="fa-solid fa-comment-dots ml-2"></i></button>\n                    </div>\n                  </div>\n                </div>\n              `,$(`#approvalCommentsModalBody_${elementID}`).find(`.approval_outer_${elementID}`).prepend(audit_html),new_comment_reply_editor=CKEDITOR.replace(`convo_replycomment_${count}0`,{height:44,removeButtons:home_rtf[0],editorplaceholder:"Type your reply here...",plugins:"mentions,undo,link,list,basicstyles,justify,richcombo,wysiwygarea,toolbar",extraPlugins:"elementspath,editorplaceholder",toolbar:[{name:"document",items:["Undo"]},{name:"paragraph",items:["NumberedList","BulletedList","-","Outdent","Indent","-","Blockquote","CreateDiv","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"basicstyles",items:["Bold","Italic","Underline","Strike","-","RemoveFormat"]},{name:"links",items:["Mention","Link","Unlink","Anchor"]},{name:"styles",items:["Styles","Format","Font","FontSize"]},{name:"colors",items:["TextColor","BGColor"]},{name:"elementspath",items:["ElementPath"]}],mentions:[{feed:dataFeed,itemTemplate:itemTemplate,outputTemplate:outputTemplate,minChars:0}],removeButtons:"PasteFromWord"}),CKEDITOR.config.removePlugins="exportpdf",CKEDITOR.config.extraPlugins="autocorrect,elementspath",CKEDITOR.instances[`convo_replycomment_${count}0`].setData(""),(new_comment_reply_editor=CKEDITOR.instances[`convo_replycomment_${count}0`]).on("change",(function(){let typedText;""===new_comment_reply_editor.getData().trim()?$(`#convo_replybutton_${count}0`).prop("disabled",!0):$(`#convo_replybutton_${count}0`).prop("disabled",!1)})),new_comment_reply_editor.on("key",(function(event){event.data.keyCode===CKEDITOR.CTRL+13&&$(`#convo_replybutton_${count}0`).trigger("click")}))},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}})),"true"==!allowed_approval&&"true"==!allowed_edit&&"true"==!allowed_rejection&&($(`#approvalWallModalBody_${elementID}`).find(`#reopen_all_button_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`#resolve_all_button_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(".resolve_button_ind").css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(".reopen_button_ind").css("display","none")),$(`#approvalCommentsModal_${elementID}`).modal("show")},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}