function showTool(){$(this).find(".row").css("display","flex")}function hideTool(){$(this).find(".row").css("display","none")}function viewCompScenario(){const e=$(this).attr("data-element_id"),t=$(`#modelName_${e}`).attr("data-model_name");let a,l,n;$("#run_saved_scenario").attr("data-element_id",e),$("#save_edited_scenario").attr("data-element_id",e),$.ajax({url:`/users/${urlPath}/computationModule/`,data:{s_id:$(this).attr("data-scenario_id"),operation:"fetch_saved_scenarios_view"},type:"POST",dataType:"json",success:function(i){if($("#element_incremental_data_").empty(),$("#viewCompScenario").find("input").val("").trigger("change"),Object.keys(i.scenarios).length>0){for(const t of i.scenarios){$("#scenario_name_").val(t.scenario_name).trigger("change"),$("#scenario_configuration_date_").val(t.configuration_date).trigger("change"),$("#run_saved_scenario").attr("data-scenario_id",t.scenario_id),$("#run_saved_scenario").attr("data-scenario_config",t.scenario_config),$("#save_edited_scenario").attr("data-scenario_id",t.scenario_id),a=t.scenario_id,$("#save_edited_scenario").attr("data-scenario_config",t.scenario_config),"false"===String(t.run_with_base_model)?$("#runWithBaseModel_").prop("checked",!1):$("#runWithBaseModel_").prop("checked",!0);const i=JSON.parse(t.scenario_config);for(let a=0;a<i.length;a++)"replace_identifier_list"in i[a]?(l=i[a].replace_identifier_list,n=i[a].replace_column_list):(l=[],n=[]),$("#element_incremental_data_").append(`<tr>\n                      <td style="text-align: center;" data-scenario_type="${i[a].scenario_type}" data-scenario_type_scenarioData="${i[a].scenario_type_scenarioData}" data-scenario_data_type="${i[a].scenario_data_type}" data-element_component_id="${i[a].element_id}" data-equation_editor_model="${i[a].equation_editor_model}" data-replace_identifier_list=${JSON.stringify(l)} data-replace_column_list=${JSON.stringify(n)}>${i[a].element_name}</td>\n                      <td style="text-align: center;" >${i[a].scenario_type}</td>\n                      <td style="text-align: center;">${i[a].scenario_type_scenarioData}</td>\n                      <td style="text-align: center;" ><i class="fas fa-edit"" onclick="editCompScenario.call(this)" style="color:var(--primary-color);" data-element_name= "${i[a].element_name}" data-scenario_id="${t.scenario_id}" data-element_id="${e}" data-title="Edit element"></i>&nbsp;<i class="fas fa-trash"" onclick="deleteScenarioElement.call(this)" style="color:var(--primary-color);" data-element_name= "${i[a].element_name}" data-scenario_id="${t.scenario_id}" data-element_id="${e}" data-title="Delete element"></i></td>\n                    </tr>`)}$.ajax({url:`/users/${urlPath}/computationModule/`,data:{model:t,type:"saved_scenario",operation:"computation_scenario_tree"},type:"POST",dataType:"json",success:function(t){$(".EBDisplayButtonIDDiv").empty(),$("#viewCompScenario").modal("show");const l={chart:{container:"#model_inputs_scenario_",levelSeparation:100,siblingSeparation:200,subTeeSeparation:100,nodeAlign:"CENTER",connectors:{type:"step"},node:{HTMLclass:"nodeExample1"}},nodeStructure:t.nodes};new Treant(l);$(".nodeExample1").css("background","black"),$(".nodeExample1").css("color","white"),$(".nodeExample1").css("border-radius","0.5rem"),$(".data_model_input_saved_scenario").hover(function(){$(this).addClass("shadow").css("cursor","pointer")},function(){$(this).removeClass("shadow")}),$(".csv_input").css("background","grey"),$(".node-title").css("margin","1rem"),$(".node-name").css("margin","1rem"),$(".model_names").css("background","var(--primary-color)"),$("#viewCompScenario").modal("show");const n=$("#scenario_name_").val();""!==String(n)&&$(".data_model_input_saved_scenario").click(function(){$(".existingDataHeader").text("Existing Data");const t=$(this).attr("data-element_id"),l=$(this).attr("data-element_name");$.ajax({url:`/users/${urlPath}/computationModule/`,data:{model:$(this).attr("data-model_name"),element_id:t,operation:"computation_element_data"},type:"POST",dataType:"json",success:function(i){$(`#viewScenarioData_${e}`).empty(),$(`#viewScenarioData_${e}`).append(`<div class="card shadow-sm  bg-white rounded;">\n                                  <div class="card-body" style="padding:0.9rem;max-height:90">\n                                      <table id="exampledataResultsScenario_${e}" class="display compact" style="width:100%;">\n                                          <thead>\n                                              <tr></tr>\n                                          </thead>\n                                          <tbody>\n                                          </tbody>\n                                      </table>\n                                  </div>\n                                </div>\n                                <div class="card shadow-sm  bg-white rounded;">\n                                <form id="incremental_data_${e}">\n                                  <div class="card-header" style="color:var(--primary-color);">\n                                    <h5 class="mb-0" style="text-align:center;">\n                                      Configure Scenario Data\n                                    </h5>\n                                  </div>\n                                  <div class="card-body" style="padding:0.9rem;">\n                                    <div class="row">\n                                      <div class="form-group col-4">\n                                          <label for="selectScenarioDataType_${e}">Select scenario data type:</label>\n                                          <select id="selectScenarioDataType_${e}" class="select2 form-control" name="selectScenarioDataType_${e}">\n                                            <option value="upload_data">Upload data</option>\n                                            <option value="equation_builder">Create with equation builder</option>\n                                          </select>\n                                        </div>\n                                      </div>\n                                    </div>\n                                    <div class="row">\n                                      <div class="form-group col-4" id="uploadData_${e}">\n                                        <div class="custom-file" style="margin-left: 0.5rem;">\n                                          <input type="file" class="custom-file-input"  accept=".csv" name="customFile">\n                                          <label class="custom-file-label" for="customFile">Choose file</label>\n                                        </div>\n                                        <br>\n                                        <br>\n                                      </div>\n                                      <div class="form-group col-4 EBDisplayButtonIDDiv" id="equationBuilder_${e}" style="display:none">\n                                        <button style="color:aliceblue; margin-left: 0.5rem;" type="button" id="EBDisplayButtonID" class="btn btn-primary btn-xs rounded">Equation builder</button>\n                                      </div>\n                                    </div>\n                                    <div class="form-group col-4" style="display:flex">\n                                      <label style="margin-left: 0.5rem;">Scenario type : </label>\n                                      <div id="" class="custom-control custom-checkbox" style="margin-left:1%;">\n                                        <input type="checkbox" name="defaultValueConfig" data-scenario_type="append" id="append${e}" class="checkboxinput custom-control-input" value="0">\n                                        <label for="append${e}" class="custom-control-label">\n                                          Append\n                                        </label>\n                                      </div>\n                                      <div id="" class="custom-control custom-checkbox" style="margin-left:1%;">\n                                        <input type="checkbox" name="defaultValueConfig" data-scenario_type="replace" id="replace${e}" class="checkboxinput custom-control-input" value="0">\n                                        <label for="replace${e}" class="custom-control-label">\n                                          Replace\n                                        </label>\n                                      </div>\n                                    </div>\n                                    <div class="form-group col-4" style="margin-left:0.4rem;display:None;">\n                                      <label for="selectIdentifierColumns_${e}">Select identifier columns:</label>\n                                      <select id="selectIdentifierColumns_${e}" class="select2 form-control" name="selectIdentifierColumns_${e}" multiple>\n                                      </select>\n                                    </div>\n                                    <div class="form-group col-4" style="margin-left:0.4rem;display:None;">\n                                      <label for="selectUpdateColumns_${e}">Select columns to update:</label>\n                                      <select id="selectUpdateColumns_${e}" class="select2 form-control" name="selectUpdateColumns_${e}" multiple>\n                                      </select>\n                                    </div>\n                                  </div>\n                                  <div style="float:right;">\n                                    <button type="button" id="addScenarioData_${e}" data-element_id = "${e}"  data-form_id = "incremental_data_${e}" data-element_id_component = "${t}" data-scenario_name = "${n}" data-element_name = "${l}" class="btn btn-primary btn-xs mx-1 my-1 rounded px-2">Add scenario &nbsp;<i class="fas fa-plus"></i></button>\n                                    <button type="button" id="quitScenarioData_${e}" class="btn btn-primary btn-xs mx-2 rounded px-2" data-dismiss="modal">Close</button>\n                                  </div>\n                                </form>\n                                </div>\n                                `),$("select.select2:not(.modal select.select2)").each(function(){parent=$(this).parent(),$(this).select2({dropdownParent:parent})}),$(".modal select.select2").each(function(){$(this).select2()});for(const t in i.columns_list)$(`#selectIdentifierColumns_${e}`).append(`<option value="${i.columns_list[t]}">${i.columns_list[t]}</option>`),$(`#selectUpdateColumns_${e}`).append(`<option value="${i.columns_list[t]}">${i.columns_list[t]}</option>`);$(`#selectIdentifierColumns_${e}`).off("select2:select select2:unselect").on("select2:select select2:unselect",function(){$(`#selectUpdateColumns_${e}`).empty();const t=$(this).val();for(const a in i.columns_list)!1===t.includes(i.columns_list[a])&&$(`#selectUpdateColumns_${e}`).append(new Option(i.columns_list[a],i.columns_list[a],!1,!1))}),$(`#selectScenarioDataType_${e}`).select2(),$(`#selectScenarioDataType_${e}`).off("select2:select").on("select2:select",function(){"upload_data"===String($(this).val())?($(`#uploadData_${e}`).css("display",""),$(`#equationBuilder_${e}`).css("display","none")):($(`#uploadData_${e}`).css("display","none"),$(`#equationBuilder_${e}`).css("display",""))}),$('[type="checkbox"]').change(function(){"replace"===String($(this).attr("data-scenario_type"))?($(`#selectIdentifierColumns_${e}`).parent().css("display",""),$(`#selectUpdateColumns_${e}`).parent().css("display","")):($(`#selectIdentifierColumns_${e}`).parent().css("display","none"),$(`#selectUpdateColumns_${e}`).parent().css("display","none")),this.checked&&$('[type="checkbox"]').not(this).prop("checked",!1)}),$("#EBDisplayButtonID").attr("data-name",n+t),eqBuilder(n,t,e),$(".custom-file-input").on("change",function(){const e=$(this).val().split("\\").pop();$(this).siblings(".custom-file-label").addClass("selected").html(e)});for(let t=0;t<i.table[i.table_headers[0]].length;t++){let a="<tr>";for(const e in i.table_headers)a+=`<td style="text-align:center;">${i.table[i.table_headers[e]][t]}</td>`;a+="</tr>",$(`#exampledataResultsScenario_${e}`).find("tbody").append(a)}$(`#exampledataResultsScenario_${e} thead tr`).empty();for(const t in i.table_headers)$(`#exampledataResultsScenario_${e}`).find("thead tr").eq(0).append(`<th style="text-align:center;">${i.table_headers[t]}</th>`);$(`#scenarioDataOutputModal_${e}`).modal("show"),initialise_table_results("exampledataResultsScenario",e),$(`#addScenarioData_${e}`).attr("data-scenario_data_source","saved_scenario"),$(`#addScenarioData_${e}`).attr("data-scenario_id",a),$(`#addScenarioData_${e}`).click(saveIncrementalData)},error:function(){Swal.fire({icon:"error",text:"Error! Failure in fetching the Table Data. Please try again."})}})})},error:function(){Swal.fire({icon:"error",text:"Error! Failure in loading the scenario configuration. Please try again."})}})}},error:()=>{Swal.fire({icon:"error",text:"Error! Failure in fetching the saved scenarios. Please try again."})}})}function approval_table_configs(){$("#approval_table_Modal").find(".modal-body").empty(),$("#approval_table_Modal").find(".modal-header").find("h5").text("Approval Table");var e=JSON.parse($(this).attr("data-data"));let t=$(this).attr("data-rtf_data"),a=$(this).attr("data-file_field_data");t=t?JSON.parse(t):[],a=a?JSON.parse(a):[];var l=!1,n=!1,o=!1;let s=!1,r=!1,d=[];$(this).attr("data-data").startsWith("{")&&$(this).attr("data-data").endsWith("}")?(e=[e],l=!0):$(this).attr("data-data").startsWith("[")?"{"==$(this).attr("data-data")[1]?l=!0:n=!0:'"'==$(this).attr("data-data")[0]&&(e=JSON.parse(JSON.parse($(this).attr("data-data"))),n=!0);let c={},p=[];if($(this).attr("data-column-alignment")?(c=JSON.parse($(this).attr("data-column-alignment")),0==Object.keys(c).length&&p.push({targets:"_all",className:"dt-center allColumnClass all"})):p.push({targets:"_all",className:"dt-center allColumnClass all"}),"approval_level_config"==$(this).attr("data-name")){e=JSON.parse($(this).attr("data-data"));l=!1,n=!1,o=!0;var _=`\n    <table id="aproval1${$(this).attr("data-s_id")}" class="row-border display" style="width: 100%;">\n                        <thead>\n                        <tr>\n                        </tr>\n                        </thead>\n                        <tbody>\n                        </tbody>\n                      </table>`;$("#approval_table_Modal").find(".modal-body").append(_);for(let t in e.level_config){string="<tr>";for(let a in e.level_config[t])string+=`<td class="view_details_wrap">${String(e.level_config[t][a]).replaceAll(",",", ")}</td>`;string+="</tr>",$("#approval_table_Modal").find(".modal-body").find("table").find("tbody").append(string)}for(let t in e.level_config[0])$("#approval_table_Modal").find(".modal-body").find("table").find("thead tr").eq(0).append(`<th>${String(t).replaceAll(",",", ")}</th>`)}if("approval_information"==$(this).attr("data-name")){r=!0;e=JSON.parse($(this).attr("data-data"));l=!1,n=!1,o=!0;_=`\n    <table id="aproval1${$(this).attr("data-s_id")}" class="row-border display" style="width: 100%;">\n      <thead>\n        <tr>\n        </tr>\n      </thead>\n      <tbody>\n      </tbody>\n    </table>`;if($("#approval_table_Modal").find(".modal-body").append(_),Object.keys(e).length>0){let t=e.type,a=e.approval_details;if("multi_level"==t){for(i in theadHTML="",theadHTML+="<th>Level</th>",theadHTML+="<th>Level - Approval Type</th>",theadHTML+="<th>Level - Approver Type</th>",theadHTML+="<th>Approver(s)</th>",theadHTML+="<th>Approved By</th>",theadHTML+="<th>Rejected By</th>",d.push("Level"),d.push("Level - Approval Type"),d.push("Level - Approver Type"),d.push("Approver(s)"),d.push("Approved By"),d.push("Rejected By"),$("#approval_table_Modal").find(".modal-body").find(`#aproval1${$(this).attr("data-s_id")}`).find("thead > tr").append(theadHTML),tbodyHTML="",a.level_config){levelDetails=a.level_config[i],tbodyHTML+="<tr>",tbodyHTML+=`<td>Level ${i}</td>`;var m="",f="";levelDetails.user_list?(m="User Based",f=levelDetails.user_list):levelDetails.group_list&&(m="Group Based",f=levelDetails.group_list),tbodyHTML+=`<td>${m}</td>`,tbodyHTML+=`<td>${levelDetails.approver_type}</td>`,tbodyHTML+=`<td>${f}</td>`,levelDetails.approved_by?tbodyHTML+=`<td>${levelDetails.approved_by}</td>`:tbodyHTML+="<td>-</td>",levelDetails.rejected_by?tbodyHTML+=`<td>${levelDetails.rejected_by}</td>`:tbodyHTML+="<td>-</td>",tbodyHTML+="</tr>"}$("#approval_table_Modal").find(".modal-body").find(`#aproval1${$(this).attr("data-s_id")}`).find("tbody").append(tbodyHTML)}else{theadHTML="",theadHTML+="<th>Approval Type</th>",theadHTML+="<th>Approver Type</th>",theadHTML+="<th>Approver(s)</th>",theadHTML+="<th>Approved By</th>",theadHTML+="<th>Rejected By</th>",d.push("Approval Type"),d.push("Approver Type"),d.push("Approver(s)"),d.push("Approved By"),d.push("Rejected By"),$("#approval_table_Modal").find(".modal-body").find(`#aproval1${$(this).attr("data-s_id")}`).find("thead > tr").append(theadHTML);var u="";f="",approvedBy="",rejectedBy="",a.user_list?(u="User Based",f=a.user_list):a.group_list&&(u="Group Based",f=a.group_list),a.approved_by?approvedBy=`<td>${a.approved_by}</td>`:approvedBy="<td>-</td>",a.rejected_by?rejectedBy=`<td>${a.rejected_by}</td>`:rejectedBy="<td>-</td>",tbodyHTML=`\n        <tr>\n        <td>${u}</td>\n        <td>${a.approver_type}</td>\n        <td>${f}</td>\n        ${approvedBy}\n        ${rejectedBy}\n        </tr>`,$("#approval_table_Modal").find(".modal-body").find(`#aproval1${$(this).attr("data-s_id")}`).find("tbody").append(tbodyHTML)}}}if(n){_=`\n    <table id="aproval1${$(this).attr("data-s_id")}" class="row-border display" style="width: 100%;">\n                        <thead>\n                        <tr>\n                        </tr>\n                        </thead>\n                        <tbody>\n                        </tbody>\n                      </table>`;$("#approval_table_Modal").find(".modal-body").append(_),$("#approval_table_Modal").find(".modal-body").find("thead tr").append(`<td>${$(this).attr("data-name")}</td>`);for(let t in e)string="<tr>",string+=`<td class="view_details_wrap">${String(e[t]).replaceAll(",",", ")}</td>`,string+="</tr>",$("#approval_table_Modal").find(".modal-body").find("table").find("tbody").append(string)}if(l)if("approver_user"==$(this).attr("data-name")){_=`\n        <table id="aproval1${$(this).attr("data-s_id")}" class="row-border display" style="width: 100%;">\n                            <thead>\n                            </thead>\n                            <tbody>\n                            </tbody>\n                          </table>`;$("#approval_table_Modal").find(".modal-body").append(_);for(let t in e){tm_head="<tr>";for(let[a,l]of Object.entries(e[t]))tm_head+=`<th>${a.toUpperCase()}</th>`;tm_head+="</tr>";break}$("#approval_table_Modal").find(".modal-body > table > thead").append(tm_head);for(let t in e){string="<tr>";for(let[a,l]of Object.entries(e[t]))string+=`<td class="view_details_wrap">${String(l)}</td>`;string+="</tr>",$("#approval_table_Modal").find(".modal-body > table > tbody").append(string)}}else if("json_data"==$(this).attr("data-name")){$("#approval_table_Modal").find(".modal-header").find("h5").text("Approval Details"),s=!0;_=`\n        <table id="aproval1${$(this).attr("data-s_id")}" class="row-border display" style="width: 100%;">\n                            <thead>\n                            <tr>\n                              <th>Column</th>\n                              <th>Value</th>\n                            </tr>\n                            </thead>\n                            <tbody>\n                            </tbody>\n                          </table>`;$("#approval_table_Modal").find(".modal-body").append(_);var v=[".PNG",".JPEG",".JPG",".BMP"],h=[".MP4",".WEBM",".OGV"];for(let t in e){string="";for(let[l,n]of Object.entries(e[t]))if(string+=`<tr><td class="view_details_wrap">${String(l)}</td>`,a.includes(l))if(n){var y=n.split(", ");for(file of(string+='<td class="view_details_wrap">',y)){let e=String(n).slice(-4);v.includes(e.toUpperCase())?string+=`<a class="mr-1" onclick="FilePreviewButton(this)" style="display:block;">\n                    <i class="fa fa-image mr-2 ihover" style="font-size:15px;cursor:pointer;"></i>\n                    <u>${String(file)}</u></a>`:h.includes(e.toUpperCase())?string+=`<a class="mr-1" onclick="FilePreviewButton(this)" style="display:block;">\n                  <i class="fa fa-video-camera mr-2 ihover" style="font-size:15px;cursor:pointer;"></i>\n                  <u>${String(file)}</u></a>`:string+=`<a class="mr-1" onclick="FilePreviewButton(this)" style="display:block;">\n                  <i class="fa fa-file mr-2 ihover" style="font-size:15px;cursor:pointer;"></i>\n                  <u>${String(file)}</u></a>`}string+="</td></tr>"}else string+=`<td class="view_details_wrap">${String(n)}</td></tr>`;else String(n).startsWith("[")?string+=`<td><button class="view_data_btn table_field_show_button view_listview_data" style="background-color: transparent; border: transparent;" onclick="approval_template_json_in_tabular.call(this)" data-column-alignment-config='${JSON.stringify(c)}' data-json='${String(n)}'>View Data</button></td>`:string+=`<td class="view_details_wrap">${String(n)}</td></tr>`;$("#approval_table_Modal").find(".modal-body > table > tbody").append(string)}}else if("approved_by"==$(this).attr("data-name")){_=`\n        <table id="aproval1${$(this).attr("data-s_id")}" class="row-border display" style="width: 100%;">\n                            <thead>\n                            <tr>\n                              <th>Level</th>\n                              <th>Approved By</th>\n                            </tr>\n                            </thead>\n                            <tbody>\n                            </tbody>\n                          </table>`;$("#approval_table_Modal").find(".modal-body").append(_);for(let[t,a]of Object.entries(e[0]))string=`\n        <tr>\n          <td class="view_details_wrap">${String(t)}</td>\n          <td class="view_details_wrap">${a.join(", ")}</td>\n        </tr>`,$("#approval_table_Modal").find(".modal-body").find("table").find("tbody").append(string)}else{_=`\n      <table id="approval_table${$(this).attr("data-s_id")}" class="row-border display" style="width: 100%;">\n                          <thead>\n                          <tr>\n                          </tr>\n                          </thead>\n                          <tbody>\n                          </tbody>\n                        </table>`;$("#approval_table_Modal").find(".modal-body").append(_);for(let t in e){string="<tr>";for(let[a,l]of Object.entries(e[t]))string+=`<td class="view_details_wrap">${String(l)}</td>`;string+="</tr>",$("#approval_table_Modal").find(".modal-body").find("table").find("tbody").append(string);for(let[t,a]of Object.entries(e[0]))$("#approval_table_Modal").find(".modal-body").find("table").find("thead tr").eq(0).append(`<th>${t}</th>`)}}if($("#approval_table_Modal").modal("show"),l||n||o){if(Object.keys(c).length){var b="center",g="center";if(c.global_header&&(b=c.global_header),c.global_content&&(g=c.global_content),s)if(c.field_level_config){if(c.field_level_config.Column.header&&c.field_level_config.Column.content){var w=c.field_level_config.Column.header,x=c.field_level_config.Column.content;p.push({targets:[0],className:`dt-head-${w} dt-body-${x} allColumnClass all`})}else p.push({targets:[0],className:`dt-head-${b} dt-body-${g} allColumnClass all`});if(c.field_level_config.Value.header&&c.field_level_config.Value.content){w=c.field_level_config.Value.header,x=c.field_level_config.Value.content;p.push({targets:[1],className:`dt-head-${w} dt-body-${x} allColumnClass all`})}else p.push({targets:[1],className:`dt-head-${b} dt-body-${g} allColumnClass all`})}else p.push({targets:[1],className:`dt-head-${b} dt-body-${g} allColumnClass all`});else if(r)for(let e=0;e<d.length;e++){const t=d[e];if(c.field_level_config)if(c.field_level_config[t])if(c.field_level_config[t].header&&c.field_level_config[t].header){w=value.header,x=value.content;p.push({targets:[e],className:`dt-head-${w} dt-body-${x} allColumnClass all`})}else p.push({targets:[e],className:`dt-head-${b} dt-body-${g} allColumnClass all`});else p.push({targets:[e],className:`dt-head-${b} dt-body-${g} allColumnClass all`});else p.push({targets:[e],className:`dt-head-${b} dt-body-${g} allColumnClass all`})}else for(let[t,a]of Object.entries(e[0])){var k=Array(Object.keys(e[0])).indexOf(t);if(c.field_level_config)if(c.field_level_config[t])if(c.field_level_config[t].header&&c.field_level_config[t].header){w=value.header,x=value.content;p.push({targets:[k],className:`dt-head-${w} dt-body-${x} allColumnClass all`})}else p.push({targets:[k],className:`dt-head-${b} dt-body-${g} allColumnClass all`});else p.push({targets:[k],className:`dt-head-${b} dt-body-${g} allColumnClass all`});else p.push({targets:[k],className:`dt-head-${b} dt-body-${g} allColumnClass all`})}}if(s){var S=$("#approval_table_Modal").find(".modal-body > table").DataTable({autoWidth:!0,scrollCollapse:!0,responsive:!0,scrollY:"50vh",scrollX:"300",bLengthChange:!1,searching:!1,info:!1,paging:!1,columnDefs:p,ordering:!1});setTimeout(()=>{S.columns.adjust()},200)}else{S=$("#approval_table_Modal").find(".modal-body > table").DataTable({autoWidth:!0,scrollCollapse:!0,responsive:!0,autoWidth:!0,scrollY:"50vh",scrollX:!0,autoWidth:!1,columnDefs:p});setTimeout(()=>{S.columns.adjust()},200)}}else $("#approval_table_Modal").find(".modal-body").append("<p>No data to show</p>")}function approval_template_json_in_tabular(){let e,t=$(this).attr("data-json");e=$(this).attr("data-column-alignment-config")?JSON.parse($(this).attr("data-column-alignment-config")):{},$("#approval_template_json_data_tabular").find(".modal-body").empty();let a=[];if(t){var l=JSON.parse(t),n="<table id='table-as-field-history-table'><thead><tr>";for(var i in l[0])l[0].hasOwnProperty(i)&&(n+="<th>"+i+"</th>");n+="</tr></thead><tbody>";for(var o=0;o<l.length;o++){for(var i in n+="<tr>",l[o])l[o].hasOwnProperty(i)&&(n+="<td>"+l[o][i]+"</td>");n+="</tr>"}if(n+="</tbody></table>",$("#approval_template_json_data_tabular").find(".modal-body").append(n),Object.keys(e).length){var s="center",r="center";e.global_header&&(s=e.global_header),e.global_content&&(r=e.global_content),a.push({targets:"_all",className:`dt-head-${s} dt-body-${r} allColumnClass all`})}else a.push({targets:"_all",className:"dt-head-center dt-body-center allColumnClass all"})}n=$("#approval_template_json_data_tabular").find(".modal-body > table").DataTable({autoWidth:!0,scrollCollapse:!0,responsive:!0,autoWidth:!0,scrollY:"50vh",scrollX:!0,autoWidth:!1,ordering:!1,columnDefs:a});setTimeout(()=>{n.columns.adjust()},200),$("#approval_template_json_data_tabular").modal("show")}function editCompScenario(){const e=$(this).attr("data-element_id"),t=$(this).attr("data-element_name"),a=$("#scenario_name_").val(),l=$(this).attr("data-scenario_id"),n=$(this).parent().parent().find("td").attr("data-equation_editor_model");let i,o;$(`#viewScenarioData_${e}`).empty(),$.ajax({url:`/users/${urlPath}/computationModule/`,data:{scenario_name:a,scenario_id:l,element_name:t,operation:"computation_element_scenario_data"},type:"POST",dataType:"json",success:function(s){$(".existingDataHeader").text("Existing Scenario Data"),$(`#viewScenarioData_${e}`).empty(),
$(`#viewScenarioData_${e}`).append(`<div class="card shadow-sm  bg-white rounded;">\n          <div class="card-body" style="padding:0.9rem;max-height:90">\n              <table id="exampledataResultsScenario_${e}" class="display compact" style="width:100%;">\n                  <thead>\n                      <tr></tr>\n                  </thead>\n                  <tbody>\n                  </tbody>\n              </table>\n          </div>\n        </div>\n        <div class="card shadow-sm  bg-white rounded;">\n        <form id="incremental_data_${e}">\n          <div class="card-header" style="color:var(--primary-color);">\n            <h5 class="mb-0" style="text-align:center;">\n              Configure Scenario Data\n            </h5>\n          </div>\n          <div class="card-body" style="padding:0.9rem;">\n            <div class="row">\n              <div class="form-group col-4">\n                  <label for="selectScenarioDataType_${e}">Select scenario data type:</label>\n                  <select id="selectScenarioDataType_${e}" class="select2 form-control" name="selectScenarioDataType_${e}">\n                    <option value="upload_data">Upload data</option>\n                    <option value="equation_builder">Create with equation builder</option>\n                  </select>\n                </div>\n              </div>\n            </div>\n            <div class="row">\n              <div class="form-group col-4" id="uploadData_${e}">\n                <div class="custom-file" style="margin-left: 0.5rem;">\n                  <input type="file" class="custom-file-input"  accept=".csv" name="customFile">\n                  <label class="custom-file-label" for="customFile">Choose file</label>\n                </div>\n                <br>\n                <br>\n              </div>\n              <div class="form-group col-4 EBDisplayButtonIDDiv" id="equationBuilder_${e}" style="display:none">\n                <button style="color:aliceblue; margin-left: 0.5rem;" type="button" id="EBDisplayButtonID" class="btn btn-primary btn-xs rounded">Equation builder</button>\n              </div>\n            </div>\n            <div class="form-group col-7" style="display:flex">\n              <label style="margin-left: 0.5rem;">Scenario type (Base Data) : </label>\n              <div id="" class="custom-control custom-checkbox" style="margin-left:1%;">\n                <input type="checkbox" name="defaultValueConfig" data-scenario_type="append" id="append${e}" class="checkboxinput custom-control-input" value="0">\n                <label for="append${e}" class="custom-control-label">\n                  Append\n                </label>\n              </div>\n              <div id="" class="custom-control custom-checkbox" style="margin-left:1%;">\n                <input type="checkbox" name="defaultValueConfig" data-scenario_type="replace" id="replace${e}" class="checkboxinput custom-control-input" value="0">\n                <label for="replace${e}" class="custom-control-label">\n                  Replace\n                </label>\n              </div>\n            </div>\n            <div class="form-group col-4" style="margin-left:0.4rem;display:None;">\n              <label for="selectIdentifierColumns_${e}">Select identifier columns:</label>\n              <select id="selectIdentifierColumns_${e}" class="select2 form-control" name="selectIdentifierColumns_${e}" multiple>\n              </select>\n            </div>\n            <div class="form-group col-4" style="margin-left:0.4rem;display:None;">\n              <label for="selectUpdateColumns_${e}">Select columns to update:</label>\n              <select id="selectUpdateColumns_${e}" class="select2 form-control" name="selectUpdateColumns_${e}" multiple>\n              </select>\n            </div>\n            <div class="form-group col-7" style="display:flex">\n              <label style="margin-left: 0.5rem;">Scenario type (Scenario Data) : </label>\n              <div id="" class="custom-control custom-checkbox" style="margin-left:1%;">\n                <input type="checkbox" name="defaultValueConfig_1" id="appendScenarioData${e}" class="checkboxinput custom-control-input" value="0">\n                <label for="appendScenarioData${e}" class="custom-control-label">\n                  Append\n                </label>\n              </div>\n              <div id="" class="custom-control custom-checkbox" style="margin-left:1%;">\n                <input type="checkbox" name="defaultValueConfig_1" id="replaceScenarioData${e}" class="checkboxinput custom-control-input" value="0">\n                <label for="replaceScenarioData${e}" class="custom-control-label">\n                  Replace\n                </label>\n              </div>\n            </div>\n          </div>\n          <div style="float:right;">\n            <button type="button" id="addScenarioData_${e}" data-element_id = "${e}"  data-form_id = "incremental_data_${e}" data-element_id_component = "${s.element_identifier}" data-scenario_name = "${a}" data-element_name = "${t}" class="btn btn-primary btn-xs mx-1 my-1 rounded px-2">Save scenario &nbsp;<i class="fas fa-save"></i></button>\n            <button type="button" id="quitScenarioData_${e}" class="btn btn-primary btn-xs mx-2 rounded px-2" data-dismiss="modal">Close</button>\n          </div>\n        </form>\n        </div>\n        `),$("select.select2:not(.modal select.select2)").each(function(){parent=$(this).parent(),$(this).select2({dropdownParent:parent})}),$(".modal select.select2").each(function(){$(this).select2()});for(const t in s.columns_list)$(`#selectIdentifierColumns_${e}`).append(`<option value="${s.columns_list[t]}">${s.columns_list[t]}</option>`),$(`#selectUpdateColumns_${e}`).append(`<option value="${s.columns_list[t]}">${s.columns_list[t]}</option>`);$(`#selectIdentifierColumns_${e}`).off("select2:select select2:unselect").on("select2:select select2:unselect",function(){$(`#selectUpdateColumns_${e}`).empty();const t=$(this).val();for(const a in s.columns_list)!1===t.includes(s.columns_list[a])&&$(`#selectUpdateColumns_${e}`).append(new Option(s.columns_list[a],s.columns_list[a],!1,!1))}),$(`#selectScenarioDataType_${e}`).select2(),setTimeout(function(){for(const[t,a]of Object.entries(s.scenario_config_dict))String(a.equation_editor_model)===n&&($(`#selectScenarioDataType_${e}`).val(a.scenario_data_type).trigger("change"),$(`#selectScenarioDataType_${e}`).val(a.scenario_data_type).trigger("select2:select"))},1e3),$(`#selectScenarioDataType_${e}`).off("select2:select").on("select2:select",function(){"upload_data"===String($(this).val())?($(`#uploadData_${e}`).css("display",""),$(`#equationBuilder_${e}`).css("display","none")):($(`#uploadData_${e}`).css("display","none"),$(`#equationBuilder_${e}`).css("display",""))});for(const a in s.scenario_config_dict)if(String(s.scenario_config_dict[a].element_name)===String(t)){const t=s.scenario_config_dict[a].scenario_type;"replace"===String(t)?($(`#replace${e}`).prop("checked",!0),"replace_identifier_list"in s.scenario_config_dict[a]?(i=s.scenario_config_dict[a].replace_identifier_list,o=s.scenario_config_dict[a].replace_column_list):(i=[],o=[]),$(`#selectIdentifierColumns_${e}`).parent().css("display",""),$(`#selectUpdateColumns_${e}`).parent().css("display",""),$(`#selectIdentifierColumns_${e}`).val(i).trigger("change"),$(`#selectUpdateColumns_${e}`).val(o).trigger("change")):$(`#append${e}`).prop("checked",!0);const l=s.scenario_config_dict[a].scenario_type_scenarioData;"replace"===String(l)?$(`#replaceScenarioData${e}`).prop("checked",!0):$(`#appendScenarioData${e}`).prop("checked",!0);break}$('[name="defaultValueConfig"]').change(function(){"replace"===$(this).attr("data-scenario_type")?($(`#selectIdentifierColumns_${e}`).parent().css("display",""),$(`#selectUpdateColumns_${e}`).parent().css("display","")):($(`#selectIdentifierColumns_${e}`).parent().css("display","none"),$(`#selectUpdateColumns_${e}`).parent().css("display","none")),this.checked&&$('[name="defaultValueConfig"]').not(this).prop("checked",!1)}),$('[name="defaultValueConfig_1"]').change(function(){this.checked&&$('[name="defaultValueConfig_1"]').not(this).prop("checked",!1)}),$("#EBDisplayButtonID").attr("data-name",a+s.element_identifier),eqBuilder(a,s.element_identifier,e),$(".custom-file-input").on("change",function(){const e=$(this).val().split("\\").pop();$(this).siblings(".custom-file-label").addClass("selected").html(e)});for(let t=0;t<s.table[s.table_headers[0]].length;t++){let a="<tr>";for(const e in s.table_headers)a+=`<td style="text-align:center;">${s.table[s.table_headers[e]][t]}</td>`;a+="</tr>",$(`#exampledataResultsScenario_${e}`).find("tbody").append(a)}$(`#exampledataResultsScenario_${e} thead tr`).empty();for(const t in s.table_headers)$(`#exampledataResultsScenario_${e}`).find("thead tr").eq(0).append(`<th style="text-align:center;">${s.table_headers[t]}</th>`);$(`#scenarioDataOutputModal_${e}`).modal("show"),initialise_table_results("exampledataResultsScenario",e),$(`#addScenarioData_${e}`).attr("data-scenario_data_source","saved_scenario"),$(`#addScenarioData_${e}`).attr("data-scenario_id",l),$(`#addScenarioData_${e}`).click(saveIncrementalData)},error:function(){Swal.fire({icon:"error",text:"Error! Failure in fetching the table data. Please try again."})}})}function saveIncrementalData(){const e=$(this).attr("data-scenario_data_source"),t=$(this).attr("data-element_id"),a=$(`#selectScenarioDataType_${t}`).val(),l=$(this).attr("data-scenario_id"),n=$(this).attr("data-element_id_component"),i=$(this).attr("data-scenario_name"),o=$(this).attr("data-element_name");let s="append",r="append",d=[],c=[];if($(`#replace${t}`).prop("checked")&&(s="replace",d=$(`#selectIdentifierColumns_${t}`).val(),c=$(`#selectUpdateColumns_${t}`).val()),$(`#replaceScenarioData${t}`).prop("checked")&&(r="replace"),"upload_data"===String(a)){const p=new FormData($(`#${$(this).attr("data-form_id")}`)[0]);p.append("element_id_component",n),p.append("model",$(`#modelName_${t}`).attr("data-model_name")),p.append("scenario_data_type",a),p.append("scenario_type",s),p.append("scenario_type_scenarioData",r),p.append("replace_identifier_list",JSON.stringify(d)),p.append("replace_column_list",JSON.stringify(c)),p.append("scenario_name",i),p.append("operation","scenario_incremental_data"),$.ajax({url:`/users/${urlPath}/computationModule/`,data:p,type:"POST",cache:!1,contentType:!1,processData:!1,success:function(i){"success"===String(i.message)?($(`#scenarioDataOutputModal_${t}`).modal("hide"),"saved_scenario"===String(e)?($("#element_incremental_data_").find("tr").each(function(){String($(this).find("td").eq(0).text())===String(o)&&$(this).remove()}),$("#element_incremental_data_").append(`<tr>\n                <td style="text-align: center;" data-scenario_type="${s}" data-scenario_type_scenarioData = "${r}" data-scenario_data_type="${a}" data-element_component_id="${n}" data-replace_identifier_list=${JSON.stringify(d)} data-replace_column_list=${JSON.stringify(c)}>${o}</td>\n                <td style="text-align: center;">${s}</td>\n                <td style="text-align: center;">${r}</td>\n                <td style="text-align: center;" ><i class="fas fa-edit"" onclick="editCompScenario.call(this)" style="color:var(--primary-color);" data-element_name= "${o}" data-scenario_id="${l}" data-element_id="${t}" data-title="Edit element"></i>&nbsp;<i class="fas fa-trash"" onclick="deleteScenarioElement.call(this)" style="color:var(--primary-color);" data-element_name= "${o}" data-scenario_id="${l}" data-element_id="${t}" data-title="Delete element"></i></td>\n              </tr>`)):($(`#element_incremental_data_${t}`).find("tr").each(function(){String($(this).find("td").eq(0).attr("data-element_component_id"))===String(n)&&$(this).remove()}),$(`#element_incremental_data_${t}`).append(`<tr>\n                <td style="text-align: center;" data-scenario_type="${s}" data-scenario_type_scenarioData = "${r}" data-scenario_data_type="${a}" data-element_component_id="${n}" data-replace_identifier_list=${JSON.stringify(d)} data-replace_column_list=${JSON.stringify(c)}>${o}</td>\n                <td style="text-align: center;">${s}</td>\n              </tr>`))):Swal.fire({icon:"error",text:"Error! Failure in adding the scenario. Please check your configuration and try again."})},error:function(){Swal.fire({icon:"error",text:"Error! Failure in adding the scenario. Please check your configuration and try again."})}})}else{const p=$(`#equationBuilder_${t}`).find("button#EBDisplayButtonID").eq(0).attr("data-name");$.ajax({url:`/users/${urlPath}/computationModule/`,data:{model:$(`#modelName_${t}`).attr("data-model_name"),element_id_component:n,scenario_data_type:a,scenario_type:s,scenario_type_scenarioData:r,replace_identifier_list:JSON.stringify(d),replace_column_list:JSON.stringify(c),scenario_name:i,equation_editor_model:p,operation:"scenario_incremental_data"},type:"POST",dataType:"json",success:function(i){"success"===String(i.message)?($(`#scenarioDataOutputModal_${t}`).modal("hide"),"saved_scenario"===String(e)?($("#element_incremental_data_").find("tr").each(function(){String($(this).find("td").eq(0).attr("data-element_component_id"))===String(n)&&$(this).remove()}),$("#element_incremental_data_").append(`<tr>\n                <td style="text-align: center;" data-scenario_type="${s}" data-scenario_type_scenarioData = "${r}" data-scenario_data_type="${a}" data-element_component_id="${n}" data-equation_editor_model="${p}" data-replace_identifier_list=${JSON.stringify(d)} data-replace_column_list=${JSON.stringify(c)}>${o}</td>\n                <td style="text-align: center;">${s}</td>\n                <td style="text-align: center;">${r}</td>\n                <td style="text-align: center;" ><i class="fas fa-edit"" onclick="editCompScenario.call(this)" style="color:var(--primary-color);" data-element_name= "${o}" data-scenario_id="${l}" data-element_id="${t}" data-title="Edit element"></i>&nbsp;<i class="fas fa-trash"" onclick="deleteScenarioElement.call(this)" style="color:var(--primary-color);" data-element_name= "${o}" data-scenario_id="${l}" data-element_id="${t}" data-title="Delete element"></i></td>\n              </tr>`)):($(`#element_incremental_data_${t}`).find("tr").each(function(){String($(this).find("td").eq(0).attr("data-element_component_id"))===String(n)&&$(this).remove()}),$(`#element_incremental_data_${t}`).append(`<tr>\n                <td style="text-align: center;" data-scenario_type="${s}" data-scenario_type_scenarioData = "${r}" data-scenario_data_type="${a}" data-element_component_id="${n}" data-equation_editor_model="${p}" data-replace_identifier_list=${JSON.stringify(d)} data-replace_column_list=${JSON.stringify(c)}>${o}</td>\n                <td style="text-align: center;">${s}</td>\n              </tr>`))):Swal.fire({icon:"error",text:"Error! Failure in adding the scenario. Please check the configuration and try again."})},error:()=>{Swal.fire({icon:"error",text:"Error! Failure in adding the scenario. Please check the configuration and try again."})}})}}function deleteScenarioElement(){$(this).parent().parent().remove()}function freezePrevcardPane(e){const t=$(e).attr("id").replace("btnFreezePanePrevRun","");if($(`#freezeprev_left_${t}`).is(":checked")&&$(`#freezeprev_right_${t}`).is(":checked"))Swal.fire({icon:"warning",text:"Error! Kindly select only one checkbox to freeze panes."});else{$(`#freezeprev_left_${t}`).is(":not(:checked)")&&$(`#freezeprev_right_${t}`).is(":not(:checked)")&&Swal.fire({icon:"warning",text:"Error! Kindly select atleast one checkbox to freeze panes."}),$(`#freezeprev_left_${t}`).is(":checked")&&(freezeDict2.left=parseInt(cellIndex1)),$(`#freezeprev_right_${t}`).is(":checked")&&(freezeDict2.right=parseInt(cellColLen3-cellIndex1+1)),$(".cell_highlighted").removeClass("cell_selected"),$(".cell_highlighted").removeClass("cell_highlighted");const e=$(`#previousRunTable_${t}`).DataTable();new $.fn.dataTable.FixedColumns(e,freezeDict2),$(`#freezePrevRunCard_computation${t}`).modal("hide")}}function freezeRuncardPane(e){const t=$(e).attr("id").replace("btnFreezePaneRun","");if($(`#freezerun_left_${t}`).is(":checked")&&$(`#freezerun_right_${t}`).is(":checked"))Swal.fire({icon:"warning",text:"Error! Kindly select only one checkbox to freeze panes."});else{$(`#freezerun_left_${t}`).is(":not(:checked)")&&$(`#freezerun_right_${t}`).is(":not(:checked)")&&Swal.fire({icon:"warning",text:"Error! Kindly select atleast one checkbox to freeze panes. "}),$(`#freezerun_left_${t}`).is(":checked")&&(freezeDict3.left=parseInt(cellIndex2)),$(`#freezerun_right_${t}`).is(":checked")&&(freezeDict3.right=parseInt(cellColLen4-cellIndex2+1)),$(".cell_highlighted").removeClass("cell_selected"),$(".cell_highlighted").removeClass("cell_highlighted");const e=$(`#runModelTable_${t}`).DataTable();new $.fn.dataTable.FixedColumns(e,freezeDict3),$(`#freezeRunCard_computation${t}`).modal("hide")}}function unfreezePrevcardPane(e){const t=$(e).attr("id").replace("btnFreezePanePrevRun","");$(`#freezeprev_left_${t}`).is(":checked")&&(freezeDict2.left=0),$(`#freezeprev_right_${t}`).is(":checked")&&(freezeDict2.right=0);const a=$(`#previousRunTable_${t}`).DataTable();new $.fn.dataTable.FixedColumns(a,freezeDict2),$(`#freezePrevRunCard_computation${t}`).modal("hide")}function unfreezeRuncardPane(e){const t=$(e).attr("id").replace("btnFreezePaneRun","");$(`#freezerun_left_${t}`).is(":checked")&&(freezeDict3.left=0),$(`#freezerun_right_${t}`).is(":checked")&&(freezeDict3.right=0);const a=$(`#runModelTable_${t}`).DataTable();new $.fn.dataTable.FixedColumns(a,freezeDict3),$(`#freezeRunCard_computation${t}`).modal("hide")}function freezeRunscecardPane(e){const t=$(e).attr("id").replace("btnFreezePaneRunsec","");if($(`#freezerunsec_left_${t}`).is(":checked")&&$(`#freezerunsec_right_${t}`).is(":checked"))Swal.fire({icon:"warning",text:"Kindly select only one checkbox to freeze panes."});else{$(`#freezerunsec_left_${t}`).is(":not(:checked)")&&$(`#freezerunsec_right_${t}`).is(":not(:checked)")&&Swal.fire({icon:"warning",text:"Kindly select atleast one checkbox to freeze panes."}),$(`#freezerunsec_left_${t}`).is(":checked")&&(freezeDict4.left=parseInt(cellIndex3)),$(`#freezerunsec_right_${t}`).is(":checked")&&(freezeDict4.right=parseInt(cellColLen5-cellIndex3+1)),$(".cell_highlighted").removeClass("cell_selected"),$(".cell_highlighted").removeClass("cell_highlighted");const e=$(`#runModelTable_multi_run${t}`).DataTable();new $.fn.dataTable.FixedColumns(e,freezeDict4),$(`#freezeRunCard_computation${t}`).modal("hide")}}function unfreezeRunscecardPane(e){const t=$(e).attr("id").replace("btnFreezePaneRunsec","");$(`#freezerunsec_left_${t}`).is(":checked")&&(freezeDict4.left=0),$(`#freezerunsec_right_${t}`).is(":checked")&&(freezeDict4.right=0);const a=$(`#runModelTable_multi_run${t}`).DataTable();new $.fn.dataTable.FixedColumns(a,freezeDict4),$(`#freezeRunCard_computation${t}`).modal("hide")}function populateValue(e){$(`#identifier_column_${e}`).off("select2:select select2:unselect").on("select2:select select2:unselect",function(){$(`#comparative_column_${e}`).empty();const t=$(this).val(),a=JSON.parse($(`#identifier_column_${e}`).attr("data-output_columns"));for(const l in a)!1===t.includes(a[l])&&$(`#comparative_column_${e}`).append(new Option(a[l],a[l],!1,!1))});let t=$(this).closest("#configure_comparative_"+e).attr("data-data");if(null!=t&&(t[0]="["))if(t=JSON.parse(t),"column_level"!=$("#config_type_"+e).val()){let a=$("#identifier_column_"+e).val();if($("#configure_parameter_"+e).empty(),a.length>0)for(let l=0;l<a.length;l++){$("#configure_parameter_"+e).append(`\n              <div class="col-4">\n                <label>${a[l]}</label>\n                <select data-column="${a[l]}" id="${a[l]}_${e}" class="select2" multiple>\n\n                </select>\n              </div>\n            `),$("#configure_parameter_"+e).find("select").each(function(){$(this).select2()}),$("#configure_parameter_"+e).find(".select2-container").css("width","");for(let n=0;n<t.length;n++){let i=0;$("#configure_parameter_"+e).find("#"+a[l]+"_"+e).find("option").each(function(){$(this).attr("value")==t[n][a[l]]&&(i=1)}),0==i&&$("#configure_parameter_"+e).find("#"+a[l]+"_"+e).append(`\n                  <option value="${t[n][a[l]]}">${t[n][a[l]]}</option>\n                `)}}}else $("#configure_parameter_"+e).html("<span>Select configuration type as row level to configure parameters</span>")}function saveComparative(e){let t={element_id:e,model_name:$("#configure_comparative_"+e).attr("data-model_name"),parameters:{}};if("column_type"!=$("#config_type_"+e).val()){let a=$("#identifier_column_"+e).val();for(let l=0;l<a.length;l++)t.parameters[a[l]]=$("#configure_parameter_"+e).find("#"+a[l]+"_"+e).val()}t.comparative=$("#comparative_column_"+e).val(),t.identifier=$("#identifier_column_"+e).val(),$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"addComparative",model_name:t.model_name,data:JSON.stringify(t)},type:"POST",dataType:"json",success:function(e){Swal.fire({icon:"success",text:"Comparative analysis saved successfully!"})},error:()=>{Swal.fire({icon:"error",text:"Error! Failure in Saving the Comparative analysis. Please check and try again."})}})}function closeScenario(e){$("#configure_comparative_"+e).css("display","none"),$("#save_comparative_"+e).parent().css("display","none")}function datatablesFuncL3(e){$("#"+e).DataTable({autoWidth:!0,scrollY:"40vh",scrollCollapse:!0,order:[[1,"desc"]],scrollX:!0,orderCellsTop:!0,responsive:!0,deferRender:!0,paging:!0,searching:!0,info:!0,lengthMenu:[[1,5,50,-1],[1,5,50,"All"]],stripeClasses:!1,pageLength:50,dom:"lfBrtip",sScrollX:"100%",scrollX:!0,buttons:[{extend:"collection",text:"Export",buttons:[{extend:"copy",title:"",exportOptions:{}},{extend:"excel",title:"",exportOptions:{}},{extend:"csv",title:"",exportOptions:{}},{extend:"pdf",title:"",exportOptions:{}}]}],columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"},{targets:0,width:"20%",className:"noVis"}]}).columns.adjust()}function viewDetail(){var e=$(this).attr("data-t_id");$("#flowDetail").find(".indDetail").css("display","none"),$.ajax({url:`/users/${urlPath}/FlowMonitor/`,data:{operation:"fetchFlowDetail",transaction_id:e},type:"POST",dataType:"json",success:function(e){var t;$("#flowDetailBody").find(".row").empty();for(let a=0;a<e.data.length;a++)$("#flowDetailBody").find(".row").append(`${shapes[e.data[a].tab_type]}`),"Fail"==e.data[a].current_status?t="red":"Pass"==e.data[a].current_status?t="green":"Not started"!=e.data[a].current_status&&"Not required"!=e.data[a].current_status&&"Ongoing"!=e.data[a].current_status||(t="#FFD700"),a!=e.data.length-1&&($("#flowDetailBody").find(".row").append(`${shapes1.arrow}`),$("#flowDetailBody").find(".row").find(".col-1").eq(-1).children().css("color",`${t}`)),$("#flowDetailBody").find(".row").find(".col-2").eq(-1).find("path").attr("stroke",`${t}`),$("#flowDetailBody").find(".row").find(".col-2").eq(-1).children().css("border-color",`${t}`),$("#flowDetailBody").find(".row").find(".col-2").eq(-1).children().css("text-align","center"),"green"!=t&&$("#flowDetailBody").find(".row").find(".col-2").eq(-1).attr("data-link",`${e.data[a].subprocess}`),$("#flowDetailBody").find(".row").find(".col-2").eq(-1).attr("data-title",`${e.data[a].detailed_status}`),$("#flowDetailBody").find(".row").find(".col-2").eq(-1).attr("data-status",`${e.data[a].current_status}`),$("#flowDetailBody").find(".row").find(".col-2").eq(-1).attr("data-name",`${e.data[a].element_name}`),$("#flowDetailBody").find(".row").find(".col-2").eq(-1).attr("data-date",`${e.data[a].modified_date}`),$("#flowDetailBody").find(".row").find(".col-2").eq(-1).attr("onclick","giveDetail.call(this)"),"decision_box"!=e.data[a].tab_type&&$("#flowDetailBody").find(".row").find(".col-2").eq(-1).find(".name").html(e.data[a].element_name)},failure:function(){Swal.fire({icon:"warning",text:"No custom homepage exists"})}})}function giveDetail(){$(this).closest(".modal-body").find(".indDetail").css("display","block");let e=$(this).attr("data-title"),t=$(this).attr("data-status"),a=$(this).attr("data-name"),l=$(this).attr("data-link"),n=$(this).attr("data-date");l=null==l?"":`<a data-toggle="tooltip" title="Go to subprocess" href="/users/${l}/" style="color:var(--primary-color)">Sub-process</a>`,$("#flowDetail").find("#flowDetailTable").find("table").find("tbody").empty(),html=`\n    <tr>\n    <td>${a}</td>\n    <td style="padding-left:10px;">${t}</td>\n    <td style="width:70%"><div style='white-space: normal;width: 100%;'>${e}</div></td>\n    <td>${n.replace("T"," ")}</td>\n    </tr>\n  `,$("#flowDetail").find("#flowDetailTable").find("table").find("tbody").append(html)}function showTransactions(e){var t=$(this).html();$(this).html('<i class="fa fa-circle-notch fa-spin"></i>');let a=$(this);$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"filterFlowDetailL3",transaction_id:"",prg_code:"",pr_code:"",element_id:e},type:"POST",dataType:"json",success:function(e){if(a.html(t),html='<table id="flowMonitorTableL3" class="display" style="width:100%;overflow-x: scroll;overflow-y:scroll;">\n        <thead style="border-bottom:1px solid var(--primary-color)">\n        <tr>\n            <th>Transaction id</th>\n            <th>Created date</th>\n            <th>View detail</th>\n            <th>Flow status</th>\n        </tr>\n        </thead>\n        <tbody style="height: 80px;border-bottom:1px solid var(--primary-color);">',e.data.length>0){transaction_id=e.data[0].transaction_id;var l=0,n=0,i=0;e.data.push({transaction_id:"yoyoy"});for(let t=0;t<e.data.length;t++)html_="\n            ",t_id=e.data[t].transaction_id,e.data[t+1]&&(e.data[t].transaction_id==e.data[t+1].transaction_id?Object.values(e.data[t]).includes("Fail")?(html_='<i class="fa fa-close" style="color:red"></i>',l=1):Object.values(e.data[t]).includes("Not started")||Object.values(e.data[t]).includes("Not required")?(html_='<i class="" style="color:yellow"></i>',i=1):Object.values(e.data[t]).includes("Pass")&&(n=1):(html+="<tr>",Object.values(e.data[t]).includes("Fail")?(html_='<i class="fa fa-close" style="color:red"></i>',l=1):Object.values(e.data[t]).includes("Not started")||Object.values(e.data[t]).includes("Not required")?(html_='<i class="" style="color:yellow"></i>',i=1):Object.values(e.data[t]).includes("Pass")&&(n=1),1==l?html_='<i class="fa fa-close" style="color:red"></i>':1==i?html_='<i class="fa fa-dot-circle-o" style="color:#FFD700"></i>':1==n&&(html_='<i class="fa fa-check" style="color:green"></i>'),l=0,n=0,i=0,html+=`\n                        <td>${e.data[t].transaction_id}</td>\n                        <td>${e.data[t].created_date.replace("T"," ")}</td>\n                        <td onclick="viewDetail.call(this)" data-t_id="${e.data[t].transaction_id}" data-toggle="modal" data-target="#flowDetail" style="cursor:pointer">View detail</td>\n                        <td>${html_}</td>\n                    `),transaction_id=e.data[t].transaction_id);if(""==$("#card0").find("#prCode").val()){$("#card0").find("#prCode").empty(),$("#card0").find("#prCode").append('<option value="">Sub-process</option>');for(let[t,a]of Object.entries(e.code))t.includes("Prg")||$("#card0").find("#prCode").append(`<option value="${t}">${a}</option>`)}""==$("#card0").find("#prgCode").val()&&($("#card0").find("#prCode").empty(),$("#card0").find("#prCode").append('<option value="">Sub-process</option>'))}$("#flowMonitorTableL3_wrapper").remove(),$("#flowMonitorTableL3").remove(),$("#flowMonitorModalL3").find(".modal-body").empty(),html+="</tr></tbody></table>",$("#flowMonitorModalL3").find(".modal-body").append(html),$("#flowMonitorTableL3").find("tbody").each(function(){var e=$(this).children("tr");$(this).html(e.get().reverse())}),$("#flowMonitorModalL3").modal("show"),datatablesFuncL3("flowMonitorTableL3")},failure:function(){a.html(t),Swal.fire({icon:"warning",text:"No custom homepage exists"})}})}function findReplaceButton(e){const t=e.getAttribute("data-elementID");$(`#findtext${t}`).empty(),$(`#selectcase${t}`).prop("disabled",!1),$(`#find${t}`).css("display","none"),$(`#replace${t}`).css("display","none"),$(`.text_based_div${t}`).css("display","none"),$(`#findlabel${t}`).css("display","none"),$(`#findlistL3${t}`).empty(),$(`#replacelistL3${t}`).empty(),$(`#replacelabel${t}`).css("display","none"),$(`#find_replace_modal_${t}`).modal("show"),$(`#findreplacesave_${t}`).attr("confirmed","False"),$("#text_basedip_"+t).prop("checked",!0);const a=$(this).attr("pr_code");$(`#find${t}`).val(""),$(`#replace${t}`).val("");const l=e.getAttribute("data-table-name");$.ajax({url:`/users/${urlPath}/${a}/`,data:{model_name:l,element_id:t,operation:"get_listview_column"},type:"POST",dataType:"json",success:function(e){findreplaceData=e,$(`#selectcolumn${t}`).empty(),$(`#selectreplacecolumn${t}`).empty(),$(`#find${t}`).empty(),$(`#replace${t}`).empty(),$(`#selectcolumn${t}`).append('<option value="" selected disabled>Select Column</option>'),$(`#selectreplacecolumn${t}`).append('<option value="" selected disabled>Select Column</option>'),$.each(Object.keys(e),function(a,l){const n=e[l].internal_type,i=e[l].verbose_name;["FileField","UniqueIDField"].includes(n)||($(`#selectcolumn${t}`).append(`<option data-type="${n}" name="${l}" value="${i}">${i}</option>`),$(`#selectreplacecolumn${t}`).append(`<option data-type="${n}" name="${l}" value="${i}">${i}</option>`))})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function selectcasechange(e){const t=e.getAttribute("data-elementID");"Entire Column"==$(e).val()?($(`#findlabel${t}`).css("display","none"),$(`#findlistL3${t}`).css("display","none"),$(`.text_based_div${t}`).css("display","none")):($(`#findlabel${t}`).css("display","block"),$(`#findlistL3${t}`).css("display","block"),$(`.text_based_div${t}`).css("display","flex"))}function closeviewdetails(e){$(`#view_details_modal_${e}`).modal("hide")}function findreplacemultiselect(e){var t=$(e).attr("element_id"),a=$(e).attr("data-col"),l=JSON.parse($(e).attr("data-name")),n=$(e).attr("data-masterColumn"),o=JSON.parse($(e).attr("data-add")),s=`<tr><td>${n}</td>`;for(i in o)s+=`<td>${o[i]}</td>`;s+="</tr>";var r="";for(let e=0;e<$(`#formModalListL${t}_${a}`).find(".ioL").length;e++)if(Object.keys(l).includes($("#masterListTablei"+t+"_"+a).find("tbody").find("tr").eq(e).find("td").eq(-1).text())){r+="<tr>";for(let l=1;l<$("#masterListTablei"+t+"_"+a).find("tbody").find("tr").eq(0).find("td").length-1;l++)rr=$("#masterListTablei"+t+"_"+a).find("tbody").find("tr").eq(e).find("td").eq(l).text(),rr=rr.trim(),r+=`<td>${rr}</td>`;r+="</tr>"}$(`#view_details_modal_${t}_wrapper`).empty(),$(`#view_details_modal_${t}_wrapper`).append(`\n  <div class="overflow:auto;">\n  <table style="width:100%; max-height:250px" class="table-responsive">\n  <thead>\n  ${s}\n  </thead>\n  <tbody>\n  ${r}\n  </tbody>\n  </table></div>`),$(`#view_details_modal_${t}`).modal("show"),$(`#view_details_modal_${t}_wrapper`).find("table").DataTable({autoWidth:!1,scrollCollapse:!0,sScrollXInner:"100%",ordering:!1,orderCellsTop:!0,responsive:!0,colReorder:{fixedColumnsLeft:1},stateSave:!0,deferRender:!0,paging:!0,lengthMenu:[[1,5,50,-1],[1,5,50,"All"]],stripeClasses:!1,pageLength:50,dom:"lfBrtip",buttons:[],columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"}]})}function findreplacechange(e){const t=e.getAttribute("data-elementID"),a=$("option:selected",`#selectcolumn${t}`).attr("data-type"),l=$("option:selected",`#selectcolumn${t}`).attr("value"),n=$("option:selected",`#selectcolumn${t}`).attr("name");let i;if($(`#selectreplacecolumn${t}`).val(l).trigger("change"),$(`#findlabel${t}`).css("display","block"),$(`#replacelabel${t}`).css("display","block"),$(`.text_based_div${t}`).css("display","flex"),$(`#findlistL3${t}`).empty(),$(`#find${t}`).val(""),
"ForeignKey"===String(a))i="text",$(`#findlistL3${t}`).append(`\n        <select data-elementID="${t}" id="find${t}" form="columnform" class="form-control select2">\n        </select>\n        <script>$("#find${t}").select2()</script>\n        `),$.each(Object.keys(findreplaceData),function(e,a){if("ForeignKey"===String(findreplaceData[a].internal_type)){const e=findreplaceData[a].Choices;for(const[a,l]of Object.entries(e))$(`#find${t}`).append(`<option name="${a}" value="${l}">${l}</option>`)}});else if("MultiSelect"===String(a)){$(`#findlistL3${t}`).append(`\n        <select data-elementID="${t}" id="find${t}" form="columnform" class="form-control select2">\n        </select>\n        <script>$("#find${t}").select2({tags: true})</script>\n        `);for(let e=0;e<$(`#formModalListL${t}_${n}`).find(".ioL").length;e++)el=$("#masterListTablei"+t+"_"+n).find("tbody").find("tr").eq(e).find("td"),idr=el.eq(-1).text().trim(),vdr=el.eq(1).text().trim(),$(`#find${t}`).append(`\n            <option value=${idr}>${vdr}</option>`)}else"CharField"===String(a)||"TextField"===String(a)||"URLField"===String(a)?i="text":"DateTimeField"===String(a)?(i="datetime-local",$(`#find${t}`).attr("step","1"),$(`#find${t}`).addClass("datetimepickerinput form-control")):"DateField"===String(a)?(i="date",$(`#find${t}`).attr("step","1"),$(`#find${t}`).addClass("datetimepickerinput form-control")):"TimeField"===String(a)?(i="time",$(`#find${t}`).attr("step","1"),$(`#find${t}`).addClass("datetimepickerinput form-control")):i="number",$(`#findlistL3${t}`).append(`\n      <input type="${i}" step="1" class="form-control" id="find${t}">\n      `);if("Entire Column"==$(`#selectcase${t}`).val()?($(`#findlabel${t}`).css("display","none"),$(`#findlistL3${t}`).css("display","none"),$(`.text_based_div${t}`).css("display","none")):($(`#findlabel${t}`).css("display","block"),$(`#findlistL3${t}`).css("display","block"),$(`.text_based_div${t}`).css("display","flex")),["IntegerField","BigIntegerField","FloatField"].includes(a))for(let e=0;e<=12;e++)$(`#selectcase${t}`).children().eq(e).prop("disabled",!1);else["DateTimeField","TimeField","DateField"].includes(a)?($(`#selectcase${t}`).val("Equal to").change(),$(`#selectcase${t}`).children().eq(3).prop("disabled",!1),$(`#selectcase${t}`).children().eq(4).prop("disabled",!1),$(`#selectcase${t}`).children().eq(5).prop("disabled",!1),$(`#selectcase${t}`).children().eq(6).prop("disabled",!1),$(`#selectcase${t}`).children().eq(7).prop("disabled",!0),$(`#selectcase${t}`).children().eq(8).prop("disabled",!0),$(`#selectcase${t}`).children().eq(9).prop("disabled",!0),$(`#selectcase${t}`).children().eq(10).prop("disabled",!0),$(`#selectcase${t}`).children().eq(11).prop("disabled",!0),$(`#selectcase${t}`).children().eq(12).prop("disabled",!0)):["DateTimeField","TimeField","DateField"].includes(a)||($(`#selectcase${t}`).children().eq(3).prop("disabled",!0),$(`#selectcase${t}`).children().eq(4).prop("disabled",!0),$(`#selectcase${t}`).children().eq(5).prop("disabled",!0),$(`#selectcase${t}`).children().eq(6).prop("disabled",!0),$(`#selectcase${t}`).children().eq(7).prop("disabled",!1),$(`#selectcase${t}`).children().eq(8).prop("disabled",!1),$(`#selectcase${t}`).children().eq(9).prop("disabled",!1),$(`#selectcase${t}`).children().eq(10).prop("disabled",!1),$(`#selectcase${t}`).children().eq(11).prop("disabled",!1),$(`#selectcase${t}`).children().eq(12).prop("disabled",!1))}function replacechange(e){const t=e.getAttribute("data-elementID"),a=$("option:selected",`#selectreplacecolumn${t}`).attr("data-type"),l=($("option:selected",`#selectreplacecolumn${t}`).attr("value"),$("option:selected",`#selectcolumn${t}`).attr("name"));let n;if($(`#replacelabel${t}`).css("display","block"),$(`#replacelistL3${t}`).empty(),$(`#replace${t}`).val(""),"ForeignKey"===String(a))n="text",$(`#replacelistL3${t}`).append(`\n        <select data-elementID="${t}" id="replace${t}" form="columnform" class="form-control select2">\n        </select>\n        <script>$("#replace${t}").select2()</script>\n        `),$.each(Object.keys(findreplaceData),function(e,a){if("ForeignKey"===String(findreplaceData[a].internal_type)){const e=findreplaceData[a].Choices;for(const[a,l]of Object.entries(e))$(`#replace${t}`).append(`<option name="${a}" value="${l}">${l}</option>`)}});else if("MultiSelect"===String(a)){$(`#replacelistL3${t}`).append(`\n        <select data-elementID="${t}" id="replace${t}" form="columnform" class="form-control select2">\n        </select>\n        <script>$("#replace${t}").select2()</script>\n        `);for(let e=0;e<$(`#formModalListL${t}_${l}`).find(".ioL").length;e++)el=$("#masterListTablei"+t+"_"+l).find("tbody").find("tr").eq(e).find("td"),idr=el.eq(-1).text().trim(),vdr=el.eq(1).text().trim(),$(`#replace${t}`).append(`\n            <option value=${idr}>${vdr}</option>`)}else"CharField"===String(a)||"TextField"===String(a)||"URLField"===String(a)?n="text":"DateTimeField"===String(a)?(n="datetime-local",$(`#replace${t}`).attr("step","1"),$(`#replace${t}`).addClass("datetimepickerinput form-control")):"DateField"===String(a)?(n="date",$(`#replace${t}`).attr("step","1"),$(`#replace${t}`).addClass("datetimepickerinput form-control")):"TimeField"===String(a)?(n="time",$(`#replace${t}`).attr("step","1"),$(`#replace${t}`).addClass("datetimepickerinput form-control")):n="number",$(`#replacelistL3${t}`).append(`\n        <input type="${n}" step="1" class="form-control" id="replace${t}">\n        `);if(["IntegerField","BigIntegerField","FloatField"].includes(a))for(let e=0;e<=12;e++)$(`#selectcase${t}`).children().eq(e).prop("disabled",!1);else["DateTimeField","TimeField","DateField"].includes(a)?($(`#selectcase${t}`).val("Equal to").change(),$(`#selectcase${t}`).children().eq(3).prop("disabled",!1),$(`#selectcase${t}`).children().eq(4).prop("disabled",!1),$(`#selectcase${t}`).children().eq(5).prop("disabled",!1),$(`#selectcase${t}`).children().eq(6).prop("disabled",!1),$(`#selectcase${t}`).children().eq(7).prop("disabled",!0),$(`#selectcase${t}`).children().eq(8).prop("disabled",!0),$(`#selectcase${t}`).children().eq(9).prop("disabled",!0),$(`#selectcase${t}`).children().eq(10).prop("disabled",!0),$(`#selectcase${t}`).children().eq(11).prop("disabled",!0),$(`#selectcase${t}`).children().eq(12).prop("disabled",!0)):["DateTimeField","TimeField","DateField"].includes(a)||($(`#selectcase${t}`).children().eq(3).prop("disabled",!0),$(`#selectcase${t}`).children().eq(4).prop("disabled",!0),$(`#selectcase${t}`).children().eq(5).prop("disabled",!0),$(`#selectcase${t}`).children().eq(6).prop("disabled",!0),$(`#selectcase${t}`).children().eq(7).prop("disabled",!1),$(`#selectcase${t}`).children().eq(8).prop("disabled",!1),$(`#selectcase${t}`).children().eq(9).prop("disabled",!1),$(`#selectcase${t}`).children().eq(10).prop("disabled",!1),$(`#selectcase${t}`).children().eq(11).prop("disabled",!1),$(`#selectcase${t}`).children().eq(12).prop("disabled",!1))}function checkRequired(){let e=$(this).parent().parent().parent().find(".carousel-item.active").find("input,textarea,select").filter(":visible"),t="",a=0;try{t=$(this).attr("id").replace("savebutton_",""),a=1,$("#savebutton_"+t).attr("type","button"),$("#savebutton_"+t).attr("name","button1")}catch(e){t=$(this).attr("href").replace("#carouselExampleIndicators","")}let l=0,n=0,i=0,o=0,s=0,r=[],d=0,c={},p=$(this).attr("data_min_fields");p=null!=p?JSON.parse(p):{};let _=[];for(let[e,t]of Object.entries(p)){for(let e=0;e<t.fields.length;e++)_.push(t.fields[e]);s+=parseInt(t.no_req_fields)}if(Object.keys(p).length>0){ind=$(this).parent().parent().parent().find(".carousel-item.active").index()+1,o=parseInt(p[ind].no_req_fields);for(let t=0;t<e.length;t++){let a=$(e[t]).val(),l=$(e[t]).attr("data-field_name");if(""==a||null==a)if(Object.values(p[ind].fields).length>0){if(Object.values(p[ind].fields).includes(String(l))){if(i>=o){n=0;break}n=1,r.push(l),$(this).removeAttr("data-slide")}}else{if(i>=o){n=0;break}n=1,r.push(l),$(this).removeAttr("data-slide")}else Object.values(p[ind].fields).length>0?Object.values(p[ind].fields).includes(String(l))&&(i+=1):i+=1,0==n&&("Next"==$.trim($(this).text())?$(this).attr("data-slide","next"):$(this).attr("data-slide","prev"))}i>=o?(n=0,"Next"==$.trim($(this).text())?$(this).attr("data-slide","next"):$(this).attr("data-slide","prev")):Swal.fire({icon:"warning",text:`Kindly fill in the value for field atleast ${o} !!!`});let l=$(this).parent().parent().parent().find(".carousel-item").find("input,textarea,select");for(let e=0;e<l.length;e++){let t=$(l[e]).val(),a=$(l[e]).parent().parent().parent().find("label").text().replace("*","").trim();c[a]=t}for(let[e,t]of Object.entries(c))""!=t&&(d+=1,r.push(e));if(0==n&&d>=s){const e=$(`#savebutton_${t}`).val();let a=window.location.href;a.includes(`#carouselExampleIndicators${t}`)&&(a=a.replace(`#carouselExampleIndicators${t}`,""));let l=$(`#savebutton_${t}`).attr("id").split("whiteSpacewrap")[1];if(l="whiteSpacewrap"+l,item_code_list)for(let e=0;e<item_code_list.length;e++)a="/users/"+item_code_list[e][l]+"/";const n=a+"create/",i=a+"createDraft/";"Save"===String(e)?$(`#savebutton_${t}`).attr("formaction",n):"Save as Draft"===String(e)&&$(`#savebutton_${t}`).attr("formaction",i),$("#savebutton_"+t).attr("type","submit"),$("#savebutton_"+t).attr("name","submit")}else 1==a&&Swal.fire({icon:"warning",text:"Kindly fill in the values for required fields !!"})}for(let t=0;t<e.length;t++){let a=$(e[t]).prop("required"),i=$(e[t]).attr("data-car_mand"),o=$(e[t]).parent().parent().find("label").text().replace("*","");if("restrict_mand"==i)if(a){let a=$(e[t]).val();""==a?(Swal.fire({icon:"warning",text:`Kindly fill in the value for mandatory field ${o} !!`}),$(this).removeAttr("data-slide"),l=1):0==l&&("Next"==$.trim($(this).text())?$(this).attr("data-slide","next"):$(this).attr("data-slide","prev"))}else 0==l&&0==n&&("Next"==$.trim($(this).text())?$(this).attr("data-slide","next"):$(this).attr("data-slide","prev"))}}async function listviewPdfEditView(e){function t(e){return new Promise(t=>setTimeout(t,e))}const a=e.getAttribute("data-element-id");$(e).html('<i class="fa fa-circle-notch fa-spin"></i>'),await t(500);var l=document.getElementById(`edit_list_preview_body${a}`).offsetWidth,n=document.getElementById(`edit_list_preview_body${a}`).offsetHeight;let i=$(`#${a}-tab`).find(".span_content_editable").text();await html2canvas(document.getElementById(`edit_list_preview_body${a}`),{allowTaint:!0}).then(function(t){var a=t.toDataURL("image/png"),o=new jsPDF("l","px",[l,n]);o.addImage(a,"PNG",0,0,o.internal.pageSize.width,o.internal.pageSize.height),o.save(`${i}.pdf`),$(e).html("Download Pdf")})}function editPreviewMode(e){const t=e.getAttribute("data-element-id");let a=e.closest(".modal-body").getAttribute("id");a=a.replace("modalBody",""),modalHtml='<div class="form-row">',$(`#modalBody${a}`).find(".form-row").each(function(){modalHtml+=$(this).html()}),modalHtml+="</div>";let l=$(`#${t}-tab`).find(".span_content_editable").text();$(`#edit_list_preview_header${a}`).empty(),$(`#edit_list_preview_header${a}`).append(`<h5 class="modal-title">${l}</h5>\n  <button type="button" class="close" data-dismiss="modal" aria-label="Close">\n    <span aria-hidden="true">&times;</span>\n  </button>`);let n={};$(`#modalBody${a}`).find(".form-row").find("input , select , textarea").each(function(){n[$(this).attr("id")]=$(this).val()});for(var i in $(`#edit_list_preview_body${a}`).empty(),$(`#edit_list_preview_body${a}`).append(modalHtml),$(`#edit_list_preview_body${a}`).css("pointer-events","none"),n)$(`#edit_list_preview_body${a}`).find("#"+i).removeAttr("onclick"),$(`#edit_list_preview_body${a}`).find("#"+i).val(n[i]).trigger("change");$(`#edit_list_preview_body${a}`).find("input , select , textarea").each(function(){$(this).attr("id",$(this).attr("id")+"modal"),$(this).parent().find(".select2-container").css("width","")}),$(`#edit_list_preview_modal${a}`).find(`#edit_list_preview_footer${a}`).empty(),$(`#edit_list_preview_modal${a}`).find(`#edit_list_preview_footer${a}`).append(`\n  <button type="button" class="btn btn-primary btn-xs mx-2 rounded px-2" data-dismiss="modal" id='savebuttonpreview_${a}'>Confirm</button>\n  <button onclick = "listviewPdfEditView(this)" type="button" data-element-id="${a}" class="btn btn-primary btn-xs mx-2 rounded px-2">Download Pdf</button>\n  <button type="button" class="btn btn-primary btn-xs mx-2 rounded px-2" data-dismiss="modal">Close</button>\n  `),$(`#edit_list_preview_modal${a}`).modal("show"),$(`#savebuttonpreview_${a}`).on("click",function(){$(`#savebutton_${t}`).attr("type","submit"),$(`#savebutton_${t}`).removeAttr("onclick"),$(`#savebutton_${t}`).click()})}function checkValidationNow(){let e=$(this).attr("data-tablename"),t=$(this).val();if(""!==t&&"---"!==t&&"----"!==t&&"{}"!==t&&t){let a=$(this).attr("id").split("_").slice(-1)[0],l=$(this).attr("id").replace("id_","").replace(`_${a}`,"");customdict=$(`#customValidationList1${a}`).val(),customdict?customdict=customdict:customdict="",t.constructor===Array&&(t=JSON.stringify(t)),$(this).attr("title",""),$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"check_validations",tableName:e,fieldName:l,fieldVal:t,process_id:a,customdict:customdict},type:"POST",dataType:"json",success:function(e){if("no"==e.error)if($(`#${e.ele_id}`).hasClass("select2"))$(`#${e.ele_id}`).parent().find("span").find(".select2-selection.select2-selection--single").css("background-color","#dbf0db");else if("MultiselectField"==$(`#${e.ele_id}`).attr("data-fieldtype")){let t=$(`#${e.ele_id}`).attr("data-connectedselectfield");$(`#${t}`).parent().find(".select2-selection--multiple").css("background-color","#dbf0db")}else if($(`#${e.ele_id}`).is(":-webkit-autofill")){var t=$(`#${e.ele_id}`).clone(!0,!0);$(`#${e.ele_id}`).after(t),$(`#${e.ele_id}`).remove(),$(`#${e.ele_id}`).css("background-color","#dbf0db")}else $(`#${e.ele_id}`).css("background-color","#dbf0db");else{if($(`#${e.ele_id}`).hasClass("select2"))$(`#${e.ele_id}`).parent().find("span").find(".select2-selection.select2-selection--single").css("background-color","#eed3d9");else if("MultiselectField"==$(`#${e.ele_id}`).attr("data-fieldtype")){let t=$(`#${e.ele_id}`).attr("data-connectedselectfield");$(`#${t}`).parent().find(".select2-selection--multiple").css("background-color","#eed3d9")}else if($(`#${e.ele_id}`).is(":-webkit-autofill")){t=$(`#${e.ele_id}`).clone(!0,!0);$(`#${e.ele_id}`).after(t),$(`#${e.ele_id}`).remove(),$(`#${e.ele_id}`).css("background-color","#eed3d9")}else $(`#${e.ele_id}`).css("background-color","#eed3d9");e.error_msg=e.error_msg.replace("Error while uploading:",""),e.error_msg=e.error_msg.replace("Error while uploading,",""),$(`#${e.ele_id}`).attr("data-toggle","tooltip"),$(`#${e.ele_id}`).attr("title",e.error_msg)}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}else $(this).css("background-color",""),$(this).hasClass("select2")&&(parent=$(this).parent(),$(this).select2({dropdownParent:parent}))}function checkValidationNowCol(){let e=$(this).attr("data-tablename"),t=$(this).attr("data-columnb_val");t=null!=t?JSON.parse(t):{};let a=$(this).attr("id").split("_").slice(-1)[0],l=$(this).attr("id").replace("id_","").replace(`_${a}`,""),n=$(this).val(),i=[],o=[];if(n&&!["","---","----","{}"].includes(n)){if(t.hasOwnProperty(l)){let e=t[l],n=$(`#id_${e}_${a}`).val();n&&!["","---","----","{}"].includes(n)&&(i.push(e),o.push(n))}if(Object.values(t).includes(l)){let e=Object.keys(t).find(e=>t[e]===l),n=$(`#id_${e}_${a}`).val();n&&!["","---","----","{}"].includes(n)&&(i.push(e),o.push(n))}if(i.length&&o.length&&(i.push(l),o.push(n)),$(this).attr("title",""),i.length>1){let t=$(`#customValidationList1${a}`).val();t||(t=""),$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"check_validations_col",tableName:e,fieldName:JSON.stringify(i),fieldVal:JSON.stringify(o),process_id:a,customdict:t},type:"POST",dataType:"json",success:function(e){if("no"==e.error)for(let a in e.ele_id)if($(`#${e.ele_id[a]}`).hasClass("select2"))$(`#${e.ele_id[a]}`).parent().find("span").find(".select2-selection.select2-selection--single").css("background-color","#dbf0db");else if("MultiselectField"==$(`#${e.ele_id[a]}`).attr("data-fieldtype")){let t=$(`#${e.ele_id[a]}`).attr("data-connectedselectfield");$(`#${t}`).parent().find(".select2-selection--multiple").css("background-color","#dbf0db")}else if($(`#${e.ele_id[a]}`).is(":-webkit-autofill")){var t=$(`#${e.ele_id[a]}`).clone(!0,!0);$(`#${e.ele_id[a]}`).after(t),$(`#${e.ele_id[a]}`).remove(),$(`#${e.ele_id[a]}`).css("background-color","#dbf0db")}else $(`#${e.ele_id[a]}`).css("background-color","#dbf0db");else for(let[a,l]of Object.entries(e.validation_status))if("success"==l)if($(`#${a}`).hasClass("select2"))$(`#${a}`).parent().find("span").find(".select2-selection.select2-selection--single").css("background-color","#dbf0db");else if("MultiselectField"==$(`#${a}`).attr("data-fieldtype")){let e=$(`#${a}`).attr("data-connectedselectfield");$(`#${e}`).parent().find(".select2-selection--multiple").css("background-color","#dbf0db")}else if($(`#${a}`).is(":-webkit-autofill")){t=$(`#${a}`).clone(!0,!0);$(`#${a}`).after(t),$(`#${a}`).remove(),$(`#${a}`).css("background-color","#dbf0db")}else $(`#${a}`).css("background-color","#dbf0db");else{if($(`#${a}`).hasClass("select2"))$(`#${a}`).parent().find("span").find(".select2-selection.select2-selection--single").css("background-color","#eed3d9");else if("MultiselectField"==$(`#${a}`).attr("data-fieldtype")){let e=$(`#${a}`).attr("data-connectedselectfield");$(`#${e}`).parent().find(".select2-selection--multiple").css("background-color","#eed3d9")}else if($(`#${a}`).is(":-webkit-autofill")){t=$(`#${a}`).clone(!0,!0);$(`#${a}`).after(t),$(`#${a}`).remove(),$(`#${a}`).css("background-color","#eed3d9")}else $(`#${a}`).css("background-color","#eed3d9");$(`#${a}`).attr("data-toggle","tooltip"),$(`#${a}`).attr("title",l)}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}}else $(this).css("background-color",""),$(this).hasClass("select2")&&(parent=$(this).parent(),$(this).select2({dropdownParent:parent}))}function tableOrdering(e){const t=e.getAttribute("data-element-id");var a=$(`#tableOrderingBtn${t}`).attr("data_list");if(""==a){var l=[];$(".card-title").find(`.${t}_editable`).each(function(){l.push($(this).attr("data-table"))});let e=[...new Set(l)];var n=e,i={};for(let e=0;e<n.length;e++)i[e]=n[e];length_order_id=Object.keys(i).length;var o="";for(let e in i)tableNumber=parseInt(e)+1,o+="<tr>",o+=`<td class="multiple_table_name">${i[e]}</td>`,o+=`<td><input oninput='validation.call(this)' class='input form-control multiple_table_order' style='width:55px;margin:auto;text-align:center' minimum=1 maximum='${length_order_id}' type="integer" value="${tableNumber}"</span></td>`,o+="</tr>"}else{a=JSON.parse($(`#tableOrderingBtn${t}`).attr("data_list")),i=a;length_order_id=Object.keys(i).length;o="";for(let e in i)tableNumber=parseInt(e),o+="<tr>",o+=`<td class="multiple_table_name">${i[e]}</td>`,o+=`<td><input oninput='validation.call(this)' class='input form-control multiple_table_order' style='width:55px;margin:auto;text-align:center' minimum=1 maximum='${length_order_id}' type="integer" value="${tableNumber}"</span></td>`,o+="</tr>"}$(`#tableOrderBodyTable${t}`).empty(),$(`#tableOrderBodyTable${t}`).append(o),$(`#tableOrderModal${t}`).modal("show")}function tableOrderSaveBtn(e){const t=e.getAttribute("data-element-id");window.location.pathname.split("/")[4];var a={};$(`#tableOrderBodyTable${t}`).find("tr").each(function(){a[$(this).find(".multiple_table_order").val()]=$(this).find(".multiple_table_name").text()});$(`#tableOrderingBtn${t}`).attr("data_list",JSON.stringify(a));var l=[];for(key in a)l.push(a[key]);l=JSON.stringify(l),$(`#tableOrderSave${t}`).html('<i class="fa fa-circle-notch fa-spin"></i>'),$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{table_order:l,element_id:t,operation:"tableOrdering",pr_code:window.location.pathname.split("/")[4]},type:"POST",dataType:"json",success:function(e){location.reload()},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function showRecurrModal(){recurrElementID=$(this).attr("data-elementid"),null!=$(`#hidden_recurr_${recurrElementID}`).attr("value")&&(data=$(`#hidden_recurr_${recurrElementID}`).attr("value"),data=JSON.parse(data),recurrLoad(data)),$("#RecurrenceModal").modal("show")}function saveRecurrButton(){var e={};"Daily"==$(".recpattern").val()?(e.type="Daily","Everyday"==$("input[name=data_choice1]:checked",".daily_div").val()?(e.daily_day="Everyday",e.rec_daily_days_no=$(".rec_daily_days_no").val()):(e.daily_day="Everyweekday",e.rec_daily_days_no="")):"Weekly"==$(".recpattern").val()?(e.type="Weekly",e.rec_weekly_days_no=$(".rec_weekly_days_no").val(),e.rec_weekly_days=$(".rec_weekly_days").val()):"Monthly"==$(".recpattern").val()?(e.type="Monthly",e.rec_monthly_days_no=$(".rec_monthly_days_no").val(),e.rec_monthly_months_no=$(".rec_monthly_months_no").val()):"Yearly"==$(".recpattern").val()&&(e.type="Yearly",e.rec_yearly_year_no=$(".rec_yearly_year_no").val(),e.rec_yearly_month_no=$(".rec_yearly_month_no").val(),e.rec_yearly_day_no=$(".rec_yearly_day_no").val()),e.daterange=$(".dtrangepicker").val(),e.end_date=$("input[name=data_choice2]:checked",".range_div").val(),"endafter"==$("input[name=data_choice2]:checked",".range_div").val()?e.end_no_occ=$(".rec_occurr").val():"onenddate"==$("input[name=data_choice2]:checked",".range_div").val()?e.end_no_occ="end":e.end_no_occ="",$(`#hidden_recurr_${recurrElementID}`).attr("value",JSON.stringify(e)),Swal.fire({icon:"success",text:"Configuration saved successfully!"})}function recurrLoad(e){e?($(".recpattern").val(e.type).trigger("select2:select"),$(".recpattern").val(e.type).trigger("change"),"Daily"==e.type?($(`input[value=${e.daily_day}]`,".daily_div").prop("checked",!0).trigger("change"),$(".rec_daily_days_no").val(e.rec_daily_days_no)):"Weekly"==e.type?($(".rec_weekly_days_no").val(e.rec_weekly_days_no),$(".rec_weekly_days").val(e.rec_weekly_days).trigger("change")):"Monthly"==e.type?($(".rec_monthly_days_no").val(e.rec_monthly_days_no),$(".rec_monthly_months_no").val(e.rec_monthly_months_no).trigger("change")):"Yearly"==e.type&&($(".rec_yearly_year_no").val(e.rec_yearly_year_no),$(".rec_yearly_month_no").val(e.rec_yearly_month_no),$(".rec_yearly_day_no").val(e.rec_yearly_month_no)),$(".dtrangepicker").val(e.daterange),startdate=e.daterange.split(" - ")[0],enddate=e.daterange.split(" - ")[1],$(".dtrangepicker").data("daterangepicker").setStartDate(startdate),$(".dtrangepicker").data("daterangepicker").setEndDate(enddate),$(`input[value=${e.end_date}]`,".range_div").prop("checked",!0).trigger("change"),$(".rec_occurr").val(e.end_no_occ)):($(".daily_div").css("display","none"),$(".weekly_div").css("display","none"),$(".monthly_div").css("display","none"),$(".yearly_div").css("display","none"),$(".recpattern").val("").trigger("select2:select"),$(".recpattern").val("").trigger("change"),$("input[name=data_choice1]",".daily_div").prop("checked",!1).trigger("change"),$(".rec_daily_days_no").val("").trigger("change"),$(".rec_weekly_days_no").val(""),$(".rec_weekly_days").val("").trigger("change"),$(".rec_monthly_days_no").val(""),$(".rec_monthly_months_no").val("").trigger("change"),$(".rec_yearly_year_no").val(""),$(".rec_yearly_month_no").val(""),$(".rec_yearly_day_no").val(""),$(".dtrangepicker").val(""),$("input[name=data_choice2]",".range_div").prop("checked",!1).trigger("change"),$(".rec_occurr").val(""))}function customTableDev(e){let t=$(e).attr("data-process_type"),a="";if("create"==t?a=$("#selectFormTable").val():"list"==t?a=$("#selectTablePC").val():"upload"==t&&(a=$("#selectDocumentTable").val()),a.constructor===Array){$("#custommValidationSelection_dev").empty(),$("#custommValidationSelection_dev").append("<option value='value'selected disabled>Select Option Name</option>");for(let e=0;e<a.length;e++)$("#custommValidationSelection_dev").append(new Option(a[e],a[e]))}else $("#custommValidationSelection_dev").empty(),$("#custommValidationSelection_dev").append("<option value='value'selected disabled>Select Option Name</option>"),$("#custommValidationSelection_dev").append(new Option(a,a));data=$(".customValbtnDev").attr("data-data_config"),null!=data?data=JSON.parse(data):data={},reloadCustomValidationDev(data)}function conditionalTableDev(){$("#custom_validation_table_dev").empty(),$("#condition_dropdown_dev").empty(),$("#condition_dropdown1_dev").empty(),$("#custommValidationSelection_dev").val()&&$.ajax({url:`/users/${urlPath}/constriant_get_data/`,data:{model_name:$("#custommValidationSelection_dev").val(),operation:"custom_conditional_table"},type:"POST",dataType:"json",success:function(e){const t=e.label_columns;$("#condition_dropdown_dev").empty(),$("#condition_dropdown1_dev").empty();for(const[e,a]of Object.entries(t))$("#condition_dropdown_dev").append('<li class="dropdown-item"><a href="javascript:void(0)" name='+e+' class="filter_btn">'+a+"</a></li>"),$("#condition_dropdown1_dev").append('<li class="dropdown-item"><a href="javascript:void(0)" name='+e+' class="filter_btn_master" style="color:var(--primary-color);font-size:11px;">'+a+"</a></li>");$(".filter_btn").click(function(){function t(){$(this).closest("tr").remove()}const a=$(this).attr("name"),l=e.form_fields[a];$("#custom_validation_table_dev").append(l),$("#custom_validation_table_dev tr").eq(-1).find("select").each(function(){$(this).select2()}),$(".remove_filter").on("click",t)}),$(".filter_btn_master").click(function(){function t(){$(this).closest("tr").remove()}const a=$(this).attr("name"),l=e.form_fields_master[a];$("#custom_validation_table_dev").append(l),$("#custom_validation_table_dev tr").eq(-1).find("select").each(function(){$(this).select2()}),$(".remove_filter").on("click",t)})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function saveCustomValidationdev(){const e={},t=[];let a=[],l=!1;if($("#custom_validation_table_dev").find("tr:not(.master_filter)").each(function(){const e={},a=$(this).find("td").find("input[name='Constraint_name']").val(),n=$(this).find("td").find("input[name='Rule_set']").val();e.column_name=$(this).find("td").find(".select2bs4").attr("name"),e.condition_name=$(this).find("td").find(".select2bs4 option:selected").val(),e.input_value=$(this).find("td").eq(4).find("div").find("input").val(),e.constraint_name=a,e.rule_set=n,a||n||(l=!0),t.push(e)}),e[$("#custommValidationSelection_dev").val()]=t,$("#custom_validation_table_dev").find("tr.master_filter").each(function(){const e={},t=$(this).find("td").find("input[name='Constraint_name']").val(),n=$(this).find("td").find("input[name='Rule_set']").val();e.column_name=$(this).find("td").find(".select2bs4").attr("name"),e.condition_name="Isin",e.input_value=$(this).find("td").find(".master_column_vals").val(),e.constraint_name=t,e.rule_set=n,e.table_name=$(this).find("td").find(".master_col_table").val(),t||n||(l=!0),a.push(e)}),e.Master_filter=a,l)Swal.fire({icon:"warning",text:"Constraint Name and Rule Set are mandatory to proceed further."});else{let t={};t.reload_custom_validation=e,$(".customValbtnDev").attr("data-data_config",JSON.stringify(t)),Swal.fire({icon:"success",text:"Custom validation configuration saved successfully!"}),$(".carousel-control-prev[href='#carouselCustomValidation']").click(),setTimeout(function(){reloadCustomValidationDev(t)},250)}}function reloadCustomValidationDev(e){if(Object.prototype.hasOwnProperty.call(e,"reload_custom_validation")){if(e.reload_custom_validation){const t=e.reload_custom_validation;$("#configuration_val_row_dev").empty();let a="",l=1;for(const e in t)"Master_filter"!=e&&(a+=`<tr> <td>${l}</td> <td value='${e}'>${e}</td> <td><button type="button" class="btn-primary reconfigurecustomvalidationdev" onclick="deleteValDev()" name="${e}"><i class="fas fa-trash"></i></button> <button type="button" class="btn-primary editcustomexist_validationdev" onclick="editValDev.call(this)" name="${e}" href="#carouselCustomValidation" data-slide="next" ><i class="fas fa-edit"></i></button></td></tr>`,l++);$("#configuration_val_row_dev").append(a)}}else $("#configuration_val_row_dev").empty()}function editValDev(){const e=$(this).attr("name");let t=null;Swal.fire({icon:"question",title:"Do you wish to load the configuration?\n\n Click 'Yes' to confirm or click 'No' if you do not wish to load it.",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(a=>{if(a.isConfirmed){if(t=!0,t&&(data=$(".customValbtnDev").attr("data-data_config"),null!=data?data=JSON.parse(data):data={},Object.prototype.hasOwnProperty.call(data,"reload_custom_validation")&&data.reload_custom_validation)){const t=data.reload_custom_validation;$.ajax({url:`/users/${urlPath}/constriant_get_data/`,data:{model_name:e,operation:"custom_conditional_table"},type:"POST",dataType:"json",success:function(a){$("#custommValidationSelection_dev").val(e).trigger("change");for(const n of t[e]){const e=n.column_name,t=a.form_fields[e];function l(){$(this).closest("tr").remove()}$("#custom_validation_table_dev").append(t),$("#custom_validation_table_dev tr").eq(-1).find("td").eq(3).find("div").find("select").removeAttr("onchange"),$("#custom_validation_table_dev tr").eq(-1).find("select").each(function(){$(this).select2()}),$("#custom_validation_table_dev tr").eq(-1).find("td").eq(1).find("div").find("input").val(n.constraint_name).trigger("change"),$("#custom_validation_table_dev tr").eq(-1).find("td").eq(2).find("div").find("input").val(n.rule_set).trigger("change"),$("#custom_validation_table_dev tr").eq(-1).find("td").eq(3).find("div").find("select").val(n.condition_name).trigger("change"),$("#custom_validation_table_dev tr").eq(-1).find("td").eq(4).find("div").find("input").val(n.input_value).trigger("change"),$(".remove_filter").on("click",l)}if(t.hasOwnProperty("Master_filter"))for(const e of t.Master_filter){const t=e.column_name,n=a.form_fields_master[t];function l(){$(this).closest("tr").remove()}$("#custom_validation_table_dev").append(n),$("#custom_validation_table_dev tr").eq(-1).find("td").eq(3).find("div").find("select").attr("data-data",e.input_value),$("#custom_validation_table_dev tr").eq(-1).find("select").each(function(){$(this).select2()}),$("#custom_validation_table_dev tr").eq(-1).find("td").eq(1).find("div").find("input").val(e.constraint_name).trigger("change"),$("#custom_validation_table_dev tr").eq(-1).find("td").eq(2).find("div").find("input").val(e.rule_set).trigger("change"),$("#custom_validation_table_dev tr").eq(-1).find("td").eq(3).find("div").find("select").val(e.table_name).trigger("change"),$(".remove_filter").on("click",l)}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}}else a.isDenied&&(t=!1)})}function deleteValDev(){const e=$(this).attr("name");Swal.fire({icon:"question",text:`Do you wish to delete ${e} configuration ?`,showDenyButton:!0,showCancelButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(e=>{e.isConfirmed&&($(".customValbtnDev").attr("data-data_config",JSON.stringify("{}")),reloadCustomValidationDev({}))})}function ExtractDataButton(e){let t=$(e).attr("data-elementid"),a=$(e).attr("data-table-name");$(`#exDataColumn1_${t}`).val("").trigger("change"),$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"dropFieldList",tableName:a},type:"POST",dataType:"json",success:function(e){$(`#exDataColumn1_${t}`).empty();for(let a=0;a<e.fieldList.length;a++)$(`#exDataColumn1_${t}`).append(new Option(e.fieldList[a],e.fieldNameList[a]))},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}}),$(`#extract_data_modal_${t}`).modal("show")}function downloadexdData(){
let e=$(this).attr("id").replace("btn_exDataDownload_",""),t=$(`#extract_data_${e}`).attr("data-table-name"),a=$(`#exDataColumn1_${e}`).val(),l=$(this).attr("data-filename");$.ajax({url:`/users/${urlPath}/processGraphModule/`,data:{operation:"download_extract_data",cols:JSON.stringify(a),tableName:t},type:"POST",success:function(e){var a=window.document.createElement("a");a.href=window.URL.createObjectURL(new Blob([e],{type:"text/csv"})),a.download=""===l||void 0===l?`${t}.csv`:`${l}.csv`,window.document.body.appendChild(a),a.click(),window.document.body.removeChild(a)},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function formatCreditCardOnKey(e,t){var a=e.which?e.which:e.keyCode;8!=a?formatCreditCard(t):document.getElementById(t).value=document.getElementById(t).value.replace(/\s+$/,"")}function formatCreditCard(e){for(var t=document.getElementById(e),a=t.value.replace(/\D/g,""),l="",n=1;n<=a.length;n++)isNumeric(a.charAt(n-1))&&(l+=a.charAt(n-1)),n%4==0&&n>0&&n<15&&(l+=" ");t.value=l}function isNumeric(e){return-1!=="0123456789".indexOf(e)}function checkvalidCC(){let e=$(this).attr("data-issuer_type");e=null!=e?JSON.parse(e):{},fieldVal=$(this).val();let t=$(this).attr("id").split("_").slice(-1)[0];if($(`#id_${e.cvv_field_create_fname}_${t}`).attr("data-cvv_card",$(this).attr("id")),""!==fieldVal&&"---"!==fieldVal&&"----"!==fieldVal&&fieldVal){let a=isValid(fieldVal);a?($(this).parent().parent().find(".fa-check").css("display","block"),$(this).parent().parent().find(".fa-times").css("display","none"),card_type=getCreditCardNameByNumber(fieldVal),$(this).hasClass("card_style")&&($(this).css("background",`url('/static/images/Base_theme/Card_Logos/${card_type}.png') no-repeat right 1rem top 0.5rem`),$(this).css("background-size","39px")),$(`#id_${e.cardtype_field_create_fname}_${t}`).val(card_type).trigger("change")):($(this).hasClass("card_style")&&($(this).css("background","url('') no-repeat right 1rem top 0.5rem"),$(this).css("background-size","39px")),$(this).parent().parent().find(".fa-check").css("display","none"),$(this).parent().parent().find(".fa-times").css("display","block"),$(`#id_${e.cardtype_field_create_fname}_${t}`).val("Invalid card type").trigger("change"))}else $(this).hasClass("card_style")&&($(this).css("background","url('') no-repeat right 1rem top 0.5rem"),$(this).css("background-size","39px")),$(`#id_${e.cardtype_field_create_fname}_${t}`).val("").trigger("change"),$(this).parent().parent().find(".fa-check").css("display","none"),$(this).parent().parent().find(".fa-times").css("display","none");$(`#id_${e.cvv_field_create_fname}_${t}`).trigger("change")}function checkvalidCCV(){let e=$(this).attr("data-cvv_card");if(fieldVal=$(this).val(),fieldValCard=$(`#${e}`).val(),""!==fieldVal&&"---"!==fieldVal&&"----"!==fieldVal&&fieldVal&&""!==fieldValCard&&"---"!==fieldValCard&&"----"!==fieldValCard&&fieldValCard){let e=isSecurityCodeValid(fieldValCard,fieldVal);e?($(this).parent().parent().find(".fa-check").css("display","block"),$(this).parent().parent().find(".fa-times").css("display","none"),$(this).parent().parent().find(".fa-check").attr("data-content","Valid cvv no")):($(this).parent().parent().find(".fa-check").css("display","none"),$(this).parent().parent().find(".fa-times").css("display","block"),$(this).parent().parent().find(".fa-times").attr("data-content","Invalid cvv no"))}else""!=fieldVal&&"---"!=fieldVal&&"----"!=fieldVal?($(this).parent().parent().find(".fa-check").css("display","none"),$(this).parent().parent().find(".fa-times").css("display","block"),$(this).parent().parent().find(".fa-times").attr("data-content","Please enter Card no first")):($(this).parent().parent().find(".fa-check").css("display","none"),$(this).parent().parent().find(".fa-times").css("display","none"),$(this).parent().parent().find(".fa-check").attr("data-content","Valid cvv no"),$(this).parent().parent().find(".fa-times").attr("data-content","Invalid cvv no"))}function checkvalidExpiry(){fieldVal=$(this).val();$(this).attr("id").split("_").slice(-1)[0];if(""!==fieldVal&&"---"!==fieldVal&&"----"!==fieldVal&&fieldVal){let e=isExpirationDateValid(fieldVal.split("-")[1],fieldVal.split("-")[0]);e?($(this).parent().parent().find(".fa-check").css("display","block"),$(this).parent().parent().find(".fa-times").css("display","none")):($(this).parent().parent().find(".fa-check").css("display","none"),$(this).parent().parent().find(".fa-times").css("display","block"))}else $(this).parent().parent().find(".fa-check").css("display","none"),$(this).parent().parent().find(".fa-times").css("display","none")}function downloadexdData_compL3(){let e=$(this).attr("data-elementid"),t=$(this).attr("data-elementid_redis"),a=$(this).attr("data-submitname"),l=$(`#${a}${e}`).val();$.ajax({url:`/users/${urlPath}/computationModule/`,data:{operation:"download_extract_data_comp",cols:JSON.stringify(l),data_element_id:t},type:"POST",success:function(e){var t=window.document.createElement("a");t.href=window.URL.createObjectURL(new Blob([e],{type:"text/csv"})),t.download="data.csv",window.document.body.appendChild(t),t.click(),window.document.body.removeChild(t)},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function tableselectShow(e,t,a,l=!1){const n=window.location.pathname.split("/")[4],i=a;let o="",s="",r="",d="",c="";l?(o=`#tables_f${t}_list`,s=`#tablefield_modal_${t}_list`,r=`.add_newtblf_${t}_list`,d=`#save_table_field_${t}_list`,c="view"):(o=`#tables_f${t}`,s=`#tablefield_modal_${t}`,r=`.add_newtblf_${t}`,d=`#save_table_field_${t}`,c="edit");var p=0;$.ajax({url:`/users/${urlPath}/${n}/`,data:{model_name:i,element_id:t,operation:"get_listview_column"},type:"POST",dataType:"json",success:function(e){tableFieldData=e,$.fn.dataTable.isDataTable(o)&&$(o).DataTable().destroy(),$(o).find(".constraint_tblef_tableHeader").empty(),$(o).find("tbody").empty(),$.each(Object.keys(e),function(t,a){if("UniqueIDField"!=e[a].internal_type){const l=e[a].verbose_name;$(o).find(".constraint_tblef_tableHeader").append(`<th data-fname=${Object.keys(e)[t]} style="text-align:center;border-bottom: 1px solid var(--primary-color); border-top: 1px solid var(--primary-color); padding: 5px 0;">${l}</th>`),p+=1}}),l||($(o).find(".constraint_tblef_tableHeader").append('<th style="text-align:center;border-bottom: 1px solid var(--primary-color); border-top: 1px solid var(--primary-color); padding: 5px 0;">Actions</th>'),p+=1)},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}});var _=p-1;$(r).off("click").on("click",function(){if($(o).DataTable().destroy(),$(o).find("tbody").append('<tr style="padding: 5px 0;"></tr>'),$.each(Object.keys(tableFieldData),function(e,a){const l=tableFieldData[a].internal_type;if("UniqueIDField"!=l){let n;if("ForeignKey"===String(l))n="text",$(o).find("tbody").find("tr").last().append(`\n          <td style="border-top: 1px solid #e9ecef;max-width:35rem;min-width:5rem;">\n              <select data-fname="${Object.keys(tableFieldData)[e]}" form="columnform" style="width:100%;" class="form-control textInput select2 p-2 ${t}_${c}_${Object.keys(tableFieldData)[e]}">\n              </select>\n          </td>\n              `),$.each(Object.keys(tableFieldData),function(a,l){if("ForeignKey"===String(tableFieldData[l].internal_type)){const a=tableFieldData[l].Choices;for(const[l,n]of Object.entries(a))$(`.${t}_${c}_${Object.keys(tableFieldData)[e]}`).last().append(`<option name="${n}" value="${l}">${n}</option>`)}});else if("TextField"===String(l)||"ConcatenationField"===String(l)||"CardField"===String(l)||"CardCvvField"===String(l)||"CardTypeField"===String(l))n="text",$(o).find("tbody").find("tr").last().append(`<td style="border-top: 1px solid #e9ecef;min-width:5rem;">\n            <input data-fname="${Object.keys(tableFieldData)[e]}" type="${n}" class="form-control p-2 textInput" style="width:100%;">\n            </td>\n            `);else if("DateTimeField"===String(l))n="datetime-local",$(o).find("tbody").find("tr").last().append(`<td style="border-top: 1px solid #e9ecef;min-width:5rem;">\n            <input data-fname="${Object.keys(tableFieldData)[e]}" type="${n}" step="1" class="form-control datetimepickerinput p-2" style="width:100%;">\n            </td>\n            `);else if("DateField"===String(l))n="date",$(o).find("tbody").find("tr").last().append(`<td style="border-top: 1px solid #e9ecef;min-width:5rem;">\n            <input data-fname="${Object.keys(tableFieldData)[e]}" type="${n}" step="1" class="form-control datetimepickerinput p-2" style="width:100%;">\n            </td>\n            `);else if("TimeField"===String(l))n="time",use_sec=tableFieldData[a].use_seconds,"false"==use_sec?$(o).find("tbody").find("tr").last().append(`<td style="border-top: 1px solid #e9ecef;min-width:5rem;">\n              <input data-fname="${Object.keys(tableFieldData)[e]}" type="${n}" class="form-control timepickerinput p-2" style="width:100%;" data-dp-format="HH:mm">\n              </td>\n              `):$(o).find("tbody").find("tr").last().append(`<td style="border-top: 1px solid #e9ecef;min-width:5rem;">\n              <input data-fname="${Object.keys(tableFieldData)[e]}" type="${n}" class="form-control timepickerinput p-2" style="width:100%;" data-dp-format="HH:mm:ss">\n              </td>\n              `);else if("EmailTypeField"===String(l))n="email",$(o).find("tbody").find("tr").last().append(`<td style="border-top: 1px solid #e9ecef;min-width:5rem;">\n            <input data-fname="${Object.keys(tableFieldData)[e]}" type="${n}" class="form-control textInput p-2" style="width:100%;">\n            </td>\n            `);else if("UniqueIDField"===String(l))n="text",$(o).find("tbody").find("tr").last().append(`<td style="border-top: 1px solid #e9ecef;min-width:5rem;">\n            <input data-fname="${Object.keys(tableFieldData)[e]}" type="${n}" class="form-control textInput p-2" style="width:100%;" disabled>\n            </td>\n            `);else if("BooleanField"===String(l))n="checkbox",$(o).find("tbody").find("tr").last().append(`<td style="padding-left:3rem;padding-right:3rem;min-width:5rem;">\n            <input type='checkbox' data-fname="${Object.keys(tableFieldData)[e]}" class="form-control p-2">\n            </td>\n            `);else if("CharField"===String(l)){n="text",tableFieldData[a].hasOwnProperty("choices")?choices=tableFieldData[a].choices:choices=[];const l=new Set;for(let e=0;e<choices.length;e++)for(let t=0;t<choices[e].length;t++)l.add(choices[e][t]);const i=[...l];if(choices.length>0){$(o).find("tbody").find("tr").last().append(`<td style="border-top: 1px solid #e9ecef;max-width:35rem;min-width:5rem;">\n              <select data-fname="${Object.keys(tableFieldData)[e]}" form="columnform" style="width:100%;" class="form-control textInput select2 p-2 ${t}_${c}_${Object.keys(tableFieldData)[e]}">\n              </select>\n              `);for(let a=0;a<i.length;a++)$(`.${t}_${c}_${Object.keys(tableFieldData)[e]}`).last().append(`<option name="${i[a]}" value="${i[a]}">${i[a]}</option>`)}else $(o).find("tbody").find("tr").last().append(`<td style="border-top: 1px solid #e9ecef;min-width:5rem;">\n              <input data-fname="${Object.keys(tableFieldData)[e]}" type="${n}" class="form-control textInput p-2" style="width:100%;">\n              </td>\n              `)}else"URLField"===String(l)?(n="url",$(o).find("tbody").find("tr").last().append(`<td style="border-top: 1px solid #e9ecef;min-width:5rem;">\n            <input data-fname="${Object.keys(tableFieldData)[e]}" type="${n}" class="form-control p-2" textInput style="width:100%;">\n            </td>\n            `)):"FileField"===String(l)?(n="file",accept="*",tableFieldData[a].file_extension&&("Any"==tableFieldData[a].file_extension?accept="*":"Images"==tableFieldData[a].file_extension?accept="image/*":"Document"==tableFieldData[a].file_extension?accept=".doc,.docx,.rtf,.pdf,.csv,xlsx,.odt,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document":"PDF"==tableFieldData[a].file_extension&&(accept=".pdf")),$(o).find("tbody").find("tr").last().append(`<td style="border-top: 1px solid #e9ecef;min-width:5rem;">\n            <input accept=${accept} type='file' data-fname="${Object.keys(tableFieldData)[e]}" class='form-control p-2' style="width:100%;" multiple>\n            </td>\n            `)):"UserField"===String(l)?(n="text",$(o).find("tbody").find("tr").last().append(`\n            <td style="border-top: 1px solid #e9ecef;">\n                <select data-fname="${Object.keys(tableFieldData)[e]}" style="width:100%;" form="columnform" class="form-control textInput select2 p-2 ${t}_${c}_${Object.keys(tableFieldData)[e]}">\n                </select>\n            </td>\n                `),$.each(Object.keys(tableFieldData),function(a,l){if("UserField"===String(tableFieldData[l].internal_type)){const a=tableFieldData[l].Choices;for(let l in a)$(`.${t}_${c}_${Object.keys(tableFieldData)[e]}`).last().append(`<option name="${a[l]}" value="${a[l]}">${a[l]}</option>`)}})):(n="number",$(o).find("tbody").find("tr").last().append(`<td style="border-top: 1px solid #e9ecef;min-width:5rem;">\n            <input data-fname="${Object.keys(tableFieldData)[e]}" type="${n}" step="1" class="form-control textInput p-2" style="width:100%;">\n            </td>\n            `));$(o).find("tbody").find("tr").last().find("select").each(function(){$(this).select2()}),$(o).find("tbody").find("tr").last().find(".timepickerinput").each(function(){var e=$(this).attr("data-dp-format");$(this).datetimepicker({showClose:!0,showClear:!0,showTodayButton:!0,format:e,locale:"en"})})}}),l||$(o).find("tbody").find("tr").last().append('<td style="border-top: 1px solid #e9ecef;">\n        <a href="#"  class="remove_tbl_row fa fa-times" style="color:var(--primary-color);width:100%"></a>\n      </td>'),$(o).find("tbody").find("tr").eq(-1).on("click",".remove_tbl_row",function(){$(o).DataTable().destroy(),$(this).closest("tr").remove(),$(o).DataTable({searching:!1,paging:!1,info:!0,bAutoWidth:!0,bScrollAutoCss:!0,lengthChange:!1,autoWidth:!0,scrollCollapse:!0,responsive:!0,autoWidth:!0,scrollY:"50vh",scrollX:!0,sScrollX:"auto",sScrollXInner:"auto",ordering:!1,columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"},{targets:"_all","max-width":"35rem"},{targets:[_],width:"100px"}]})}),l){var e=$(o).DataTable({searching:!1,paging:!1,info:!0,bAutoWidth:!0,bScrollAutoCss:!0,lengthChange:!1,autoWidth:!0,scrollCollapse:!0,responsive:!0,autoWidth:!0,scrollY:"50vh",scrollX:!0,sScrollX:"auto",sScrollXInner:"auto",ordering:!1,columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"},{targets:"_all","max-width":"35rem"}]});setTimeout(()=>{e.columns.adjust()},200)}else{e=$(o).DataTable({searching:!1,paging:!1,info:!0,bAutoWidth:!0,bScrollAutoCss:!0,lengthChange:!1,autoWidth:!0,scrollCollapse:!0,responsive:!0,autoWidth:!0,scrollY:"50vh",scrollX:!0,sScrollX:"auto",sScrollXInner:"auto",ordering:!1,columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"},{targets:"_all","max-width":"35rem"},{targets:[_],width:"100px"}]});setTimeout(()=>{e.columns.adjust()},200)}}),data_reload_list=l?$(this).attr("data-name"):$(`#id_${e}_${t}`).val(),data_reload_list&&""!=data_reload_list?(data_reload_list=JSON.parse(data_reload_list),setTimeout(()=>{for(let e in data_reload_list)$(r).trigger("click"),reload_d=data_reload_list[e],$(o).find("tbody").find("tr").last().find("td").find("input,select").each(function(){$(this).is(":checkbox")?1==reload_d[$(this).attr("data-fname")]?$(this).prop("checked",!0):$(this).prop("checked",!1):"file"===$(this).attr("type")?$(this).val("").trigger("change"):$(this).val(reload_d[$(this).attr("data-fname")]).trigger("change"),l?($(this).attr("disabled",!0),$(s).find(".modal-title").text("View Details"),$(r).css("display","none"),$(".remove_tbl_row").css("display","none"),$(d).css("display","none")):($(this).attr("disabled",!1),$(s).find(".modal-title").text("Add Records"),$(r).css("display","block"),$(".remove_tbl_row").css("display","block"),$(d).css("display","block"))});$(s).modal("show")},1e3)):$(s).modal("show"),$(d).off("click").on("click",function(){header_list=[],$(o).find("thead").find("tr").find("th").each(function(){val=$(this).attr("data-fname"),null!=val&&header_list.push(val)}),v_dict=[],temp_dict={},$(o).find("tbody").find("tr").each(function(){temp_dict={},$(this).find("td").each(function(e){$(this).find("input").is(":checkbox")?$(this).find("input").is(":checked")?val=1:val=0:val=$(this).find("input,select").val(),null!=val&&(temp_dict[header_list[e]]=val)}),v_dict.push(temp_dict)}),$(`#id_${e}_${t}`).val(JSON.stringify(v_dict)),$(s).modal("hide")})}function formatState1(e){if(!e.id)return e.text;var t="",a=$(e.element).attr("data-email"),l=$(e.element).attr("data-fname");null!=l&&""!=l||(l="Rev");var n=$(e.element).attr("data-lname");null!=n&&""!=n||(n="Admin");var i=$(e.element).attr("data-pic");return t="----"!=e.text?null==i||""==i?"Rev"==l||"Admin"==n?$(`<div class="optdiv1">\n                <i class="fa fa-user profile_user ddpic"></i>\n                <div>\n                  <label class="ddpiclabel">${e.text}</h6>\n                  <small>${a}</small>\n                </div>\n              </div>`):$(`<div class="optdiv1">\n              <h6 class="ddpic">${l[0]}${n[0]}</h6>\n              <div>\n                <label class="ddpiclabel">${e.text}</h6>\n                <small>${a}</small>\n              </div>\n            </div>`):$(`<div class="optdiv1">\n            <img class="ddorig" src="${"/media/"+i}"/>\n            <div>\n              <label class="ddoriglabel">${e.text}</h6>\n              <small>${a}</small>\n            </div>\n          </div>`):e.text,t}function formatState2(e){if(!e.id)return e.text;var t="",a=$(e.element).attr("data-fname");null!=a&&""!=a||(a="Rev");var l=$(e.element).attr("data-lname");null!=l&&""!=l||(l="Admin");var n=$(e.element).attr("data-pic");return t="----"!=e.text?null==n||""==n?"Rev"==a||"Admin"==l?$(`<div class="optdiv1">\n                <h6 class="fa fa-user profile_user sopic"></h6>\n                <label class="solabel">${e.text}</label>\n              </div>`):$(`<div class="optdiv1">\n              <h6 class="sopic">${a[0]}${l[0]}</h6>\n              <label class="solabel">${e.text}</label>\n            </div>`):$(`<div class="optdiv2">\n            <img src="${"/media/"+n}" class="soorig"/>\n            <label class="solabel">${e.text}</label>\n          </div>`):e.text,t}function addHtml(e,t){let a=$(this).attr("name"),l=$(this).attr("class").replace("renameRemoteColumnBtnExl",""),n="";if(Object.keys(e).length>0){n=`\n          <div class="row renameColumnGroup" style="margin-top:0.5rem;">\n              <div class="col-1" style="color:var(--primary-color); margin:auto;">\n                  <i class="fas fa-trash-alt removeRemoteCol" style="cursor"></i>\n              </div>\n              <div class="col-10" style="margin-left:0.25rem">\n                  <label>${a}</label>\n                  <div class='row'>\n                    <div class='col-6'>\n                      <select class="select2 form-control" name="">\n                        <option value='' selected disabled>select sheet</option>\n          `,sheetlist=e[a];for(let e=0;e<sheetlist.length;e++)n+=`<option value='${sheetlist[e]}'>${sheetlist[e]}</option>`;n+="\n            </select>\n            </div>\n            <div class='col-6'>\n              <select class=\"select2 form-control\" name=\"\">\n                <option value='' selected disabled>select table</option>\n        ";for(let e=0;e<t.length;e++)n+=`<option value='${t[e]}'>${t[e]}</option>`;n+="\n                </select>\n              </div>\n          </div>\n          </div>\n        "}$(`#renameRemoteColumnContainer${l}`).append(n),$(`#renameRemoteColumnContainer${l}`).find(".renameColumnGroup").last().find("select.select2").each(function(){$(this).select2()}),$(".removeRemoteCol").on("click",function(){$(this).parent().parent().remove()})}function sftpUpload(){let e=$(this).attr("data-elementID"),t=$(this).attr("data-tab_name");$(`#sftpUploadMapper${e}`).find("select.select2").each(function(){$(this).select2()});let a=[],l={};$(`#${e}_tab_content`).find("#documenttableUS").find("tbody").find("tr").each(function(){a.push($(this).find("td").eq(0).find("input").val())}),$(`#dropdown1${e}`).off("select2:select").on("select2:select",function(){"SFTP"===$(`#dropdown1${e}`).val()||"FTP"===$(`#dropdown1${e}`).val()||"AWS_S3"===$(`#dropdown1${e}`).val()||"AZURE"===$(`#dropdown1${e}`).val()?($(`#remote_connection_div${e}`).css("display","block"),$(`#remote_connectionpre_div${e}`).css("display","none"),$(`#remote_connectionfile_div${e}`).css("display","none"),$(`#remote_conn_filepath_div${e}`).css("display","none"),$(`#remote_conn_filetype_div${e}`).css("display","none"),$(`#remote_conn_fileregex_div${e}`).css("display","none"),$(`#remote_connection_name_div${e}`).css("display","none"),$(`#remote_conn_localpath_div${e}`).css("display","none"),$(`#configure_remote_connection${e}`).css("display","none"),$(`.remoteConnectiondropdown${e}`).css("display","none"),$(`.remoteConnectionRenameCard${e}`).css("display","none"),"SFTP"===$(`#dropdown1${e}`).val()||"FTP"===$(`#dropdown1${e}`).val()?$(`#remote_conn_filepath_div${e}`).find("label").text("File path:"):"AWS_S3"===$(`#dropdown1${e}`).val()?$(`#remote_conn_filepath_div${e}`).find("label").text("Bucket name:"):"AZURE"===$(`#dropdown1${e}`).val()&&$(`#remote_conn_filepath_div${e}`).find("label").text("Container name:")):"LOCAL"===$(`#dropdown1${e}`).val()&&($(`#remote_connection_div${e}`).css("display","none"),$(`#configure_remote_connection${e}`).css("display","none"),$(`#remote_conn_filepath_div${e}`).css("display","none"),$(`#remote_conn_filetype_div${e}`).css("display","block"),$(`#remote_conn_fileregex_div${e}`).css("display","none"),$(`#remote_connectionpre_div${e}`).css("display","none"),$(`#remote_connectionfile_div${e}`).css("display","none"),$(`#remote_conn_localpath_div${e}`).css("display","block"),$(`#remote_connection_name_div${e}`).css("display","none"),$(`.remoteConnectiondropdown${e}`).css("display","inline-block"),$(`.remoteConnectionRenameCard${e}`).css("display","block"),$(`#sftpUploadMapper${e}`).find("select.select2").each(function(){$(this).select2()}))}),$(`#remote_filetype${e}`).off("select2:select").on("select2:select",function(){let t=$(`#dropdown1${e}`).val(),a=$(this).val();"LOCAL"==t&&a&&("csv"==a?$(`#customFileLocal${e}`).attr("accept",".csv"):"xlsx"==a&&$(`#customFileLocal${e}`).attr("accept",".xlsx"))}),$(`#customFileLocal${e}`).off("change").on("change",function(){let t=$(`#remote_filetype${e}`).val();if("csv"==t){let t=$(`#customFileLocal${e}`).prop("files"),l=[];l=$.map(t,function(e){return e.name}),connectionList=l,$(`#renameRemoteColumnDropdown${e}`).empty();for(let t=0;t<connectionList.length;t++){let a=connectionList[t],l=a.lastIndexOf("."),n=a.slice(0,l);$(`#renameRemoteColumnDropdown${e}`).append(`<li class="dropdown-item"><a href="javascript:void(0)" name='${connectionList[t]}' class="renameRemoteColumnBtn${e}">${n}</a></li>`)}$(`.renameRemoteColumnBtn${e}`).off("click").on("click",function(){let t=$(this).attr("name");html=`\n              <div class="row renameColumnGroup" style="margin-top:0.5rem;">\n                  <div class="col-1" style="color:var(--primary-color); margin:auto;">\n                      <i class="fas fa-trash-alt removeRemoteCol" style="cursor"></i>\n                  </div>\n                  <div class="col-10" style="margin-left:0.25rem">\n                      <label>${t}</label>\n                      <select class="select2 form-control" name="">\n                      <option value='' selected disabled>select one</option>\n              `;for(let e=0;e<a.length;e++)html+=`<option value='${a[e]}'>${a[e]}</option>`;html+="\n                      </select>\n                  </div>\n              </div>\n            ",$(`#renameRemoteColumnContainer${e}`).append(html),$(`#renameRemoteColumnContainer${e}`).find(".renameColumnGroup").last().find("select.select2").each(function(){$(this).select2()}),$(".removeRemoteCol").on("click",function(){$(this).parent().parent().remove()})})}else if("xlsx"==t){let t=new FormData($(`#import_data_csv_remote${e}`)[0]);t.append("operation","get_xlsx_sheetname_sftp"),$.ajax({url:window.location.pathname,data:t,type:"POST",cache:!1,contentType:!1,processData:!1,success:function(t){l=t.hasOwnProperty("sheet_mapping")?t.sheet_mapping:{},l=JSON.stringify(l);let n=$(`#customFileLocal${e}`).prop("files"),i=[];i=$.map(n,function(e){return e.name}),connectionList=i,upload_tables_xl=JSON.stringify(a),$(`#renameRemoteColumnDropdown${e}`).empty();for(let t=0;t<connectionList.length;t++){let a=connectionList[t],n=a.lastIndexOf("."),i=a.slice(0,n);$(`#renameRemoteColumnDropdown${e}`).append(`<li class="dropdown-item"><a href="javascript:void(0)" name='${connectionList[t]}' class="renameRemoteColumnBtnExl${e}" onclick='addHtml.call(this,${l},${upload_tables_xl})'>${i}</a></li>`)}},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}}),$(`#remote_connection_list${e}`).off("select2:select").on("select2:select",function(){"new_connection"===$(`#remote_connection_list${e}`).val()?($(`#configure_remote_connection${e}`).css("display","block"),$(`#remote_connectionpre_div${e}`).css("display","none"),$(`#remote_connectionfile_div${e}`).css("display","none"),$(`.remoteConnectiondropdown${e}`).css("display","none"),$(`.remoteConnectionRenameCard${e}`).css("display","none"),$(`#remote_conn_filepath_div${e}`).css("display","none"),$(`#remote_conn_filetype_div${e}`).css("display","none"),$(`#remote_conn_fileregex_div${e}`).css("display","none"),$(`#remote_connection_name_div${e}`).css("display","block")):"defined_connection"===$(`#remote_connection_list${e}`).val()&&($(`#configure_remote_connection${e}`).css("display","none"),$(`#remote_connectionpre_div${e}`).css("display","block"),$(`#remote_connectionfile_div${e}`).css("display","block"),$(`.remoteConnectiondropdown${e}`).css("display","inline-block"),$(`.remoteConnectionRenameCard${e}`).css("display","block"),$(`#remote_conn_filepath_div${e}`).css("display","block"),$(`#remote_conn_filetype_div${e}`).css("display","block"),$(`#remote_conn_fileregex_div${e}`).css("display","block"),$(`#remote_connection_name_div${e}`).css("display","none"),$(`#remote_connectionpre_list${e}`).empty(),$(`#remote_filetype${e}`).select2(),$(`#remote_connectionpre_list${e}`).select2(),$.ajax({url:`/users/${urlPath}/computationModule/`,data:{operation:"fetch_remote_connection_list",remote_type:$(`#dropdown1${e}`).val()},type:"POST",dataType:"json",success:function(t){let a=t.connectionList;$(`#remote_connectionpre_list${e}`).empty(),$(`#remote_connectionpre_list${e}`).append('<option value = "" selected disabled>Select Connection</option>');for(let t=0;t<a.length;t++)$(`#remote_connectionpre_list${e}`).append(`<option value='${a[t]}'>${a[t]}</option>`);let l=$(`#remote_connectionpre_list${e}`).attr("data-data");l&&($(`#remote_connectionpre_list${e}`).val(l).trigger("change"),$(`#remote_connectionpre_list${e}`).val(l).trigger("select2:select"),$(`#remote_connectionpre_list${e}`).removeAttr("data-data"))},error:function(){Swal.fire({icon:"error",text:"Error! Failure in fetching the connection name list. Please try again."})}}))}),$(`#remote_connectionpre_list${e},.remote_fetchlist`).off("change").on("change",function(){$(`#remote_connectionfile_list${e}`).empty(),$(`#renameRemoteColumnDropdown${e}`).empty(),$(`#renameRemoteColumnContainer${e}`).empty(),remote_type=$(`#dropdown1${e}`).val(),call_flag="","SFTP"!=remote_type&&"FTP"!=remote_type&&"AWS_S3"!=remote_type&&"AZURE"!=remote_type||(call_flag=$(`#remote_connectionpre_list${e}`).val()&&$(`#remote_filetype${e}`).val()&&$(`#remote_filepath${e}`).val()),call_flag&&$.ajax({url:`/users/${urlPath}/computationModule/`,data:{operation:"fetch_remote_file_list",connection_name:$(`#remote_connectionpre_list${e}`).val(),file_type:$(`#remote_filetype${e}`).val(),file_path:$(`#remote_filepath${e}`).val(),file_regex:$(`#remote_fileregex${e}`).val(),remote_type:$(`#dropdown1${e}`).val(),upload_comp:"yes"},type:"POST",dataType:"json",success:function(t){if("error"!=t.status){connectionList=t.file_list,l=t.hasOwnProperty("sheet_mapping")?t.sheet_mapping:{},$(`#remote_connectionfile_list${e}`).empty(),$(`#renameRemoteColumnDropdown${e}`).empty();for(let t=0;t<connectionList.length;t++){let a=connectionList[t],l=a.lastIndexOf("."),n=a.slice(0,l);$(`#remote_connectionfile_list${e}`).append(`<option value='${connectionList[t]}'>${n}</option>`)}$(`#remote_connectionfile_list${e}`).select2()}},error:function(){Swal.fire({icon:"error",text:"Error! Failure in fetching the file list. Please try again."})}})}),$(`#remote_connectionfile_list${e}`).off("change").on("change",function(){connectionList=$(`#remote_connectionfile_list${e}`).val(),$(`#renameRemoteColumnDropdown${e}`).empty();for(let t=0;t<connectionList.length;t++){let a=connectionList[t],l=a.lastIndexOf("."),n=a.slice(0,l);$(`#renameRemoteColumnDropdown${e}`).append(`<li class="dropdown-item"><a href="javascript:void(0)" name='${connectionList[t]}' class="renameRemoteColumnBtn${e}">${n}</a></li>`)}$(`.renameRemoteColumnBtn${e}`).off("click").on("click",function(){let t=$(this).attr("name"),n="";if(Object.keys(l).length>0){n=`\n            <div class="row renameColumnGroup" style="margin-top:0.5rem;">\n                <div class="col-1" style="color:var(--primary-color); margin:auto;">\n                    <i class="fas fa-trash-alt removeRemoteCol" style="cursor"></i>\n                </div>\n                <div class="col-10" style="margin-left:0.25rem">\n                    <label>${t}</label>\n                    <div class='row'>\n                      <div class='col-6'>\n                        <select class="select2 form-control" name="">\n                          <option value='' selected disabled>select sheet</option>\n            `,sheetlist=l[t];for(let e=0;e<sheetlist.length;e++)n+=`<option value='${sheetlist[e]}'>${sheetlist[e]}</option>`;n+="\n              </select>\n              </div>\n              <div class='col-6'>\n                <select class=\"select2 form-control\" name=\"\">\n                  <option value='' selected disabled>select table</option>\n          ";for(let e=0;e<a.length;e++)n+=`<option value='${a[e]}'>${a[e]}</option>`;n+="\n                  </select>\n                </div>\n            </div>\n            </div>\n          "}else{n=`\n            <div class="row renameColumnGroup" style="margin-top:0.5rem;">\n                <div class="col-1" style="color:var(--primary-color); margin:auto;">\n                    <i class="fas fa-trash-alt removeRemoteCol" style="cursor"></i>\n                </div>\n                <div class="col-10" style="margin-left:0.25rem">\n                    <label>${t}</label>\n                    <select class="select2 form-control" name="">\n                    <option value='' selected disabled>select one</option>\n            `;for(let e=0;e<a.length;e++)n+=`<option value='${a[e]}'>${a[e]}</option>`;n+="\n                    </select>\n                </div>\n            </div>\n          "}$(`#renameRemoteColumnContainer${e}`).append(n),$(`#renameRemoteColumnContainer${e}`).find(".renameColumnGroup").last().find("select.select2").each(function(){$(this).select2()}),$(".removeRemoteCol").on("click",function(){$(this).parent().parent().remove()})})}),$(`#remoteConnectionButtonID${e}`).off("click").on("click",function(){$(`#remote_hostname${e}`).val("").trigger("change"),$(`#remote_username${e}`).val("").trigger("change"),$(`#remote_password${e}`).val("").trigger("change"),"SFTP"==$(`#dropdown1${e}`).val()?($(`#remote_username${e}`).parent().css("display","block"),
$(`#remote_password${e}`).parent().css("display","block"),$(`#remote_hostname${e}`).parent().css("display","block"),$(`#remote_username${e}`).parent().find("label").text("Username"),$(`#remote_password${e}`).parent().find("label").text("Password")):"FTP"==$(`#dropdown1${e}`).val()?($(`#remote_username${e}`).parent().css("display","none"),$(`#remote_password${e}`).parent().css("display","none"),$(`#remote_hostname${e}`).parent().css("display","block"),$(`#remote_username${e}`).parent().find("label").text("Username"),$(`#remote_password${e}`).parent().find("label").text("Password")):"AWS_S3"==$(`#dropdown1${e}`).val()?($(`#remote_hostname${e}`).parent().css("display","none"),$(`#remote_username${e}`).parent().css("display","block"),$(`#remote_password${e}`).parent().css("display","block"),$(`#remote_username${e}`).parent().find("label").text("Access key ID"),$(`#remote_password${e}`).parent().find("label").text("Secret access key")):"AZURE"==$(`#dropdown1${e}`).val()&&($(`#remote_hostname${e}`).parent().css("display","none"),$(`#remote_username${e}`).parent().css("display","block"),$(`#remote_password${e}`).parent().css("display","block"),$(`#remote_username${e}`).parent().find("label").text("AccountName"),$(`#remote_password${e}`).parent().find("label").text("AccountKey")),$(`#remoteConnectionModal${e}`).modal("show")}),$(`#validate_remote_connection${e}`).off("click").on("click",function(){$(`#validate_remote_connection${e}`).css("display","none"),$(`#validate_remote_load${e}`).css("display","block"),$.ajax({url:`/users/${urlPath}/computationModule/`,data:{operation:"validate_remote_string",element_id:"",model_name:"upload",connection_name:$(`#remote_connection_name${e}`).val(),hostname:$(`#remote_hostname${e}`).val(),username:$(`#remote_username${e}`).val(),password:$(`#remote_password${e}`).val(),remote_type:$(`#dropdown1${e}`).val()},type:"POST",dataType:"json",success:function(t){$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"fetch_upload_view_custom_messages",element_id:e,messages:JSON.stringify(["connection_validation_message","invalid_credentials_message"])},type:"POST",dataType:"json",success:function(a){"error"!=t.status?(message="",icon="",a.connection_validation_message&&(message=a.connection_validation_message.message,icon=a.connection_validation_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"success",iconHtml:iconHtml,text:message||t.msg}),$(`#remoteConnectionModal${e}`).modal("hide"),$(`#remote_connection_list${e}`).val("defined_connection").trigger("change"),$(`#remote_connection_list${e}`).val("defined_connection").trigger("select2:select"),$(`#remote_connectionpre_list${e}`).attr("data-data",t.connection_name)):(message="",icon="",a.invalid_credentials_message&&(message=a.invalid_credentials_message.message,icon=a.invalid_credentials_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`),Swal.fire({icon:"error",iconHtml:iconHtml,text:message||t.msg})),$(`#validate_remote_connection${e}`).css("display","block"),$(`#validate_remote_load${e}`).css("display","none")},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})},error:function(){Swal.fire({icon:"error",text:data.msg}),$(`#validate_remote_connection${e}`).css("display","block"),$(`#validate_remote_load${e}`).css("display","none")}})}),$(`#savesftpUpload_button_${e}`).off("click").on("click",function(){let a={},l=$(`#dropdown1${e}`).val(),n=$(`#remote_filepath${e}`).val(),i=$(`#remote_filetype${e}`).val(),o=$(`#remote_connectionpre_list${e}`).val(),s=$(`#remote_fileregex${e}`).val();if("csv"==i)$(`#renameRemoteColumnContainer${e}`).find(".renameColumnGroup").each(function(){let e=$(this).find(".col-10").find("label").text(),t=$(this).find(".col-10").find("select").val();a[e]=t});else{let t=[];$(`#renameRemoteColumnContainer${e}`).find(".renameColumnGroup").each(function(){let e=$(this).find("div").eq(1).find("label").text(),l=$(this).find("div").eq(1).find(".row").find("div").eq(0).find("select").val(),n=$(this).find("div").eq(1).find(".row").find("div").eq(1).find("select").val(),i={};a={},i[l]=n,a[e]=i,t.push(a)}),a=t}"SFTP"!=l&&"FTP"!=l&&"AWS_S3"!=l&&"AZURE"!=l||$.ajax({url:window.location.pathname,data:{operation:"upload_sftp_data",datasource:l,file_path:n,file_type:i,connection_name:o,mappingConfig:JSON.stringify(a),file_regex:s,element_id:e,tab_name:t},type:"POST",dataType:"json",success:function(t){$(`#sftpUploadMapper${e}`).modal("hide"),$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"fetch_upload_view_custom_messages",element_id:e,messages:JSON.stringify(["validation_failure_message","sent_approval_upload_message","export_successful_message"])},type:"POST",dataType:"json",success:function(e){var a="";"success"==t.icon?(a="",icon="",e.export_successful_message&&(a=e.export_successful_message.message,a.replaceAll("{Table Name}",t.table_name),icon=e.export_successful_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`)):"info"==t.icon?(a="",icon="",e.sent_approval_upload_message&&(a=e.sent_approval_upload_message.message,a.replaceAll("{Table Name}",t.table_name),icon=e.sent_approval_upload_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`)):"error"==t.icon&&(a="",icon="",e.validation_failure_message&&(a=e.validation_failure_message.message,icon=e.validation_failure_message.icon),iconHtml="",icon&&(iconHtml=`<i class="${icon}" style="border: 0 !important;"></i>`)),Swal.fire({icon:t.icon,iconHtml:iconHtml,text:a||t.msg}).then(e=>{e.isConfirmed&&window.location.reload()})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})})}function rftField(){let e=$(this).parent().find("input").attr("data-element_id"),t=$(this).parent().find("input").attr("data-tablename"),a=$(this).parent().find("input").attr("name").replace(t+"__",""),l=$(this).attr("data-data");$("#rtf_field_dialog").attr("data-element_id",e),$("#rtf_field_dialog").attr("data-table_name",t),$("#rtf_field_dialog").attr("data-field_name",a),$("#rtf_field_dialog").modal("show"),$(`#list_view_edit_modal_${e}`).modal("hide"),l?CKEDITOR.instances.rtf_field_message.setData(l):CKEDITOR.instances.rtf_field_message.setData("")}function save_rtf_field_data(){let e=$("#rtf_field_dialog").attr("data-element_id"),t=$("#rtf_field_dialog").attr("data-field_name"),a=CKEDITOR.instances.rtf_field_message.getData();$(`#id_${t}_${e}`).val(a).trigger("change"),$(`#id_${t}_${e}`).siblings('p[title="RTF editor"]').attr("data-data",a),$("#rtf_field_dialog").removeAttr("data-element_id"),$("#rtf_field_dialog").removeAttr("data-table_name"),$("#rtf_field_dialog").removeAttr("data-field_name"),$("#rtf_field_dialog").modal("hide"),$(`#list_view_edit_modal_${e}`).modal("show")}function showRTFDataListView(){let e=$(this).attr("data-data");if($("#rtf_field_listview_dialog").modal("show"),e){CKEDITOR.instances.rtf_field_message_listview.setData(e);let t=CKEDITOR.instances.rtf_field_message_listview;t&&t.destroy(!0),CKEDITOR.replace("rtf_field_message_listview",{height:300,removeButtons:"CreateDiv,Anchor,Language,About,PasteText,PasteFromWord,Find,Replace,SelectAll,Scayt,Blockquote,Outdent,Indent,BulletedList,NumberedList,CopyFormatting,RemoveFormat,Bold,Italic,Underline,Strike,Subscript,Superscript,TextColor,BidiLtr,BidiRtl,Templates,Link,Unlink,Source,Save,NewPage,ExportPdf,Preview,Print,Styles,Format,Font,FontSize,BGColor,ShowBlocks,Maximize,JustifyLeft,JustifyCenter,JustifyRight,JustifyBlock,HorizontalRule,SpecialChar,PageBreak,Iframe,Flash,Table,Image,Smiley,Source,Save,Templates,CreateDiv,Unlink,Anchor,Language,Link,Image,Flash,Table,HorizontalRule,SpecialChar,PageBreak,Iframe,ShowBlocks,Maximize,About,Print,Preview,ExportPdf,NewPage,Form,Checkbox,Radio,TextField,Textarea,Select,Button,ImageButton,HiddenField,Smiley,Flash,About,Templates,Cut,Copy,Paste,PasteText,PasteFromWord,Redo,Undo,Find,Replace,SelectAll,Scayt,Form,Checkbox,Radio,TextField,Textarea,Select,Button,ImageButton,HiddenField,Bold,Italic,Underline,Strike,Subscript,Superscript,CopyFormatting,RemoveFormat,Outdent,NumberedList,BulletedList,Indent,Blockquote,JustifyLeft,CreateDiv,JustifyCenter,JustifyRight,JustifyBlock,Language,BidiRtl,BidiLtr,Link,Unlink,Anchor,Image,Table,HorizontalRule,Smiley,SpecialChar,PageBreak,Iframe,Styles,Format,Font,FontSize,TextColor,BGColor,Source,Save,NewPage,ExportPdf,Preview,Print,Templates,PasteText,PasteFromWord,Replace,Find,SelectAll,Scayt,Form,Checkbox,Radio,TextField,Textarea,Select,Button,ImageButton,HiddenField,Bold,BidiLtr,BidiRtl,Language,JustifyRight,JustifyBlock,JustifyCenter,CreateDiv,Indent,BulletedList,NumberedList,Outdent,Blockquote,JustifyLeft,CopyFormatting,RemoveFormat,Styles,Format,Font,FontSize,TextColor,BGColor,ShowBlocks,Maximize,About,Italic,Underline,Strike,Subscript,Superscript"}),CKEDITOR.config.removePlugins="exportpdf,elementspath",CKEDITOR.config.resize_enabled=!1,setTimeout(()=>{CKEDITOR.instances.rtf_field_message_listview.insertHtml(e,mode="unfiltered_html"),CKEDITOR.instances.rtf_field_message_listview.setReadOnly(!0)},300)}}function showRTFDataCreateView(){let e=$(this).attr("data-data");if($("#rtf_field_createView_dialog").modal("show"),e){CKEDITOR.instances.rtf_field_message_createView.setData(e);let t=CKEDITOR.instances.rtf_field_message_createView;t&&t.destroy(!0),CKEDITOR.replace("rtf_field_message_createView",{height:300,removeButtons:"CreateDiv,Anchor,Language,About,PasteText,PasteFromWord,Find,Replace,SelectAll,Scayt,Blockquote,Outdent,Indent,BulletedList,NumberedList,CopyFormatting,RemoveFormat,Bold,Italic,Underline,Strike,Subscript,Superscript,TextColor,BidiLtr,BidiRtl,Templates,Link,Unlink,Source,Save,NewPage,ExportPdf,Preview,Print,Styles,Format,Font,FontSize,BGColor,ShowBlocks,Maximize,JustifyLeft,JustifyCenter,JustifyRight,JustifyBlock,HorizontalRule,SpecialChar,PageBreak,Iframe,Flash,Table,Image,Smiley,Source,Save,Templates,CreateDiv,Unlink,Anchor,Language,Link,Image,Flash,Table,HorizontalRule,SpecialChar,PageBreak,Iframe,ShowBlocks,Maximize,About,Print,Preview,ExportPdf,NewPage,Form,Checkbox,Radio,TextField,Textarea,Select,Button,ImageButton,HiddenField,Smiley,Flash,About,Templates,Cut,Copy,Paste,PasteText,PasteFromWord,Redo,Undo,Find,Replace,SelectAll,Scayt,Form,Checkbox,Radio,TextField,Textarea,Select,Button,ImageButton,HiddenField,Bold,Italic,Underline,Strike,Subscript,Superscript,CopyFormatting,RemoveFormat,Outdent,NumberedList,BulletedList,Indent,Blockquote,JustifyLeft,CreateDiv,JustifyCenter,JustifyRight,JustifyBlock,Language,BidiRtl,BidiLtr,Link,Unlink,Anchor,Image,Table,HorizontalRule,Smiley,SpecialChar,PageBreak,Iframe,Styles,Format,Font,FontSize,TextColor,BGColor,Source,Save,NewPage,ExportPdf,Preview,Print,Templates,PasteText,PasteFromWord,Replace,Find,SelectAll,Scayt,Form,Checkbox,Radio,TextField,Textarea,Select,Button,ImageButton,HiddenField,Bold,BidiLtr,BidiRtl,Language,JustifyRight,JustifyBlock,JustifyCenter,CreateDiv,Indent,BulletedList,NumberedList,Outdent,Blockquote,JustifyLeft,CopyFormatting,RemoveFormat,Styles,Format,Font,FontSize,TextColor,BGColor,ShowBlocks,Maximize,About,Italic,Underline,Strike,Subscript,Superscript"}),CKEDITOR.config.removePlugins="exportpdf,elementspath",CKEDITOR.config.resize_enabled=!1,setTimeout(()=>{CKEDITOR.instances.rtf_field_message_createView.insertHtml(e,mode="unfiltered_html"),CKEDITOR.instances.rtf_field_message_createView.setReadOnly(!0)},300)}}function showRejected_in_tabular(){let e=$(this).attr("data-json");if($("#rejected_records_tabular").find(".modal-body").empty(),e){var t=JSON.parse(e),a="<table id='table-as-field-draft-table'><thead><tr>";for(var l in t[0])t[0].hasOwnProperty(l)&&(a+="<th>"+l+"</th>");a+="</tr></thead><tbody>";for(var n=0;n<t.length;n++){for(var l in a+="<tr>",t[n])t[n].hasOwnProperty(l)&&(a+="<td>"+t[n][l]+"</td>");a+="</tr>"}a+="</tbody></table>",$("#rejected_records_tabular").find(".modal-body").append(a)}a=$("#rejected_records_tabular").find(".modal-body > table").DataTable({autoWidth:!0,scrollCollapse:!0,responsive:!0,autoWidth:!0,scrollY:"50vh",scrollX:!0,autoWidth:!1,ordering:!1,columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"}]});setTimeout(()=>{a.columns.adjust()},200),$("#rejected_records_tabular").modal("show")}function showTableDataCreateView(){let e=$(this).attr("data-json");if($("#table_field_createView_dialog").find(".modal-body").empty(),e){var t=JSON.parse(e),a="<table id='table_field_tabular'><thead><tr>";for(var l in t[0])t[0].hasOwnProperty(l)&&(a+="<th>"+l+"</th>");a+="</tr></thead><tbody>";for(var n=0;n<t.length;n++){for(var l in a+="<tr>",t[n])t[n].hasOwnProperty(l)&&(a+="<td>"+t[n][l]+"</td>");a+="</tr>"}a+="</tbody></table>",$("#table_field_createView_dialog").find(".modal-body").append(a)}a=$("#table_field_createView_dialog").find(".modal-body > table").DataTable({autoWidth:!0,scrollCollapse:!0,responsive:!0,autoWidth:!0,scrollY:"50vh",scrollX:!0,autoWidth:!1,ordering:!1,columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"}]});setTimeout(()=>{a.columns.adjust()},200),$("#draftModal").modal("hide"),$("#table_field_createView_dialog").modal("show")}function approval_table_comments_configs(){parsedData=JSON.parse($(this).attr("data-data")),$("#approval_table_Modal").find(".modal-body").empty();var e=`\n    <table id="approval_table${$(this).attr("data-s_id")}" class="row-border display" style="width: 100%;">\n                        <thead>\n                          <tr>\n                            <th>Level</th>\n                            <th>Approver</th>\n                            <th>Comments</th>\n                          </tr>\n                        </thead>\n                        <tbody>\n                        </tbody>\n                      </table>`;$("#approval_table_Modal").find(".modal-body").append(e),$("#approval_table_Modal").modal("show");for(let[e,t]of Object.entries(parsedData))string="<tr>",string+=`<td class="view_details_wrap">${e.split("___")[1]}</td><td class="view_details_wrap">${e.split("___")[0]}</td><td class="view_details_wrap">${t.replaceAll("&rsquo;","'").replaceAll("&rdquo;",'"').replaceAll("&rsquo;","").replaceAll("&rdquo;","").replaceAll("&lsquo;","").replaceAll("&ldquo;","").replaceAll(""," ")}</td>`,string+="</tr>",$("#approval_table_Modal").find(".modal-body").find("table").find("tbody").append(string);var t=$("#approval_table_Modal").find(".modal-body").find("table").DataTable({autoWidth:!0,scrollCollapse:!0,responsive:!0,autoWidth:!0,scrollY:"50vh",scrollX:!0,autoWidth:!1,ordering:!1,columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"}]});setTimeout(()=>{t.columns.adjust()},200)}function showHistory_in_tabular(){let e=$(this).attr("data-json");if($("#view_history_tabular").find(".modal-body").empty(),e){var t=JSON.parse(e),a="<table id='table-as-field-history-table'><thead><tr>";for(var l in t[0])t[0].hasOwnProperty(l)&&(a+="<th>"+l+"</th>");a+="</tr></thead><tbody>";for(var n=0;n<t.length;n++){for(var l in a+="<tr>",t[n])t[n].hasOwnProperty(l)&&(a+="<td>"+t[n][l]+"</td>");a+="</tr>"}a+="</tbody></table>",$("#view_history_tabular").find(".modal-body").append(a)}a=$("#view_history_tabular").find(".modal-body > table").DataTable({autoWidth:!0,scrollCollapse:!0,responsive:!0,autoWidth:!0,scrollY:"50vh",scrollX:!0,autoWidth:!1,ordering:!1,columnDefs:[{targets:"_all",className:"dt-center allColumnClass all"}]});setTimeout(()=>{a.columns.adjust()},200),$("#view_history_tabular").modal("show")}function EditApprovalData(){let e=$(this).attr("data-elementID");const t=window.location.pathname.split("/")[4];let a=$(this).parent().find("textarea").val(),l=$(this).parent().parent().parent().parent().find(`#id_tablename_${e}`).val(),n=$(this).attr("data-editapproval_fields");n=n?JSON.parse(n):[];let i=$(this).attr("data-editapproval_table"),o=$(this);a?(a=JSON.parse(a.replaceAll("\\'","'")),a=a[0]):a=[];let s=[],r=0;a&&$.ajax({url:`/users/${urlPath}/${t}/`,data:{model_name:l,element_id:e,operation:"get_listview_column"},type:"POST",dataType:"json",success:function(t){if($(`#tables_edit_json_${e}`).find(".editjson_tblef_tableHeader").empty(),$(`#tables_edit_json_${e}`).find("tbody").empty(),$.each(Object.keys(t),function(l,o){if("UniqueIDField"!=t[o].internal_type&&a.hasOwnProperty(Object.keys(t)[l])){const a=t[o].verbose_name;$(`#tables_edit_json_${e}`).find(".editjson_tblef_tableHeader").append(`<th data-fname=${Object.keys(t)[l]} style="width:150px;text-align: center;white-space: pre-line;">&nbsp;&nbsp;${a}</th>`),i&&n.length&&(n.includes(Object.keys(t)[l])&&s.push(r),r++)}}),$(`#tables_edit_json_${e}`).find("tbody").append('<tr style="display: flex;justify-content: space-around;align-items:flex-start"></tr>'),$.each(Object.keys(t),function(l,n){const i=t[n].internal_type;if("UniqueIDField"!=i){let o;if("ForeignKey"===String(i)&&a.hasOwnProperty(Object.keys(t)[l]))o="text",$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().append(`\n                <td>\n                    <select data-fname="${Object.keys(t)[l]}" style="width:150px;" form="columnform" class="form-control select2 p-2 ${e}_${Object.keys(t)[l]}">\n                    </select>\n                </td>\n                    `),$.each(Object.keys(t),function(a,n){if("ForeignKey"===String(t[n].internal_type)){const a=t[n].Choices;for(const[n,i]of Object.entries(a))$(`.${e}_${Object.keys(t)[l]}`).last().append(`<option name="${i}" value="${n}">${i}</option>`)}}),a.hasOwnProperty(Object.keys(t)[l])&&$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().find(`select[data-fname="${Object.keys(t)[l]}"]`).val(a[Object.keys(t)[l]]).trigger("change");else if("TextField"!==String(i)&&"ConcatenationField"!==String(i)&&"CardField"!==String(i)&&"CardCvvField"!==String(i)&&"CardTypeField"!==String(i)&&"RTFField"!==String(i)&&"MultiselectField"!==String(i)||!a.hasOwnProperty(Object.keys(t)[l]))if("DateTimeField"===String(i)&&a.hasOwnProperty(Object.keys(t)[l]))o="datetime-local",$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().append(`<td>\n                  <input data-fname="${Object.keys(t)[l]}" type="${o}" step="1" class="form-control datetimepickerinput p-2" style="width:150px;">\n                  </td>\n                  `),a.hasOwnProperty(Object.keys(t)[l])&&$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().find(`input[data-fname="${Object.keys(t)[l]}"]`).val(a[Object.keys(t)[l]]).trigger("change");else if("DateField"===String(i)&&a.hasOwnProperty(Object.keys(t)[l]))o="date",$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().append(`<td>\n                  <input data-fname="${Object.keys(t)[l]}" type="${o}" step="1" class="form-control datetimepickerinput p-2" style="width:150px;">\n                  </td>\n                  `),a.hasOwnProperty(Object.keys(t)[l])&&$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().find(`input[data-fname="${Object.keys(t)[l]}"]`).val(a[Object.keys(t)[l]]).trigger("change");else if("TimeField"===String(i)&&a.hasOwnProperty(Object.keys(t)[l]))o="time",use_sec=t[n].use_seconds,"false"==use_sec?$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().append(`<td>\n                    <input data-fname="${Object.keys(t)[l]}" type="${o}" class="form-control timepickerinput p-2" style="width:150px;" data-dp-format="HH:mm">\n                    </td>\n                    `):$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().append(`<td>\n                    <input data-fname="${Object.keys(t)[l]}" type="${o}" class="form-control timepickerinput p-2" style="width:150px;" data-dp-format="HH:mm:ss">\n                    </td>\n                    `),a.hasOwnProperty(Object.keys(t)[l])&&$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().find(`input[data-fname="${Object.keys(t)[l]}"]`).val(a[Object.keys(t)[l]]).trigger("change");else if("EmailTypeField"===String(i)&&a.hasOwnProperty(Object.keys(t)[l]))o="email",$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().append(`<td>\n                  <input data-fname="${Object.keys(t)[l]}" type="${o}" class="form-control p-2" style="width:150px;">\n                  </td>\n                  `),a.hasOwnProperty(Object.keys(t)[l])&&$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().find(`input[data-fname="${Object.keys(t)[l]}"]`).val(a[Object.keys(t)[l]]).trigger("change");else if("UniqueIDField"===String(i)&&a.hasOwnProperty(Object.keys(t)[l]))o="text",$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().append(`<td>\n                  <input data-fname="${Object.keys(t)[l]}" type="${o}" class="form-control p-2" style="width:150px;" disabled>\n                  </td>\n                  `),a.hasOwnProperty(Object.keys(t)[l])&&$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().find(`input[data-fname="${Object.keys(t)[l]}"]`).val(a[Object.keys(t)[l]]).trigger("change");else if("BooleanField"===String(i)&&a.hasOwnProperty(Object.keys(t)[l]))o="checkbox",$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().append(`<td style="padding-left:3rem;padding-right:3rem;">\n                  <input type='checkbox' data-fname="${Object.keys(t)[l]}" class="form-control p-2">\n                  </td>\n                  `),a.hasOwnProperty(Object.keys(t)[l])&&a[Object.keys(t)[l]]&&$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().find(`input[data-fname="${Object.keys(t)[l]}"]`).prop("checked",!0);else if("CharField"===String(i)&&a.hasOwnProperty(Object.keys(t)[l])){o="text",choices=[],t[n].hasOwnProperty("choices")?choices=t[n].choices:choices=[];const i=new Set;for(let e=0;e<choices.length;e++)for(let t=0;t<choices[e].length;t++)i.add(choices[e][t]);const s=[...i];if(choices.length>0){$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().append(`<td>\n                    <select data-fname="${Object.keys(t)[l]}" style="width:150px;" form="columnform" class="form-control select2 p-2 ${e}_${Object.keys(t)[l]}">\n                    </select>\n                    `);for(let a=0;a<s.length;a++)$(`.${e}_${Object.keys(t)[l]}`).last().append(`<option name="${s[a]}" value="${s[a]}">${s[a]}</option>`);a.hasOwnProperty(Object.keys(t)[l])&&$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().find(`select[data-fname="${Object.keys(t)[l]}"]`).val(a[Object.keys(t)[l]]).trigger("change")}else $(`#tables_edit_json_${e}`).find("tbody").find("tr").last().append(`<td>\n                    <input data-fname="${Object.keys(t)[l]}" type="${o}" class="form-control p-2" style="width:150px;">\n                    </td>\n                    `),a.hasOwnProperty(Object.keys(t)[l])&&$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().find(`input[data-fname="${Object.keys(t)[l]}"]`).val(a[Object.keys(t)[l]]).trigger("change")}else"URLField"===String(i)&&a.hasOwnProperty(Object.keys(t)[l])?(o="url",$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().append(`<td>\n                  <input data-fname="${Object.keys(t)[l]}" type="${o}" class="form-control p-2" style="width:150px;">\n                  </td>\n                  `),a.hasOwnProperty(Object.keys(t)[l])&&$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().find(`input[data-fname="${Object.keys(t)[l]}"]`).val(a[Object.keys(t)[l]]).trigger("change")):"FileField"===String(i)&&a.hasOwnProperty(Object.keys(t)[l])?(o="file",accept="*",t[n].file_extension&&("Any"==t[n].file_extension?accept="*":"Images"==t[n].file_extension?accept="image/*":"Document"==t[n].file_extension?accept=".doc,.docx,.rtf,.pdf,.csv,xlsx,.odt,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document":"PDF"==t[n].file_extension&&(accept=".pdf")),$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().append(`<td>\n                  <input accept=${accept} type='file' data-fname="${Object.keys(t)[l]}" data-existing-value="${a[Object.keys(t)[l]]}" class='form-control p-2' style="width:150px;" multiple>\n                  </td>\n                  `)):"UserField"===String(i)&&a.hasOwnProperty(Object.keys(t)[l])?(o="text",$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().append(`\n                  <td>\n                      <select data-fname="${Object.keys(t)[l]}" style="width:150px;" form="columnform" class="form-control select2 p-2 ${e}_${Object.keys(t)[l]}">\n                      </select>\n                  </td>\n                      `),$.each(Object.keys(t),function(a,n){if("UserField"===String(t[n].internal_type)){const a=t[n].Choices;for(let n in a)$(`.${e}_${Object.keys(t)[l]}`).last().append(`<option name="${a[n]}" value="${a[n]}">${a[n]}</option>`)}}),a.hasOwnProperty(Object.keys(t)[l])&&$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().find(`select[data-fname="${Object.keys(t)[l]}"]`).val(a[Object.keys(t)[l]]).trigger("change")):a.hasOwnProperty(Object.keys(t)[l])&&(o="number",$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().append(`<td>\n                    <input data-fname="${Object.keys(t)[l]}" type="${o}" step="1" class="form-control p-2" style="width:150px;">\n                    </td>\n                    `),a.hasOwnProperty(Object.keys(t)[l])&&$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().find(`input[data-fname="${Object.keys(t)[l]}"]`).val(a[Object.keys(t)[l]]).trigger("change"));else o="text",$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().append(`<td>\n                  <input data-fname="${Object.keys(t)[l]}" type="${o}" class="form-control p-2" style="width:150px;">\n                  </td>\n                  `),a.hasOwnProperty(Object.keys(t)[l])&&$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().find(`input[data-fname="${Object.keys(t)[l]}"]`).val(a[Object.keys(t)[l]]).trigger("change");$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().find("select").each(function(){$(this).select2()}),$(`#tables_edit_json_${e}`).find("tbody").find("tr").last().find(".timepickerinput").each(function(){var e=$(this).attr("data-dp-format");$(this).datetimepicker({showClose:!0,showClear:!0,showTodayButton:!0,format:e,locale:"en"})})}}),s.length>0)for(let t=0;t<s.length;t++)$(`#tables_edit_json_${e}`).find("thead").find("tr").find("th").eq(s[t]).css("display","none"),$(`#tables_edit_json_${e}`).find("tbody").find("tr").find("td").eq(s[t]).css("display","none");$(`#list_view_edit_json_modal_${e}`).modal("show")},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}}),$(`#save_editjson_field_${e}`).off("click").on("click",function(){header_list=[],$(`#tables_edit_json_${e}`).find("thead").find("tr").find("th").each(function(){val=$(this).attr("data-fname"),header_list.push(val)}),v_dict=[],temp_dict={},$(`#tables_edit_json_${e}`).find("tbody").find("tr").each(function(){temp_dict={},$(this).find("td").each(function(e){$(this).find("input").is(":checkbox")?$(this).find("input").is(":checked")?val=1:val=0:$(this).find('input[type="file"]').length?$(this).find("input").val()?val=$(this).find("input,select").val():val=$(this).find("input").attr("data-existing-value"):val=$(this).find("input,select").val(),temp_dict[header_list[e]]=val}),v_dict.push(temp_dict)}),temp_v_dict=v_dict[0],data_to_edit_temp=a;for(let[e,t]of Object.entries(data_to_edit_temp))e in temp_v_dict||(temp_v_dict[e]=t);$(o).parent().find("textarea").val(JSON.stringify([temp_v_dict])),$(`#list_view_edit_json_modal_${e}`).modal("hide")})}function EditApprovalGroupUser(){let e=$(this).attr("data-elementID"),t=$(this).attr("data-ug_iden");if(maximum_levels_allowed=$(`#list_view_edit_modal_${e}`).attr("data-maximum_levels_allowed"),maximum_approvers_allowed=$(`#list_view_edit_modal_${e}`).attr("data-maximum_approvers_allowed"),$(`#select_edit_user_${e}`).select2({maximumSelectionLength:maximum_approvers_allowed}),$(`#select_edit_group_${e}`).select2({maximumSelectionLength:maximum_approvers_allowed}),"approver group"==t){let t=$(this).parent().find("input").val();t&&(t=JSON.parse(t)),$(`#select_edit_user_${e}`).parent().css("display","none"),$(`#select_edit_group_${e}`).parent().css("display","block"),$(`#select_edit_group_${e}`).val(t).trigger("change")}else{let t=$(this).parent().find("input").val();t&&(t=JSON.parse(t)),$(`#select_edit_user_${e}`).parent().css("display","block"),$(`#select_edit_group_${e}`).parent().css("display","none"),$(`#select_edit_user_${e}`).val(t).trigger("change")}$(`#list_view_edit_approver_data_modal_${e}`).modal("show"),$(`#save_editapprover_data_field_${e}`).off("click").on("click",function(){$(`#list_view_edit_approver_data_modal_${e}`).modal("hide"),$(`#approvalCommentModal_${e}`).find(".modal-title").text("Approval Level Change Comment"),$(`#approvalCommentModal_${e}`).find("#approval_final_send").text("Save comment"),$(`#approvalCommentModal_${e}`).css("display","block"),$(`#approvalCommentModal_${e}`).css("opacity",1),$(`#approvalCommentModal_${e}`).css("z-index",2e3),$(`#approvalCommentModal_${e}`).find("#approval_final_send").removeAttr("onclick"),$(`#approvalCommentModal_${e}`).find("#approval_final_send").off("click").on("click",function(){let a=CKEDITOR.instances[`approvalCommentText${e}`].getData().replaceAll("&#39;","&rsquo;").replaceAll("&quot","&rdquo;");$(`#list_view_edit_modal_${e}`).find('input[name="approval_level_change_comment_edit"]').attr("value",a),"approver group"==t?(new_group_vals=$(`#select_edit_group_${e}`).val(),$(`#id_approver_group_${e}`).val(JSON.stringify(new_group_vals)).trigger("change")):(new_user_vals=$(`#select_edit_user_${e}`).val(),$(`#id_approver_user_${e}`).val(JSON.stringify(new_user_vals)).trigger("change")),$(`#approvalCommentModal_${e}`).css("z-index",1050),$(`#approvalCommentModal_${e}`).css("opacity",0),$(`#approvalCommentModal_${e}`).css("display","none"),$(`#approvalCommentModal_${e}`).find("#approval_final_send").attr("onclick","approve_ind.call(this)")}),$(`#approvalCommentModal_${e}`).find(".close").on("click",function(){$(`#approvalCommentModal_${e}`).css("z-index",1050),$(`#approvalCommentModal_${e}`).css("opacity",0),$(`#approvalCommentModal_${e}`).css("display","none"),$(`#approvalCommentModal_${e}`).find("#approval_final_send").attr("onclick","approve_ind.call(this)"),$(`#list_view_edit_approver_data_modal_${e}`).modal("show")})})}function approval_table_audit_logs(e,t){pdata=$(this).attr("data-data").replaceAll("'",'"'),pdata=pdata.replaceAll('\\\\"',"'"),pdata=pdata.replaceAll("\\'",'"'),parsedData=JSON.parse(pdata);let a={Time:"time",Action:"action",User:"user",Value:"value",Level:"level"},l=["Level","Action","User","Time","Value"];Object.keys(t).length>0&&(l=Object.values(t));for(let e=0;e<parsedData.length;e++)for(let[t,a]of Object.entries(parsedData[e]))for(let e=0;e<a.length;e++)a[e].level=t;if(Object.keys(t).length>0){let e=[],l={};for(let n=0;n<parsedData.length;n++)for(let[i,o]of Object.entries(parsedData[n])){l={},l[i]=[];for(let e=0;e<o.length;e++){tt={};for(let[l,n]of Object.entries(t))tt[a[n]]=o[e][a[n]];l[i].push(tt)}e.push(l)}parsedData=e}let n={},i=[];$(this).attr("data-column-alignment")?n=JSON.parse($(this).attr("data-column-alignment")):i.push({targets:"_all",className:"dt-center allColumnClass all"}),$("#approval_table_Modal").find(".modal-header").find("h5").text("Approval Table"),$("#approval_table_Modal").find(".modal-body").empty();var o=`\n    <table id="approval_table${$(this).attr("data-s_id")}" class="row-border display" style="width: 100%;">\n                        <thead>\n                          <tr>`;for(let e=0;e<l.length;e++)"Value"==l[e]?o+=`<th style="width: 15rem;">${l[e]}</th>`:o+=`<th>${l[e]}</th>`;o+="\n                          </tr>\n                        </thead>\n                        <tbody>\n                        </tbody>\n                      </table>",
$("#approval_table_Modal").find(".modal-body").append(o),$("#approval_table_Modal").find(".modal-header").find("h5").text("Approval audit log"),$("#approval_table_Modal").modal("show");for(let t=0;t<parsedData.length;t++)for(let[a,l]of Object.entries(parsedData[t])){string="<tr>",string_bk=string;for(let t=0;t<l.length;t++){string2="";for(let[a,n]of Object.entries(l[t])){if("value"==a&&n&&n.constructor!==Array&&-1!=n.indexOf(" from ")&&-1!=n.indexOf(" to ")&&"Comment"!=l[t].action){var s="",r=n.indexOf("from "),d=n.indexOf(" to "),c=n.slice(0,r),p=n.slice(r,d).split("from ")[1],_=n.slice(d).split(" to ")[1];if(n.startsWith("approval_level_config")){var m=JSON.parse(p.replaceAll("'",'"')),f=JSON.parse(_.replaceAll("'",'"')),u="",v="";for(let t in m.level_config){v+=`<tr><td>${t}</td>`;for(let[a,l]of Object.entries(m.level_config[t])){if("user_list"==a){tmp=[];for(let t=0;t<l.length;t++)l[t]in e?tmp.push(e[l[t]]):tmp.push(l[t]);l=tmp}v+=`<td style="text-align:left;">${l}</td>`}v+="</tr>"}u+="<th>Level</th>";for(let e of Object.keys(m.level_config[0]))u+=`<th>${e}</th>`;var h=`<table class="row-border"><thead><tr>${u}</tr></thead><tbody>${v}</tbody></table>`,y="",b="";for(let t in f.level_config){b+=`<tr><td>${t}</td>`;for(let[a,l]of Object.entries(f.level_config[t])){if("user_list"==a){tmp=[];for(let t=0;t<l.length;t++)l[t]in e?tmp.push(e[l[t]]):tmp.push(l[t]);l=tmp}b+=`<td style="text-align:left;">${l}</td>`}b+="</tr>"}y+="<th>Level</th>";for(let e of Object.keys(f.level_config[0]))y+=`<th>${e}</th>`;var g=`<table class="row-border"><thead><tr>${y}</tr></thead><tbody>${b}</tbody></table>`;h=`<table class="row-border"><thead><tr>${u}</tr></thead><tbody>${v}</tbody></table>`}else h=p,g=_;s=`<div><p style="text-align:center;">${c}</p><p style="text-align:center;margin-bottom:0;">From</p><p>${h}</p><p style="text-align:center;margin-bottom:0;">To</p><p>${g}</p></div>`,n=s}"value"==a?(n=String(n).replaceAll(/\\r/g,"<br>"),n=n.replaceAll(/\\n/g,"<br>"),n=n.replaceAll(/\\t/g,"&nbsp;&nbsp;"),n=String(n).replaceAll(/<p><\/p>/g,""),n=n.replaceAll(/<br><br>/g,"<br>"),string2+=`<td><div style="white-space: normal;max-width: 47rem; display:flex; flex-direction:column;word-break: break-word;"><p>${n}</p></div></td>`):string2+="user"==a&&n in e?`<td>${e[n]}</td>`:`<td>${n}</td>`}string=string_bk+string2+"</tr>",$("#approval_table_Modal").find(".modal-body > table > tbody").append(string)}}if(Object.keys(n).length>0){var w="center",x="center";if(n.global_header&&(w=n.global_header),n.global_content&&(x=n.global_content),n.field_level_config.Level.header&&n.field_level_config.Level.content){var k=n.field_level_config.Level.header,S=n.field_level_config.Level.content;i.push({targets:[0],className:`dt-head-${k} dt-body-${S} allColumnClass all`})}else i.push({targets:[0],className:`dt-head-${w} dt-body-${x} allColumnClass all`});if(n.field_level_config.Action.header&&n.field_level_config.Action.content){k=n.field_level_config.Action.header,S=n.field_level_config.Action.content;i.push({targets:[1],className:`dt-head-${k} dt-body-${S} allColumnClass all`})}else i.push({targets:[1],className:`dt-head-${w} dt-body-${x} allColumnClass all`});if(n.field_level_config.User.header&&n.field_level_config.User.content){k=n.field_level_config.User.header,S=n.field_level_config.User.content;i.push({targets:[2],className:`dt-head-${k} dt-body-${S} allColumnClass all`})}else i.push({targets:[2],className:`dt-head-${w} dt-body-${x} allColumnClass all`});if(n.field_level_config.Time.header&&n.field_level_config.Time.content){k=n.field_level_config.Time.header,S=n.field_level_config.Time.content;i.push({targets:[3],className:`dt-head-${k} dt-body-${S} allColumnClass all`})}else i.push({targets:[3],className:`dt-head-${w} dt-body-${x} allColumnClass all`});if(n.field_level_config.Value.header&&n.field_level_config.Value.content){k=n.field_level_config.Value.header,S=n.field_level_config.Value.content;i.push({targets:[4],className:`dt-head-${k} dt-body-${S} allColumnClass all`})}else i.push({targets:[4],className:`dt-head-${w} dt-body-${x} allColumnClass all`})}else i.push({targets:"_all",className:"dt-center allColumnClass all"});var C=$("#approval_table_Modal").find(".modal-body > table").DataTable({autoWidth:!0,scrollCollapse:!0,responsive:!0,scrollY:"50vh",scrollX:!0,ordering:!1,columnDefs:i});setTimeout(()=>{C.columns.adjust()},200)}function EditAppLevelConfig(){let e=$(this).attr("data-elementID"),t=$(this).parent().find("textarea").val(),a=!1;t&&(t=JSON.parse(t));let l=$(this).attr("data-app_table_sep");null==l&&(l=" ");let n=$(this).attr("data-app_table_cols");null==n&&(n=JSON.stringify(["username","first_name","last_name"])),$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").remove(),$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"get_user_group_list",app_table_sep:l,app_table_cols:n},type:"POST",dataType:"json",success:function(l){if(user_list=l.user_list,group_list=l.group_list,maximum_levels_allowed=$(`#list_view_edit_modal_${e}`).attr("data-maximum_levels_allowed"),maximum_approvers_allowed=$(`#list_view_edit_modal_${e}`).attr("data-maximum_approvers_allowed"),$(`#modalBody${e}_applevel`).find(".card-body").find(".disabled_lists").empty(),$(`#modalBody${e}_applevel`).find(".card-body").find("#approval-reorder-div").find(".approval-list").empty(),$(`#addRow_app_level${e}`).off("click").on("click",function(){levels=$("#approval-reorder-div ul li").find(".newlevel").length,""!=maximum_levels_allowed&&levels==maximum_levels_allowed?(level_html=`\n              <div class="row" id="maximum_level_count_app_level_config" style="color:red;display:block;">\n              <div class="form-group col-12">\n                <span>\n                  Maximum Approver Levels count : ${maximum_levels_allowed}.\n                </span>\n              </div>\n            </div>\n              `,$(level_html).insertAfter(`#addRow_app_level${e}`),$(`#addRow_app_level${e}`).prop("disabled",!0)):$(`#modalBody${e}_applevel`).find(".card-body").find("#approval-reorder-div").find(".approval-list").append('\n              <li class="btn btn-sm btn-light col" style="height:auto;margin: 5px auto;">\n                <div class="form-group row newlevel">\n                  <div class="col-1"><input class="input form-control" name="level_no" style="width:55px;margin:auto;text-align:center" type="integer"></div>\n                  <div class="col-2">\n                    <select class="form-control select2 approval_type_applvl" name="approval_type">\n                      <option value="" selected disabled>Select One</option>\n                      <option value="static">Static Group Based</option>\n                      <option value="static_user">Static User Based</option>\n                    </select>\n                  </div>\n                  <div class="col-2"><select class="form-control select2" name="group_list" disabled multiple></select></div>\n                  <div class="col-2"><select class="form-control select2" name="user_list" disabled multiple></select></div>\n                  <div class="col-3">\n                    <select class="form-control select2" name="approver_type">\n                      <option value="several">Several Approvers</option>\n                      <option value="joint">Joint Approvers</option>\n                    </select>\n                  </div>\n                  <div class="col-1">\n                    <a href="javascript:void(0)" class="remove_app_level fa fa-times" data-approved="no"></a>\n                  </div>\n                  <div class="col-1">\n                    <span class="ui-icon ui-icon-arrowthick-2-n-s float-right mt-1"></span>\n                  </div>\n                </div>\n              </li>\n            '),$(".approval-list").sortable({update:function(e,t){node_list=document.getElementById("approval-lists").querySelectorAll("input[name=level_no]");for(var a=0;a<node_list.length;++a)input=node_list[a],input.value=a}}),$(".remove_app_level").off("click").on("click",function(){let t=0,a=0,l=[];if($("#maximum_level_count_app_level_config").css("display","none"),$(`#addRow_app_level${e}`).prop("disabled",!1),$(`#modalBody${e}_applevel`).find(".newlevel").find("a").each(function(){"no"==$(this).attr("data-approved")?(a+=1,l.push($(this))):t+=1}),1==a)for(let e=0;e<l.length;e++)$(l[e]).css("pointer-events","none");else $(this).parent().parent().parent().remove()});for(let t=0;t<group_list.length;t++)$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(2).find("select").append(`<option value="${group_list[t]}">${group_list[t]}</option>`);for(let[t,a]of Object.entries(user_list))$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(3).find("select").append(`<option value="${t}">${a}</option>`);$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("select.select2").each(function(){$(this).select2()}),$("[name=group_list]").select2({maximumSelectionLength:maximum_approvers_allowed}),$("[name=user_list]").select2({maximumSelectionLength:maximum_approvers_allowed}),$(".approval_type_applvl").off("select2:select").on("select2:select",function(){"static"==$(this).val()?($(this).parent().parent().find("div").eq(2).find("select").prop("disabled",!1),$(this).parent().parent().find("div").eq(3).find("select").prop("disabled",!0)):"static_user"==$(this).val()&&($(this).parent().parent().find("div").eq(2).find("select").prop("disabled",!0),$(this).parent().parent().find("div").eq(3).find("select").prop("disabled",!1))}),$(`#modalBody${e}_applevel`).find(".newlevel").find("a").each(function(){"no"==$(this).attr("data-approved")&&$(this).css("pointer-events","all")})}),t){let l=t.current_level,n=t.level_config;$(`#edit_app_level_current_level${e}`).text(`Current level: ${l}`);for(let t=0;t<n.length;t++)$(`#addRow_app_level${e}`).trigger("click"),$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(0).find("input").val(t).trigger("change"),$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(0).find("input").prop("disabled",!0),$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(1).find("select").val(n[t].approval_type).trigger("change"),$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(1).find("select").prop("disabled",!0),n[t].hasOwnProperty("group_list")&&(a=!0,$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(2).find("select").prop("disabled",!0),$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(3).find("select").prop("disabled",!0),$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(2).find("select").val(n[t].group_list).trigger("change")),n[t].hasOwnProperty("user_list")&&($(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(2).find("select").prop("disabled",!0),$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(3).find("select").prop("disabled",!0),$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(3).find("select").val(n[t].user_list).trigger("change")),$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(4).find("select").val(n[t].approver_type).trigger("change"),$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(4).find("select").prop("disabled",!0),$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(5).find("input").val(t).trigger("change"),$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(5).find("input").prop("disabled",!0),$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(6).find("a").css("pointer-events","none"),$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(6).find("a").attr("data-approved","yes"),t>=l?(n[t].hasOwnProperty("group_list")&&$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(2).find("select").prop("disabled",!1),n[t].hasOwnProperty("user_list")&&$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(3).find("select").prop("disabled",!1),$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(4).find("select").prop("disabled",!1),$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(5).find("input").prop("disabled",!1),$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(6).find("a").css("pointer-events","all"),$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().find("div").eq(6).find("a").attr("data-approved","no")):(element=$(`#modalBody${e}_applevel`).find(".card-body").find(".newlevel").last().parent(),$(`#modalBody${e}_applevel`).find(".card-body").find(".disabled_lists").find(".disabled_lists").append(element),element.find(".ui-icon.ui-icon-arrowthick-2-n-s").remove())}$(`#list_view_edit_applevel_modal_${e}`).modal("show"),$(`#save_editapp_level_field_${e}`).off("click").on("click",function(){$(`#list_view_edit_applevel_modal_${e}`).modal("hide"),$("#"+e+"_tab_content").find(`#approvalCommentModal_${e}`).find(".modal-title").text("Approval Level Change Comment"),$("#"+e+"_tab_content").find(`#approvalCommentModal_${e}`).find("#approval_final_send").text("Save comment"),$("#"+e+"_tab_content").find(`#approvalCommentModal_${e}`).css("display","block"),$("#"+e+"_tab_content").find(`#approvalCommentModal_${e}`).css("opacity",1),$("#"+e+"_tab_content").find(`#approvalCommentModal_${e}`).css("z-index",2e3),$("#"+e+"_tab_content").find(`#approvalCommentModal_${e}`).find("#approval_final_send").attr("data-approval_type","app_lvl_change"),$("#"+e+"_tab_content").find(`#approvalCommentModal_${e}`).find("#approval_final_send").attr("onclick",`SaveAppLevelChange.call(this,'${e}',${a})`),$("#"+e+"_tab_content").find(`#approvalCommentModal_${e}`).find(".close").on("click",function(){$("#"+e+"_tab_content").find(`#approvalCommentModal_${e}`).css("display","none"),$("#"+e+"_tab_content").find(`#approvalCommentModal_${e}`).css("opacity",0),$("#"+e+"_tab_content").find(`#approvalCommentModal_${e}`).css("z-index",1050),$("#"+e+"_tab_content").find(`#approvalCommentModal_${e}`).find("#approval_final_send").attr("onclick","approve_ind.call(this)"),$(`#list_view_edit_applevel_modal_${e}`).modal("show")})}),$("[name=group_list]").select2({maximumSelectionLength:maximum_approvers_allowed}),$("[name=user_list]").select2({maximumSelectionLength:maximum_approvers_allowed})},error:function(){Swal.fire({icon:"error",text:"Error while getting the users/group list."})}})}function SaveAppLevelChange(e,t){temp_list=[],relevel=[],final_save_dict={},curr_level=parseInt($(`#edit_app_level_current_level${e}`).text().split(": ")[1]);let a=CKEDITOR.instances[`approvalCommentText${e}`].getData().replaceAll("&#39;","&rsquo;").replaceAll("&quot","&rdquo;");$(`#modalBody${e}_applevel`).find(".newlevel").each(function(){temp_dict={},$(this).find("div").find("select,input").each(function(){"group_list"==$(this).attr("name")||"user_list"==$(this).attr("name")?"group_list"==$(this).attr("name")&&t?0!=$(this).val().length&&(temp_dict[$(this).attr("name")]=$(this).val()):"user_list"!=$(this).attr("name")||t||0!=$(this).val().length&&(temp_dict[$(this).attr("name")]=$(this).val()):null!=$(this).attr("name")&&("relevel"!=$(this).attr("name")&&"level_no"!=$(this).attr("name")&&(temp_dict[$(this).attr("name")]=$(this).val()),"relevel"==$(this).attr("name")&&relevel.push(parseInt($(this).val())))}),temp_list.push(temp_dict)}),final_save_dict.level_config=temp_list,final_save_dict.current_level=curr_level,temp_lvl_conf=final_save_dict.level_config[curr_level],new_approver_group="",new_approver_user="",new_approver_type=temp_lvl_conf.approver_type,"user_list"in temp_lvl_conf&&(new_approver_user=temp_lvl_conf.user_list),"group_list"in temp_lvl_conf&&(new_approver_group=temp_lvl_conf.group_list),new_approver_group&&$(`#id_approver_group_${e}`).val(JSON.stringify(new_approver_group)).trigger("change"),new_approver_user&&$(`#id_approver_user_${e}`).val(JSON.stringify(new_approver_user)).trigger("change"),new_approver_type&&$(`#id_approver_type_${e}`).val(new_approver_type).trigger("change"),$(`#id_approval_level_config_${e}`).val(JSON.stringify(final_save_dict)).trigger("change"),$(`#list_view_edit_modal_${e}`).find('input[name="approval_level_change_comment_edit"]').attr("value",a),$("#"+e+"_tab_content").find(`#approvalCommentModal_${e}`).css("display","none"),$("#"+e+"_tab_content").find(`#approvalCommentModal_${e}`).css("opacity",0),$("#"+e+"_tab_content").find(`#approvalCommentModal_${e}`).css("z-index",1050),$("#"+e+"_tab_content").find(`#approvalCommentModal_${e}`).find("#approval_final_send").attr("onclick","approve_ind.call(this)")}function editApprovalLevels(e,t){$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"get_user_group_list"},type:"POST",dataType:"json",success:function(a){function l(){$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).attr("approval_level_reordered","true"),$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).find(".approval_level_divs").each(function(e){old_data_level=$(this).attr("data-level"),$(this).attr("old-data-level",old_data_level),$(this).attr("data-level",e),$(this).find(".remove-level").attr("data-level",e),$(this).find(".levelclass").html(`Level ${e}`),$(this).find("input.input_change,select.input_change").each(function(){old_name=$(this).attr("name"),new_name=old_name.split("__")[0]+"__"+e,$(this).attr("name",new_name),$(this).attr("id",new_name)})})}user_list=a.user_list,group_list=a.group_list,maximum_levels_allowed=$(`#approvalWallModalBody_${elementID}`).attr("data-maximum_levels_allowed"),maximum_approvers_allowed=$(`#approvalWallModalBody_${elementID}`).attr("data-maximum_approvers_allowed"),$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).sortable({items:"> div:not(.approval_level_divs.no_sort)",forcePlaceholderSize:!0,update:function(e,t){l()}}),approval_levels=approval_level_config.level_config,current_level=approval_level_config.current_level;for(let e in approval_levels)if(!(e<current_level)){parent_div=$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).find(`div[data-level='${e}']`),drag_html=`\n            <div style="width: fit-content;float: right;color:red;font-size:17px" data-level='${e}' data-toggle="tooltip" onclick="removeApprovaLevel(this,${current_level})" title="Remove Level">\n              <span><i class="fa fa-times-circle"></i></span>\n            </div>\n            <div style="width: fit-content;cursor:move;" data-toggle="tooltip" title="Drag to Reorder Level">\n              <span class="ui-icon ui-icon-arrowthick-2-n-s mt-1 mb-1"></span>\n            </div>`,$(parent_div).prepend(drag_html);for(let[t,a]of Object.entries(approval_levels[e]))if(select_html="","approver_type"==t)select_html=`\n                  <select name="edit_${t}__${e}" id="edit_${t}__${e}" onchange="$(this).siblings('[data-col=${t}]').text($(this).val());" data-edit-col="${t}__${e}" class="select2 input_change">\n                    <option data-toggle="tooltip" title="Please note: Several Approvers implies that the approval decision can be undertaken by any single member from the list of approvers" value="several">Several Approvers</option>\n                    <option data-toggle="tooltip" title="Please note: Joint Approvers implies that the approval decision will need to be individually undertaken by all members from the list of approvers" value="joint">Joint Approvers</option>\n                  </select>\n                `,$(select_html).insertAfter($(parent_div).find(`[data-col=${t}]`)),$(parent_div).find(`[data-col=${t}]`).css("display","none"),$(`[name=edit_${t}__${e}]`).select2({width:"100%"}),$(`[name=edit_${t}__${e}]`).val(a).trigger("change");else if("user_list"==t){select_html=`\n                  <select multiple name="edit_${t}__${e}" id="edit_${t}__${e}" onchange="$(this).siblings('[data-col=${t}]').text($(this).val());" data-edit-col="${t}__${e}" class="select2 input_change" style="width:100%">\n                    `;for(let[e,t]of Object.entries(user_list))a.includes(e)?select_html+=`<option selected value="${e}">${t.replace("( )","")}</option>`:select_html+=`<option value="${e}">${t.replace("( )","")}</option>`;select_html+="</select>",$(select_html).insertAfter($(parent_div).find(`[data-col=${t}]`)),$(parent_div).find(`[data-col=${t}]`).css("display","none"),$(`[name=edit_${t}__${e}]`).select2({width:"100%",maximumSelectionLength:maximum_approvers_allowed})}else if("group_list"==t){for(group of(select_html=`\n                  <select multiple name="edit_${t}__${e}" id="edit_${t}__${e}" onchange="$(this).siblings('[data-col=${t}]').text($(this).val());" data-edit-col="${t}__${e}" class="select2 input_change" style="width:100%">\n                    `,group_list))a.includes(group)?select_html+=`<option selected value="${group}">${group}</option>`:select_html+=`<option value="${group}">${group}</option>`;select_html+="</select>",$(select_html).insertAfter($(parent_div).find(`[data-col=${t}]`)),$(parent_div).find(`[data-col=${t}]`).css("display","none"),$(`[name=edit_${t}__${e}]`).select2({width:"100%",maximumSelectionLength:maximum_approvers_allowed})}else"approval_type"==t&&(input_html=`<input type="text" class="form-control textInput input_change" name="edit_${t}__${e}" value="${a}" id="edit_${t}__${e}" data-edit-col="${t}__${e}" disabled>`,$(input_html).insertAfter($(parent_div).find(`[data-col=${t}]`)),$(parent_div).find(`[data-col=${t}]`).css("display","none"))}$(`#approvalWallModalBody_${elementID}`).find(".levelclass").css("margin-top","25%"),$(`#approvalWallModalBody_${elementID}`).find(`#edit_approval_levels_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`#save_approval_levels_${elementID}`).css("display","block"),$(`#approvalWallModalBody_${elementID}`).find(`#add_levels_div_${elementID}`).css("display","block"),t=JSON.stringify(t),$(`#approvalWallModalBody_${elementID}`).find(`#add_approval_levels_${elementID}`).attr("onclick",`addApprovalLevel(this,'${e}',${t}, '${maximum_levels_allowed}', '${maximum_approvers_allowed}')`)},error:function(){Swal.fire({icon:"error",text:"Error while getting the users/group list."})}})}function removeApprovaLevel(e,t){if($("#maximum_level_count_aw").css("display","none"),$(`#add_approval_levels_${elementID}`).prop("disabled",!1),$(e).attr("removed-old-data-level")?(removed_old_data_level=$(e).attr("removed-old-data-level"),removed_data_level=$(e).attr("data-level")):removed_data_level=$(e).attr("data-level"),levels_length=$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).find(".approval_level_divs").length,levels_length-=parseInt(t),levels_length>1)if("true"==$(e).attr("data-added-level"))$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).find(`div[data-level='${removed_data_level}']`).remove(),$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).find(".approval_level_divs").each(function(e){removed_old_data_level=$(this).attr("data-level"),$(this).attr("removed-old-data-level",removed_old_data_level),$(this).attr("data-level",e),$(this).find(".remove-level").attr("data-level",e),$(this).find(".levelclass").html(`Level ${e}`),$(this).find(`[data-level=${removed_old_data_level}]`).attr("data-level",e),$(this).find("input.input_change,select.input_change").each(function(){old_name=$(this).attr("name"),new_name=old_name.split("__")[0]+"__"+e,$(this).attr("name",new_name),$(this).attr("id",new_name)})});else{$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).find(`div[data-level='${removed_data_level}']`).remove();let e="";removed_levels_list=$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).attr("approval_level_removed"),null==removed_levels_list||""==removed_levels_list||"[]"==removed_levels_list?e=[removed_data_level]:(removed_levels_list=JSON.parse(removed_levels_list),removed_levels_list.push(removed_old_data_level),e=removed_levels_list),e&&$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).attr("approval_level_removed",JSON.stringify(e)),$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).find(".approval_level_divs").each(function(e){removed_old_data_level=$(this).attr("data-level"),$(this).attr("removed-old-data-level",removed_old_data_level),$(this).attr("data-level",e),$(this).find(".remove-level").attr("data-level",e),$(this).find(".levelclass").html(`Level ${e}`),$(this).find(`[data-level=${removed_old_data_level}]`).attr("data-level",e),$(this).find("input.input_change,select.input_change").each(function(){old_name=$(this).attr("name"),new_name=old_name.split("__")[0]+"__"+e,$(this).attr("name",new_name),$(this).attr("id",new_name)})})}}function addApprovalLevel(e,t,a,l,n){if(current_level=a.current_level,total_level=$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).find(".approval_level_divs:last-child").attr("data-level"),levels=$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).find(".approval_level_divs").length,""!=l&&levels==l)add_level_html=`\n      <div class="row" id="maximum_level_count_aw" style="color:red;display:block;">\n      <div class="form-group col-12">\n        <span>\n          Maximum Approver Levels count : ${l}.\n        </span>\n      </div>\n    </div>`,$(add_level_html).insertAfter(`#header_div_${elementID}`),$(`#add_approval_levels_${elementID}`).prop("disabled",!0);else{add_level_html=`\n      <div data-level="${parseInt(total_level)+1}" class="approval_level_divs">\n        <div style="width: fit-content;float: right;color:red;font-size:17px;cursor:pointer;" class="remove-level" class="remove-level" data-added-level="true" data-level='${parseInt(total_level)+1}' data-toggle="tooltip" onclick="removeApprovaLevel(this,${current_level})" title="Remove Level">\n          <span><i class="fa fa-times-circle"></i></span>\n        </div>\n        <div style="width: fit-content;cursor:move;" data-toggle="tooltip" title="Drag to Reorder Level">\n          <span class="ui-icon ui-icon-arrowthick-2-n-s mt-1 mb-1"></span>\n        </div>\n\n        <div class="row">\n          <div class="col-3">\n            <div class="levelclass" style="background: darkgrey;color:white;">Level ${parseInt(total_level)+1}</div>\n          </div>\n          <div class="col-9" style="border-left: 1px solid lightgrey;">\n            <div style="border-radius: 0.5rem;margin-left: 6px;padding: 4px;text-align: left;">\n              <div>\n                <select class="form-control select2 input_change approver_type__${parseInt(total_level)+1}" data-col="approver_type" style="width:100%" name="edit_approver_type__${parseInt(total_level)+1}" id="edit_approver_type__${parseInt(total_level)+1}" data-edit-col="approver_type__${parseInt(total_level)+1}">\n                  <option value="several">Several Approvers</option>\n                  <option value="joint">Joint Approvers</option>\n                </select>\n              </div>\n            </div>\n            <div style="border-radius: 0.5rem;padding: 10px;text-align: left;">\n              <h6 style="margin-bottom: 0.5rem;font-size:13px;text-transform: capitalize;text-align: left;">Approval Type</h6>\n              <select class="form-control select2 input_change approval_type__${parseInt(total_level)+1}" data-col="approval_type" style="width:100%" name="edit_approval_type__${parseInt(total_level)+1}" id="edit_approval_type__${parseInt(total_level)+1}" data-edit-col="approval_type__${parseInt(total_level)+1}">\n                <option value="" selected>Select One</option>\n                <option value="static">Static Group Based</option>\n                <option value="static_user">Static User Based</option>\n              </select>\n            </div>\n            <div style="border-radius: 0.5rem;padding: 10px;text-align: left;" class="div_user_list__${parseInt(total_level)+1}">\n              <h6 style="margin-bottom: 0.5rem;font-size:13px;text-transform: capitalize;text-align: left;">Approvers</h6>\n              <select class="form-control select2 input_change user_list__${parseInt(total_level)+1}" data-col="user_list" style="width:100%" name="edit_user_list__${parseInt(total_level)+1}" id="edit_user_list__${parseInt(total_level)+1}" data-edit-col="user_list__${parseInt(total_level)+1}"disabled multiple>\n                `;for(let[e,t]of Object.entries(user_list))add_level_html+=`<option value="${e}">${t}</option>`;for(group of(add_level_html+=`\n              </select>\n            </div>\n            <div style="border-radius: 0.5rem;padding: 10px;text-align: left;" class="div_group_list__${parseInt(total_level)+1}">\n              <h6 style="margin-bottom: 0.5rem;font-size:13px;text-transform: capitalize;text-align: left;">Group Approvers</h6>\n              <select class="form-control select2 input_change group_list__${parseInt(total_level)+1}" data-col="group_list" style="width:100%" name="edit_group_list__${parseInt(total_level)+1}" id="edit_group_list__${parseInt(total_level)+1}" data-edit-col="group_list__${parseInt(total_level)+1}" disabled multiple>\n                `,group_list))add_level_html+=`<option value="${group}">${group}</option>`;add_level_html+="\n              </select>\n            </div>\n          </div>\n        </div>\n      </div>\n      ",$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).append(add_level_html)}$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).attr("data-level-added","true"),$(`[data-level="${parseInt(total_level)+1}"]`).find(".select2").select2(),$(`#edit_group_list__${parseInt(total_level)+1}`).select2({maximumSelectionLength:n}),$(`#edit_user_list__${parseInt(total_level)+1}`).select2({maximumSelectionLength:n}),$(`.approval_type__${parseInt(total_level)+1}`).change(function(){"static"==this.value?($(this).closest(".approval_level_divs").find(`.div_group_list__${parseInt(total_level)+1}`).css("display","block"),$(this).closest(".approval_level_divs").find(`.group_list__${parseInt(total_level)+1}`).prop("disabled",!1),$(this).closest(".approval_level_divs").find(`.user_list__${parseInt(total_level)+1}`).prop("disabled",!0),$(this).closest(".approval_level_divs").find(`.user_list__${parseInt(total_level)+1}`).val("").trigger("change"),$(this).closest(".approval_level_divs").find(`.div_user_list__${parseInt(total_level)+1}`).css("display","none")):"static_user"==this.value&&($(this).closest(".approval_level_divs").find(`.div_user_list__${parseInt(total_level)+1}`).css("display","block"),$(this).closest(".approval_level_divs").find(`.user_list__${parseInt(total_level)+1}`).prop("disabled",!1),$(this).closest(".approval_level_divs").find(`.group_list__${parseInt(total_level)+1}`).prop("disabled",!0),$(this).closest(".approval_level_divs").find(`.group_list__${parseInt(total_level)+1}`).val("").trigger("change"),$(this).closest(".approval_level_divs").find(`.div_group_list__${parseInt(total_level)+1}`).css("display","none"))})}function saveLevelChangeComment(e,t){$("#"+elementID+"_tab_content").find(`#approvalCommentModal_${elementID}`).find(".modal-title").text("Approval Level Change Comment"),
$("#"+elementID+"_tab_content").find(`#approvalCommentModal_${elementID}`).find(".modal-title").css("color","black"),$("#"+elementID+"_tab_content").find(`#approvalCommentModal_${elementID}`).find(".approvers_edit_data").css("margin-bottom","unset"),$("#"+elementID+"_tab_content").find(`#approvalCommentModal_${elementID}`).find("#approval_final_send").text("Save comment"),$("#"+elementID+"_tab_content").find(`#approvalCommentModal_${elementID}`).modal("show"),$("#"+elementID+"_tab_content").find(`#approvalCommentModal_${elementID}`).css("z-index",2e3),$("#"+elementID+"_tab_content").find(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("data-approval_type","app_lvl_change"),t=JSON.stringify(t),$("#"+elementID+"_tab_content").find(`#approvalCommentModal_${elementID}`).find("#approval_final_send").attr("onclick",`saveApprovalLevels.call(this,'${e}',${t})`)}function saveApprovalLevels(e,t){var a=JSON.parse(JSON.stringify(t.level_config)),l=[];temp_list=[],final_save_dict={},curr_level=t.current_level;let n=CKEDITOR.instances[`approvalCommentText${elementID}`].getData().replaceAll("&#39;","&rsquo;").replaceAll("&quot","&rdquo;");var i=$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).attr("approval_level_reordered");null==i||""==i?i=!1:"true"==i&&(i=!0);var o=$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).attr("data-level-added");null==o||""==o?o=!1:"true"==o&&(o=!0);var s=$(`#approvalWallModalBody_${elementID}`).find(`#view_at_all_levels_${elementID}`).attr("approval_level_removed");s=null==s||""==s||"[]"==s?[]:JSON.parse(s);for(let e in s)t.level_config.splice(parseInt(e),1);for($(`#approvalWallModalBody_${elementID}`).find(".approval_level_divs").each(function(){level=$(this).attr("data-level"),old_data_level=$(this).attr("old-data-level"),parent_div=$(this),level>=curr_level&&(temp_dict={},$(this).find("[data-col]").each(function(){key=$(this).attr("data-col"),""!=$(parent_div).find(`[name=edit_${key}__${level}]`).val()&&"[]"!=$(parent_div).find(`[name=edit_${key}__${level}]`).val()&&(temp_dict[key]=$(parent_div).find(`[name=edit_${key}__${level}]`).val())}),t.level_config[level]=temp_dict)}),index=0;index<a.length;index++)if(data=a[index],s.includes(index)){var r={index:index,userChanged:null,groupChanged:null,approverTypeChanged:null,approvalChanged:null,isDeleted:!0};l[index]=r}else{r={index:index,userChanged:null,groupChanged:null,approverTypeChanged:null,approvalChanged:null,isDeleted:!1};0==s.length&&(data.approver_type!=t.level_config[index].approver_type&&(r.approverTypeChanged=data.approver_type),data.approval_type!=t.level_config[index].approval_type&&(r.approvalChanged=data.approval_type),JSON.stringify(data.user_list)!=JSON.stringify(t.level_config[index].user_list)&&(r.userChanged=data.user_list),JSON.stringify(data.group_list)!=JSON.stringify(t.level_config[index].group_list)&&(r.groupChanged=data.group_list)),r.userChanged||r.groupChanged||r.approverTypeChanged||r.approvalChanged?l[index]=r:l[index]=null}$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"editApprovalLevelsAprrovalWall",listOfChangedLevel:JSON.stringify(l),new_approval_level_configs:JSON.stringify({level_config:t.level_config,current_level:curr_level}),old_approval_level_configs:JSON.stringify({level_config:a,current_level:curr_level}),id:e,edit_comment:n,current_level:curr_level,approval_level_reordered:JSON.stringify(i),level_added:JSON.stringify(o),all_removed_levels:JSON.stringify(s)},type:"POST",dataType:"json",success:function(e){$("#"+elementID+"_tab_content").find(`#approvalCommentModal_${elementID}`).modal("hide"),Swal.fire({icon:"success",text:"Approval Level configurations updated successfully!"}).then(e=>{e.isConfirmed&&location.reload()})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function editApprovers(e,t,a){$(`#approvalWallModalBody_${elementID}`).find(`#edit_approvers_${elementID}`).css("display","none"),$(`#approvalWallModalBody_${elementID}`).find(`#save_approvers_${elementID}`).css("display","block"),$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"get_user_group_list"},type:"POST",dataType:"json",success:function(e){if(user_list=e.user_list,group_list=e.group_list,maximum_levels_allowed=$(`#approvalWallModalBody_${elementID}`).attr("data-maximum_levels_allowed"),maximum_approvers_allowed=$(`#approvalWallModalBody_${elementID}`).attr("data-maximum_approvers_allowed"),"static_user"==a||"dynamic_user"==a){selected_approvers=[],$(`#approvalWallModalBody_${elementID}`).find(`#approver_users_${element_id}`).find("ul").find("li.li_approvers").each(function(){username=$(this).find(".approvers_username").text(),selected_approvers.push(username),$(this).css("display","none")}),select_html='\n            <select class="edit_approvers_select select2 form-control" multiple style="width:100%">\n          ';for(let[e,t]of Object.entries(user_list))selected_approvers.includes(e)?select_html+=`<option selected value="${e}">${t.replace("( )","")}</option>`:select_html+=`<option value="${e}">${t.replace("( )","")}</option>`;select_html+="</select>",$(`#approver_users_${elementID}`).append(select_html),$(`#approver_users_${elementID}`).find(".edit_approvers_select").select2({maximumSelectionLength:maximum_approvers_allowed})}else if("static"==a||"dynamic_group"==a){for(group of($(`#approvalWallModalBody_${elementID}`).find(`#approver_users_${element_id}`).find("ul").find("li.li_approvers").each(function(){$(this).css("display","none")}),select_html='\n            <select class="edit_approvers_select select2 form-control" multiple style="width:100%">\n          ',group_list))t.includes(group)?select_html+=`<option selected value="${group}">${group}</option>`:select_html+=`<option value="${group}">${group}</option>`;select_html+="</select>",$(`#approver_users_${elementID}`).append(select_html),$(`#approver_users_${elementID}`).find(".edit_approvers_select").select2({maximumSelectionLength:maximum_approvers_allowed})}},error:function(){Swal.fire({icon:"error",text:"Error while getting the users/group list."})}})}function saveApprovers(e,t,a,l,n,i){var o=$(`#approver_users_${elementID}`).find(".edit_approvers_select").val();if("static_user"==n||"dynamic_user"==n){old_approvers=[];for(var s=0;s<a.length;s++)old_approvers.push(a[s].username)}else"static"!=n&&"dynamic_group"!=n||(old_approvers=t);$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"saveStaticApprovers",new_approvers:JSON.stringify(o),old_approvers:JSON.stringify(old_approvers),old_approval_audit_log:JSON.stringify(l),id:e,type_of_approval:n,approver_type:i},type:"POST",dataType:"json",success:function(e){Swal.fire({icon:"success",text:"Approvers configurations updated successfully!"}).then(e=>{e.isConfirmed&&location.reload()})},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}})}function listview_auto_compute(e){const t=$(`#autoCompute_${e}`);if(t.length>0){const l=$(t).attr("data-elementID"),n=[];let i={},o={};const s={},r=[];$("#list_view_edit_modal_"+l).find("div").find("form").find(".form-row").find('[data-computed-field="true"]').each(function(){n.push($(this).attr("id").replace("id_","").replace("_"+l,"")),i[$(this).attr("id").replace("id_","").replace("_"+l,"")]=JSON.parse($(this).attr("data-comp_input"))});const d=$(t).attr("data-table-name").replace('["',"").replace('"]',"");var a=$("form").find("input[name='csrfmiddlewaretoken']").attr("value");$.ajaxSetup({beforeSend:function(e,t){e.setRequestHeader("X-CSRFToken",a)}});for(let[e,t]of Object.entries(i))for(let a=0;a<t.length;a++)t[a]in o?o[t[a]].push(e):o[t[a]]=[e];for(let[t,a]of Object.entries(o))$(`#id_${t}_${e}`).on("change dp.change",function(){for(let e in a){let t=i[a[e]],o="no";for(let e=0;e<t.length;e++){if(""==$(`#id_${t[e]}_${l}`).val()||null==$(`#id_${t[e]}_${l}`).val()||"---"==$(`#id_${t[e]}_${l}`).val()||"----"==$(`#id_${t[e]}_${l}`).val()){o="no";break}o="yes"}"yes"==o&&($("#list_view_edit_modal_"+l).find("div").find("form").find(".form-row").find("input[data-field_name],select[data-field_name]").each(function(){let e=$(this).val();""===String(e)&&(e="NaN");const t=$(this).attr("id").replace("id_","").replace("_"+l,""),a=$(this).attr("datatype");s[t]=e,r.push(a)}),$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{element_id:l,operation:"calculate_computed_value_auto",values_dic:JSON.stringify(s),datatype_list:JSON.stringify(r),table_name:JSON.stringify(d),field_name:a[e]},type:"POST",dataType:"json",success:function(e){if("yes"===String(e.error_msg))for(let t=0;t<e.f_list.length;t++)Swal.fire({icon:"error",text:`Error while calculating : ${e.f_list[t]} - ${e.e_list[t]}`});else for(const[t,a]of Object.entries(e.data[0]))for(let e=0;e<n.length;e++)String(t)===n[e]&&$("#id_"+n[e]+"_"+l).val(a).trigger("change")},error:function(){Swal.fire({icon:"error",text:"Error! Please try again."})}}))}})}}ctoken=$("form").find("input[name='csrfmiddlewaretoken']").attr("value"),$.ajaxSetup({beforeSend:function(e,t){e.setRequestHeader("X-CSRFToken",ctoken)}});var cellIndex1,cellIndex2,cellIndex3,cellColLen3,cellColLen4,cellColLen5,findreplaceData,filter_list={},freezeDict2={left:0,right:0},freezeDict3={left:0,right:0},freezeDict4={left:0,right:0},adjustTable=function(){setTimeout(()=>{$(`#${$(this).attr("data-id")}`).DataTable().columns.adjust()},500)},scenarioDetail=function(){const e=$(this).attr("data-data"),t=$(this).attr("data-s_id");$.ajax({url:`/users/${urlPath}/dynamicVal/`,data:{operation:"fetch_scenario_detail",data:e,s_id:t},type:"POST",dataType:"json",success:function(e){$("#scenarioModal").find(".modal-body").empty();const t=[];for(const[a,l]of Object.entries(e)){const e=`\n                <div class="card card-default collapsed-card">\n                  <div class="card-header">\n                    <h6 class="card-title" style="font-size: medium; color:var(--primary-color); font-weight: bold;">${a}</h6>\n\n                    <div class="card-tools">\n\n                      <button type="button" class="btn btn-tool" onclick="adjustTable.call(this)" data-id="${a}" data-card-widget="collapse"><i class="fas fa-plus"></i></button>\n\n                    </div>\n                  </div>\n                  <div class="card-body">\n                    <table id="${a}" class="row-border display" style="width: 100%;">\n                      <thead>\n                      </thead>\n                      <tbody>\n                      </tbody>\n                    </table>\n                  </div>\n                </div>\n                `;$("#scenarioModal").find(".modal-body").append(e);let n="",i="";for(let e=0;e<l.length;e++){i+="<tr>",n="";for(let[t,a]of Object.entries(l[e]))n+=`<th>${t}</th>`,"null"===a&&(a=""),i+=`<td class="view_details_wrap">${a.toString()}</td>`;i+="</tr>"}$("#scenarioModal").find(".modal-body").find("#"+a).find("thead").append("<tr>"+n+"</tr>"),$("#scenarioModal").find(".modal-body").find("#"+a).find("tbody").append(i),datatables(a),t.push(a)}$("#scenarioModal").modal("show"),setTimeout(()=>{for(let e=0;e<t.length;e++)$(`#${t[e]}`).DataTable().columns.adjust()},500)},error:()=>{Swal.fire({icon:"error",text:"Error! Please try again."})}})};$("#run_saved_scenario").click(function(){const e=$(this).attr("data-scenario_id"),t=$(this).attr("data-scenario_config"),a=$(this).attr("data-element_id"),l=$("#scenario_name_").val(),n=[];let i={};$(`#computationForm_${a}`).find("div.form-row").each(function(){$(this).find("div.form-group").each(function(){i="0"===String($(this).find("select").length)?{varName:$(this).find("label").text(),inputValue:$(this).find("input").val()}:{varName:$(this).find("label").text(),inputValue:$(this).find("select").val()},n.push(i)})}),$(`#computationForm_${a}`).find("div.form-row").each(function(){const e=$(this).attr("data-parent_element_id");$(this).find("div.form-group").each(function(){if("file"===$(this).find("input[name=gVarFileRM]").attr("type")){const t=new FormData($(this).find("form.gVarFileInput")[0]);t.append("operation","gVarFileRunModel"),t.append("gVarName",$(this).find("label.gVarNameLabel").text()),t.append("elementID",e),$.ajax({url:`/users/${urlPath}/computationModule/`,data:t,type:"POST",cache:!1,contentType:!1,processData:!1,success:function(e){},error:()=>{Swal.fire({icon:"error",text:"Error! Please try again."})}})}})}),$.ajax({url:`/users/${urlPath}/computationModule/`,data:{config:JSON.stringify({model:$(`#modelName_${a}`).attr("data-model_name"),configGlobalDict:n,configGlobalFunc:[]}),scenario_name:l,scenario_id:e,scenario_config:t,operation:"run_scenario"},type:"POST",dataType:"json",success:function(e){if($(`#viewRunScenarioData_${a}`).empty(),$(`#viewRunScenarioData_${a}`).append(`<div class="card shadow-sm  bg-white rounded;">\n          <div class="card-body" style="padding:0.9rem;">\n              <table id="exampledataResultsScenarioRun_${a}" class="display compact" style="width:100%;">\n                  <thead>\n                      <tr></tr>\n                  </thead>\n                  <tbody>\n                  </tbody>\n              </table>\n          </div>\n        </div>\n        <div style="float:right;">\n            <button type="button" id="quitRunScenarioData_${a}" class="btn btn-primary btn-xs mx-2 rounded px-2" data-dismiss="modal">Close</button>\n        </div>\n        `),$(`#exampledataResultsScenarioRun_${a} tbody`).empty(),$(`#exampledataResultsScenarioRun_${a} thead tr`).empty(),e.hasOwnProperty("content")){for(const[t,l]of Object.entries(e.content[0]))$(`#exampledataResultsScenarioRun_${a}`).find("thead tr").eq(0).append(`<th>${t}</th>`);for(let t=0;t<e.content.length;t++){let l="<tr>";for(const[a,n]of Object.entries(e.content[t]))l+=`<td>${n}</td>`;l+="</tr>",$(`#exampledataResultsScenarioRun_${a}`).find("tbody").append(l)}$(`#runscenarioDataOutputModal_${a}`).modal("show"),initialise_table_results("exampledataResultsScenarioRun",a)}},error:function(){Swal.fire({icon:"error",text:"Error! Failure in running the scenario. Please try again."})}})}),$(document).ready(function(){$("#ckEditorModal").on("shown.bs.modal",function(){$(document).off("focusin.modal")}),$(".copy_class_to_apply").bind({copy:function(){return!1}}),$(".paste_class_to_apply").bind({paste:function(){return!1}}),$(".dtrangepicker").daterangepicker({locale:{format:"YYYY-MM-DD"}}),$(".dtrangepicker").val(""),$(".dttrangepicker").daterangepicker({timePicker:!0,timePicker24Hour:!0,timePickerSeconds:!0,locale:{format:"YYYY-MM-DD HH:mm:ss"}}),$(".dttrangepicker").val(""),$(".ttrangepicker").daterangepicker({timePicker:!0,timePicker24Hour:!0,timePickerIncrement:1,timePickerSeconds:!0,locale:{format:"HH:mm:ss"}}).on("show.daterangepicker",function(e,t){t.container.find(".calendar-table").hide()}),$(".ttrangepicker").val(""),$(".ttrangepicker_sec").daterangepicker({timePicker:!0,timePicker24Hour:!0,timePickerIncrement:1,locale:{format:"HH:mm"}}).on("show.daterangepicker",function(e,t){t.container.find(".calendar-table").hide()}),$(".ttrangepicker_sec").val(""),$(".dttrangepicker_sec").daterangepicker({timePicker:!0,timePicker24Hour:!0,locale:{format:"YYYY-MM-DD HH:mm"}}),$(".dttrangepicker_sec").val(""),$(".popoverclass_card").popover({trigger:"focus"}),$(".user_logo").select2({templateResult:formatState1,templateSelection:formatState2})}),$(document).ready(function(){$(".mandatory").on("change",function(){let e=$(this).attr("data-mandatory_list");e=e.replaceAll("'",'"'),e.length>0?mandatory=JSON.parse(e):mandatory=[];let t=[],a=$(this).attr("data-id");$(this).attr("data-elementid");$(`#computationForm_${a}`).find("input,select").each(function(){mandatory.includes($(this).attr("data-var_name"))&&(var_value=$(this).val(),null!=var_value&&""!=var_value&&t.push(var_value))});var l=Array.from(new Set(t));l.length==mandatory.length?$(`#runModel_${a}`).prop("disabled",!1):$(`#runModel_${a}`).prop("disabled",!0)})}),$(".validation").on("change",function(){let e=[],t={},a=-1,l=-1,n=-1;if("null"!=$(this).attr("data-val")){let s=$(this).attr("data-val"),r=$(this).attr("data-custom_message"),d=$(this).attr("data-id");if(s.length>0){s=JSON.parse(s),a=$(this).val();for(let e=0;e<s.length;e++)s[e].varConst in t?t[s[e].varConst].push(s[e]):t[s[e].varConst]=[s[e]];constraint_dict_copy=t;for(let[e,a]of Object.entries(constraint_dict_copy)){ruleset_dict={};for(let e=0;e<a.length;e++)a[e].varRule in ruleset_dict?ruleset_dict[a[e].varRule].push(a[e]):ruleset_dict[a[e].varRule]=[a[e]];t[e]=ruleset_dict}for(let[s,r]of Object.entries(t)){temp_test=[];for(let[e,t]of Object.entries(r)){l=-1,n=-1;for(let e=0;e<t.length;e++){column_value=$(this).val();var i=t[e].varValue,o=$(this).attr("type");"number"==o&&(column_value.constructor===Array?column_value=column_value.map(function(e){return parseFloat(e)}):column_value=parseFloat(column_value),i=i.constructor===Array?i.map(function(e){return parseFloat(e)}):parseFloat(i)),condition=t[e].varCond,rule_set=t[e].varRule,"IN"==condition?a=!!i.includes(column_value):"Not IN"==condition?a=!i.includes(column_value):"Equal"==condition?a=i==column_value:"Unequal"==condition?a=i!=column_value:"Starts"==condition?a=!!column_value.startsWith(i):"Neg_Start"==condition?a=!column_value.startsWith(i):"Ends"==condition?a=!!column_value.endsWith(i):"Neg_End"==condition?a=!column_value.endsWith(i):"Contains"==condition?a=!!column_value.includes(i):"Neg_Contains"==condition?a=!!column_value.includes(i):"Greater"==condition?a=column_value>i:"Greater_Than"==condition?a=column_value>=i:"Smaller"==condition?a=column_value<i:"Smaller_Than"==condition&&(a=column_value<=i),-1!=l&&-1!=n?(a=n==rule_set?a&&l:a||l,n=rule_set,l=a):(l=a,n=rule_set)}temp_test.push(a)}e.push(temp_test.some(Boolean))}evaluate=e.every(Boolean),!1===evaluate?r.length>0?(Swal.fire({icon:"error",text:r}),$(`#runModel_${d}`).prop("disabled",!0)):(Swal.fire({icon:"error",text:"Validation Failed! Please enter a valid input."}),$(`#runModel_${d}`).prop("disabled",!0)):$(`#runModel_${d}`).prop("disabled",!1)}}}),$(".run_draw_carousel").on("slid.bs.carousel",function(){const e=$(this).find(".carousel-item.active").parent().attr("id").replace("MultiRunCarouselInn_",""),t=$(this).find(".carousel-item.active").attr("id").replace(`_carousel_${e}`,"").replace("run_","");$(`#runModelTable_multi_run${e}_${t}`).DataTable().draw()}),$(".check_validForm_now").on("change dp.change",checkValidationNow),$(".column_validator").on("change dp.change",checkValidationNowCol);var tableFieldData,validation=function(){parseInt($(this).val())<1&&$(this).val(1).trigger("change"),parseInt($(this).val())>parseInt($(this).attr("maximum"))&&$(this).val(parseInt($(this).attr("maximum"))).trigger("change")},recurrElementID="";$(".recpattern").off("select2:select").on("select2:select",function(){"Daily"==$(this).val()?($(".daily_div").css("display","block"),$(".weekly_div").css("display","none"),$(".monthly_div").css("display","none"),$(".yearly_div").css("display","none")):"Weekly"==$(this).val()?($(".daily_div").css("display","none"),$(".weekly_div").css("display","block"),$(".monthly_div").css("display","none"),$(".yearly_div").css("display","none")):"Monthly"==$(this).val()?($(".daily_div").css("display","none"),$(".weekly_div").css("display","none"),$(".monthly_div").css("display","block"),$(".yearly_div").css("display","none")):"Yearly"==$(this).val()&&($(".daily_div").css("display","none"),$(".weekly_div").css("display","none"),$(".monthly_div").css("display","none"),$(".yearly_div").css("display","block"))}),$(".daily_div input[name=data_choice1]").on("change",function(){checked_val=$("input[name=data_choice1]:checked",".daily_div").val(),"Everyday"!=checked_val?$(".rec_daily_days_no").attr("disabled",!0):$(".rec_daily_days_no").attr("disabled",!1)}),$(".range_div input[name=data_choice2]").on("change",function(){checked_val=$("input[name=data_choice2]:checked",".range_div").val(),"endafter"!=checked_val?$(".rec_occurr").attr("disabled",!0):$(".rec_occurr").attr("disabled",!1)}),$(".user_logo").select2({templateResult:formatState1,templateSelection:formatState2});